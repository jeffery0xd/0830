var e=Object.defineProperty,t=(t,r,n)=>((t,r,n)=>r in t?e(t,r,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[r]=n)(t,"symbol"!=typeof r?r+"":r,n);!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver(e=>{for(const r of e)if("childList"===r.type)for(const e of r.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)}).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();var r="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function n(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function a(e){if(e.__esModule)return e;var t=e.default;if("function"==typeof t){var r=function e(){return this instanceof e?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};r.prototype=t.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(e).forEach(function(t){var n=Object.getOwnPropertyDescriptor(e,t);Object.defineProperty(r,t,n.get?n:{enumerable:!0,get:function(){return e[t]}})}),r}var s={exports:{}},i={},o={exports:{}},l={},c=Symbol.for("react.element"),d=Symbol.for("react.portal"),u=Symbol.for("react.fragment"),h=Symbol.for("react.strict_mode"),f=Symbol.for("react.profiler"),m=Symbol.for("react.provider"),p=Symbol.for("react.context"),g=Symbol.for("react.forward_ref"),x=Symbol.for("react.suspense"),v=Symbol.for("react.memo"),b=Symbol.for("react.lazy"),y=Symbol.iterator;var w={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},_=Object.assign,k={};function N(e,t,r){this.props=e,this.context=t,this.refs=k,this.updater=r||w}function j(){}function S(e,t,r){this.props=e,this.context=t,this.refs=k,this.updater=r||w}N.prototype.isReactComponent={},N.prototype.setState=function(e,t){if("object"!=typeof e&&"function"!=typeof e&&null!=e)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},N.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},j.prototype=N.prototype;var T=S.prototype=new j;T.constructor=S,_(T,N.prototype),T.isPureReactComponent=!0;var E=Array.isArray,C=Object.prototype.hasOwnProperty,A={current:null},O={key:!0,ref:!0,__self:!0,__source:!0};function I(e,t,r){var n,a={},s=null,i=null;if(null!=t)for(n in void 0!==t.ref&&(i=t.ref),void 0!==t.key&&(s=""+t.key),t)C.call(t,n)&&!O.hasOwnProperty(n)&&(a[n]=t[n]);var o=arguments.length-2;if(1===o)a.children=r;else if(1<o){for(var l=Array(o),d=0;d<o;d++)l[d]=arguments[d+2];a.children=l}if(e&&e.defaultProps)for(n in o=e.defaultProps)void 0===a[n]&&(a[n]=o[n]);return{$$typeof:c,type:e,key:s,ref:i,props:a,_owner:A.current}}function R(e){return"object"==typeof e&&null!==e&&e.$$typeof===c}var P=/\/+/g;function D(e,t){return"object"==typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(e){return t[e]})}(""+e.key):t.toString(36)}function L(e,t,r,n,a){var s=typeof e;"undefined"!==s&&"boolean"!==s||(e=null);var i=!1;if(null===e)i=!0;else switch(s){case"string":case"number":i=!0;break;case"object":switch(e.$$typeof){case c:case d:i=!0}}if(i)return a=a(i=e),e=""===n?"."+D(i,0):n,E(a)?(r="",null!=e&&(r=e.replace(P,"$&/")+"/"),L(a,t,r,"",function(e){return e})):null!=a&&(R(a)&&(a=function(e,t){return{$$typeof:c,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(a,r+(!a.key||i&&i.key===a.key?"":(""+a.key).replace(P,"$&/")+"/")+e)),t.push(a)),1;if(i=0,n=""===n?".":n+":",E(e))for(var o=0;o<e.length;o++){var l=n+D(s=e[o],o);i+=L(s,t,r,l,a)}else if(l=function(e){return null===e||"object"!=typeof e?null:"function"==typeof(e=y&&e[y]||e["@@iterator"])?e:null}(e),"function"==typeof l)for(e=l.call(e),o=0;!(s=e.next()).done;)i+=L(s=s.value,t,r,l=n+D(s,o++),a);else if("object"===s)throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return i}function M(e,t,r){if(null==e)return e;var n=[],a=0;return L(e,n,"","",function(e){return t.call(r,e,a++)}),n}function F(e){if(-1===e._status){var t=e._result;(t=t()).then(function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)},function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)}),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var U={current:null},B={transition:null},z={ReactCurrentDispatcher:U,ReactCurrentBatchConfig:B,ReactCurrentOwner:A};function V(){throw Error("act(...) is not supported in production builds of React.")}l.Children={map:M,forEach:function(e,t,r){M(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return M(e,function(){t++}),t},toArray:function(e){return M(e,function(e){return e})||[]},only:function(e){if(!R(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},l.Component=N,l.Fragment=u,l.Profiler=f,l.PureComponent=S,l.StrictMode=h,l.Suspense=x,l.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=z,l.act=V,l.cloneElement=function(e,t,r){if(null==e)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var n=_({},e.props),a=e.key,s=e.ref,i=e._owner;if(null!=t){if(void 0!==t.ref&&(s=t.ref,i=A.current),void 0!==t.key&&(a=""+t.key),e.type&&e.type.defaultProps)var o=e.type.defaultProps;for(l in t)C.call(t,l)&&!O.hasOwnProperty(l)&&(n[l]=void 0===t[l]&&void 0!==o?o[l]:t[l])}var l=arguments.length-2;if(1===l)n.children=r;else if(1<l){o=Array(l);for(var d=0;d<l;d++)o[d]=arguments[d+2];n.children=o}return{$$typeof:c,type:e.type,key:a,ref:s,props:n,_owner:i}},l.createContext=function(e){return(e={$$typeof:p,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:m,_context:e},e.Consumer=e},l.createElement=I,l.createFactory=function(e){var t=I.bind(null,e);return t.type=e,t},l.createRef=function(){return{current:null}},l.forwardRef=function(e){return{$$typeof:g,render:e}},l.isValidElement=R,l.lazy=function(e){return{$$typeof:b,_payload:{_status:-1,_result:e},_init:F}},l.memo=function(e,t){return{$$typeof:v,type:e,compare:void 0===t?null:t}},l.startTransition=function(e){var t=B.transition;B.transition={};try{e()}finally{B.transition=t}},l.unstable_act=V,l.useCallback=function(e,t){return U.current.useCallback(e,t)},l.useContext=function(e){return U.current.useContext(e)},l.useDebugValue=function(){},l.useDeferredValue=function(e){return U.current.useDeferredValue(e)},l.useEffect=function(e,t){return U.current.useEffect(e,t)},l.useId=function(){return U.current.useId()},l.useImperativeHandle=function(e,t,r){return U.current.useImperativeHandle(e,t,r)},l.useInsertionEffect=function(e,t){return U.current.useInsertionEffect(e,t)},l.useLayoutEffect=function(e,t){return U.current.useLayoutEffect(e,t)},l.useMemo=function(e,t){return U.current.useMemo(e,t)},l.useReducer=function(e,t,r){return U.current.useReducer(e,t,r)},l.useRef=function(e){return U.current.useRef(e)},l.useState=function(e){return U.current.useState(e)},l.useSyncExternalStore=function(e,t,r){return U.current.useSyncExternalStore(e,t,r)},l.useTransition=function(){return U.current.useTransition()},l.version="18.3.1",o.exports=l;var W=o.exports;const H=n(W);
/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var G=W,q=Symbol.for("react.element"),K=Symbol.for("react.fragment"),X=Object.prototype.hasOwnProperty,Y=G.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,J={key:!0,ref:!0,__self:!0,__source:!0};function Z(e,t,r){var n,a={},s=null,i=null;for(n in void 0!==r&&(s=""+r),void 0!==t.key&&(s=""+t.key),void 0!==t.ref&&(i=t.ref),t)X.call(t,n)&&!J.hasOwnProperty(n)&&(a[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps)void 0===a[n]&&(a[n]=t[n]);return{$$typeof:q,type:e,key:s,ref:i,props:a,_owner:Y.current}}i.Fragment=K,i.jsx=Z,i.jsxs=Z,s.exports=i;var Q=s.exports,ee={exports:{}},te={},re={exports:{}},ne={};
/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */
!function(e){function t(e,t){var r=e.length;e.push(t);e:for(;0<r;){var n=r-1>>>1,s=e[n];if(!(0<a(s,t)))break e;e[n]=t,e[r]=s,r=n}}function r(e){return 0===e.length?null:e[0]}function n(e){if(0===e.length)return null;var t=e[0],r=e.pop();if(r!==t){e[0]=r;e:for(var n=0,s=e.length,i=s>>>1;n<i;){var o=2*(n+1)-1,l=e[o],c=o+1,d=e[c];if(0>a(l,r))c<s&&0>a(d,l)?(e[n]=d,e[c]=r,n=c):(e[n]=l,e[o]=r,n=o);else{if(!(c<s&&0>a(d,r)))break e;e[n]=d,e[c]=r,n=c}}}return t}function a(e,t){var r=e.sortIndex-t.sortIndex;return 0!==r?r:e.id-t.id}if("object"==typeof performance&&"function"==typeof performance.now){var s=performance;e.unstable_now=function(){return s.now()}}else{var i=Date,o=i.now();e.unstable_now=function(){return i.now()-o}}var l=[],c=[],d=1,u=null,h=3,f=!1,m=!1,p=!1,g="function"==typeof setTimeout?setTimeout:null,x="function"==typeof clearTimeout?clearTimeout:null,v="undefined"!=typeof setImmediate?setImmediate:null;function b(e){for(var a=r(c);null!==a;){if(null===a.callback)n(c);else{if(!(a.startTime<=e))break;n(c),a.sortIndex=a.expirationTime,t(l,a)}a=r(c)}}function y(e){if(p=!1,b(e),!m)if(null!==r(l))m=!0,I(w);else{var t=r(c);null!==t&&R(y,t.startTime-e)}}function w(t,a){m=!1,p&&(p=!1,x(j),j=-1),f=!0;var s=h;try{for(b(a),u=r(l);null!==u&&(!(u.expirationTime>a)||t&&!E());){var i=u.callback;if("function"==typeof i){u.callback=null,h=u.priorityLevel;var o=i(u.expirationTime<=a);a=e.unstable_now(),"function"==typeof o?u.callback=o:u===r(l)&&n(l),b(a)}else n(l);u=r(l)}if(null!==u)var d=!0;else{var g=r(c);null!==g&&R(y,g.startTime-a),d=!1}return d}finally{u=null,h=s,f=!1}}"undefined"!=typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var _,k=!1,N=null,j=-1,S=5,T=-1;function E(){return!(e.unstable_now()-T<S)}function C(){if(null!==N){var t=e.unstable_now();T=t;var r=!0;try{r=N(!0,t)}finally{r?_():(k=!1,N=null)}}else k=!1}if("function"==typeof v)_=function(){v(C)};else if("undefined"!=typeof MessageChannel){var A=new MessageChannel,O=A.port2;A.port1.onmessage=C,_=function(){O.postMessage(null)}}else _=function(){g(C,0)};function I(e){N=e,k||(k=!0,_())}function R(t,r){j=g(function(){t(e.unstable_now())},r)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(e){e.callback=null},e.unstable_continueExecution=function(){m||f||(m=!0,I(w))},e.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):S=0<e?Math.floor(1e3/e):5},e.unstable_getCurrentPriorityLevel=function(){return h},e.unstable_getFirstCallbackNode=function(){return r(l)},e.unstable_next=function(e){switch(h){case 1:case 2:case 3:var t=3;break;default:t=h}var r=h;h=t;try{return e()}finally{h=r}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var r=h;h=e;try{return t()}finally{h=r}},e.unstable_scheduleCallback=function(n,a,s){var i=e.unstable_now();switch("object"==typeof s&&null!==s?s="number"==typeof(s=s.delay)&&0<s?i+s:i:s=i,n){case 1:var o=-1;break;case 2:o=250;break;case 5:o=1073741823;break;case 4:o=1e4;break;default:o=5e3}return n={id:d++,callback:a,priorityLevel:n,startTime:s,expirationTime:o=s+o,sortIndex:-1},s>i?(n.sortIndex=s,t(c,n),null===r(l)&&n===r(c)&&(p?(x(j),j=-1):p=!0,R(y,s-i))):(n.sortIndex=o,t(l,n),m||f||(m=!0,I(w))),n},e.unstable_shouldYield=E,e.unstable_wrapCallback=function(e){var t=h;return function(){var r=h;h=t;try{return e.apply(this,arguments)}finally{h=r}}}}(ne),re.exports=ne;var ae=re.exports,se=W,ie=ae;
/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */function oe(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var le=new Set,ce={};function de(e,t){ue(e,t),ue(e+"Capture",t)}function ue(e,t){for(ce[e]=t,e=0;e<t.length;e++)le.add(t[e])}var he=!("undefined"==typeof window||void 0===window.document||void 0===window.document.createElement),fe=Object.prototype.hasOwnProperty,me=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,pe={},ge={};function xe(e,t,r,n,a,s,i){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=n,this.attributeNamespace=a,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=s,this.removeEmptyString=i}var ve={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){ve[e]=new xe(e,0,!1,e,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];ve[t]=new xe(t,1,!1,e[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(e){ve[e]=new xe(e,2,!1,e.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){ve[e]=new xe(e,2,!1,e,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){ve[e]=new xe(e,3,!1,e.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(e){ve[e]=new xe(e,3,!0,e,null,!1,!1)}),["capture","download"].forEach(function(e){ve[e]=new xe(e,4,!1,e,null,!1,!1)}),["cols","rows","size","span"].forEach(function(e){ve[e]=new xe(e,6,!1,e,null,!1,!1)}),["rowSpan","start"].forEach(function(e){ve[e]=new xe(e,5,!1,e.toLowerCase(),null,!1,!1)});var be=/[\-:]([a-z])/g;function ye(e){return e[1].toUpperCase()}function we(e,t,r,n){var a=ve.hasOwnProperty(t)?ve[t]:null;(null!==a?0!==a.type:n||!(2<t.length)||"o"!==t[0]&&"O"!==t[0]||"n"!==t[1]&&"N"!==t[1])&&(function(e,t,r,n){if(null==t||function(e,t,r,n){if(null!==r&&0===r.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return!n&&(null!==r?!r.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}(e,t,r,n))return!0;if(n)return!1;if(null!==r)switch(r.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}(t,r,a,n)&&(r=null),n||null===a?function(e){return!!fe.call(ge,e)||!fe.call(pe,e)&&(me.test(e)?ge[e]=!0:(pe[e]=!0,!1))}(t)&&(null===r?e.removeAttribute(t):e.setAttribute(t,""+r)):a.mustUseProperty?e[a.propertyName]=null===r?3!==a.type&&"":r:(t=a.attributeName,n=a.attributeNamespace,null===r?e.removeAttribute(t):(r=3===(a=a.type)||4===a&&!0===r?"":""+r,n?e.setAttributeNS(n,t,r):e.setAttribute(t,r))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(be,ye);ve[t]=new xe(t,1,!1,e,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(be,ye);ve[t]=new xe(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(be,ye);ve[t]=new xe(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(e){ve[e]=new xe(e,1,!1,e.toLowerCase(),null,!1,!1)}),ve.xlinkHref=new xe("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(e){ve[e]=new xe(e,1,!1,e.toLowerCase(),null,!0,!0)});var _e=se.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,ke=Symbol.for("react.element"),Ne=Symbol.for("react.portal"),je=Symbol.for("react.fragment"),Se=Symbol.for("react.strict_mode"),Te=Symbol.for("react.profiler"),Ee=Symbol.for("react.provider"),Ce=Symbol.for("react.context"),Ae=Symbol.for("react.forward_ref"),Oe=Symbol.for("react.suspense"),Ie=Symbol.for("react.suspense_list"),Re=Symbol.for("react.memo"),Pe=Symbol.for("react.lazy"),De=Symbol.for("react.offscreen"),Le=Symbol.iterator;function Me(e){return null===e||"object"!=typeof e?null:"function"==typeof(e=Le&&e[Le]||e["@@iterator"])?e:null}var Fe,Ue=Object.assign;function Be(e){if(void 0===Fe)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);Fe=t&&t[1]||""}return"\n"+Fe+e}var $e=!1;function ze(e,t){if(!e||$e)return"";$e=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),"object"==typeof Reflect&&Reflect.construct){try{Reflect.construct(t,[])}catch(c){var n=c}Reflect.construct(e,[],t)}else{try{t.call()}catch(c){n=c}e.call(t.prototype)}else{try{throw Error()}catch(c){n=c}e()}}catch(c){if(c&&n&&"string"==typeof c.stack){for(var a=c.stack.split("\n"),s=n.stack.split("\n"),i=a.length-1,o=s.length-1;1<=i&&0<=o&&a[i]!==s[o];)o--;for(;1<=i&&0<=o;i--,o--)if(a[i]!==s[o]){if(1!==i||1!==o)do{if(i--,0>--o||a[i]!==s[o]){var l="\n"+a[i].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}}while(1<=i&&0<=o);break}}}finally{$e=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?Be(e):""}function Ve(e){switch(e.tag){case 5:return Be(e.type);case 16:return Be("Lazy");case 13:return Be("Suspense");case 19:return Be("SuspenseList");case 0:case 2:case 15:return e=ze(e.type,!1);case 11:return e=ze(e.type.render,!1);case 1:return e=ze(e.type,!0);default:return""}}function We(e){if(null==e)return null;if("function"==typeof e)return e.displayName||e.name||null;if("string"==typeof e)return e;switch(e){case je:return"Fragment";case Ne:return"Portal";case Te:return"Profiler";case Se:return"StrictMode";case Oe:return"Suspense";case Ie:return"SuspenseList"}if("object"==typeof e)switch(e.$$typeof){case Ce:return(e.displayName||"Context")+".Consumer";case Ee:return(e._context.displayName||"Context")+".Provider";case Ae:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case Re:return null!==(t=e.displayName||null)?t:We(e.type)||"Memo";case Pe:t=e._payload,e=e._init;try{return We(e(t))}catch(r){}}return null}function He(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=(e=t.render).displayName||e.name||"",t.displayName||(""!==e?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return We(t);case 8:return t===Se?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"==typeof t)return t.displayName||t.name||null;if("string"==typeof t)return t}return null}function Ge(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function qe(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function Ke(e){e._valueTracker||(e._valueTracker=function(e){var t=qe(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&void 0!==r&&"function"==typeof r.get&&"function"==typeof r.set){var a=r.get,s=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return a.call(this)},set:function(e){n=""+e,s.call(this,e)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(e){n=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function Xe(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),n="";return e&&(n=qe(e)?e.checked?"true":"false":e.value),(e=n)!==r&&(t.setValue(e),!0)}function Ye(e){if(void 0===(e=e||("undefined"!=typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}function Je(e,t){var r=t.checked;return Ue({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=r?r:e._wrapperState.initialChecked})}function Ze(e,t){var r=null==t.defaultValue?"":t.defaultValue,n=null!=t.checked?t.checked:t.defaultChecked;r=Ge(null!=t.value?t.value:r),e._wrapperState={initialChecked:n,initialValue:r,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}}function Qe(e,t){null!=(t=t.checked)&&we(e,"checked",t,!1)}function et(e,t){Qe(e,t);var r=Ge(t.value),n=t.type;if(null!=r)"number"===n?(0===r&&""===e.value||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if("submit"===n||"reset"===n)return void e.removeAttribute("value");t.hasOwnProperty("value")?rt(e,t.type,r):t.hasOwnProperty("defaultValue")&&rt(e,t.type,Ge(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked)}function tt(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var n=t.type;if(!("submit"!==n&&"reset"!==n||void 0!==t.value&&null!==t.value))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}""!==(r=e.name)&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,""!==r&&(e.name=r)}function rt(e,t,r){"number"===t&&Ye(e.ownerDocument)===e||(null==r?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var nt=Array.isArray;function at(e,t,r,n){if(e=e.options,t){t={};for(var a=0;a<r.length;a++)t["$"+r[a]]=!0;for(r=0;r<e.length;r++)a=t.hasOwnProperty("$"+e[r].value),e[r].selected!==a&&(e[r].selected=a),a&&n&&(e[r].defaultSelected=!0)}else{for(r=""+Ge(r),t=null,a=0;a<e.length;a++){if(e[a].value===r)return e[a].selected=!0,void(n&&(e[a].defaultSelected=!0));null!==t||e[a].disabled||(t=e[a])}null!==t&&(t.selected=!0)}}function st(e,t){if(null!=t.dangerouslySetInnerHTML)throw Error(oe(91));return Ue({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function it(e,t){var r=t.value;if(null==r){if(r=t.children,t=t.defaultValue,null!=r){if(null!=t)throw Error(oe(92));if(nt(r)){if(1<r.length)throw Error(oe(93));r=r[0]}t=r}null==t&&(t=""),r=t}e._wrapperState={initialValue:Ge(r)}}function ot(e,t){var r=Ge(t.value),n=Ge(t.defaultValue);null!=r&&((r=""+r)!==e.value&&(e.value=r),null==t.defaultValue&&e.defaultValue!==r&&(e.defaultValue=r)),null!=n&&(e.defaultValue=""+n)}function lt(e){var t=e.textContent;t===e._wrapperState.initialValue&&""!==t&&null!==t&&(e.value=t)}function ct(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function dt(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?ct(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}var ut,ht,ft=(ht=function(e,t){if("http://www.w3.org/2000/svg"!==e.namespaceURI||"innerHTML"in e)e.innerHTML=t;else{for((ut=ut||document.createElement("div")).innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=ut.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}},"undefined"!=typeof MSApp&&MSApp.execUnsafeLocalFunction?function(e,t,r,n){MSApp.execUnsafeLocalFunction(function(){return ht(e,t)})}:ht);function mt(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&3===r.nodeType)return void(r.nodeValue=t)}e.textContent=t}var pt={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},gt=["Webkit","ms","Moz","O"];function xt(e,t,r){return null==t||"boolean"==typeof t||""===t?"":r||"number"!=typeof t||0===t||pt.hasOwnProperty(e)&&pt[e]?(""+t).trim():t+"px"}function vt(e,t){for(var r in e=e.style,t)if(t.hasOwnProperty(r)){var n=0===r.indexOf("--"),a=xt(r,t[r],n);"float"===r&&(r="cssFloat"),n?e.setProperty(r,a):e[r]=a}}Object.keys(pt).forEach(function(e){gt.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),pt[t]=pt[e]})});var bt=Ue({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function yt(e,t){if(t){if(bt[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML))throw Error(oe(137,e));if(null!=t.dangerouslySetInnerHTML){if(null!=t.children)throw Error(oe(60));if("object"!=typeof t.dangerouslySetInnerHTML||!("__html"in t.dangerouslySetInnerHTML))throw Error(oe(61))}if(null!=t.style&&"object"!=typeof t.style)throw Error(oe(62))}}function wt(e,t){if(-1===e.indexOf("-"))return"string"==typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var _t=null;function kt(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var Nt=null,jt=null,St=null;function Tt(e){if(e=ws(e)){if("function"!=typeof Nt)throw Error(oe(280));var t=e.stateNode;t&&(t=ks(t),Nt(e.stateNode,e.type,t))}}function Et(e){jt?St?St.push(e):St=[e]:jt=e}function Ct(){if(jt){var e=jt,t=St;if(St=jt=null,Tt(e),t)for(e=0;e<t.length;e++)Tt(t[e])}}function At(e,t){return e(t)}function Ot(){}var It=!1;function Rt(e,t,r){if(It)return e(t,r);It=!0;try{return At(e,t,r)}finally{It=!1,(null!==jt||null!==St)&&(Ot(),Ct())}}function Pt(e,t){var r=e.stateNode;if(null===r)return null;var n=ks(r);if(null===n)return null;r=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(n=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!n;break e;default:e=!1}if(e)return null;if(r&&"function"!=typeof r)throw Error(oe(231,t,typeof r));return r}var Dt=!1;if(he)try{var Lt={};Object.defineProperty(Lt,"passive",{get:function(){Dt=!0}}),window.addEventListener("test",Lt,Lt),window.removeEventListener("test",Lt,Lt)}catch(ht){Dt=!1}function Mt(e,t,r,n,a,s,i,o,l){var c=Array.prototype.slice.call(arguments,3);try{t.apply(r,c)}catch(d){this.onError(d)}}var Ft=!1,Ut=null,Bt=!1,$t=null,zt={onError:function(e){Ft=!0,Ut=e}};function Vt(e,t,r,n,a,s,i,o,l){Ft=!1,Ut=null,Mt.apply(zt,arguments)}function Wt(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{!!(4098&(t=e).flags)&&(r=t.return),e=t.return}while(e)}return 3===t.tag?r:null}function Ht(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function Gt(e){if(Wt(e)!==e)throw Error(oe(188))}function qt(e){return null!==(e=function(e){var t=e.alternate;if(!t){if(null===(t=Wt(e)))throw Error(oe(188));return t!==e?null:e}for(var r=e,n=t;;){var a=r.return;if(null===a)break;var s=a.alternate;if(null===s){if(null!==(n=a.return)){r=n;continue}break}if(a.child===s.child){for(s=a.child;s;){if(s===r)return Gt(a),e;if(s===n)return Gt(a),t;s=s.sibling}throw Error(oe(188))}if(r.return!==n.return)r=a,n=s;else{for(var i=!1,o=a.child;o;){if(o===r){i=!0,r=a,n=s;break}if(o===n){i=!0,n=a,r=s;break}o=o.sibling}if(!i){for(o=s.child;o;){if(o===r){i=!0,r=s,n=a;break}if(o===n){i=!0,n=s,r=a;break}o=o.sibling}if(!i)throw Error(oe(189))}}if(r.alternate!==n)throw Error(oe(190))}if(3!==r.tag)throw Error(oe(188));return r.stateNode.current===r?e:t}(e))?Kt(e):null}function Kt(e){if(5===e.tag||6===e.tag)return e;for(e=e.child;null!==e;){var t=Kt(e);if(null!==t)return t;e=e.sibling}return null}var Xt=ie.unstable_scheduleCallback,Yt=ie.unstable_cancelCallback,Jt=ie.unstable_shouldYield,Zt=ie.unstable_requestPaint,Qt=ie.unstable_now,er=ie.unstable_getCurrentPriorityLevel,tr=ie.unstable_ImmediatePriority,rr=ie.unstable_UserBlockingPriority,nr=ie.unstable_NormalPriority,ar=ie.unstable_LowPriority,sr=ie.unstable_IdlePriority,ir=null,or=null;var lr=Math.clz32?Math.clz32:function(e){return e>>>=0,0===e?32:31-(cr(e)/dr|0)|0},cr=Math.log,dr=Math.LN2;var ur=64,hr=4194304;function fr(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&e;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&e;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function mr(e,t){var r=e.pendingLanes;if(0===r)return 0;var n=0,a=e.suspendedLanes,s=e.pingedLanes,i=268435455&r;if(0!==i){var o=i&~a;0!==o?n=fr(o):0!==(s&=i)&&(n=fr(s))}else 0!==(i=r&~a)?n=fr(i):0!==s&&(n=fr(s));if(0===n)return 0;if(0!==t&&t!==n&&0===(t&a)&&((a=n&-n)>=(s=t&-t)||16===a&&4194240&s))return t;if(4&n&&(n|=16&r),0!==(t=e.entangledLanes))for(e=e.entanglements,t&=n;0<t;)a=1<<(r=31-lr(t)),n|=e[r],t&=~a;return n}function pr(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function gr(e){return 0!==(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function xr(){var e=ur;return!(4194240&(ur<<=1))&&(ur=64),e}function vr(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function br(e,t,r){e.pendingLanes|=t,536870912!==t&&(e.suspendedLanes=0,e.pingedLanes=0),(e=e.eventTimes)[t=31-lr(t)]=r}function yr(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var n=31-lr(r),a=1<<n;a&t|e[n]&t&&(e[n]|=t),r&=~a}}var wr=0;function _r(e){return 1<(e&=-e)?4<e?268435455&e?16:536870912:4:1}var kr,Nr,jr,Sr,Tr,Er=!1,Cr=[],Ar=null,Or=null,Ir=null,Rr=new Map,Pr=new Map,Dr=[],Lr="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Mr(e,t){switch(e){case"focusin":case"focusout":Ar=null;break;case"dragenter":case"dragleave":Or=null;break;case"mouseover":case"mouseout":Ir=null;break;case"pointerover":case"pointerout":Rr.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Pr.delete(t.pointerId)}}function Fr(e,t,r,n,a,s){return null===e||e.nativeEvent!==s?(e={blockedOn:t,domEventName:r,eventSystemFlags:n,nativeEvent:s,targetContainers:[a]},null!==t&&(null!==(t=ws(t))&&Nr(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,null!==a&&-1===t.indexOf(a)&&t.push(a),e)}function Ur(e){var t=ys(e.target);if(null!==t){var r=Wt(t);if(null!==r)if(13===(t=r.tag)){if(null!==(t=Ht(r)))return e.blockedOn=t,void Tr(e.priority,function(){jr(r)})}else if(3===t&&r.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===r.tag?r.stateNode.containerInfo:null)}e.blockedOn=null}function Br(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var r=Jr(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==r)return null!==(t=ws(r))&&Nr(t),e.blockedOn=r,!1;var n=new(r=e.nativeEvent).constructor(r.type,r);_t=n,r.target.dispatchEvent(n),_t=null,t.shift()}return!0}function $r(e,t,r){Br(e)&&r.delete(t)}function zr(){Er=!1,null!==Ar&&Br(Ar)&&(Ar=null),null!==Or&&Br(Or)&&(Or=null),null!==Ir&&Br(Ir)&&(Ir=null),Rr.forEach($r),Pr.forEach($r)}function Vr(e,t){e.blockedOn===t&&(e.blockedOn=null,Er||(Er=!0,ie.unstable_scheduleCallback(ie.unstable_NormalPriority,zr)))}function Wr(e){function t(t){return Vr(t,e)}if(0<Cr.length){Vr(Cr[0],e);for(var r=1;r<Cr.length;r++){var n=Cr[r];n.blockedOn===e&&(n.blockedOn=null)}}for(null!==Ar&&Vr(Ar,e),null!==Or&&Vr(Or,e),null!==Ir&&Vr(Ir,e),Rr.forEach(t),Pr.forEach(t),r=0;r<Dr.length;r++)(n=Dr[r]).blockedOn===e&&(n.blockedOn=null);for(;0<Dr.length&&null===(r=Dr[0]).blockedOn;)Ur(r),null===r.blockedOn&&Dr.shift()}var Hr=_e.ReactCurrentBatchConfig,Gr=!0;function qr(e,t,r,n){var a=wr,s=Hr.transition;Hr.transition=null;try{wr=1,Xr(e,t,r,n)}finally{wr=a,Hr.transition=s}}function Kr(e,t,r,n){var a=wr,s=Hr.transition;Hr.transition=null;try{wr=4,Xr(e,t,r,n)}finally{wr=a,Hr.transition=s}}function Xr(e,t,r,n){if(Gr){var a=Jr(e,t,r,n);if(null===a)Ga(e,t,n,Yr,r),Mr(e,n);else if(function(e,t,r,n,a){switch(t){case"focusin":return Ar=Fr(Ar,e,t,r,n,a),!0;case"dragenter":return Or=Fr(Or,e,t,r,n,a),!0;case"mouseover":return Ir=Fr(Ir,e,t,r,n,a),!0;case"pointerover":var s=a.pointerId;return Rr.set(s,Fr(Rr.get(s)||null,e,t,r,n,a)),!0;case"gotpointercapture":return s=a.pointerId,Pr.set(s,Fr(Pr.get(s)||null,e,t,r,n,a)),!0}return!1}(a,e,t,r,n))n.stopPropagation();else if(Mr(e,n),4&t&&-1<Lr.indexOf(e)){for(;null!==a;){var s=ws(a);if(null!==s&&kr(s),null===(s=Jr(e,t,r,n))&&Ga(e,t,n,Yr,r),s===a)break;a=s}null!==a&&n.stopPropagation()}else Ga(e,t,n,null,r)}}var Yr=null;function Jr(e,t,r,n){if(Yr=null,null!==(e=ys(e=kt(n))))if(null===(t=Wt(e)))e=null;else if(13===(r=t.tag)){if(null!==(e=Ht(t)))return e;e=null}else if(3===r){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Yr=e,null}function Zr(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(er()){case tr:return 1;case rr:return 4;case nr:case ar:return 16;case sr:return 536870912;default:return 16}default:return 16}}var Qr=null,en=null,tn=null;function rn(){if(tn)return tn;var e,t,r=en,n=r.length,a="value"in Qr?Qr.value:Qr.textContent,s=a.length;for(e=0;e<n&&r[e]===a[e];e++);var i=n-e;for(t=1;t<=i&&r[n-t]===a[s-t];t++);return tn=a.slice(e,1<t?1-t:void 0)}function nn(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function an(){return!0}function sn(){return!1}function on(e){function t(t,r,n,a,s){for(var i in this._reactName=t,this._targetInst=n,this.type=r,this.nativeEvent=a,this.target=s,this.currentTarget=null,e)e.hasOwnProperty(i)&&(t=e[i],this[i]=t?t(a):a[i]);return this.isDefaultPrevented=(null!=a.defaultPrevented?a.defaultPrevented:!1===a.returnValue)?an:sn,this.isPropagationStopped=sn,this}return Ue(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!=typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=an)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!=typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=an)},persist:function(){},isPersistent:an}),t}var ln,cn,dn,un={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},hn=on(un),fn=Ue({},un,{view:0,detail:0}),mn=on(fn),pn=Ue({},fn,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Tn,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==dn&&(dn&&"mousemove"===e.type?(ln=e.screenX-dn.screenX,cn=e.screenY-dn.screenY):cn=ln=0,dn=e),ln)},movementY:function(e){return"movementY"in e?e.movementY:cn}}),gn=on(pn),xn=on(Ue({},pn,{dataTransfer:0})),vn=on(Ue({},fn,{relatedTarget:0})),bn=on(Ue({},un,{animationName:0,elapsedTime:0,pseudoElement:0})),yn=Ue({},un,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),wn=on(yn),_n=on(Ue({},un,{data:0})),kn={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Nn={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},jn={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Sn(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=jn[e])&&!!t[e]}function Tn(){return Sn}var En=Ue({},fn,{key:function(e){if(e.key){var t=kn[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=nn(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?Nn[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Tn,charCode:function(e){return"keypress"===e.type?nn(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?nn(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}}),Cn=on(En),An=on(Ue({},pn,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),On=on(Ue({},fn,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Tn})),In=on(Ue({},un,{propertyName:0,elapsedTime:0,pseudoElement:0})),Rn=Ue({},pn,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Pn=on(Rn),Dn=[9,13,27,32],Ln=he&&"CompositionEvent"in window,Mn=null;he&&"documentMode"in document&&(Mn=document.documentMode);var Fn=he&&"TextEvent"in window&&!Mn,Un=he&&(!Ln||Mn&&8<Mn&&11>=Mn),Bn=String.fromCharCode(32),$n=!1;function zn(e,t){switch(e){case"keyup":return-1!==Dn.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Vn(e){return"object"==typeof(e=e.detail)&&"data"in e?e.data:null}var Wn=!1;var Hn={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Gn(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!Hn[e.type]:"textarea"===t}function qn(e,t,r,n){Et(n),0<(t=Ka(t,"onChange")).length&&(r=new hn("onChange","change",null,r,n),e.push({event:r,listeners:t}))}var Kn=null,Xn=null;function Yn(e){Ba(e,0)}function Jn(e){if(Xe(_s(e)))return e}function Zn(e,t){if("change"===e)return t}var Qn=!1;if(he){var ea;if(he){var ta="oninput"in document;if(!ta){var ra=document.createElement("div");ra.setAttribute("oninput","return;"),ta="function"==typeof ra.oninput}ea=ta}else ea=!1;Qn=ea&&(!document.documentMode||9<document.documentMode)}function na(){Kn&&(Kn.detachEvent("onpropertychange",aa),Xn=Kn=null)}function aa(e){if("value"===e.propertyName&&Jn(Xn)){var t=[];qn(t,Xn,e,kt(e)),Rt(Yn,t)}}function sa(e,t,r){"focusin"===e?(na(),Xn=r,(Kn=t).attachEvent("onpropertychange",aa)):"focusout"===e&&na()}function ia(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return Jn(Xn)}function oa(e,t){if("click"===e)return Jn(t)}function la(e,t){if("input"===e||"change"===e)return Jn(t)}var ca="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t};function da(e,t){if(ca(e,t))return!0;if("object"!=typeof e||null===e||"object"!=typeof t||null===t)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var a=r[n];if(!fe.call(t,a)||!ca(e[a],t[a]))return!1}return!0}function ua(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function ha(e,t){var r,n=ua(e);for(e=0;n;){if(3===n.nodeType){if(r=e+n.textContent.length,e<=t&&r>=t)return{node:n,offset:t-e};e=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=ua(n)}}function fa(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?fa(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function ma(){for(var e=window,t=Ye();t instanceof e.HTMLIFrameElement;){try{var r="string"==typeof t.contentWindow.location.href}catch(n){r=!1}if(!r)break;t=Ye((e=t.contentWindow).document)}return t}function pa(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}function ga(e){var t=ma(),r=e.focusedElem,n=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&fa(r.ownerDocument.documentElement,r)){if(null!==n&&pa(r))if(t=n.start,void 0===(e=n.end)&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if((e=(t=r.ownerDocument||document)&&t.defaultView||window).getSelection){e=e.getSelection();var a=r.textContent.length,s=Math.min(n.start,a);n=void 0===n.end?s:Math.min(n.end,a),!e.extend&&s>n&&(a=n,n=s,s=a),a=ha(r,s);var i=ha(r,n);a&&i&&(1!==e.rangeCount||e.anchorNode!==a.node||e.anchorOffset!==a.offset||e.focusNode!==i.node||e.focusOffset!==i.offset)&&((t=t.createRange()).setStart(a.node,a.offset),e.removeAllRanges(),s>n?(e.addRange(t),e.extend(i.node,i.offset)):(t.setEnd(i.node,i.offset),e.addRange(t)))}for(t=[],e=r;e=e.parentNode;)1===e.nodeType&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for("function"==typeof r.focus&&r.focus(),r=0;r<t.length;r++)(e=t[r]).element.scrollLeft=e.left,e.element.scrollTop=e.top}}var xa=he&&"documentMode"in document&&11>=document.documentMode,va=null,ba=null,ya=null,wa=!1;function _a(e,t,r){var n=r.window===r?r.document:9===r.nodeType?r:r.ownerDocument;wa||null==va||va!==Ye(n)||("selectionStart"in(n=va)&&pa(n)?n={start:n.selectionStart,end:n.selectionEnd}:n={anchorNode:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset},ya&&da(ya,n)||(ya=n,0<(n=Ka(ba,"onSelect")).length&&(t=new hn("onSelect","select",null,t,r),e.push({event:t,listeners:n}),t.target=va)))}function ka(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var Na={animationend:ka("Animation","AnimationEnd"),animationiteration:ka("Animation","AnimationIteration"),animationstart:ka("Animation","AnimationStart"),transitionend:ka("Transition","TransitionEnd")},ja={},Sa={};function Ta(e){if(ja[e])return ja[e];if(!Na[e])return e;var t,r=Na[e];for(t in r)if(r.hasOwnProperty(t)&&t in Sa)return ja[e]=r[t];return e}he&&(Sa=document.createElement("div").style,"AnimationEvent"in window||(delete Na.animationend.animation,delete Na.animationiteration.animation,delete Na.animationstart.animation),"TransitionEvent"in window||delete Na.transitionend.transition);var Ea=Ta("animationend"),Ca=Ta("animationiteration"),Aa=Ta("animationstart"),Oa=Ta("transitionend"),Ia=new Map,Ra="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Pa(e,t){Ia.set(e,t),de(t,[e])}for(var Da=0;Da<Ra.length;Da++){var La=Ra[Da];Pa(La.toLowerCase(),"on"+(La[0].toUpperCase()+La.slice(1)))}Pa(Ea,"onAnimationEnd"),Pa(Ca,"onAnimationIteration"),Pa(Aa,"onAnimationStart"),Pa("dblclick","onDoubleClick"),Pa("focusin","onFocus"),Pa("focusout","onBlur"),Pa(Oa,"onTransitionEnd"),ue("onMouseEnter",["mouseout","mouseover"]),ue("onMouseLeave",["mouseout","mouseover"]),ue("onPointerEnter",["pointerout","pointerover"]),ue("onPointerLeave",["pointerout","pointerover"]),de("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),de("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),de("onBeforeInput",["compositionend","keypress","textInput","paste"]),de("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),de("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),de("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ma="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Fa=new Set("cancel close invalid load scroll toggle".split(" ").concat(Ma));function Ua(e,t,r){var n=e.type||"unknown-event";e.currentTarget=r,function(e,t,r,n,a,s,i,o,l){if(Vt.apply(this,arguments),Ft){if(!Ft)throw Error(oe(198));var c=Ut;Ft=!1,Ut=null,Bt||(Bt=!0,$t=c)}}(n,t,void 0,e),e.currentTarget=null}function Ba(e,t){t=!!(4&t);for(var r=0;r<e.length;r++){var n=e[r],a=n.event;n=n.listeners;e:{var s=void 0;if(t)for(var i=n.length-1;0<=i;i--){var o=n[i],l=o.instance,c=o.currentTarget;if(o=o.listener,l!==s&&a.isPropagationStopped())break e;Ua(a,o,c),s=l}else for(i=0;i<n.length;i++){if(l=(o=n[i]).instance,c=o.currentTarget,o=o.listener,l!==s&&a.isPropagationStopped())break e;Ua(a,o,c),s=l}}}if(Bt)throw e=$t,Bt=!1,$t=null,e}function $a(e,t){var r=t[xs];void 0===r&&(r=t[xs]=new Set);var n=e+"__bubble";r.has(n)||(Ha(t,e,2,!1),r.add(n))}function za(e,t,r){var n=0;t&&(n|=4),Ha(r,e,n,t)}var Va="_reactListening"+Math.random().toString(36).slice(2);function Wa(e){if(!e[Va]){e[Va]=!0,le.forEach(function(t){"selectionchange"!==t&&(Fa.has(t)||za(t,!1,e),za(t,!0,e))});var t=9===e.nodeType?e:e.ownerDocument;null===t||t[Va]||(t[Va]=!0,za("selectionchange",!1,t))}}function Ha(e,t,r,n){switch(Zr(t)){case 1:var a=qr;break;case 4:a=Kr;break;default:a=Xr}r=a.bind(null,t,r,e),a=void 0,!Dt||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(a=!0),n?void 0!==a?e.addEventListener(t,r,{capture:!0,passive:a}):e.addEventListener(t,r,!0):void 0!==a?e.addEventListener(t,r,{passive:a}):e.addEventListener(t,r,!1)}function Ga(e,t,r,n,a){var s=n;if(!(1&t||2&t||null===n))e:for(;;){if(null===n)return;var i=n.tag;if(3===i||4===i){var o=n.stateNode.containerInfo;if(o===a||8===o.nodeType&&o.parentNode===a)break;if(4===i)for(i=n.return;null!==i;){var l=i.tag;if((3===l||4===l)&&((l=i.stateNode.containerInfo)===a||8===l.nodeType&&l.parentNode===a))return;i=i.return}for(;null!==o;){if(null===(i=ys(o)))return;if(5===(l=i.tag)||6===l){n=s=i;continue e}o=o.parentNode}}n=n.return}Rt(function(){var n=s,a=kt(r),i=[];e:{var o=Ia.get(e);if(void 0!==o){var l=hn,c=e;switch(e){case"keypress":if(0===nn(r))break e;case"keydown":case"keyup":l=Cn;break;case"focusin":c="focus",l=vn;break;case"focusout":c="blur",l=vn;break;case"beforeblur":case"afterblur":l=vn;break;case"click":if(2===r.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":l=gn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":l=xn;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":l=On;break;case Ea:case Ca:case Aa:l=bn;break;case Oa:l=In;break;case"scroll":l=mn;break;case"wheel":l=Pn;break;case"copy":case"cut":case"paste":l=wn;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":l=An}var d=!!(4&t),u=!d&&"scroll"===e,h=d?null!==o?o+"Capture":null:o;d=[];for(var f,m=n;null!==m;){var p=(f=m).stateNode;if(5===f.tag&&null!==p&&(f=p,null!==h&&(null!=(p=Pt(m,h))&&d.push(qa(m,p,f)))),u)break;m=m.return}0<d.length&&(o=new l(o,c,null,r,a),i.push({event:o,listeners:d}))}}if(!(7&t)){if(l="mouseout"===e||"pointerout"===e,(!(o="mouseover"===e||"pointerover"===e)||r===_t||!(c=r.relatedTarget||r.fromElement)||!ys(c)&&!c[gs])&&(l||o)&&(o=a.window===a?a:(o=a.ownerDocument)?o.defaultView||o.parentWindow:window,l?(l=n,null!==(c=(c=r.relatedTarget||r.toElement)?ys(c):null)&&(c!==(u=Wt(c))||5!==c.tag&&6!==c.tag)&&(c=null)):(l=null,c=n),l!==c)){if(d=gn,p="onMouseLeave",h="onMouseEnter",m="mouse","pointerout"!==e&&"pointerover"!==e||(d=An,p="onPointerLeave",h="onPointerEnter",m="pointer"),u=null==l?o:_s(l),f=null==c?o:_s(c),(o=new d(p,m+"leave",l,r,a)).target=u,o.relatedTarget=f,p=null,ys(a)===n&&((d=new d(h,m+"enter",c,r,a)).target=f,d.relatedTarget=u,p=d),u=p,l&&c)e:{for(h=c,m=0,f=d=l;f;f=Xa(f))m++;for(f=0,p=h;p;p=Xa(p))f++;for(;0<m-f;)d=Xa(d),m--;for(;0<f-m;)h=Xa(h),f--;for(;m--;){if(d===h||null!==h&&d===h.alternate)break e;d=Xa(d),h=Xa(h)}d=null}else d=null;null!==l&&Ya(i,o,l,d,!1),null!==c&&null!==u&&Ya(i,u,c,d,!0)}if("select"===(l=(o=n?_s(n):window).nodeName&&o.nodeName.toLowerCase())||"input"===l&&"file"===o.type)var g=Zn;else if(Gn(o))if(Qn)g=la;else{g=ia;var x=sa}else(l=o.nodeName)&&"input"===l.toLowerCase()&&("checkbox"===o.type||"radio"===o.type)&&(g=oa);switch(g&&(g=g(e,n))?qn(i,g,r,a):(x&&x(e,o,n),"focusout"===e&&(x=o._wrapperState)&&x.controlled&&"number"===o.type&&rt(o,"number",o.value)),x=n?_s(n):window,e){case"focusin":(Gn(x)||"true"===x.contentEditable)&&(va=x,ba=n,ya=null);break;case"focusout":ya=ba=va=null;break;case"mousedown":wa=!0;break;case"contextmenu":case"mouseup":case"dragend":wa=!1,_a(i,r,a);break;case"selectionchange":if(xa)break;case"keydown":case"keyup":_a(i,r,a)}var v;if(Ln)e:{switch(e){case"compositionstart":var b="onCompositionStart";break e;case"compositionend":b="onCompositionEnd";break e;case"compositionupdate":b="onCompositionUpdate";break e}b=void 0}else Wn?zn(e,r)&&(b="onCompositionEnd"):"keydown"===e&&229===r.keyCode&&(b="onCompositionStart");b&&(Un&&"ko"!==r.locale&&(Wn||"onCompositionStart"!==b?"onCompositionEnd"===b&&Wn&&(v=rn()):(en="value"in(Qr=a)?Qr.value:Qr.textContent,Wn=!0)),0<(x=Ka(n,b)).length&&(b=new _n(b,e,null,r,a),i.push({event:b,listeners:x}),v?b.data=v:null!==(v=Vn(r))&&(b.data=v))),(v=Fn?function(e,t){switch(e){case"compositionend":return Vn(t);case"keypress":return 32!==t.which?null:($n=!0,Bn);case"textInput":return(e=t.data)===Bn&&$n?null:e;default:return null}}(e,r):function(e,t){if(Wn)return"compositionend"===e||!Ln&&zn(e,t)?(e=rn(),tn=en=Qr=null,Wn=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Un&&"ko"!==t.locale?null:t.data}}(e,r))&&(0<(n=Ka(n,"onBeforeInput")).length&&(a=new _n("onBeforeInput","beforeinput",null,r,a),i.push({event:a,listeners:n}),a.data=v))}Ba(i,t)})}function qa(e,t,r){return{instance:e,listener:t,currentTarget:r}}function Ka(e,t){for(var r=t+"Capture",n=[];null!==e;){var a=e,s=a.stateNode;5===a.tag&&null!==s&&(a=s,null!=(s=Pt(e,r))&&n.unshift(qa(e,s,a)),null!=(s=Pt(e,t))&&n.push(qa(e,s,a))),e=e.return}return n}function Xa(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag);return e||null}function Ya(e,t,r,n,a){for(var s=t._reactName,i=[];null!==r&&r!==n;){var o=r,l=o.alternate,c=o.stateNode;if(null!==l&&l===n)break;5===o.tag&&null!==c&&(o=c,a?null!=(l=Pt(r,s))&&i.unshift(qa(r,l,o)):a||null!=(l=Pt(r,s))&&i.push(qa(r,l,o))),r=r.return}0!==i.length&&e.push({event:t,listeners:i})}var Ja=/\r\n?/g,Za=/\u0000|\uFFFD/g;function Qa(e){return("string"==typeof e?e:""+e).replace(Ja,"\n").replace(Za,"")}function es(e,t,r){if(t=Qa(t),Qa(e)!==t&&r)throw Error(oe(425))}function ts(){}var rs=null,ns=null;function as(e,t){return"textarea"===e||"noscript"===e||"string"==typeof t.children||"number"==typeof t.children||"object"==typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var ss="function"==typeof setTimeout?setTimeout:void 0,is="function"==typeof clearTimeout?clearTimeout:void 0,os="function"==typeof Promise?Promise:void 0,ls="function"==typeof queueMicrotask?queueMicrotask:void 0!==os?function(e){return os.resolve(null).then(e).catch(cs)}:ss;function cs(e){setTimeout(function(){throw e})}function ds(e,t){var r=t,n=0;do{var a=r.nextSibling;if(e.removeChild(r),a&&8===a.nodeType)if("/$"===(r=a.data)){if(0===n)return e.removeChild(a),void Wr(t);n--}else"$"!==r&&"$?"!==r&&"$!"!==r||n++;r=a}while(r);Wr(t)}function us(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t)break;if("/$"===t)return null}}return e}function hs(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var r=e.data;if("$"===r||"$!"===r||"$?"===r){if(0===t)return e;t--}else"/$"===r&&t++}e=e.previousSibling}return null}var fs=Math.random().toString(36).slice(2),ms="__reactFiber$"+fs,ps="__reactProps$"+fs,gs="__reactContainer$"+fs,xs="__reactEvents$"+fs,vs="__reactListeners$"+fs,bs="__reactHandles$"+fs;function ys(e){var t=e[ms];if(t)return t;for(var r=e.parentNode;r;){if(t=r[gs]||r[ms]){if(r=t.alternate,null!==t.child||null!==r&&null!==r.child)for(e=hs(e);null!==e;){if(r=e[ms])return r;e=hs(e)}return t}r=(e=r).parentNode}return null}function ws(e){return!(e=e[ms]||e[gs])||5!==e.tag&&6!==e.tag&&13!==e.tag&&3!==e.tag?null:e}function _s(e){if(5===e.tag||6===e.tag)return e.stateNode;throw Error(oe(33))}function ks(e){return e[ps]||null}var Ns=[],js=-1;function Ss(e){return{current:e}}function Ts(e){0>js||(e.current=Ns[js],Ns[js]=null,js--)}function Es(e,t){js++,Ns[js]=e.current,e.current=t}var Cs={},As=Ss(Cs),Os=Ss(!1),Is=Cs;function Rs(e,t){var r=e.type.contextTypes;if(!r)return Cs;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var a,s={};for(a in r)s[a]=t[a];return n&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=s),s}function Ps(e){return null!=(e=e.childContextTypes)}function Ds(){Ts(Os),Ts(As)}function Ls(e,t,r){if(As.current!==Cs)throw Error(oe(168));Es(As,t),Es(Os,r)}function Ms(e,t,r){var n=e.stateNode;if(t=t.childContextTypes,"function"!=typeof n.getChildContext)return r;for(var a in n=n.getChildContext())if(!(a in t))throw Error(oe(108,He(e)||"Unknown",a));return Ue({},r,n)}function Fs(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Cs,Is=As.current,Es(As,e),Es(Os,Os.current),!0}function Us(e,t,r){var n=e.stateNode;if(!n)throw Error(oe(169));r?(e=Ms(e,t,Is),n.__reactInternalMemoizedMergedChildContext=e,Ts(Os),Ts(As),Es(As,e)):Ts(Os),Es(Os,r)}var Bs=null,$s=!1,zs=!1;function Vs(e){null===Bs?Bs=[e]:Bs.push(e)}function Ws(){if(!zs&&null!==Bs){zs=!0;var e=0,t=wr;try{var r=Bs;for(wr=1;e<r.length;e++){var n=r[e];do{n=n(!0)}while(null!==n)}Bs=null,$s=!1}catch(a){throw null!==Bs&&(Bs=Bs.slice(e+1)),Xt(tr,Ws),a}finally{wr=t,zs=!1}}return null}var Hs=[],Gs=0,qs=null,Ks=0,Xs=[],Ys=0,Js=null,Zs=1,Qs="";function ei(e,t){Hs[Gs++]=Ks,Hs[Gs++]=qs,qs=e,Ks=t}function ti(e,t,r){Xs[Ys++]=Zs,Xs[Ys++]=Qs,Xs[Ys++]=Js,Js=e;var n=Zs;e=Qs;var a=32-lr(n)-1;n&=~(1<<a),r+=1;var s=32-lr(t)+a;if(30<s){var i=a-a%5;s=(n&(1<<i)-1).toString(32),n>>=i,a-=i,Zs=1<<32-lr(t)+a|r<<a|n,Qs=s+e}else Zs=1<<s|r<<a|n,Qs=e}function ri(e){null!==e.return&&(ei(e,1),ti(e,1,0))}function ni(e){for(;e===qs;)qs=Hs[--Gs],Hs[Gs]=null,Ks=Hs[--Gs],Hs[Gs]=null;for(;e===Js;)Js=Xs[--Ys],Xs[Ys]=null,Qs=Xs[--Ys],Xs[Ys]=null,Zs=Xs[--Ys],Xs[Ys]=null}var ai=null,si=null,ii=!1,oi=null;function li(e,t){var r=Rd(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,null===(t=e.deletions)?(e.deletions=[r],e.flags|=16):t.push(r)}function ci(e,t){switch(e.tag){case 5:var r=e.type;return null!==(t=1!==t.nodeType||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t)&&(e.stateNode=t,ai=e,si=us(t.firstChild),!0);case 6:return null!==(t=""===e.pendingProps||3!==t.nodeType?null:t)&&(e.stateNode=t,ai=e,si=null,!0);case 13:return null!==(t=8!==t.nodeType?null:t)&&(r=null!==Js?{id:Zs,overflow:Qs}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},(r=Rd(18,null,null,0)).stateNode=t,r.return=e,e.child=r,ai=e,si=null,!0);default:return!1}}function di(e){return!(!(1&e.mode)||128&e.flags)}function ui(e){if(ii){var t=si;if(t){var r=t;if(!ci(e,t)){if(di(e))throw Error(oe(418));t=us(r.nextSibling);var n=ai;t&&ci(e,t)?li(n,r):(e.flags=-4097&e.flags|2,ii=!1,ai=e)}}else{if(di(e))throw Error(oe(418));e.flags=-4097&e.flags|2,ii=!1,ai=e}}}function hi(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;ai=e}function fi(e){if(e!==ai)return!1;if(!ii)return hi(e),ii=!0,!1;var t;if((t=3!==e.tag)&&!(t=5!==e.tag)&&(t="head"!==(t=e.type)&&"body"!==t&&!as(e.type,e.memoizedProps)),t&&(t=si)){if(di(e))throw mi(),Error(oe(418));for(;t;)li(e,t),t=us(t.nextSibling)}if(hi(e),13===e.tag){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(oe(317));e:{for(e=e.nextSibling,t=0;e;){if(8===e.nodeType){var r=e.data;if("/$"===r){if(0===t){si=us(e.nextSibling);break e}t--}else"$"!==r&&"$!"!==r&&"$?"!==r||t++}e=e.nextSibling}si=null}}else si=ai?us(e.stateNode.nextSibling):null;return!0}function mi(){for(var e=si;e;)e=us(e.nextSibling)}function pi(){si=ai=null,ii=!1}function gi(e){null===oi?oi=[e]:oi.push(e)}var xi=_e.ReactCurrentBatchConfig;function vi(e,t,r){if(null!==(e=r.ref)&&"function"!=typeof e&&"object"!=typeof e){if(r._owner){if(r=r._owner){if(1!==r.tag)throw Error(oe(309));var n=r.stateNode}if(!n)throw Error(oe(147,e));var a=n,s=""+e;return null!==t&&null!==t.ref&&"function"==typeof t.ref&&t.ref._stringRef===s?t.ref:((t=function(e){var t=a.refs;null===e?delete t[s]:t[s]=e})._stringRef=s,t)}if("string"!=typeof e)throw Error(oe(284));if(!r._owner)throw Error(oe(290,e))}return e}function bi(e,t){throw e=Object.prototype.toString.call(t),Error(oe(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function yi(e){return(0,e._init)(e._payload)}function wi(e){function t(t,r){if(e){var n=t.deletions;null===n?(t.deletions=[r],t.flags|=16):n.push(r)}}function r(r,n){if(!e)return null;for(;null!==n;)t(r,n),n=n.sibling;return null}function n(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function a(e,t){return(e=Dd(e,t)).index=0,e.sibling=null,e}function s(t,r,n){return t.index=n,e?null!==(n=t.alternate)?(n=n.index)<r?(t.flags|=2,r):n:(t.flags|=2,r):(t.flags|=1048576,r)}function i(t){return e&&null===t.alternate&&(t.flags|=2),t}function o(e,t,r,n){return null===t||6!==t.tag?((t=Ud(r,e.mode,n)).return=e,t):((t=a(t,r)).return=e,t)}function l(e,t,r,n){var s=r.type;return s===je?d(e,t,r.props.children,n,r.key):null!==t&&(t.elementType===s||"object"==typeof s&&null!==s&&s.$$typeof===Pe&&yi(s)===t.type)?((n=a(t,r.props)).ref=vi(e,t,r),n.return=e,n):((n=Ld(r.type,r.key,r.props,null,e.mode,n)).ref=vi(e,t,r),n.return=e,n)}function c(e,t,r,n){return null===t||4!==t.tag||t.stateNode.containerInfo!==r.containerInfo||t.stateNode.implementation!==r.implementation?((t=Bd(r,e.mode,n)).return=e,t):((t=a(t,r.children||[])).return=e,t)}function d(e,t,r,n,s){return null===t||7!==t.tag?((t=Md(r,e.mode,n,s)).return=e,t):((t=a(t,r)).return=e,t)}function u(e,t,r){if("string"==typeof t&&""!==t||"number"==typeof t)return(t=Ud(""+t,e.mode,r)).return=e,t;if("object"==typeof t&&null!==t){switch(t.$$typeof){case ke:return(r=Ld(t.type,t.key,t.props,null,e.mode,r)).ref=vi(e,null,t),r.return=e,r;case Ne:return(t=Bd(t,e.mode,r)).return=e,t;case Pe:return u(e,(0,t._init)(t._payload),r)}if(nt(t)||Me(t))return(t=Md(t,e.mode,r,null)).return=e,t;bi(e,t)}return null}function h(e,t,r,n){var a=null!==t?t.key:null;if("string"==typeof r&&""!==r||"number"==typeof r)return null!==a?null:o(e,t,""+r,n);if("object"==typeof r&&null!==r){switch(r.$$typeof){case ke:return r.key===a?l(e,t,r,n):null;case Ne:return r.key===a?c(e,t,r,n):null;case Pe:return h(e,t,(a=r._init)(r._payload),n)}if(nt(r)||Me(r))return null!==a?null:d(e,t,r,n,null);bi(e,r)}return null}function f(e,t,r,n,a){if("string"==typeof n&&""!==n||"number"==typeof n)return o(t,e=e.get(r)||null,""+n,a);if("object"==typeof n&&null!==n){switch(n.$$typeof){case ke:return l(t,e=e.get(null===n.key?r:n.key)||null,n,a);case Ne:return c(t,e=e.get(null===n.key?r:n.key)||null,n,a);case Pe:return f(e,t,r,(0,n._init)(n._payload),a)}if(nt(n)||Me(n))return d(t,e=e.get(r)||null,n,a,null);bi(t,n)}return null}return function o(l,c,d,m){if("object"==typeof d&&null!==d&&d.type===je&&null===d.key&&(d=d.props.children),"object"==typeof d&&null!==d){switch(d.$$typeof){case ke:e:{for(var p=d.key,g=c;null!==g;){if(g.key===p){if((p=d.type)===je){if(7===g.tag){r(l,g.sibling),(c=a(g,d.props.children)).return=l,l=c;break e}}else if(g.elementType===p||"object"==typeof p&&null!==p&&p.$$typeof===Pe&&yi(p)===g.type){r(l,g.sibling),(c=a(g,d.props)).ref=vi(l,g,d),c.return=l,l=c;break e}r(l,g);break}t(l,g),g=g.sibling}d.type===je?((c=Md(d.props.children,l.mode,m,d.key)).return=l,l=c):((m=Ld(d.type,d.key,d.props,null,l.mode,m)).ref=vi(l,c,d),m.return=l,l=m)}return i(l);case Ne:e:{for(g=d.key;null!==c;){if(c.key===g){if(4===c.tag&&c.stateNode.containerInfo===d.containerInfo&&c.stateNode.implementation===d.implementation){r(l,c.sibling),(c=a(c,d.children||[])).return=l,l=c;break e}r(l,c);break}t(l,c),c=c.sibling}(c=Bd(d,l.mode,m)).return=l,l=c}return i(l);case Pe:return o(l,c,(g=d._init)(d._payload),m)}if(nt(d))return function(a,i,o,l){for(var c=null,d=null,m=i,p=i=0,g=null;null!==m&&p<o.length;p++){m.index>p?(g=m,m=null):g=m.sibling;var x=h(a,m,o[p],l);if(null===x){null===m&&(m=g);break}e&&m&&null===x.alternate&&t(a,m),i=s(x,i,p),null===d?c=x:d.sibling=x,d=x,m=g}if(p===o.length)return r(a,m),ii&&ei(a,p),c;if(null===m){for(;p<o.length;p++)null!==(m=u(a,o[p],l))&&(i=s(m,i,p),null===d?c=m:d.sibling=m,d=m);return ii&&ei(a,p),c}for(m=n(a,m);p<o.length;p++)null!==(g=f(m,a,p,o[p],l))&&(e&&null!==g.alternate&&m.delete(null===g.key?p:g.key),i=s(g,i,p),null===d?c=g:d.sibling=g,d=g);return e&&m.forEach(function(e){return t(a,e)}),ii&&ei(a,p),c}(l,c,d,m);if(Me(d))return function(a,i,o,l){var c=Me(o);if("function"!=typeof c)throw Error(oe(150));if(null==(o=c.call(o)))throw Error(oe(151));for(var d=c=null,m=i,p=i=0,g=null,x=o.next();null!==m&&!x.done;p++,x=o.next()){m.index>p?(g=m,m=null):g=m.sibling;var v=h(a,m,x.value,l);if(null===v){null===m&&(m=g);break}e&&m&&null===v.alternate&&t(a,m),i=s(v,i,p),null===d?c=v:d.sibling=v,d=v,m=g}if(x.done)return r(a,m),ii&&ei(a,p),c;if(null===m){for(;!x.done;p++,x=o.next())null!==(x=u(a,x.value,l))&&(i=s(x,i,p),null===d?c=x:d.sibling=x,d=x);return ii&&ei(a,p),c}for(m=n(a,m);!x.done;p++,x=o.next())null!==(x=f(m,a,p,x.value,l))&&(e&&null!==x.alternate&&m.delete(null===x.key?p:x.key),i=s(x,i,p),null===d?c=x:d.sibling=x,d=x);return e&&m.forEach(function(e){return t(a,e)}),ii&&ei(a,p),c}(l,c,d,m);bi(l,d)}return"string"==typeof d&&""!==d||"number"==typeof d?(d=""+d,null!==c&&6===c.tag?(r(l,c.sibling),(c=a(c,d)).return=l,l=c):(r(l,c),(c=Ud(d,l.mode,m)).return=l,l=c),i(l)):r(l,c)}}var _i=wi(!0),ki=wi(!1),Ni=Ss(null),ji=null,Si=null,Ti=null;function Ei(){Ti=Si=ji=null}function Ci(e){var t=Ni.current;Ts(Ni),e._currentValue=t}function Ai(e,t,r){for(;null!==e;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==n&&(n.childLanes|=t)):null!==n&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===r)break;e=e.return}}function Oi(e,t){ji=e,Ti=Si=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(0!==(e.lanes&t)&&(wl=!0),e.firstContext=null)}function Ii(e){var t=e._currentValue;if(Ti!==e)if(e={context:e,memoizedValue:t,next:null},null===Si){if(null===ji)throw Error(oe(308));Si=e,ji.dependencies={lanes:0,firstContext:e}}else Si=Si.next=e;return t}var Ri=null;function Pi(e){null===Ri?Ri=[e]:Ri.push(e)}function Di(e,t,r,n){var a=t.interleaved;return null===a?(r.next=r,Pi(t)):(r.next=a.next,a.next=r),t.interleaved=r,Li(e,n)}function Li(e,t){e.lanes|=t;var r=e.alternate;for(null!==r&&(r.lanes|=t),r=e,e=e.return;null!==e;)e.childLanes|=t,null!==(r=e.alternate)&&(r.childLanes|=t),r=e,e=e.return;return 3===r.tag?r.stateNode:null}var Mi=!1;function Fi(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Ui(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Bi(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function $i(e,t,r){var n=e.updateQueue;if(null===n)return null;if(n=n.shared,2&Ac){var a=n.pending;return null===a?t.next=t:(t.next=a.next,a.next=t),n.pending=t,Li(e,r)}return null===(a=n.interleaved)?(t.next=t,Pi(n)):(t.next=a.next,a.next=t),n.interleaved=t,Li(e,r)}function zi(e,t,r){if(null!==(t=t.updateQueue)&&(t=t.shared,4194240&r)){var n=t.lanes;r|=n&=e.pendingLanes,t.lanes=r,yr(e,r)}}function Vi(e,t){var r=e.updateQueue,n=e.alternate;if(null!==n&&r===(n=n.updateQueue)){var a=null,s=null;if(null!==(r=r.firstBaseUpdate)){do{var i={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};null===s?a=s=i:s=s.next=i,r=r.next}while(null!==r);null===s?a=s=t:s=s.next=t}else a=s=t;return r={baseState:n.baseState,firstBaseUpdate:a,lastBaseUpdate:s,shared:n.shared,effects:n.effects},void(e.updateQueue=r)}null===(e=r.lastBaseUpdate)?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function Wi(e,t,r,n){var a=e.updateQueue;Mi=!1;var s=a.firstBaseUpdate,i=a.lastBaseUpdate,o=a.shared.pending;if(null!==o){a.shared.pending=null;var l=o,c=l.next;l.next=null,null===i?s=c:i.next=c,i=l;var d=e.alternate;null!==d&&((o=(d=d.updateQueue).lastBaseUpdate)!==i&&(null===o?d.firstBaseUpdate=c:o.next=c,d.lastBaseUpdate=l))}if(null!==s){var u=a.baseState;for(i=0,d=c=l=null,o=s;;){var h=o.lane,f=o.eventTime;if((n&h)===h){null!==d&&(d=d.next={eventTime:f,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var m=e,p=o;switch(h=t,f=r,p.tag){case 1:if("function"==typeof(m=p.payload)){u=m.call(f,u,h);break e}u=m;break e;case 3:m.flags=-65537&m.flags|128;case 0:if(null==(h="function"==typeof(m=p.payload)?m.call(f,u,h):m))break e;u=Ue({},u,h);break e;case 2:Mi=!0}}null!==o.callback&&0!==o.lane&&(e.flags|=64,null===(h=a.effects)?a.effects=[o]:h.push(o))}else f={eventTime:f,lane:h,tag:o.tag,payload:o.payload,callback:o.callback,next:null},null===d?(c=d=f,l=u):d=d.next=f,i|=h;if(null===(o=o.next)){if(null===(o=a.shared.pending))break;o=(h=o).next,h.next=null,a.lastBaseUpdate=h,a.shared.pending=null}}if(null===d&&(l=u),a.baseState=l,a.firstBaseUpdate=c,a.lastBaseUpdate=d,null!==(t=a.shared.interleaved)){a=t;do{i|=a.lane,a=a.next}while(a!==t)}else null===s&&(a.shared.lanes=0);Fc|=i,e.lanes=i,e.memoizedState=u}}function Hi(e,t,r){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var n=e[t],a=n.callback;if(null!==a){if(n.callback=null,n=r,"function"!=typeof a)throw Error(oe(191,a));a.call(n)}}}var Gi={},qi=Ss(Gi),Ki=Ss(Gi),Xi=Ss(Gi);function Yi(e){if(e===Gi)throw Error(oe(174));return e}function Ji(e,t){switch(Es(Xi,t),Es(Ki,e),Es(qi,Gi),e=t.nodeType){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:dt(null,"");break;default:t=dt(t=(e=8===e?t.parentNode:t).namespaceURI||null,e=e.tagName)}Ts(qi),Es(qi,t)}function Zi(){Ts(qi),Ts(Ki),Ts(Xi)}function Qi(e){Yi(Xi.current);var t=Yi(qi.current),r=dt(t,e.type);t!==r&&(Es(Ki,e),Es(qi,r))}function eo(e){Ki.current===e&&(Ts(qi),Ts(Ki))}var to=Ss(0);function ro(e){for(var t=e;null!==t;){if(13===t.tag){var r=t.memoizedState;if(null!==r&&(null===(r=r.dehydrated)||"$?"===r.data||"$!"===r.data))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(128&t.flags)return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var no=[];function ao(){for(var e=0;e<no.length;e++)no[e]._workInProgressVersionPrimary=null;no.length=0}var so=_e.ReactCurrentDispatcher,io=_e.ReactCurrentBatchConfig,oo=0,lo=null,co=null,uo=null,ho=!1,fo=!1,mo=0,po=0;function go(){throw Error(oe(321))}function xo(e,t){if(null===t)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!ca(e[r],t[r]))return!1;return!0}function vo(e,t,r,n,a,s){if(oo=s,lo=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,so.current=null===e||null===e.memoizedState?tl:rl,e=r(n,a),fo){s=0;do{if(fo=!1,mo=0,25<=s)throw Error(oe(301));s+=1,uo=co=null,t.updateQueue=null,so.current=nl,e=r(n,a)}while(fo)}if(so.current=el,t=null!==co&&null!==co.next,oo=0,uo=co=lo=null,ho=!1,t)throw Error(oe(300));return e}function bo(){var e=0!==mo;return mo=0,e}function yo(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===uo?lo.memoizedState=uo=e:uo=uo.next=e,uo}function wo(){if(null===co){var e=lo.alternate;e=null!==e?e.memoizedState:null}else e=co.next;var t=null===uo?lo.memoizedState:uo.next;if(null!==t)uo=t,co=e;else{if(null===e)throw Error(oe(310));e={memoizedState:(co=e).memoizedState,baseState:co.baseState,baseQueue:co.baseQueue,queue:co.queue,next:null},null===uo?lo.memoizedState=uo=e:uo=uo.next=e}return uo}function _o(e,t){return"function"==typeof t?t(e):t}function ko(e){var t=wo(),r=t.queue;if(null===r)throw Error(oe(311));r.lastRenderedReducer=e;var n=co,a=n.baseQueue,s=r.pending;if(null!==s){if(null!==a){var i=a.next;a.next=s.next,s.next=i}n.baseQueue=a=s,r.pending=null}if(null!==a){s=a.next,n=n.baseState;var o=i=null,l=null,c=s;do{var d=c.lane;if((oo&d)===d)null!==l&&(l=l.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),n=c.hasEagerState?c.eagerState:e(n,c.action);else{var u={lane:d,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};null===l?(o=l=u,i=n):l=l.next=u,lo.lanes|=d,Fc|=d}c=c.next}while(null!==c&&c!==s);null===l?i=n:l.next=o,ca(n,t.memoizedState)||(wl=!0),t.memoizedState=n,t.baseState=i,t.baseQueue=l,r.lastRenderedState=n}if(null!==(e=r.interleaved)){a=e;do{s=a.lane,lo.lanes|=s,Fc|=s,a=a.next}while(a!==e)}else null===a&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function No(e){var t=wo(),r=t.queue;if(null===r)throw Error(oe(311));r.lastRenderedReducer=e;var n=r.dispatch,a=r.pending,s=t.memoizedState;if(null!==a){r.pending=null;var i=a=a.next;do{s=e(s,i.action),i=i.next}while(i!==a);ca(s,t.memoizedState)||(wl=!0),t.memoizedState=s,null===t.baseQueue&&(t.baseState=s),r.lastRenderedState=s}return[s,n]}function jo(){}function So(e,t){var r=lo,n=wo(),a=t(),s=!ca(n.memoizedState,a);if(s&&(n.memoizedState=a,wl=!0),n=n.queue,Fo(Co.bind(null,r,n,e),[e]),n.getSnapshot!==t||s||null!==uo&&1&uo.memoizedState.tag){if(r.flags|=2048,Ro(9,Eo.bind(null,r,n,a,t),void 0,null),null===Oc)throw Error(oe(349));30&oo||To(r,t,a)}return a}function To(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},null===(t=lo.updateQueue)?(t={lastEffect:null,stores:null},lo.updateQueue=t,t.stores=[e]):null===(r=t.stores)?t.stores=[e]:r.push(e)}function Eo(e,t,r,n){t.value=r,t.getSnapshot=n,Ao(t)&&Oo(e)}function Co(e,t,r){return r(function(){Ao(t)&&Oo(e)})}function Ao(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!ca(e,r)}catch(n){return!0}}function Oo(e){var t=Li(e,1);null!==t&&ad(t,e,1,-1)}function Io(e){var t=yo();return"function"==typeof e&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:_o,lastRenderedState:e},t.queue=e,e=e.dispatch=Yo.bind(null,lo,e),[t.memoizedState,e]}function Ro(e,t,r,n){return e={tag:e,create:t,destroy:r,deps:n,next:null},null===(t=lo.updateQueue)?(t={lastEffect:null,stores:null},lo.updateQueue=t,t.lastEffect=e.next=e):null===(r=t.lastEffect)?t.lastEffect=e.next=e:(n=r.next,r.next=e,e.next=n,t.lastEffect=e),e}function Po(){return wo().memoizedState}function Do(e,t,r,n){var a=yo();lo.flags|=e,a.memoizedState=Ro(1|t,r,void 0,void 0===n?null:n)}function Lo(e,t,r,n){var a=wo();n=void 0===n?null:n;var s=void 0;if(null!==co){var i=co.memoizedState;if(s=i.destroy,null!==n&&xo(n,i.deps))return void(a.memoizedState=Ro(t,r,s,n))}lo.flags|=e,a.memoizedState=Ro(1|t,r,s,n)}function Mo(e,t){return Do(8390656,8,e,t)}function Fo(e,t){return Lo(2048,8,e,t)}function Uo(e,t){return Lo(4,2,e,t)}function Bo(e,t){return Lo(4,4,e,t)}function $o(e,t){return"function"==typeof t?(e=e(),t(e),function(){t(null)}):null!=t?(e=e(),t.current=e,function(){t.current=null}):void 0}function zo(e,t,r){return r=null!=r?r.concat([e]):null,Lo(4,4,$o.bind(null,t,e),r)}function Vo(){}function Wo(e,t){var r=wo();t=void 0===t?null:t;var n=r.memoizedState;return null!==n&&null!==t&&xo(t,n[1])?n[0]:(r.memoizedState=[e,t],e)}function Ho(e,t){var r=wo();t=void 0===t?null:t;var n=r.memoizedState;return null!==n&&null!==t&&xo(t,n[1])?n[0]:(e=e(),r.memoizedState=[e,t],e)}function Go(e,t,r){return 21&oo?(ca(r,t)||(r=xr(),lo.lanes|=r,Fc|=r,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,wl=!0),e.memoizedState=r)}function qo(e,t){var r=wr;wr=0!==r&&4>r?r:4,e(!0);var n=io.transition;io.transition={};try{e(!1),t()}finally{wr=r,io.transition=n}}function Ko(){return wo().memoizedState}function Xo(e,t,r){var n=nd(e);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},Jo(e))Zo(t,r);else if(null!==(r=Di(e,t,r,n))){ad(r,e,n,rd()),Qo(r,t,n)}}function Yo(e,t,r){var n=nd(e),a={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(Jo(e))Zo(t,a);else{var s=e.alternate;if(0===e.lanes&&(null===s||0===s.lanes)&&null!==(s=t.lastRenderedReducer))try{var i=t.lastRenderedState,o=s(i,r);if(a.hasEagerState=!0,a.eagerState=o,ca(o,i)){var l=t.interleaved;return null===l?(a.next=a,Pi(t)):(a.next=l.next,l.next=a),void(t.interleaved=a)}}catch(c){}null!==(r=Di(e,t,a,n))&&(ad(r,e,n,a=rd()),Qo(r,t,n))}}function Jo(e){var t=e.alternate;return e===lo||null!==t&&t===lo}function Zo(e,t){fo=ho=!0;var r=e.pending;null===r?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function Qo(e,t,r){if(4194240&r){var n=t.lanes;r|=n&=e.pendingLanes,t.lanes=r,yr(e,r)}}var el={readContext:Ii,useCallback:go,useContext:go,useEffect:go,useImperativeHandle:go,useInsertionEffect:go,useLayoutEffect:go,useMemo:go,useReducer:go,useRef:go,useState:go,useDebugValue:go,useDeferredValue:go,useTransition:go,useMutableSource:go,useSyncExternalStore:go,useId:go,unstable_isNewReconciler:!1},tl={readContext:Ii,useCallback:function(e,t){return yo().memoizedState=[e,void 0===t?null:t],e},useContext:Ii,useEffect:Mo,useImperativeHandle:function(e,t,r){return r=null!=r?r.concat([e]):null,Do(4194308,4,$o.bind(null,t,e),r)},useLayoutEffect:function(e,t){return Do(4194308,4,e,t)},useInsertionEffect:function(e,t){return Do(4,2,e,t)},useMemo:function(e,t){var r=yo();return t=void 0===t?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var n=yo();return t=void 0!==r?r(t):t,n.memoizedState=n.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},n.queue=e,e=e.dispatch=Xo.bind(null,lo,e),[n.memoizedState,e]},useRef:function(e){return e={current:e},yo().memoizedState=e},useState:Io,useDebugValue:Vo,useDeferredValue:function(e){return yo().memoizedState=e},useTransition:function(){var e=Io(!1),t=e[0];return e=qo.bind(null,e[1]),yo().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var n=lo,a=yo();if(ii){if(void 0===r)throw Error(oe(407));r=r()}else{if(r=t(),null===Oc)throw Error(oe(349));30&oo||To(n,t,r)}a.memoizedState=r;var s={value:r,getSnapshot:t};return a.queue=s,Mo(Co.bind(null,n,s,e),[e]),n.flags|=2048,Ro(9,Eo.bind(null,n,s,r,t),void 0,null),r},useId:function(){var e=yo(),t=Oc.identifierPrefix;if(ii){var r=Qs;t=":"+t+"R"+(r=(Zs&~(1<<32-lr(Zs)-1)).toString(32)+r),0<(r=mo++)&&(t+="H"+r.toString(32)),t+=":"}else t=":"+t+"r"+(r=po++).toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},rl={readContext:Ii,useCallback:Wo,useContext:Ii,useEffect:Fo,useImperativeHandle:zo,useInsertionEffect:Uo,useLayoutEffect:Bo,useMemo:Ho,useReducer:ko,useRef:Po,useState:function(){return ko(_o)},useDebugValue:Vo,useDeferredValue:function(e){return Go(wo(),co.memoizedState,e)},useTransition:function(){return[ko(_o)[0],wo().memoizedState]},useMutableSource:jo,useSyncExternalStore:So,useId:Ko,unstable_isNewReconciler:!1},nl={readContext:Ii,useCallback:Wo,useContext:Ii,useEffect:Fo,useImperativeHandle:zo,useInsertionEffect:Uo,useLayoutEffect:Bo,useMemo:Ho,useReducer:No,useRef:Po,useState:function(){return No(_o)},useDebugValue:Vo,useDeferredValue:function(e){var t=wo();return null===co?t.memoizedState=e:Go(t,co.memoizedState,e)},useTransition:function(){return[No(_o)[0],wo().memoizedState]},useMutableSource:jo,useSyncExternalStore:So,useId:Ko,unstable_isNewReconciler:!1};function al(e,t){if(e&&e.defaultProps){for(var r in t=Ue({},t),e=e.defaultProps)void 0===t[r]&&(t[r]=e[r]);return t}return t}function sl(e,t,r,n){r=null==(r=r(n,t=e.memoizedState))?t:Ue({},t,r),e.memoizedState=r,0===e.lanes&&(e.updateQueue.baseState=r)}var il={isMounted:function(e){return!!(e=e._reactInternals)&&Wt(e)===e},enqueueSetState:function(e,t,r){e=e._reactInternals;var n=rd(),a=nd(e),s=Bi(n,a);s.payload=t,null!=r&&(s.callback=r),null!==(t=$i(e,s,a))&&(ad(t,e,a,n),zi(t,e,a))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var n=rd(),a=nd(e),s=Bi(n,a);s.tag=1,s.payload=t,null!=r&&(s.callback=r),null!==(t=$i(e,s,a))&&(ad(t,e,a,n),zi(t,e,a))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=rd(),n=nd(e),a=Bi(r,n);a.tag=2,null!=t&&(a.callback=t),null!==(t=$i(e,a,n))&&(ad(t,e,n,r),zi(t,e,n))}};function ol(e,t,r,n,a,s,i){return"function"==typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(n,s,i):!t.prototype||!t.prototype.isPureReactComponent||(!da(r,n)||!da(a,s))}function ll(e,t,r){var n=!1,a=Cs,s=t.contextType;return"object"==typeof s&&null!==s?s=Ii(s):(a=Ps(t)?Is:As.current,s=(n=null!=(n=t.contextTypes))?Rs(e,a):Cs),t=new t(r,s),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=il,e.stateNode=t,t._reactInternals=e,n&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=a,e.__reactInternalMemoizedMaskedChildContext=s),t}function cl(e,t,r,n){e=t.state,"function"==typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(r,n),"function"==typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(r,n),t.state!==e&&il.enqueueReplaceState(t,t.state,null)}function dl(e,t,r,n){var a=e.stateNode;a.props=r,a.state=e.memoizedState,a.refs={},Fi(e);var s=t.contextType;"object"==typeof s&&null!==s?a.context=Ii(s):(s=Ps(t)?Is:As.current,a.context=Rs(e,s)),a.state=e.memoizedState,"function"==typeof(s=t.getDerivedStateFromProps)&&(sl(e,t,s,r),a.state=e.memoizedState),"function"==typeof t.getDerivedStateFromProps||"function"==typeof a.getSnapshotBeforeUpdate||"function"!=typeof a.UNSAFE_componentWillMount&&"function"!=typeof a.componentWillMount||(t=a.state,"function"==typeof a.componentWillMount&&a.componentWillMount(),"function"==typeof a.UNSAFE_componentWillMount&&a.UNSAFE_componentWillMount(),t!==a.state&&il.enqueueReplaceState(a,a.state,null),Wi(e,r,a,n),a.state=e.memoizedState),"function"==typeof a.componentDidMount&&(e.flags|=4194308)}function ul(e,t){try{var r="",n=t;do{r+=Ve(n),n=n.return}while(n);var a=r}catch(s){a="\nError generating stack: "+s.message+"\n"+s.stack}return{value:e,source:t,stack:a,digest:null}}function hl(e,t,r){return{value:e,source:null,stack:null!=r?r:null,digest:null!=t?t:null}}function fl(e,t){try{console.error(t.value)}catch(r){setTimeout(function(){throw r})}}var ml="function"==typeof WeakMap?WeakMap:Map;function pl(e,t,r){(r=Bi(-1,r)).tag=3,r.payload={element:null};var n=t.value;return r.callback=function(){Gc||(Gc=!0,qc=n),fl(0,t)},r}function gl(e,t,r){(r=Bi(-1,r)).tag=3;var n=e.type.getDerivedStateFromError;if("function"==typeof n){var a=t.value;r.payload=function(){return n(a)},r.callback=function(){fl(0,t)}}var s=e.stateNode;return null!==s&&"function"==typeof s.componentDidCatch&&(r.callback=function(){fl(0,t),"function"!=typeof n&&(null===Kc?Kc=new Set([this]):Kc.add(this));var e=t.stack;this.componentDidCatch(t.value,{componentStack:null!==e?e:""})}),r}function xl(e,t,r){var n=e.pingCache;if(null===n){n=e.pingCache=new ml;var a=new Set;n.set(t,a)}else void 0===(a=n.get(t))&&(a=new Set,n.set(t,a));a.has(r)||(a.add(r),e=Td.bind(null,e,t,r),t.then(e,e))}function vl(e){do{var t;if((t=13===e.tag)&&(t=null===(t=e.memoizedState)||null!==t.dehydrated),t)return e;e=e.return}while(null!==e);return null}function bl(e,t,r,n,a){return 1&e.mode?(e.flags|=65536,e.lanes=a,e):(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,1===r.tag&&(null===r.alternate?r.tag=17:((t=Bi(-1,1)).tag=2,$i(r,t,1))),r.lanes|=1),e)}var yl=_e.ReactCurrentOwner,wl=!1;function _l(e,t,r,n){t.child=null===e?ki(t,null,r,n):_i(t,e.child,r,n)}function kl(e,t,r,n,a){r=r.render;var s=t.ref;return Oi(t,a),n=vo(e,t,r,n,s,a),r=bo(),null===e||wl?(ii&&r&&ri(t),t.flags|=1,_l(e,t,n,a),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,Gl(e,t,a))}function Nl(e,t,r,n,a){if(null===e){var s=r.type;return"function"!=typeof s||Pd(s)||void 0!==s.defaultProps||null!==r.compare||void 0!==r.defaultProps?((e=Ld(r.type,null,n,t,t.mode,a)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=s,jl(e,t,s,n,a))}if(s=e.child,0===(e.lanes&a)){var i=s.memoizedProps;if((r=null!==(r=r.compare)?r:da)(i,n)&&e.ref===t.ref)return Gl(e,t,a)}return t.flags|=1,(e=Dd(s,n)).ref=t.ref,e.return=t,t.child=e}function jl(e,t,r,n,a){if(null!==e){var s=e.memoizedProps;if(da(s,n)&&e.ref===t.ref){if(wl=!1,t.pendingProps=n=s,0===(e.lanes&a))return t.lanes=e.lanes,Gl(e,t,a);131072&e.flags&&(wl=!0)}}return El(e,t,r,n,a)}function Sl(e,t,r){var n=t.pendingProps,a=n.children,s=null!==e?e.memoizedState:null;if("hidden"===n.mode)if(1&t.mode){if(!(1073741824&r))return e=null!==s?s.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Es(Dc,Pc),Pc|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=null!==s?s.baseLanes:r,Es(Dc,Pc),Pc|=n}else t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Es(Dc,Pc),Pc|=r;else null!==s?(n=s.baseLanes|r,t.memoizedState=null):n=r,Es(Dc,Pc),Pc|=n;return _l(e,t,a,r),t.child}function Tl(e,t){var r=t.ref;(null===e&&null!==r||null!==e&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function El(e,t,r,n,a){var s=Ps(r)?Is:As.current;return s=Rs(t,s),Oi(t,a),r=vo(e,t,r,n,s,a),n=bo(),null===e||wl?(ii&&n&&ri(t),t.flags|=1,_l(e,t,r,a),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,Gl(e,t,a))}function Cl(e,t,r,n,a){if(Ps(r)){var s=!0;Fs(t)}else s=!1;if(Oi(t,a),null===t.stateNode)Hl(e,t),ll(t,r,n),dl(t,r,n,a),n=!0;else if(null===e){var i=t.stateNode,o=t.memoizedProps;i.props=o;var l=i.context,c=r.contextType;"object"==typeof c&&null!==c?c=Ii(c):c=Rs(t,c=Ps(r)?Is:As.current);var d=r.getDerivedStateFromProps,u="function"==typeof d||"function"==typeof i.getSnapshotBeforeUpdate;u||"function"!=typeof i.UNSAFE_componentWillReceiveProps&&"function"!=typeof i.componentWillReceiveProps||(o!==n||l!==c)&&cl(t,i,n,c),Mi=!1;var h=t.memoizedState;i.state=h,Wi(t,n,i,a),l=t.memoizedState,o!==n||h!==l||Os.current||Mi?("function"==typeof d&&(sl(t,r,d,n),l=t.memoizedState),(o=Mi||ol(t,r,o,n,h,l,c))?(u||"function"!=typeof i.UNSAFE_componentWillMount&&"function"!=typeof i.componentWillMount||("function"==typeof i.componentWillMount&&i.componentWillMount(),"function"==typeof i.UNSAFE_componentWillMount&&i.UNSAFE_componentWillMount()),"function"==typeof i.componentDidMount&&(t.flags|=4194308)):("function"==typeof i.componentDidMount&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=l),i.props=n,i.state=l,i.context=c,n=o):("function"==typeof i.componentDidMount&&(t.flags|=4194308),n=!1)}else{i=t.stateNode,Ui(e,t),o=t.memoizedProps,c=t.type===t.elementType?o:al(t.type,o),i.props=c,u=t.pendingProps,h=i.context,"object"==typeof(l=r.contextType)&&null!==l?l=Ii(l):l=Rs(t,l=Ps(r)?Is:As.current);var f=r.getDerivedStateFromProps;(d="function"==typeof f||"function"==typeof i.getSnapshotBeforeUpdate)||"function"!=typeof i.UNSAFE_componentWillReceiveProps&&"function"!=typeof i.componentWillReceiveProps||(o!==u||h!==l)&&cl(t,i,n,l),Mi=!1,h=t.memoizedState,i.state=h,Wi(t,n,i,a);var m=t.memoizedState;o!==u||h!==m||Os.current||Mi?("function"==typeof f&&(sl(t,r,f,n),m=t.memoizedState),(c=Mi||ol(t,r,c,n,h,m,l)||!1)?(d||"function"!=typeof i.UNSAFE_componentWillUpdate&&"function"!=typeof i.componentWillUpdate||("function"==typeof i.componentWillUpdate&&i.componentWillUpdate(n,m,l),"function"==typeof i.UNSAFE_componentWillUpdate&&i.UNSAFE_componentWillUpdate(n,m,l)),"function"==typeof i.componentDidUpdate&&(t.flags|=4),"function"==typeof i.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!=typeof i.componentDidUpdate||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!=typeof i.getSnapshotBeforeUpdate||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=m),i.props=n,i.state=m,i.context=l,n=c):("function"!=typeof i.componentDidUpdate||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!=typeof i.getSnapshotBeforeUpdate||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),n=!1)}return Al(e,t,r,n,s,a)}function Al(e,t,r,n,a,s){Tl(e,t);var i=!!(128&t.flags);if(!n&&!i)return a&&Us(t,r,!1),Gl(e,t,s);n=t.stateNode,yl.current=t;var o=i&&"function"!=typeof r.getDerivedStateFromError?null:n.render();return t.flags|=1,null!==e&&i?(t.child=_i(t,e.child,null,s),t.child=_i(t,null,o,s)):_l(e,t,o,s),t.memoizedState=n.state,a&&Us(t,r,!0),t.child}function Ol(e){var t=e.stateNode;t.pendingContext?Ls(0,t.pendingContext,t.pendingContext!==t.context):t.context&&Ls(0,t.context,!1),Ji(e,t.containerInfo)}function Il(e,t,r,n,a){return pi(),gi(a),t.flags|=256,_l(e,t,r,n),t.child}var Rl,Pl,Dl,Ll,Ml={dehydrated:null,treeContext:null,retryLane:0};function Fl(e){return{baseLanes:e,cachePool:null,transitions:null}}function Ul(e,t,r){var n,a=t.pendingProps,s=to.current,i=!1,o=!!(128&t.flags);if((n=o)||(n=(null===e||null!==e.memoizedState)&&!!(2&s)),n?(i=!0,t.flags&=-129):null!==e&&null===e.memoizedState||(s|=1),Es(to,1&s),null===e)return ui(t),null!==(e=t.memoizedState)&&null!==(e=e.dehydrated)?(1&t.mode?"$!"===e.data?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(o=a.children,e=a.fallback,i?(a=t.mode,i=t.child,o={mode:"hidden",children:o},1&a||null===i?i=Fd(o,a,0,null):(i.childLanes=0,i.pendingProps=o),e=Md(e,a,r,null),i.return=t,e.return=t,i.sibling=e,t.child=i,t.child.memoizedState=Fl(r),t.memoizedState=Ml,e):Bl(t,o));if(null!==(s=e.memoizedState)&&null!==(n=s.dehydrated))return function(e,t,r,n,a,s,i){if(r)return 256&t.flags?(t.flags&=-257,$l(e,t,i,n=hl(Error(oe(422))))):null!==t.memoizedState?(t.child=e.child,t.flags|=128,null):(s=n.fallback,a=t.mode,n=Fd({mode:"visible",children:n.children},a,0,null),(s=Md(s,a,i,null)).flags|=2,n.return=t,s.return=t,n.sibling=s,t.child=n,1&t.mode&&_i(t,e.child,null,i),t.child.memoizedState=Fl(i),t.memoizedState=Ml,s);if(!(1&t.mode))return $l(e,t,i,null);if("$!"===a.data){if(n=a.nextSibling&&a.nextSibling.dataset)var o=n.dgst;return n=o,$l(e,t,i,n=hl(s=Error(oe(419)),n,void 0))}if(o=0!==(i&e.childLanes),wl||o){if(null!==(n=Oc)){switch(i&-i){case 4:a=2;break;case 16:a=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:a=32;break;case 536870912:a=268435456;break;default:a=0}0!==(a=0!==(a&(n.suspendedLanes|i))?0:a)&&a!==s.retryLane&&(s.retryLane=a,Li(e,a),ad(n,e,a,-1))}return xd(),$l(e,t,i,n=hl(Error(oe(421))))}return"$?"===a.data?(t.flags|=128,t.child=e.child,t=Cd.bind(null,e),a._reactRetry=t,null):(e=s.treeContext,si=us(a.nextSibling),ai=t,ii=!0,oi=null,null!==e&&(Xs[Ys++]=Zs,Xs[Ys++]=Qs,Xs[Ys++]=Js,Zs=e.id,Qs=e.overflow,Js=t),t=Bl(t,n.children),t.flags|=4096,t)}(e,t,o,a,n,s,r);if(i){i=a.fallback,o=t.mode,n=(s=e.child).sibling;var l={mode:"hidden",children:a.children};return 1&o||t.child===s?(a=Dd(s,l)).subtreeFlags=14680064&s.subtreeFlags:((a=t.child).childLanes=0,a.pendingProps=l,t.deletions=null),null!==n?i=Dd(n,i):(i=Md(i,o,r,null)).flags|=2,i.return=t,a.return=t,a.sibling=i,t.child=a,a=i,i=t.child,o=null===(o=e.child.memoizedState)?Fl(r):{baseLanes:o.baseLanes|r,cachePool:null,transitions:o.transitions},i.memoizedState=o,i.childLanes=e.childLanes&~r,t.memoizedState=Ml,a}return e=(i=e.child).sibling,a=Dd(i,{mode:"visible",children:a.children}),!(1&t.mode)&&(a.lanes=r),a.return=t,a.sibling=null,null!==e&&(null===(r=t.deletions)?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=a,t.memoizedState=null,a}function Bl(e,t){return(t=Fd({mode:"visible",children:t},e.mode,0,null)).return=e,e.child=t}function $l(e,t,r,n){return null!==n&&gi(n),_i(t,e.child,null,r),(e=Bl(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function zl(e,t,r){e.lanes|=t;var n=e.alternate;null!==n&&(n.lanes|=t),Ai(e.return,t,r)}function Vl(e,t,r,n,a){var s=e.memoizedState;null===s?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:a}:(s.isBackwards=t,s.rendering=null,s.renderingStartTime=0,s.last=n,s.tail=r,s.tailMode=a)}function Wl(e,t,r){var n=t.pendingProps,a=n.revealOrder,s=n.tail;if(_l(e,t,n.children,r),2&(n=to.current))n=1&n|2,t.flags|=128;else{if(null!==e&&128&e.flags)e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&zl(e,r,t);else if(19===e.tag)zl(e,r,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if(Es(to,n),1&t.mode)switch(a){case"forwards":for(r=t.child,a=null;null!==r;)null!==(e=r.alternate)&&null===ro(e)&&(a=r),r=r.sibling;null===(r=a)?(a=t.child,t.child=null):(a=r.sibling,r.sibling=null),Vl(t,!1,a,r,s);break;case"backwards":for(r=null,a=t.child,t.child=null;null!==a;){if(null!==(e=a.alternate)&&null===ro(e)){t.child=a;break}e=a.sibling,a.sibling=r,r=a,a=e}Vl(t,!0,r,null,s);break;case"together":Vl(t,!1,null,null,void 0);break;default:t.memoizedState=null}else t.memoizedState=null;return t.child}function Hl(e,t){!(1&t.mode)&&null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Gl(e,t,r){if(null!==e&&(t.dependencies=e.dependencies),Fc|=t.lanes,0===(r&t.childLanes))return null;if(null!==e&&t.child!==e.child)throw Error(oe(153));if(null!==t.child){for(r=Dd(e=t.child,e.pendingProps),t.child=r,r.return=t;null!==e.sibling;)e=e.sibling,(r=r.sibling=Dd(e,e.pendingProps)).return=t;r.sibling=null}return t.child}function ql(e,t){if(!ii)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;null!==t;)null!==t.alternate&&(r=t),t=t.sibling;null===r?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var n=null;null!==r;)null!==r.alternate&&(n=r),r=r.sibling;null===n?t||null===e.tail?e.tail=null:e.tail.sibling=null:n.sibling=null}}function Kl(e){var t=null!==e.alternate&&e.alternate.child===e.child,r=0,n=0;if(t)for(var a=e.child;null!==a;)r|=a.lanes|a.childLanes,n|=14680064&a.subtreeFlags,n|=14680064&a.flags,a.return=e,a=a.sibling;else for(a=e.child;null!==a;)r|=a.lanes|a.childLanes,n|=a.subtreeFlags,n|=a.flags,a.return=e,a=a.sibling;return e.subtreeFlags|=n,e.childLanes=r,t}function Xl(e,t,r){var n=t.pendingProps;switch(ni(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Kl(t),null;case 1:case 17:return Ps(t.type)&&Ds(),Kl(t),null;case 3:return n=t.stateNode,Zi(),Ts(Os),Ts(As),ao(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),null!==e&&null!==e.child||(fi(t)?t.flags|=4:null===e||e.memoizedState.isDehydrated&&!(256&t.flags)||(t.flags|=1024,null!==oi&&(ld(oi),oi=null))),Pl(e,t),Kl(t),null;case 5:eo(t);var a=Yi(Xi.current);if(r=t.type,null!==e&&null!=t.stateNode)Dl(e,t,r,n,a),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!n){if(null===t.stateNode)throw Error(oe(166));return Kl(t),null}if(e=Yi(qi.current),fi(t)){n=t.stateNode,r=t.type;var s=t.memoizedProps;switch(n[ms]=t,n[ps]=s,e=!!(1&t.mode),r){case"dialog":$a("cancel",n),$a("close",n);break;case"iframe":case"object":case"embed":$a("load",n);break;case"video":case"audio":for(a=0;a<Ma.length;a++)$a(Ma[a],n);break;case"source":$a("error",n);break;case"img":case"image":case"link":$a("error",n),$a("load",n);break;case"details":$a("toggle",n);break;case"input":Ze(n,s),$a("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!s.multiple},$a("invalid",n);break;case"textarea":it(n,s),$a("invalid",n)}for(var i in yt(r,s),a=null,s)if(s.hasOwnProperty(i)){var o=s[i];"children"===i?"string"==typeof o?n.textContent!==o&&(!0!==s.suppressHydrationWarning&&es(n.textContent,o,e),a=["children",o]):"number"==typeof o&&n.textContent!==""+o&&(!0!==s.suppressHydrationWarning&&es(n.textContent,o,e),a=["children",""+o]):ce.hasOwnProperty(i)&&null!=o&&"onScroll"===i&&$a("scroll",n)}switch(r){case"input":Ke(n),tt(n,s,!0);break;case"textarea":Ke(n),lt(n);break;case"select":case"option":break;default:"function"==typeof s.onClick&&(n.onclick=ts)}n=a,t.updateQueue=n,null!==n&&(t.flags|=4)}else{i=9===a.nodeType?a:a.ownerDocument,"http://www.w3.org/1999/xhtml"===e&&(e=ct(r)),"http://www.w3.org/1999/xhtml"===e?"script"===r?((e=i.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):"string"==typeof n.is?e=i.createElement(r,{is:n.is}):(e=i.createElement(r),"select"===r&&(i=e,n.multiple?i.multiple=!0:n.size&&(i.size=n.size))):e=i.createElementNS(e,r),e[ms]=t,e[ps]=n,Rl(e,t,!1,!1),t.stateNode=e;e:{switch(i=wt(r,n),r){case"dialog":$a("cancel",e),$a("close",e),a=n;break;case"iframe":case"object":case"embed":$a("load",e),a=n;break;case"video":case"audio":for(a=0;a<Ma.length;a++)$a(Ma[a],e);a=n;break;case"source":$a("error",e),a=n;break;case"img":case"image":case"link":$a("error",e),$a("load",e),a=n;break;case"details":$a("toggle",e),a=n;break;case"input":Ze(e,n),a=Je(e,n),$a("invalid",e);break;case"option":default:a=n;break;case"select":e._wrapperState={wasMultiple:!!n.multiple},a=Ue({},n,{value:void 0}),$a("invalid",e);break;case"textarea":it(e,n),a=st(e,n),$a("invalid",e)}for(s in yt(r,a),o=a)if(o.hasOwnProperty(s)){var l=o[s];"style"===s?vt(e,l):"dangerouslySetInnerHTML"===s?null!=(l=l?l.__html:void 0)&&ft(e,l):"children"===s?"string"==typeof l?("textarea"!==r||""!==l)&&mt(e,l):"number"==typeof l&&mt(e,""+l):"suppressContentEditableWarning"!==s&&"suppressHydrationWarning"!==s&&"autoFocus"!==s&&(ce.hasOwnProperty(s)?null!=l&&"onScroll"===s&&$a("scroll",e):null!=l&&we(e,s,l,i))}switch(r){case"input":Ke(e),tt(e,n,!1);break;case"textarea":Ke(e),lt(e);break;case"option":null!=n.value&&e.setAttribute("value",""+Ge(n.value));break;case"select":e.multiple=!!n.multiple,null!=(s=n.value)?at(e,!!n.multiple,s,!1):null!=n.defaultValue&&at(e,!!n.multiple,n.defaultValue,!0);break;default:"function"==typeof a.onClick&&(e.onclick=ts)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(t.flags|=4)}null!==t.ref&&(t.flags|=512,t.flags|=2097152)}return Kl(t),null;case 6:if(e&&null!=t.stateNode)Ll(e,t,e.memoizedProps,n);else{if("string"!=typeof n&&null===t.stateNode)throw Error(oe(166));if(r=Yi(Xi.current),Yi(qi.current),fi(t)){if(n=t.stateNode,r=t.memoizedProps,n[ms]=t,(s=n.nodeValue!==r)&&null!==(e=ai))switch(e.tag){case 3:es(n.nodeValue,r,!!(1&e.mode));break;case 5:!0!==e.memoizedProps.suppressHydrationWarning&&es(n.nodeValue,r,!!(1&e.mode))}s&&(t.flags|=4)}else(n=(9===r.nodeType?r:r.ownerDocument).createTextNode(n))[ms]=t,t.stateNode=n}return Kl(t),null;case 13:if(Ts(to),n=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(ii&&null!==si&&1&t.mode&&!(128&t.flags))mi(),pi(),t.flags|=98560,s=!1;else if(s=fi(t),null!==n&&null!==n.dehydrated){if(null===e){if(!s)throw Error(oe(318));if(!(s=null!==(s=t.memoizedState)?s.dehydrated:null))throw Error(oe(317));s[ms]=t}else pi(),!(128&t.flags)&&(t.memoizedState=null),t.flags|=4;Kl(t),s=!1}else null!==oi&&(ld(oi),oi=null),s=!0;if(!s)return 65536&t.flags?t:null}return 128&t.flags?(t.lanes=r,t):((n=null!==n)!==(null!==e&&null!==e.memoizedState)&&n&&(t.child.flags|=8192,1&t.mode&&(null===e||1&to.current?0===Lc&&(Lc=3):xd())),null!==t.updateQueue&&(t.flags|=4),Kl(t),null);case 4:return Zi(),Pl(e,t),null===e&&Wa(t.stateNode.containerInfo),Kl(t),null;case 10:return Ci(t.type._context),Kl(t),null;case 19:if(Ts(to),null===(s=t.memoizedState))return Kl(t),null;if(n=!!(128&t.flags),null===(i=s.rendering))if(n)ql(s,!1);else{if(0!==Lc||null!==e&&128&e.flags)for(e=t.child;null!==e;){if(null!==(i=ro(e))){for(t.flags|=128,ql(s,!1),null!==(n=i.updateQueue)&&(t.updateQueue=n,t.flags|=4),t.subtreeFlags=0,n=r,r=t.child;null!==r;)e=n,(s=r).flags&=14680066,null===(i=s.alternate)?(s.childLanes=0,s.lanes=e,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=i.childLanes,s.lanes=i.lanes,s.child=i.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=i.memoizedProps,s.memoizedState=i.memoizedState,s.updateQueue=i.updateQueue,s.type=i.type,e=i.dependencies,s.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return Es(to,1&to.current|2),t.child}e=e.sibling}null!==s.tail&&Qt()>Wc&&(t.flags|=128,n=!0,ql(s,!1),t.lanes=4194304)}else{if(!n)if(null!==(e=ro(i))){if(t.flags|=128,n=!0,null!==(r=e.updateQueue)&&(t.updateQueue=r,t.flags|=4),ql(s,!0),null===s.tail&&"hidden"===s.tailMode&&!i.alternate&&!ii)return Kl(t),null}else 2*Qt()-s.renderingStartTime>Wc&&1073741824!==r&&(t.flags|=128,n=!0,ql(s,!1),t.lanes=4194304);s.isBackwards?(i.sibling=t.child,t.child=i):(null!==(r=s.last)?r.sibling=i:t.child=i,s.last=i)}return null!==s.tail?(t=s.tail,s.rendering=t,s.tail=t.sibling,s.renderingStartTime=Qt(),t.sibling=null,r=to.current,Es(to,n?1&r|2:1&r),t):(Kl(t),null);case 22:case 23:return fd(),n=null!==t.memoizedState,null!==e&&null!==e.memoizedState!==n&&(t.flags|=8192),n&&1&t.mode?!!(1073741824&Pc)&&(Kl(t),6&t.subtreeFlags&&(t.flags|=8192)):Kl(t),null;case 24:case 25:return null}throw Error(oe(156,t.tag))}function Yl(e,t){switch(ni(t),t.tag){case 1:return Ps(t.type)&&Ds(),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return Zi(),Ts(Os),Ts(As),ao(),65536&(e=t.flags)&&!(128&e)?(t.flags=-65537&e|128,t):null;case 5:return eo(t),null;case 13:if(Ts(to),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(oe(340));pi()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return Ts(to),null;case 4:return Zi(),null;case 10:return Ci(t.type._context),null;case 22:case 23:return fd(),null;default:return null}}Rl=function(e,t){for(var r=t.child;null!==r;){if(5===r.tag||6===r.tag)e.appendChild(r.stateNode);else if(4!==r.tag&&null!==r.child){r.child.return=r,r=r.child;continue}if(r===t)break;for(;null===r.sibling;){if(null===r.return||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}},Pl=function(){},Dl=function(e,t,r,n){var a=e.memoizedProps;if(a!==n){e=t.stateNode,Yi(qi.current);var s,i=null;switch(r){case"input":a=Je(e,a),n=Je(e,n),i=[];break;case"select":a=Ue({},a,{value:void 0}),n=Ue({},n,{value:void 0}),i=[];break;case"textarea":a=st(e,a),n=st(e,n),i=[];break;default:"function"!=typeof a.onClick&&"function"==typeof n.onClick&&(e.onclick=ts)}for(c in yt(r,n),r=null,a)if(!n.hasOwnProperty(c)&&a.hasOwnProperty(c)&&null!=a[c])if("style"===c){var o=a[c];for(s in o)o.hasOwnProperty(s)&&(r||(r={}),r[s]="")}else"dangerouslySetInnerHTML"!==c&&"children"!==c&&"suppressContentEditableWarning"!==c&&"suppressHydrationWarning"!==c&&"autoFocus"!==c&&(ce.hasOwnProperty(c)?i||(i=[]):(i=i||[]).push(c,null));for(c in n){var l=n[c];if(o=null!=a?a[c]:void 0,n.hasOwnProperty(c)&&l!==o&&(null!=l||null!=o))if("style"===c)if(o){for(s in o)!o.hasOwnProperty(s)||l&&l.hasOwnProperty(s)||(r||(r={}),r[s]="");for(s in l)l.hasOwnProperty(s)&&o[s]!==l[s]&&(r||(r={}),r[s]=l[s])}else r||(i||(i=[]),i.push(c,r)),r=l;else"dangerouslySetInnerHTML"===c?(l=l?l.__html:void 0,o=o?o.__html:void 0,null!=l&&o!==l&&(i=i||[]).push(c,l)):"children"===c?"string"!=typeof l&&"number"!=typeof l||(i=i||[]).push(c,""+l):"suppressContentEditableWarning"!==c&&"suppressHydrationWarning"!==c&&(ce.hasOwnProperty(c)?(null!=l&&"onScroll"===c&&$a("scroll",e),i||o===l||(i=[])):(i=i||[]).push(c,l))}r&&(i=i||[]).push("style",r);var c=i;(t.updateQueue=c)&&(t.flags|=4)}},Ll=function(e,t,r,n){r!==n&&(t.flags|=4)};var Jl=!1,Zl=!1,Ql="function"==typeof WeakSet?WeakSet:Set,ec=null;function tc(e,t){var r=e.ref;if(null!==r)if("function"==typeof r)try{r(null)}catch(n){Sd(e,t,n)}else r.current=null}function rc(e,t,r){try{r()}catch(n){Sd(e,t,n)}}var nc=!1;function ac(e,t,r){var n=t.updateQueue;if(null!==(n=null!==n?n.lastEffect:null)){var a=n=n.next;do{if((a.tag&e)===e){var s=a.destroy;a.destroy=void 0,void 0!==s&&rc(t,r,s)}a=a.next}while(a!==n)}}function sc(e,t){if(null!==(t=null!==(t=t.updateQueue)?t.lastEffect:null)){var r=t=t.next;do{if((r.tag&e)===e){var n=r.create;r.destroy=n()}r=r.next}while(r!==t)}}function ic(e){var t=e.ref;if(null!==t){var r=e.stateNode;e.tag,e=r,"function"==typeof t?t(e):t.current=e}}function oc(e){var t=e.alternate;null!==t&&(e.alternate=null,oc(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&(delete t[ms],delete t[ps],delete t[xs],delete t[vs],delete t[bs])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function lc(e){return 5===e.tag||3===e.tag||4===e.tag}function cc(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||lc(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function dc(e,t,r){var n=e.tag;if(5===n||6===n)e=e.stateNode,t?8===r.nodeType?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(8===r.nodeType?(t=r.parentNode).insertBefore(e,r):(t=r).appendChild(e),null!=(r=r._reactRootContainer)||null!==t.onclick||(t.onclick=ts));else if(4!==n&&null!==(e=e.child))for(dc(e,t,r),e=e.sibling;null!==e;)dc(e,t,r),e=e.sibling}function uc(e,t,r){var n=e.tag;if(5===n||6===n)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(4!==n&&null!==(e=e.child))for(uc(e,t,r),e=e.sibling;null!==e;)uc(e,t,r),e=e.sibling}var hc=null,fc=!1;function mc(e,t,r){for(r=r.child;null!==r;)pc(e,t,r),r=r.sibling}function pc(e,t,r){if(or&&"function"==typeof or.onCommitFiberUnmount)try{or.onCommitFiberUnmount(ir,r)}catch(o){}switch(r.tag){case 5:Zl||tc(r,t);case 6:var n=hc,a=fc;hc=null,mc(e,t,r),fc=a,null!==(hc=n)&&(fc?(e=hc,r=r.stateNode,8===e.nodeType?e.parentNode.removeChild(r):e.removeChild(r)):hc.removeChild(r.stateNode));break;case 18:null!==hc&&(fc?(e=hc,r=r.stateNode,8===e.nodeType?ds(e.parentNode,r):1===e.nodeType&&ds(e,r),Wr(e)):ds(hc,r.stateNode));break;case 4:n=hc,a=fc,hc=r.stateNode.containerInfo,fc=!0,mc(e,t,r),hc=n,fc=a;break;case 0:case 11:case 14:case 15:if(!Zl&&(null!==(n=r.updateQueue)&&null!==(n=n.lastEffect))){a=n=n.next;do{var s=a,i=s.destroy;s=s.tag,void 0!==i&&(2&s||4&s)&&rc(r,t,i),a=a.next}while(a!==n)}mc(e,t,r);break;case 1:if(!Zl&&(tc(r,t),"function"==typeof(n=r.stateNode).componentWillUnmount))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(o){Sd(r,t,o)}mc(e,t,r);break;case 21:mc(e,t,r);break;case 22:1&r.mode?(Zl=(n=Zl)||null!==r.memoizedState,mc(e,t,r),Zl=n):mc(e,t,r);break;default:mc(e,t,r)}}function gc(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var r=e.stateNode;null===r&&(r=e.stateNode=new Ql),t.forEach(function(t){var n=Ad.bind(null,e,t);r.has(t)||(r.add(t),t.then(n,n))})}}function xc(e,t){var r=t.deletions;if(null!==r)for(var n=0;n<r.length;n++){var a=r[n];try{var s=e,i=t,o=i;e:for(;null!==o;){switch(o.tag){case 5:hc=o.stateNode,fc=!1;break e;case 3:case 4:hc=o.stateNode.containerInfo,fc=!0;break e}o=o.return}if(null===hc)throw Error(oe(160));pc(s,i,a),hc=null,fc=!1;var l=a.alternate;null!==l&&(l.return=null),a.return=null}catch(c){Sd(a,t,c)}}if(12854&t.subtreeFlags)for(t=t.child;null!==t;)vc(t,e),t=t.sibling}function vc(e,t){var r=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(xc(t,e),bc(e),4&n){try{ac(3,e,e.return),sc(3,e)}catch(p){Sd(e,e.return,p)}try{ac(5,e,e.return)}catch(p){Sd(e,e.return,p)}}break;case 1:xc(t,e),bc(e),512&n&&null!==r&&tc(r,r.return);break;case 5:if(xc(t,e),bc(e),512&n&&null!==r&&tc(r,r.return),32&e.flags){var a=e.stateNode;try{mt(a,"")}catch(p){Sd(e,e.return,p)}}if(4&n&&null!=(a=e.stateNode)){var s=e.memoizedProps,i=null!==r?r.memoizedProps:s,o=e.type,l=e.updateQueue;if(e.updateQueue=null,null!==l)try{"input"===o&&"radio"===s.type&&null!=s.name&&Qe(a,s),wt(o,i);var c=wt(o,s);for(i=0;i<l.length;i+=2){var d=l[i],u=l[i+1];"style"===d?vt(a,u):"dangerouslySetInnerHTML"===d?ft(a,u):"children"===d?mt(a,u):we(a,d,u,c)}switch(o){case"input":et(a,s);break;case"textarea":ot(a,s);break;case"select":var h=a._wrapperState.wasMultiple;a._wrapperState.wasMultiple=!!s.multiple;var f=s.value;null!=f?at(a,!!s.multiple,f,!1):h!==!!s.multiple&&(null!=s.defaultValue?at(a,!!s.multiple,s.defaultValue,!0):at(a,!!s.multiple,s.multiple?[]:"",!1))}a[ps]=s}catch(p){Sd(e,e.return,p)}}break;case 6:if(xc(t,e),bc(e),4&n){if(null===e.stateNode)throw Error(oe(162));a=e.stateNode,s=e.memoizedProps;try{a.nodeValue=s}catch(p){Sd(e,e.return,p)}}break;case 3:if(xc(t,e),bc(e),4&n&&null!==r&&r.memoizedState.isDehydrated)try{Wr(t.containerInfo)}catch(p){Sd(e,e.return,p)}break;case 4:default:xc(t,e),bc(e);break;case 13:xc(t,e),bc(e),8192&(a=e.child).flags&&(s=null!==a.memoizedState,a.stateNode.isHidden=s,!s||null!==a.alternate&&null!==a.alternate.memoizedState||(Vc=Qt())),4&n&&gc(e);break;case 22:if(d=null!==r&&null!==r.memoizedState,1&e.mode?(Zl=(c=Zl)||d,xc(t,e),Zl=c):xc(t,e),bc(e),8192&n){if(c=null!==e.memoizedState,(e.stateNode.isHidden=c)&&!d&&1&e.mode)for(ec=e,d=e.child;null!==d;){for(u=ec=d;null!==ec;){switch(f=(h=ec).child,h.tag){case 0:case 11:case 14:case 15:ac(4,h,h.return);break;case 1:tc(h,h.return);var m=h.stateNode;if("function"==typeof m.componentWillUnmount){n=h,r=h.return;try{t=n,m.props=t.memoizedProps,m.state=t.memoizedState,m.componentWillUnmount()}catch(p){Sd(n,r,p)}}break;case 5:tc(h,h.return);break;case 22:if(null!==h.memoizedState){kc(u);continue}}null!==f?(f.return=h,ec=f):kc(u)}d=d.sibling}e:for(d=null,u=e;;){if(5===u.tag){if(null===d){d=u;try{a=u.stateNode,c?"function"==typeof(s=a.style).setProperty?s.setProperty("display","none","important"):s.display="none":(o=u.stateNode,i=null!=(l=u.memoizedProps.style)&&l.hasOwnProperty("display")?l.display:null,o.style.display=xt("display",i))}catch(p){Sd(e,e.return,p)}}}else if(6===u.tag){if(null===d)try{u.stateNode.nodeValue=c?"":u.memoizedProps}catch(p){Sd(e,e.return,p)}}else if((22!==u.tag&&23!==u.tag||null===u.memoizedState||u===e)&&null!==u.child){u.child.return=u,u=u.child;continue}if(u===e)break e;for(;null===u.sibling;){if(null===u.return||u.return===e)break e;d===u&&(d=null),u=u.return}d===u&&(d=null),u.sibling.return=u.return,u=u.sibling}}break;case 19:xc(t,e),bc(e),4&n&&gc(e);case 21:}}function bc(e){var t=e.flags;if(2&t){try{e:{for(var r=e.return;null!==r;){if(lc(r)){var n=r;break e}r=r.return}throw Error(oe(160))}switch(n.tag){case 5:var a=n.stateNode;32&n.flags&&(mt(a,""),n.flags&=-33),uc(e,cc(e),a);break;case 3:case 4:var s=n.stateNode.containerInfo;dc(e,cc(e),s);break;default:throw Error(oe(161))}}catch(i){Sd(e,e.return,i)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function yc(e,t,r){ec=e,wc(e)}function wc(e,t,r){for(var n=!!(1&e.mode);null!==ec;){var a=ec,s=a.child;if(22===a.tag&&n){var i=null!==a.memoizedState||Jl;if(!i){var o=a.alternate,l=null!==o&&null!==o.memoizedState||Zl;o=Jl;var c=Zl;if(Jl=i,(Zl=l)&&!c)for(ec=a;null!==ec;)l=(i=ec).child,22===i.tag&&null!==i.memoizedState?Nc(a):null!==l?(l.return=i,ec=l):Nc(a);for(;null!==s;)ec=s,wc(s),s=s.sibling;ec=a,Jl=o,Zl=c}_c(e)}else 8772&a.subtreeFlags&&null!==s?(s.return=a,ec=s):_c(e)}}function _c(e){for(;null!==ec;){var t=ec;if(8772&t.flags){var r=t.alternate;try{if(8772&t.flags)switch(t.tag){case 0:case 11:case 15:Zl||sc(5,t);break;case 1:var n=t.stateNode;if(4&t.flags&&!Zl)if(null===r)n.componentDidMount();else{var a=t.elementType===t.type?r.memoizedProps:al(t.type,r.memoizedProps);n.componentDidUpdate(a,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var s=t.updateQueue;null!==s&&Hi(t,s,n);break;case 3:var i=t.updateQueue;if(null!==i){if(r=null,null!==t.child)switch(t.child.tag){case 5:case 1:r=t.child.stateNode}Hi(t,i,r)}break;case 5:var o=t.stateNode;if(null===r&&4&t.flags){r=o;var l=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&r.focus();break;case"img":l.src&&(r.src=l.src)}}break;case 6:case 4:case 12:case 19:case 17:case 21:case 22:case 23:case 25:break;case 13:if(null===t.memoizedState){var c=t.alternate;if(null!==c){var d=c.memoizedState;if(null!==d){var u=d.dehydrated;null!==u&&Wr(u)}}}break;default:throw Error(oe(163))}Zl||512&t.flags&&ic(t)}catch(h){Sd(t,t.return,h)}}if(t===e){ec=null;break}if(null!==(r=t.sibling)){r.return=t.return,ec=r;break}ec=t.return}}function kc(e){for(;null!==ec;){var t=ec;if(t===e){ec=null;break}var r=t.sibling;if(null!==r){r.return=t.return,ec=r;break}ec=t.return}}function Nc(e){for(;null!==ec;){var t=ec;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{sc(4,t)}catch(l){Sd(t,r,l)}break;case 1:var n=t.stateNode;if("function"==typeof n.componentDidMount){var a=t.return;try{n.componentDidMount()}catch(l){Sd(t,a,l)}}var s=t.return;try{ic(t)}catch(l){Sd(t,s,l)}break;case 5:var i=t.return;try{ic(t)}catch(l){Sd(t,i,l)}}}catch(l){Sd(t,t.return,l)}if(t===e){ec=null;break}var o=t.sibling;if(null!==o){o.return=t.return,ec=o;break}ec=t.return}}var jc,Sc=Math.ceil,Tc=_e.ReactCurrentDispatcher,Ec=_e.ReactCurrentOwner,Cc=_e.ReactCurrentBatchConfig,Ac=0,Oc=null,Ic=null,Rc=0,Pc=0,Dc=Ss(0),Lc=0,Mc=null,Fc=0,Uc=0,Bc=0,$c=null,zc=null,Vc=0,Wc=1/0,Hc=null,Gc=!1,qc=null,Kc=null,Xc=!1,Yc=null,Jc=0,Zc=0,Qc=null,ed=-1,td=0;function rd(){return 6&Ac?Qt():-1!==ed?ed:ed=Qt()}function nd(e){return 1&e.mode?2&Ac&&0!==Rc?Rc&-Rc:null!==xi.transition?(0===td&&(td=xr()),td):0!==(e=wr)?e:e=void 0===(e=window.event)?16:Zr(e.type):1}function ad(e,t,r,n){if(50<Zc)throw Zc=0,Qc=null,Error(oe(185));br(e,r,n),2&Ac&&e===Oc||(e===Oc&&(!(2&Ac)&&(Uc|=r),4===Lc&&cd(e,Rc)),sd(e,n),1===r&&0===Ac&&!(1&t.mode)&&(Wc=Qt()+500,$s&&Ws()))}function sd(e,t){var r=e.callbackNode;!function(e,t){for(var r=e.suspendedLanes,n=e.pingedLanes,a=e.expirationTimes,s=e.pendingLanes;0<s;){var i=31-lr(s),o=1<<i,l=a[i];-1===l?0!==(o&r)&&0===(o&n)||(a[i]=pr(o,t)):l<=t&&(e.expiredLanes|=o),s&=~o}}(e,t);var n=mr(e,e===Oc?Rc:0);if(0===n)null!==r&&Yt(r),e.callbackNode=null,e.callbackPriority=0;else if(t=n&-n,e.callbackPriority!==t){if(null!=r&&Yt(r),1===t)0===e.tag?function(e){$s=!0,Vs(e)}(dd.bind(null,e)):Vs(dd.bind(null,e)),ls(function(){!(6&Ac)&&Ws()}),r=null;else{switch(_r(n)){case 1:r=tr;break;case 4:r=rr;break;case 16:default:r=nr;break;case 536870912:r=sr}r=Od(r,id.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function id(e,t){if(ed=-1,td=0,6&Ac)throw Error(oe(327));var r=e.callbackNode;if(Nd()&&e.callbackNode!==r)return null;var n=mr(e,e===Oc?Rc:0);if(0===n)return null;if(30&n||0!==(n&e.expiredLanes)||t)t=vd(e,n);else{t=n;var a=Ac;Ac|=2;var s=gd();for(Oc===e&&Rc===t||(Hc=null,Wc=Qt()+500,md(e,t));;)try{yd();break}catch(o){pd(e,o)}Ei(),Tc.current=s,Ac=a,null!==Ic?t=0:(Oc=null,Rc=0,t=Lc)}if(0!==t){if(2===t&&(0!==(a=gr(e))&&(n=a,t=od(e,a))),1===t)throw r=Mc,md(e,0),cd(e,n),sd(e,Qt()),r;if(6===t)cd(e,n);else{if(a=e.current.alternate,!(30&n||function(e){for(var t=e;;){if(16384&t.flags){var r=t.updateQueue;if(null!==r&&null!==(r=r.stores))for(var n=0;n<r.length;n++){var a=r[n],s=a.getSnapshot;a=a.value;try{if(!ca(s(),a))return!1}catch(i){return!1}}}if(r=t.child,16384&t.subtreeFlags&&null!==r)r.return=t,t=r;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}(a)||(t=vd(e,n),2===t&&(s=gr(e),0!==s&&(n=s,t=od(e,s))),1!==t)))throw r=Mc,md(e,0),cd(e,n),sd(e,Qt()),r;switch(e.finishedWork=a,e.finishedLanes=n,t){case 0:case 1:throw Error(oe(345));case 2:case 5:kd(e,zc,Hc);break;case 3:if(cd(e,n),(130023424&n)===n&&10<(t=Vc+500-Qt())){if(0!==mr(e,0))break;if(((a=e.suspendedLanes)&n)!==n){rd(),e.pingedLanes|=e.suspendedLanes&a;break}e.timeoutHandle=ss(kd.bind(null,e,zc,Hc),t);break}kd(e,zc,Hc);break;case 4:if(cd(e,n),(4194240&n)===n)break;for(t=e.eventTimes,a=-1;0<n;){var i=31-lr(n);s=1<<i,(i=t[i])>a&&(a=i),n&=~s}if(n=a,10<(n=(120>(n=Qt()-n)?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*Sc(n/1960))-n)){e.timeoutHandle=ss(kd.bind(null,e,zc,Hc),n);break}kd(e,zc,Hc);break;default:throw Error(oe(329))}}}return sd(e,Qt()),e.callbackNode===r?id.bind(null,e):null}function od(e,t){var r=$c;return e.current.memoizedState.isDehydrated&&(md(e,t).flags|=256),2!==(e=vd(e,t))&&(t=zc,zc=r,null!==t&&ld(t)),e}function ld(e){null===zc?zc=e:zc.push.apply(zc,e)}function cd(e,t){for(t&=~Bc,t&=~Uc,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-lr(t),n=1<<r;e[r]=-1,t&=~n}}function dd(e){if(6&Ac)throw Error(oe(327));Nd();var t=mr(e,0);if(!(1&t))return sd(e,Qt()),null;var r=vd(e,t);if(0!==e.tag&&2===r){var n=gr(e);0!==n&&(t=n,r=od(e,n))}if(1===r)throw r=Mc,md(e,0),cd(e,t),sd(e,Qt()),r;if(6===r)throw Error(oe(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,kd(e,zc,Hc),sd(e,Qt()),null}function ud(e,t){var r=Ac;Ac|=1;try{return e(t)}finally{0===(Ac=r)&&(Wc=Qt()+500,$s&&Ws())}}function hd(e){null!==Yc&&0===Yc.tag&&!(6&Ac)&&Nd();var t=Ac;Ac|=1;var r=Cc.transition,n=wr;try{if(Cc.transition=null,wr=1,e)return e()}finally{wr=n,Cc.transition=r,!(6&(Ac=t))&&Ws()}}function fd(){Pc=Dc.current,Ts(Dc)}function md(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(-1!==r&&(e.timeoutHandle=-1,is(r)),null!==Ic)for(r=Ic.return;null!==r;){var n=r;switch(ni(n),n.tag){case 1:null!=(n=n.type.childContextTypes)&&Ds();break;case 3:Zi(),Ts(Os),Ts(As),ao();break;case 5:eo(n);break;case 4:Zi();break;case 13:case 19:Ts(to);break;case 10:Ci(n.type._context);break;case 22:case 23:fd()}r=r.return}if(Oc=e,Ic=e=Dd(e.current,null),Rc=Pc=t,Lc=0,Mc=null,Bc=Uc=Fc=0,zc=$c=null,null!==Ri){for(t=0;t<Ri.length;t++)if(null!==(n=(r=Ri[t]).interleaved)){r.interleaved=null;var a=n.next,s=r.pending;if(null!==s){var i=s.next;s.next=a,n.next=i}r.pending=n}Ri=null}return e}function pd(e,t){for(;;){var r=Ic;try{if(Ei(),so.current=el,ho){for(var n=lo.memoizedState;null!==n;){var a=n.queue;null!==a&&(a.pending=null),n=n.next}ho=!1}if(oo=0,uo=co=lo=null,fo=!1,mo=0,Ec.current=null,null===r||null===r.return){Lc=1,Mc=t,Ic=null;break}e:{var s=e,i=r.return,o=r,l=t;if(t=Rc,o.flags|=32768,null!==l&&"object"==typeof l&&"function"==typeof l.then){var c=l,d=o,u=d.tag;if(!(1&d.mode||0!==u&&11!==u&&15!==u)){var h=d.alternate;h?(d.updateQueue=h.updateQueue,d.memoizedState=h.memoizedState,d.lanes=h.lanes):(d.updateQueue=null,d.memoizedState=null)}var f=vl(i);if(null!==f){f.flags&=-257,bl(f,i,o,0,t),1&f.mode&&xl(s,c,t),l=c;var m=(t=f).updateQueue;if(null===m){var p=new Set;p.add(l),t.updateQueue=p}else m.add(l);break e}if(!(1&t)){xl(s,c,t),xd();break e}l=Error(oe(426))}else if(ii&&1&o.mode){var g=vl(i);if(null!==g){!(65536&g.flags)&&(g.flags|=256),bl(g,i,o,0,t),gi(ul(l,o));break e}}s=l=ul(l,o),4!==Lc&&(Lc=2),null===$c?$c=[s]:$c.push(s),s=i;do{switch(s.tag){case 3:s.flags|=65536,t&=-t,s.lanes|=t,Vi(s,pl(0,l,t));break e;case 1:o=l;var x=s.type,v=s.stateNode;if(!(128&s.flags||"function"!=typeof x.getDerivedStateFromError&&(null===v||"function"!=typeof v.componentDidCatch||null!==Kc&&Kc.has(v)))){s.flags|=65536,t&=-t,s.lanes|=t,Vi(s,gl(s,o,t));break e}}s=s.return}while(null!==s)}_d(r)}catch(b){t=b,Ic===r&&null!==r&&(Ic=r=r.return);continue}break}}function gd(){var e=Tc.current;return Tc.current=el,null===e?el:e}function xd(){0!==Lc&&3!==Lc&&2!==Lc||(Lc=4),null===Oc||!(268435455&Fc)&&!(268435455&Uc)||cd(Oc,Rc)}function vd(e,t){var r=Ac;Ac|=2;var n=gd();for(Oc===e&&Rc===t||(Hc=null,md(e,t));;)try{bd();break}catch(a){pd(e,a)}if(Ei(),Ac=r,Tc.current=n,null!==Ic)throw Error(oe(261));return Oc=null,Rc=0,Lc}function bd(){for(;null!==Ic;)wd(Ic)}function yd(){for(;null!==Ic&&!Jt();)wd(Ic)}function wd(e){var t=jc(e.alternate,e,Pc);e.memoizedProps=e.pendingProps,null===t?_d(e):Ic=t,Ec.current=null}function _d(e){var t=e;do{var r=t.alternate;if(e=t.return,32768&t.flags){if(null!==(r=Yl(r,t)))return r.flags&=32767,void(Ic=r);if(null===e)return Lc=6,void(Ic=null);e.flags|=32768,e.subtreeFlags=0,e.deletions=null}else if(null!==(r=Xl(r,t,Pc)))return void(Ic=r);if(null!==(t=t.sibling))return void(Ic=t);Ic=t=e}while(null!==t);0===Lc&&(Lc=5)}function kd(e,t,r){var n=wr,a=Cc.transition;try{Cc.transition=null,wr=1,function(e,t,r,n){do{Nd()}while(null!==Yc);if(6&Ac)throw Error(oe(327));r=e.finishedWork;var a=e.finishedLanes;if(null===r)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(oe(177));e.callbackNode=null,e.callbackPriority=0;var s=r.lanes|r.childLanes;if(function(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var n=e.eventTimes;for(e=e.expirationTimes;0<r;){var a=31-lr(r),s=1<<a;t[a]=0,n[a]=-1,e[a]=-1,r&=~s}}(e,s),e===Oc&&(Ic=Oc=null,Rc=0),!(2064&r.subtreeFlags)&&!(2064&r.flags)||Xc||(Xc=!0,Od(nr,function(){return Nd(),null})),s=!!(15990&r.flags),!!(15990&r.subtreeFlags)||s){s=Cc.transition,Cc.transition=null;var i=wr;wr=1;var o=Ac;Ac|=4,Ec.current=null,function(e,t){if(rs=Gr,pa(e=ma())){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{var n=(r=(r=e.ownerDocument)&&r.defaultView||window).getSelection&&r.getSelection();if(n&&0!==n.rangeCount){r=n.anchorNode;var a=n.anchorOffset,s=n.focusNode;n=n.focusOffset;try{r.nodeType,s.nodeType}catch(y){r=null;break e}var i=0,o=-1,l=-1,c=0,d=0,u=e,h=null;t:for(;;){for(var f;u!==r||0!==a&&3!==u.nodeType||(o=i+a),u!==s||0!==n&&3!==u.nodeType||(l=i+n),3===u.nodeType&&(i+=u.nodeValue.length),null!==(f=u.firstChild);)h=u,u=f;for(;;){if(u===e)break t;if(h===r&&++c===a&&(o=i),h===s&&++d===n&&(l=i),null!==(f=u.nextSibling))break;h=(u=h).parentNode}u=f}r=-1===o||-1===l?null:{start:o,end:l}}else r=null}r=r||{start:0,end:0}}else r=null;for(ns={focusedElem:e,selectionRange:r},Gr=!1,ec=t;null!==ec;)if(e=(t=ec).child,1028&t.subtreeFlags&&null!==e)e.return=t,ec=e;else for(;null!==ec;){t=ec;try{var m=t.alternate;if(1024&t.flags)switch(t.tag){case 0:case 11:case 15:case 5:case 6:case 4:case 17:break;case 1:if(null!==m){var p=m.memoizedProps,g=m.memoizedState,x=t.stateNode,v=x.getSnapshotBeforeUpdate(t.elementType===t.type?p:al(t.type,p),g);x.__reactInternalSnapshotBeforeUpdate=v}break;case 3:var b=t.stateNode.containerInfo;1===b.nodeType?b.textContent="":9===b.nodeType&&b.documentElement&&b.removeChild(b.documentElement);break;default:throw Error(oe(163))}}catch(y){Sd(t,t.return,y)}if(null!==(e=t.sibling)){e.return=t.return,ec=e;break}ec=t.return}m=nc,nc=!1}(e,r),vc(r,e),ga(ns),Gr=!!rs,ns=rs=null,e.current=r,yc(r),Zt(),Ac=o,wr=i,Cc.transition=s}else e.current=r;if(Xc&&(Xc=!1,Yc=e,Jc=a),s=e.pendingLanes,0===s&&(Kc=null),function(e){if(or&&"function"==typeof or.onCommitFiberRoot)try{or.onCommitFiberRoot(ir,e,void 0,!(128&~e.current.flags))}catch(t){}}(r.stateNode),sd(e,Qt()),null!==t)for(n=e.onRecoverableError,r=0;r<t.length;r++)a=t[r],n(a.value,{componentStack:a.stack,digest:a.digest});if(Gc)throw Gc=!1,e=qc,qc=null,e;!!(1&Jc)&&0!==e.tag&&Nd(),s=e.pendingLanes,1&s?e===Qc?Zc++:(Zc=0,Qc=e):Zc=0,Ws()}(e,t,r,n)}finally{Cc.transition=a,wr=n}return null}function Nd(){if(null!==Yc){var e=_r(Jc),t=Cc.transition,r=wr;try{if(Cc.transition=null,wr=16>e?16:e,null===Yc)var n=!1;else{if(e=Yc,Yc=null,Jc=0,6&Ac)throw Error(oe(331));var a=Ac;for(Ac|=4,ec=e.current;null!==ec;){var s=ec,i=s.child;if(16&ec.flags){var o=s.deletions;if(null!==o){for(var l=0;l<o.length;l++){var c=o[l];for(ec=c;null!==ec;){var d=ec;switch(d.tag){case 0:case 11:case 15:ac(8,d,s)}var u=d.child;if(null!==u)u.return=d,ec=u;else for(;null!==ec;){var h=(d=ec).sibling,f=d.return;if(oc(d),d===c){ec=null;break}if(null!==h){h.return=f,ec=h;break}ec=f}}}var m=s.alternate;if(null!==m){var p=m.child;if(null!==p){m.child=null;do{var g=p.sibling;p.sibling=null,p=g}while(null!==p)}}ec=s}}if(2064&s.subtreeFlags&&null!==i)i.return=s,ec=i;else e:for(;null!==ec;){if(2048&(s=ec).flags)switch(s.tag){case 0:case 11:case 15:ac(9,s,s.return)}var x=s.sibling;if(null!==x){x.return=s.return,ec=x;break e}ec=s.return}}var v=e.current;for(ec=v;null!==ec;){var b=(i=ec).child;if(2064&i.subtreeFlags&&null!==b)b.return=i,ec=b;else e:for(i=v;null!==ec;){if(2048&(o=ec).flags)try{switch(o.tag){case 0:case 11:case 15:sc(9,o)}}catch(w){Sd(o,o.return,w)}if(o===i){ec=null;break e}var y=o.sibling;if(null!==y){y.return=o.return,ec=y;break e}ec=o.return}}if(Ac=a,Ws(),or&&"function"==typeof or.onPostCommitFiberRoot)try{or.onPostCommitFiberRoot(ir,e)}catch(w){}n=!0}return n}finally{wr=r,Cc.transition=t}}return!1}function jd(e,t,r){e=$i(e,t=pl(0,t=ul(r,t),1),1),t=rd(),null!==e&&(br(e,1,t),sd(e,t))}function Sd(e,t,r){if(3===e.tag)jd(e,e,r);else for(;null!==t;){if(3===t.tag){jd(t,e,r);break}if(1===t.tag){var n=t.stateNode;if("function"==typeof t.type.getDerivedStateFromError||"function"==typeof n.componentDidCatch&&(null===Kc||!Kc.has(n))){t=$i(t,e=gl(t,e=ul(r,e),1),1),e=rd(),null!==t&&(br(t,1,e),sd(t,e));break}}t=t.return}}function Td(e,t,r){var n=e.pingCache;null!==n&&n.delete(t),t=rd(),e.pingedLanes|=e.suspendedLanes&r,Oc===e&&(Rc&r)===r&&(4===Lc||3===Lc&&(130023424&Rc)===Rc&&500>Qt()-Vc?md(e,0):Bc|=r),sd(e,t)}function Ed(e,t){0===t&&(1&e.mode?(t=hr,!(130023424&(hr<<=1))&&(hr=4194304)):t=1);var r=rd();null!==(e=Li(e,t))&&(br(e,t,r),sd(e,r))}function Cd(e){var t=e.memoizedState,r=0;null!==t&&(r=t.retryLane),Ed(e,r)}function Ad(e,t){var r=0;switch(e.tag){case 13:var n=e.stateNode,a=e.memoizedState;null!==a&&(r=a.retryLane);break;case 19:n=e.stateNode;break;default:throw Error(oe(314))}null!==n&&n.delete(t),Ed(e,r)}function Od(e,t){return Xt(e,t)}function Id(e,t,r,n){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Rd(e,t,r,n){return new Id(e,t,r,n)}function Pd(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Dd(e,t){var r=e.alternate;return null===r?((r=Rd(e.tag,t,e.key,e.mode)).elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=14680064&e.flags,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function Ld(e,t,r,n,a,s){var i=2;if(n=e,"function"==typeof e)Pd(e)&&(i=1);else if("string"==typeof e)i=5;else e:switch(e){case je:return Md(r.children,a,s,t);case Se:i=8,a|=8;break;case Te:return(e=Rd(12,r,t,2|a)).elementType=Te,e.lanes=s,e;case Oe:return(e=Rd(13,r,t,a)).elementType=Oe,e.lanes=s,e;case Ie:return(e=Rd(19,r,t,a)).elementType=Ie,e.lanes=s,e;case De:return Fd(r,a,s,t);default:if("object"==typeof e&&null!==e)switch(e.$$typeof){case Ee:i=10;break e;case Ce:i=9;break e;case Ae:i=11;break e;case Re:i=14;break e;case Pe:i=16,n=null;break e}throw Error(oe(130,null==e?e:typeof e,""))}return(t=Rd(i,r,t,a)).elementType=e,t.type=n,t.lanes=s,t}function Md(e,t,r,n){return(e=Rd(7,e,n,t)).lanes=r,e}function Fd(e,t,r,n){return(e=Rd(22,e,n,t)).elementType=De,e.lanes=r,e.stateNode={isHidden:!1},e}function Ud(e,t,r){return(e=Rd(6,e,null,t)).lanes=r,e}function Bd(e,t,r){return(t=Rd(4,null!==e.children?e.children:[],e.key,t)).lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function $d(e,t,r,n,a){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=vr(0),this.expirationTimes=vr(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=vr(0),this.identifierPrefix=n,this.onRecoverableError=a,this.mutableSourceEagerHydrationData=null}function zd(e,t,r,n,a,s,i,o,l){return e=new $d(e,t,r,o,l),1===t?(t=1,!0===s&&(t|=8)):t=0,s=Rd(3,null,null,t),e.current=s,s.stateNode=e,s.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},Fi(s),e}function Vd(e){if(!e)return Cs;e:{if(Wt(e=e._reactInternals)!==e||1!==e.tag)throw Error(oe(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Ps(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(null!==t);throw Error(oe(171))}if(1===e.tag){var r=e.type;if(Ps(r))return Ms(e,r,t)}return t}function Wd(e,t,r,n,a,s,i,o,l){return(e=zd(r,n,!0,e,0,s,0,o,l)).context=Vd(null),r=e.current,(s=Bi(n=rd(),a=nd(r))).callback=null!=t?t:null,$i(r,s,a),e.current.lanes=a,br(e,a,n),sd(e,n),e}function Hd(e,t,r,n){var a=t.current,s=rd(),i=nd(a);return r=Vd(r),null===t.context?t.context=r:t.pendingContext=r,(t=Bi(s,i)).payload={element:e},null!==(n=void 0===n?null:n)&&(t.callback=n),null!==(e=$i(a,t,i))&&(ad(e,a,i,s),zi(e,a,i)),i}function Gd(e){return(e=e.current).child?(e.child.tag,e.child.stateNode):null}function qd(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var r=e.retryLane;e.retryLane=0!==r&&r<t?r:t}}function Kd(e,t){qd(e,t),(e=e.alternate)&&qd(e,t)}jc=function(e,t,r){if(null!==e)if(e.memoizedProps!==t.pendingProps||Os.current)wl=!0;else{if(0===(e.lanes&r)&&!(128&t.flags))return wl=!1,function(e,t,r){switch(t.tag){case 3:Ol(t),pi();break;case 5:Qi(t);break;case 1:Ps(t.type)&&Fs(t);break;case 4:Ji(t,t.stateNode.containerInfo);break;case 10:var n=t.type._context,a=t.memoizedProps.value;Es(Ni,n._currentValue),n._currentValue=a;break;case 13:if(null!==(n=t.memoizedState))return null!==n.dehydrated?(Es(to,1&to.current),t.flags|=128,null):0!==(r&t.child.childLanes)?Ul(e,t,r):(Es(to,1&to.current),null!==(e=Gl(e,t,r))?e.sibling:null);Es(to,1&to.current);break;case 19:if(n=0!==(r&t.childLanes),128&e.flags){if(n)return Wl(e,t,r);t.flags|=128}if(null!==(a=t.memoizedState)&&(a.rendering=null,a.tail=null,a.lastEffect=null),Es(to,to.current),n)break;return null;case 22:case 23:return t.lanes=0,Sl(e,t,r)}return Gl(e,t,r)}(e,t,r);wl=!!(131072&e.flags)}else wl=!1,ii&&1048576&t.flags&&ti(t,Ks,t.index);switch(t.lanes=0,t.tag){case 2:var n=t.type;Hl(e,t),e=t.pendingProps;var a=Rs(t,As.current);Oi(t,r),a=vo(null,t,n,e,a,r);var s=bo();return t.flags|=1,"object"==typeof a&&null!==a&&"function"==typeof a.render&&void 0===a.$$typeof?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Ps(n)?(s=!0,Fs(t)):s=!1,t.memoizedState=null!==a.state&&void 0!==a.state?a.state:null,Fi(t),a.updater=il,t.stateNode=a,a._reactInternals=t,dl(t,n,e,r),t=Al(null,t,n,!0,s,r)):(t.tag=0,ii&&s&&ri(t),_l(null,t,a,r),t=t.child),t;case 16:n=t.elementType;e:{switch(Hl(e,t),e=t.pendingProps,n=(a=n._init)(n._payload),t.type=n,a=t.tag=function(e){if("function"==typeof e)return Pd(e)?1:0;if(null!=e){if((e=e.$$typeof)===Ae)return 11;if(e===Re)return 14}return 2}(n),e=al(n,e),a){case 0:t=El(null,t,n,e,r);break e;case 1:t=Cl(null,t,n,e,r);break e;case 11:t=kl(null,t,n,e,r);break e;case 14:t=Nl(null,t,n,al(n.type,e),r);break e}throw Error(oe(306,n,""))}return t;case 0:return n=t.type,a=t.pendingProps,El(e,t,n,a=t.elementType===n?a:al(n,a),r);case 1:return n=t.type,a=t.pendingProps,Cl(e,t,n,a=t.elementType===n?a:al(n,a),r);case 3:e:{if(Ol(t),null===e)throw Error(oe(387));n=t.pendingProps,a=(s=t.memoizedState).element,Ui(e,t),Wi(t,n,null,r);var i=t.memoizedState;if(n=i.element,s.isDehydrated){if(s={element:n,isDehydrated:!1,cache:i.cache,pendingSuspenseBoundaries:i.pendingSuspenseBoundaries,transitions:i.transitions},t.updateQueue.baseState=s,t.memoizedState=s,256&t.flags){t=Il(e,t,n,r,a=ul(Error(oe(423)),t));break e}if(n!==a){t=Il(e,t,n,r,a=ul(Error(oe(424)),t));break e}for(si=us(t.stateNode.containerInfo.firstChild),ai=t,ii=!0,oi=null,r=ki(t,null,n,r),t.child=r;r;)r.flags=-3&r.flags|4096,r=r.sibling}else{if(pi(),n===a){t=Gl(e,t,r);break e}_l(e,t,n,r)}t=t.child}return t;case 5:return Qi(t),null===e&&ui(t),n=t.type,a=t.pendingProps,s=null!==e?e.memoizedProps:null,i=a.children,as(n,a)?i=null:null!==s&&as(n,s)&&(t.flags|=32),Tl(e,t),_l(e,t,i,r),t.child;case 6:return null===e&&ui(t),null;case 13:return Ul(e,t,r);case 4:return Ji(t,t.stateNode.containerInfo),n=t.pendingProps,null===e?t.child=_i(t,null,n,r):_l(e,t,n,r),t.child;case 11:return n=t.type,a=t.pendingProps,kl(e,t,n,a=t.elementType===n?a:al(n,a),r);case 7:return _l(e,t,t.pendingProps,r),t.child;case 8:case 12:return _l(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(n=t.type._context,a=t.pendingProps,s=t.memoizedProps,i=a.value,Es(Ni,n._currentValue),n._currentValue=i,null!==s)if(ca(s.value,i)){if(s.children===a.children&&!Os.current){t=Gl(e,t,r);break e}}else for(null!==(s=t.child)&&(s.return=t);null!==s;){var o=s.dependencies;if(null!==o){i=s.child;for(var l=o.firstContext;null!==l;){if(l.context===n){if(1===s.tag){(l=Bi(-1,r&-r)).tag=2;var c=s.updateQueue;if(null!==c){var d=(c=c.shared).pending;null===d?l.next=l:(l.next=d.next,d.next=l),c.pending=l}}s.lanes|=r,null!==(l=s.alternate)&&(l.lanes|=r),Ai(s.return,r,t),o.lanes|=r;break}l=l.next}}else if(10===s.tag)i=s.type===t.type?null:s.child;else if(18===s.tag){if(null===(i=s.return))throw Error(oe(341));i.lanes|=r,null!==(o=i.alternate)&&(o.lanes|=r),Ai(i,r,t),i=s.sibling}else i=s.child;if(null!==i)i.return=s;else for(i=s;null!==i;){if(i===t){i=null;break}if(null!==(s=i.sibling)){s.return=i.return,i=s;break}i=i.return}s=i}_l(e,t,a.children,r),t=t.child}return t;case 9:return a=t.type,n=t.pendingProps.children,Oi(t,r),n=n(a=Ii(a)),t.flags|=1,_l(e,t,n,r),t.child;case 14:return a=al(n=t.type,t.pendingProps),Nl(e,t,n,a=al(n.type,a),r);case 15:return jl(e,t,t.type,t.pendingProps,r);case 17:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:al(n,a),Hl(e,t),t.tag=1,Ps(n)?(e=!0,Fs(t)):e=!1,Oi(t,r),ll(t,n,a),dl(t,n,a,r),Al(null,t,n,!0,e,r);case 19:return Wl(e,t,r);case 22:return Sl(e,t,r)}throw Error(oe(156,t.tag))};var Xd="function"==typeof reportError?reportError:function(e){console.error(e)};function Yd(e){this._internalRoot=e}function Jd(e){this._internalRoot=e}function Zd(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function Qd(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function eu(){}function tu(e,t,r,n,a){var s=r._reactRootContainer;if(s){var i=s;if("function"==typeof a){var o=a;a=function(){var e=Gd(i);o.call(e)}}Hd(t,i,e,a)}else i=function(e,t,r,n,a){if(a){if("function"==typeof n){var s=n;n=function(){var e=Gd(i);s.call(e)}}var i=Wd(t,n,e,0,null,!1,0,"",eu);return e._reactRootContainer=i,e[gs]=i.current,Wa(8===e.nodeType?e.parentNode:e),hd(),i}for(;a=e.lastChild;)e.removeChild(a);if("function"==typeof n){var o=n;n=function(){var e=Gd(l);o.call(e)}}var l=zd(e,0,!1,null,0,!1,0,"",eu);return e._reactRootContainer=l,e[gs]=l.current,Wa(8===e.nodeType?e.parentNode:e),hd(function(){Hd(t,l,r,n)}),l}(r,t,e,a,n);return Gd(i)}Jd.prototype.render=Yd.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(oe(409));Hd(e,t,null,null)},Jd.prototype.unmount=Yd.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;hd(function(){Hd(null,e,null,null)}),t[gs]=null}},Jd.prototype.unstable_scheduleHydration=function(e){if(e){var t=Sr();e={blockedOn:null,target:e,priority:t};for(var r=0;r<Dr.length&&0!==t&&t<Dr[r].priority;r++);Dr.splice(r,0,e),0===r&&Ur(e)}},kr=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=fr(t.pendingLanes);0!==r&&(yr(t,1|r),sd(t,Qt()),!(6&Ac)&&(Wc=Qt()+500,Ws()))}break;case 13:hd(function(){var t=Li(e,1);if(null!==t){var r=rd();ad(t,e,1,r)}}),Kd(e,1)}},Nr=function(e){if(13===e.tag){var t=Li(e,134217728);if(null!==t)ad(t,e,134217728,rd());Kd(e,134217728)}},jr=function(e){if(13===e.tag){var t=nd(e),r=Li(e,t);if(null!==r)ad(r,e,t,rd());Kd(e,t)}},Sr=function(){return wr},Tr=function(e,t){var r=wr;try{return wr=e,t()}finally{wr=r}},Nt=function(e,t,r){switch(t){case"input":if(et(e,r),t=r.name,"radio"===r.type&&null!=t){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var n=r[t];if(n!==e&&n.form===e.form){var a=ks(n);if(!a)throw Error(oe(90));Xe(n),et(n,a)}}}break;case"textarea":ot(e,r);break;case"select":null!=(t=r.value)&&at(e,!!r.multiple,t,!1)}},At=ud,Ot=hd;var ru={usingClientEntryPoint:!1,Events:[ws,_s,ks,Et,Ct,ud]},nu={findFiberByHostInstance:ys,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},au={bundleType:nu.bundleType,version:nu.version,rendererPackageName:nu.rendererPackageName,rendererConfig:nu.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:_e.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return null===(e=qt(e))?null:e.stateNode},findFiberByHostInstance:nu.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if("undefined"!=typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var su=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!su.isDisabled&&su.supportsFiber)try{ir=su.inject(au),or=su}catch(ht){}}te.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=ru,te.createPortal=function(e,t){var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!Zd(t))throw Error(oe(200));return function(e,t,r){var n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:Ne,key:null==n?null:""+n,children:e,containerInfo:t,implementation:r}}(e,t,null,r)},te.createRoot=function(e,t){if(!Zd(e))throw Error(oe(299));var r=!1,n="",a=Xd;return null!=t&&(!0===t.unstable_strictMode&&(r=!0),void 0!==t.identifierPrefix&&(n=t.identifierPrefix),void 0!==t.onRecoverableError&&(a=t.onRecoverableError)),t=zd(e,1,!1,null,0,r,0,n,a),e[gs]=t.current,Wa(8===e.nodeType?e.parentNode:e),new Yd(t)},te.findDOMNode=function(e){if(null==e)return null;if(1===e.nodeType)return e;var t=e._reactInternals;if(void 0===t){if("function"==typeof e.render)throw Error(oe(188));throw e=Object.keys(e).join(","),Error(oe(268,e))}return e=null===(e=qt(t))?null:e.stateNode},te.flushSync=function(e){return hd(e)},te.hydrate=function(e,t,r){if(!Qd(t))throw Error(oe(200));return tu(null,e,t,!0,r)},te.hydrateRoot=function(e,t,r){if(!Zd(e))throw Error(oe(405));var n=null!=r&&r.hydratedSources||null,a=!1,s="",i=Xd;if(null!=r&&(!0===r.unstable_strictMode&&(a=!0),void 0!==r.identifierPrefix&&(s=r.identifierPrefix),void 0!==r.onRecoverableError&&(i=r.onRecoverableError)),t=Wd(t,null,e,1,null!=r?r:null,a,0,s,i),e[gs]=t.current,Wa(e),n)for(e=0;e<n.length;e++)a=(a=(r=n[e])._getVersion)(r._source),null==t.mutableSourceEagerHydrationData?t.mutableSourceEagerHydrationData=[r,a]:t.mutableSourceEagerHydrationData.push(r,a);return new Jd(t)},te.render=function(e,t,r){if(!Qd(t))throw Error(oe(200));return tu(null,e,t,!1,r)},te.unmountComponentAtNode=function(e){if(!Qd(e))throw Error(oe(40));return!!e._reactRootContainer&&(hd(function(){tu(null,null,e,!1,function(){e._reactRootContainer=null,e[gs]=null})}),!0)},te.unstable_batchedUpdates=ud,te.unstable_renderSubtreeIntoContainer=function(e,t,r,n){if(!Qd(r))throw Error(oe(200));if(null==e||void 0===e._reactInternals)throw Error(oe(38));return tu(e,t,r,!1,n)},te.version="18.3.1-next-f1338f8080-20240426",function e(){if("undefined"!=typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),ee.exports=te;var iu,ou=ee.exports;iu=ou.createRoot,ou.hydrateRoot;const lu=({onLogin:e})=>{const[t,r]=W.useState(""),[n,a]=W.useState(""),[s,i]=W.useState(!1);return Q.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-blue-900 via-purple-900 to-indigo-900 flex items-center justify-center p-4",children:[Q.jsx("div",{className:"absolute inset-0 bg-black opacity-20"}),Q.jsxs("div",{className:"absolute inset-0 overflow-hidden",children:[Q.jsx("div",{className:"absolute -top-40 -right-40 w-80 h-80 bg-purple-500 rounded-full mix-blend-multiply filter blur-xl opacity-70 animate-blob"}),Q.jsx("div",{className:"absolute -bottom-40 -left-40 w-80 h-80 bg-blue-500 rounded-full mix-blend-multiply filter blur-xl opacity-70 animate-blob animation-delay-2000"}),Q.jsx("div",{className:"absolute top-40 left-40 w-80 h-80 bg-indigo-500 rounded-full mix-blend-multiply filter blur-xl opacity-70 animate-blob animation-delay-4000"})]}),Q.jsxs("div",{className:"relative z-10 w-full max-w-md",children:[Q.jsxs("div",{className:"bg-white bg-opacity-10 backdrop-filter backdrop-blur-lg rounded-3xl shadow-2xl border border-white border-opacity-20 p-8",children:[Q.jsxs("div",{className:"text-center mb-8",children:[Q.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-gradient-to-r from-blue-500 to-purple-600 rounded-2xl mb-4",children:Q.jsx("span",{className:"text-2xl",children:""})}),Q.jsx("h1",{className:"text-3xl font-bold text-white mb-2",children:"Analytics Pro"}),Q.jsx("p",{className:"text-blue-200 text-sm",children:""})]}),Q.jsxs("form",{onSubmit:async n=>{n.preventDefault(),i(!0),a(""),setTimeout(()=>{"19961015"===t?(localStorage.setItem("websiteAuth","authenticated"),e(!0)):(a(""),r("")),i(!1)},500)},className:"space-y-6",children:[Q.jsxs("div",{children:[Q.jsx("label",{className:"block text-sm font-medium text-white mb-2",children:""}),Q.jsxs("div",{className:"relative",children:[Q.jsx("input",{type:"password",value:t,onChange:e=>r(e.target.value),className:"w-full px-4 py-3 bg-white bg-opacity-10 border border-white border-opacity-20 rounded-xl text-white placeholder-blue-200 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200",placeholder:"",required:!0}),Q.jsx("div",{className:"absolute inset-y-0 right-0 pr-3 flex items-center",children:Q.jsx("svg",{className:"h-5 w-5 text-blue-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:Q.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})})})]}),n&&Q.jsxs("p",{className:"mt-2 text-sm text-red-300 flex items-center",children:[Q.jsx("svg",{className:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:Q.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),n]})]}),Q.jsx("button",{type:"submit",disabled:s,className:"w-full bg-gradient-to-r from-blue-500 to-purple-600 text-white font-semibold py-3 px-4 rounded-xl hover:from-blue-600 hover:to-purple-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 focus:ring-offset-transparent transform transition-all duration-200 hover:scale-[1.02] disabled:opacity-50 disabled:cursor-not-allowed",children:s?Q.jsxs("div",{className:"flex items-center justify-center",children:[Q.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white mr-2"}),"..."]}):Q.jsxs("div",{className:"flex items-center justify-center",children:[Q.jsx("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:Q.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 16l-4-4m0 0l4-4m-4 4h14m-5 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h7a3 3 0 013 3v1"})}),""]})})]}),Q.jsxs("div",{className:"mt-8 text-center",children:[Q.jsxs("div",{className:"flex items-center justify-center space-x-2 text-blue-200 text-sm",children:[Q.jsx("div",{className:"w-2 h-2 bg-green-400 rounded-full animate-pulse"}),Q.jsx("span",{children:""})]}),Q.jsx("p",{className:"text-blue-300 text-xs mt-2",children:"Version 2.0.1 | Secured Access"})]})]}),Q.jsx("div",{className:"mt-6 text-center",children:Q.jsxs("p",{className:"text-blue-200 text-sm flex items-center justify-center",children:[Q.jsx("svg",{className:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:Q.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"})}),""]})})]}),Q.jsx("style",{jsx:!0,children:"\n        @keyframes blob {\n          0% {\n            transform: translate(0px, 0px) scale(1);\n          }\n          33% {\n            transform: translate(30px, -50px) scale(1.1);\n          }\n          66% {\n            transform: translate(-20px, 20px) scale(0.9);\n          }\n          100% {\n            transform: translate(0px, 0px) scale(1);\n          }\n        }\n        .animate-blob {\n          animation: blob 7s infinite;\n        }\n        .animation-delay-2000 {\n          animation-delay: 2s;\n        }\n        .animation-delay-4000 {\n          animation-delay: 4s;\n        }\n      "})]})},cu=W.createContext(),du=()=>{const e=W.useContext(cu);if(!e)throw new Error("useTheme must be used within a ThemeProvider");return e},uu=({children:e})=>{const[t,r]=W.useState(!1),[n,a]=W.useState(new Date),[s,i]=W.useState(new Date);W.useEffect(()=>{const e=e=>{r(e.detail.isDark)};return window.addEventListener("themeChange",e),()=>window.removeEventListener("themeChange",e)},[]),W.useEffect(()=>{const e=()=>{const e=new Date,t=new Date(e.toLocaleString("en-US",{timeZone:"Asia/Shanghai"})),r=new Date(e.toLocaleString("en-US",{timeZone:"America/Mexico_City"}));a(t),i(r)};e();const t=setInterval(e,1e3);return()=>clearInterval(t)},[]);return Q.jsx(cu.Provider,{value:{isDark:t,toggleTheme:()=>{const e=!t;r(e);const n=new CustomEvent("themeChange",{detail:{isDark:e}});window.dispatchEvent(n)},beijingTime:n,mexicoTime:s},children:e})},hu=({onMenuToggle:e,onLogout:t,isAuthenticated:r})=>{const{isDark:n,toggleTheme:a,beijingTime:s,mexicoTime:i}=du(),o=e=>e?e.toLocaleTimeString("zh-CN",{hour12:!1,hour:"2-digit",minute:"2-digit",second:"2-digit"}):"--:--:--",l=e=>e?e.toLocaleDateString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit"}):"--/--/--";return Q.jsx("header",{className:"sticky top-0 z-50 bg-white border-b border-gray-200 shadow-sm",children:Q.jsxs("div",{className:"flex items-center justify-between px-6 py-4",children:[Q.jsxs("div",{className:"flex items-center space-x-4",children:[Q.jsx("button",{onClick:e,className:"p-2 text-gray-600 hover:text-gray-900 hover:bg-gray-100 rounded-lg transition-colors duration-200 lg:hidden",children:Q.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:Q.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})}),Q.jsxs("div",{className:"flex items-center space-x-3",children:[Q.jsx("div",{className:"flex items-center justify-center w-10 h-10 bg-blue-600 rounded-lg",children:Q.jsx("svg",{className:"w-6 h-6 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:Q.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})})}),Q.jsxs("div",{children:[Q.jsx("h1",{className:"text-xl font-medium text-gray-900",children:"Analytics Pro"}),Q.jsx("p",{className:"text-sm text-gray-500",children:""})]})]})]}),Q.jsxs("div",{className:"hidden md:flex items-center space-x-4",children:[Q.jsxs("div",{className:"flex items-center space-x-3 px-4 py-2 bg-gray-50 rounded-lg border border-gray-200",children:[Q.jsx("div",{className:"w-2 h-2 bg-red-500 rounded-full"}),Q.jsxs("div",{className:"text-center",children:[Q.jsx("div",{className:"text-xs font-medium text-gray-700",children:" "}),Q.jsx("div",{className:"text-sm font-mono text-gray-900",children:s?o(s):"--:--:--"}),Q.jsx("div",{className:"text-xs text-gray-500",children:s?l(s):"--/--/--"})]})]}),Q.jsxs("div",{className:"flex items-center space-x-3 px-4 py-2 bg-gray-50 rounded-lg border border-gray-200",children:[Q.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full"}),Q.jsxs("div",{className:"text-center",children:[Q.jsx("div",{className:"text-xs font-medium text-gray-700",children:" "}),Q.jsx("div",{className:"text-sm font-mono text-gray-900",children:i?o(i):"--:--:--"}),Q.jsx("div",{className:"text-xs text-gray-500",children:i?l(i):"--/--/--"})]})]})]}),Q.jsxs("div",{className:"flex items-center space-x-3",children:[Q.jsx("button",{onClick:a,className:"p-2 text-gray-600 hover:text-gray-900 hover:bg-gray-100 rounded-lg transition-colors duration-200",title:"",children:n?Q.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:Q.jsx("path",{fillRule:"evenodd",d:"M10 2a1 1 0 011 1v1a1 1 0 11-2 0V3a1 1 0 011-1zm4 8a4 4 0 11-8 0 4 4 0 018 0zm-.464 4.95l.707.707a1 1 0 001.414-1.414l-.707-.707a1 1 0 00-1.414 1.414zm2.12-10.607a1 1 0 010 1.414l-.706.707a1 1 0 11-1.414-1.414l.707-.707a1 1 0 011.414 0zM17 11a1 1 0 100-2h-1a1 1 0 100 2h1zm-7 4a1 1 0 011 1v1a1 1 0 11-2 0v-1a1 1 0 011-1zM5.05 6.464A1 1 0 106.465 5.05l-.708-.707a1 1 0 00-1.414 1.414l.707.707zm1.414 8.486l-.707.707a1 1 0 01-1.414-1.414l.707-.707a1 1 0 011.414 1.414zM4 11a1 1 0 100-2H3a1 1 0 000 2h1z",clipRule:"evenodd"})}):Q.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:Q.jsx("path",{d:"M17.293 13.293A8 8 0 016.707 2.707a8.001 8.001 0 1010.586 10.586z"})})}),Q.jsxs("div",{className:"flex items-center space-x-2 px-3 py-2 bg-green-50 text-green-700 rounded-lg border border-green-200",children:[Q.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full"}),Q.jsx("span",{className:"text-sm font-medium",children:""})]}),r&&Q.jsx("button",{onClick:t,className:"p-2 text-gray-600 hover:text-red-600 hover:bg-red-50 rounded-lg transition-colors duration-200",title:"",children:Q.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:Q.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"})})})]})]})})},fu=({activeTab:e,setActiveTab:t,isOpen:r,onClose:n})=>{const{isDark:a}=du();return Q.jsxs(Q.Fragment,{children:[r&&Q.jsx("div",{className:"fixed inset-0 bg-black/50 z-40 lg:hidden",onClick:n}),Q.jsx("aside",{className:`fixed inset-y-0 left-0 z-50 w-64 transition-all duration-200 ease-in-out\n        ${r?"translate-x-0":"-translate-x-full lg:translate-x-0"}\n        bg-white border-r border-gray-200 shadow-lg`,children:Q.jsxs("div",{className:"flex flex-col h-full",children:[Q.jsx("div",{className:"px-6 py-6 border-b border-gray-200",children:Q.jsxs("div",{className:"flex items-center justify-between",children:[Q.jsxs("div",{className:"flex items-center space-x-3",children:[Q.jsx("div",{className:"flex items-center justify-center w-10 h-10 bg-blue-600 rounded-lg",children:Q.jsx("svg",{className:"w-6 h-6 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:Q.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2V6zM14 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V6zM4 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2v-2zM14 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z"})})}),Q.jsxs("div",{children:[Q.jsx("h2",{className:"text-lg font-medium text-gray-900",children:""}),Q.jsx("p",{className:"text-sm text-gray-500",children:"Navigation"})]})]}),Q.jsx("button",{onClick:n,className:"lg:hidden p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg transition-colors duration-200",children:Q.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:Q.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})}),Q.jsx("nav",{className:"flex-1 px-3 py-4 space-y-1 overflow-y-auto",children:[{id:"overview",name:"",icon:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z",desc:"Dashboard"},{id:"ad-data",name:"",icon:"M16 8v8m-4-5v5m-4-2v2m-2 4h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z",desc:"Ad Data Entry"},{id:"commission-system",name:"",icon:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z",desc:"Commission System"},{id:"three-column-commission",name:"",icon:"M4 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2V6zM14 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V6zM4 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2v-2z",desc:"Three Column Layout"},{id:"commission-leaderboard",name:"",icon:"M9 12l2 2 4-4M7.835 4.697a3.42 3.42 0 001.946-.806 3.42 3.42 0 014.438 0 3.42 3.42 0 001.946.806 3.42 3.42 0 013.138 3.138 3.42 3.42 0 00.806 1.946 3.42 3.42 0 010 4.438 3.42 3.42 0 00-.806 1.946 3.42 3.42 0 01-3.138 3.138 3.42 3.42 0 00-1.946.806 3.42 3.42 0 01-4.438 0 3.42 3.42 0 00-1.946-.806 3.42 3.42 0 01-3.138-3.138 3.42 3.42 0 00-.806-1.946 3.42 3.42 0 010-4.438 3.42 3.42 0 00.806-1.946 3.42 3.42 0 013.138-3.138z",desc:"Commission Leaderboard"},{id:"daily",name:"",icon:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z",desc:"Daily Stats"},{id:"roi-ranking",name:"",icon:"M9 12l2 2 4-4M7.835 4.697a3.42 3.42 0 001.946-.806 3.42 3.42 0 014.438 0 3.42 3.42 0 001.946.806 3.42 3.42 0 013.138 3.138 3.42 3.42 0 00.806 1.946 3.42 3.42 0 010 4.438 3.42 3.42 0 00-.806 1.946 3.42 3.42 0 01-3.138 3.138 3.42 3.42 0 00-1.946.806 3.42 3.42 0 01-4.438 0 3.42 3.42 0 00-1.946-.806 3.42 3.42 0 01-3.138-3.138 3.42 3.42 0 00-.806-1.946 3.42 3.42 0 010-4.438 3.42 3.42 0 00.806-1.946 3.42 3.42 0 013.138-3.138z",desc:"ROI Ranking"},{id:"export",name:"",icon:"M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z",desc:"Export"},{id:"account-management-3d",name:"",icon:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10",desc:"3D Account Management"},{id:"daily-orders",name:"",icon:"M17 9V7a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2m2 4h10a2 2 0 002-2v-6a2 2 0 00-2-2H9a2 2 0 00-2 2v6a2 2 0 002 2zm7-5a2 2 0 11-4 0 2 2 0 014 0z",desc:"Orders"},{id:"product-downloader",name:"",icon:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z",desc:"Product Images"},{id:"website-checker",name:"",icon:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z",desc:"Website Checker"}].map(r=>Q.jsxs("button",{onClick:()=>{t(r.id),n()},className:"w-full flex items-center space-x-3 px-3 py-2 rounded-lg text-left transition-colors duration-200 "+(e===r.id?"bg-blue-50 text-blue-700 border-r-2 border-blue-600":"text-gray-700 hover:text-gray-900 hover:bg-gray-100"),children:[Q.jsx("div",{className:"flex items-center justify-center w-5 h-5 "+(e===r.id?"text-blue-600":"text-gray-500"),children:Q.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:Q.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:r.icon})})}),Q.jsxs("div",{className:"flex-1 min-w-0",children:[Q.jsx("div",{className:"font-medium text-sm truncate",children:r.name}),Q.jsx("div",{className:"text-xs truncate "+(e===r.id?"text-blue-600/80":"text-gray-500"),children:r.desc})]}),e===r.id&&Q.jsx("div",{className:"w-2 h-2 bg-blue-600 rounded-full"})]},r.id))}),Q.jsx("div",{className:"px-6 py-4 border-t border-gray-200",children:Q.jsx("div",{className:"p-4 bg-gray-50 rounded-lg border border-gray-200",children:Q.jsxs("div",{className:"text-center",children:[Q.jsx("div",{className:"text-sm font-medium text-gray-900",children:"Analytics Pro"}),Q.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Version 3.0.0"}),Q.jsxs("div",{className:"flex items-center justify-center space-x-2 mt-3",children:[Q.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full"}),Q.jsx("span",{className:"text-xs font-medium text-green-600",children:""})]})]})})})]})})]})},mu={},pu=function(e,t,r){let n=Promise.resolve();if(t&&t.length>0){document.getElementsByTagName("link");const e=document.querySelector("meta[property=csp-nonce]"),r=(null==e?void 0:e.nonce)||(null==e?void 0:e.getAttribute("nonce"));n=Promise.allSettled(t.map(e=>{if((e=function(e){return"/"+e}(e))in mu)return;mu[e]=!0;const t=e.endsWith(".css"),n=t?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${e}"]${n}`))return;const a=document.createElement("link");return a.rel=t?"stylesheet":"modulepreload",t||(a.as="script"),a.crossOrigin="",a.href=e,r&&a.setAttribute("nonce",r),document.head.appendChild(a),t?new Promise((t,r)=>{a.addEventListener("load",t),a.addEventListener("error",()=>r(new Error(`Unable to preload CSS for ${e}`)))}):void 0}))}function a(e){const t=new Event("vite:preloadError",{cancelable:!0});if(t.payload=e,window.dispatchEvent(t),!t.defaultPrevented)throw e}return n.then(t=>{for(const e of t||[])"rejected"===e.status&&a(e.reason);return e().catch(a)})};class gu extends Error{constructor(e,t="FunctionsError",r){super(e),this.name=t,this.context=r}}class xu extends gu{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class vu extends gu{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class bu extends gu{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var yu,wu;(wu=yu||(yu={})).Any="any",wu.ApNortheast1="ap-northeast-1",wu.ApNortheast2="ap-northeast-2",wu.ApSouth1="ap-south-1",wu.ApSoutheast1="ap-southeast-1",wu.ApSoutheast2="ap-southeast-2",wu.CaCentral1="ca-central-1",wu.EuCentral1="eu-central-1",wu.EuWest1="eu-west-1",wu.EuWest2="eu-west-2",wu.EuWest3="eu-west-3",wu.SaEast1="sa-east-1",wu.UsEast1="us-east-1",wu.UsWest1="us-west-1",wu.UsWest2="us-west-2";var _u=function(e,t,r,n){return new(r||(r=Promise))(function(a,s){function i(e){try{l(n.next(e))}catch(t){s(t)}}function o(e){try{l(n.throw(e))}catch(t){s(t)}}function l(e){var t;e.done?a(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(i,o)}l((n=n.apply(e,t||[])).next())})};class ku{constructor(e,{headers:t={},customFetch:r,region:n=yu.Any}={}){this.url=e,this.headers=t,this.region=n,this.fetch=(e=>{let t;return t=e||("undefined"==typeof fetch?(...e)=>pu(async()=>{const{default:e}=await Promise.resolve().then(()=>Lu);return{default:e}},void 0).then(({default:t})=>t(...e)):fetch),(...e)=>t(...e)})(r)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e,t={}){var r;return _u(this,void 0,void 0,function*(){try{const{headers:n,method:a,body:s}=t;let i={},{region:o}=t;o||(o=this.region);const l=new URL(`${this.url}/${e}`);let c;o&&"any"!==o&&(i["x-region"]=o,l.searchParams.set("forceFunctionRegion",o)),s&&(n&&!Object.prototype.hasOwnProperty.call(n,"Content-Type")||!n)&&("undefined"!=typeof Blob&&s instanceof Blob||s instanceof ArrayBuffer?(i["Content-Type"]="application/octet-stream",c=s):"string"==typeof s?(i["Content-Type"]="text/plain",c=s):"undefined"!=typeof FormData&&s instanceof FormData?c=s:(i["Content-Type"]="application/json",c=JSON.stringify(s)));const d=yield this.fetch(l.toString(),{method:a||"POST",headers:Object.assign(Object.assign(Object.assign({},i),this.headers),n),body:c}).catch(e=>{throw new xu(e)}),u=d.headers.get("x-relay-error");if(u&&"true"===u)throw new vu(d);if(!d.ok)throw new bu(d);let h,f=(null!==(r=d.headers.get("Content-Type"))&&void 0!==r?r:"text/plain").split(";")[0].trim();return h="application/json"===f?yield d.json():"application/octet-stream"===f?yield d.blob():"text/event-stream"===f?d:"multipart/form-data"===f?yield d.formData():yield d.text(),{data:h,error:null,response:d}}catch(n){return{data:null,error:n,response:n instanceof bu||n instanceof vu?n.context:void 0}}})}}var Nu={},ju={},Su={},Tu={},Eu={},Cu={},Au=function(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if("undefined"!=typeof global)return global;throw new Error("unable to locate global object")}();const Ou=Au.fetch,Iu=Au.fetch.bind(Au),Ru=Au.Headers,Pu=Au.Request,Du=Au.Response,Lu=Object.freeze(Object.defineProperty({__proto__:null,Headers:Ru,Request:Pu,Response:Du,default:Iu,fetch:Ou},Symbol.toStringTag,{value:"Module"})),Mu=a(Lu);var Fu={};Object.defineProperty(Fu,"__esModule",{value:!0});let Uu=class extends Error{constructor(e){super(e.message),this.name="PostgrestError",this.details=e.details,this.hint=e.hint,this.code=e.code}};Fu.default=Uu;var Bu=r&&r.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Cu,"__esModule",{value:!0});const $u=Bu(Mu),zu=Bu(Fu);Cu.default=class{constructor(e){this.shouldThrowOnError=!1,this.method=e.method,this.url=e.url,this.headers=e.headers,this.schema=e.schema,this.body=e.body,this.shouldThrowOnError=e.shouldThrowOnError,this.signal=e.signal,this.isMaybeSingle=e.isMaybeSingle,e.fetch?this.fetch=e.fetch:"undefined"==typeof fetch?this.fetch=$u.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(e,t){return this.headers=Object.assign({},this.headers),this.headers[e]=t,this}then(e,t){void 0===this.schema||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),"GET"!==this.method&&"HEAD"!==this.method&&(this.headers["Content-Type"]="application/json");let r=(0,this.fetch)(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async e=>{var t,r,n;let a=null,s=null,i=null,o=e.status,l=e.statusText;if(e.ok){if("HEAD"!==this.method){const t=await e.text();""===t||(s="text/csv"===this.headers.Accept||this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?t:JSON.parse(t))}const n=null===(t=this.headers.Prefer)||void 0===t?void 0:t.match(/count=(exact|planned|estimated)/),c=null===(r=e.headers.get("content-range"))||void 0===r?void 0:r.split("/");n&&c&&c.length>1&&(i=parseInt(c[1])),this.isMaybeSingle&&"GET"===this.method&&Array.isArray(s)&&(s.length>1?(a={code:"PGRST116",details:`Results contain ${s.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},s=null,i=null,o=406,l="Not Acceptable"):s=1===s.length?s[0]:null)}else{const t=await e.text();try{a=JSON.parse(t),Array.isArray(a)&&404===e.status&&(s=[],a=null,o=200,l="OK")}catch(c){404===e.status&&""===t?(o=204,l="No Content"):a={message:t}}if(a&&this.isMaybeSingle&&(null===(n=null==a?void 0:a.details)||void 0===n?void 0:n.includes("0 rows"))&&(a=null,o=200,l="OK"),a&&this.shouldThrowOnError)throw new zu.default(a)}return{error:a,data:s,count:i,status:o,statusText:l}});return this.shouldThrowOnError||(r=r.catch(e=>{var t,r,n;return{error:{message:`${null!==(t=null==e?void 0:e.name)&&void 0!==t?t:"FetchError"}: ${null==e?void 0:e.message}`,details:`${null!==(r=null==e?void 0:e.stack)&&void 0!==r?r:""}`,hint:"",code:`${null!==(n=null==e?void 0:e.code)&&void 0!==n?n:""}`},data:null,count:null,status:0,statusText:""}})),r.then(e,t)}returns(){return this}overrideTypes(){return this}};var Vu=r&&r.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Eu,"__esModule",{value:!0});const Wu=Vu(Cu);let Hu=class extends Wu.default{select(e){let t=!1;const r=(null!=e?e:"*").split("").map(e=>/\s/.test(e)&&!t?"":('"'===e&&(t=!t),e)).join("");return this.url.searchParams.set("select",r),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(e,{ascending:t=!0,nullsFirst:r,foreignTable:n,referencedTable:a=n}={}){const s=a?`${a}.order`:"order",i=this.url.searchParams.get(s);return this.url.searchParams.set(s,`${i?`${i},`:""}${e}.${t?"asc":"desc"}${void 0===r?"":r?".nullsfirst":".nullslast"}`),this}limit(e,{foreignTable:t,referencedTable:r=t}={}){const n=void 0===r?"limit":`${r}.limit`;return this.url.searchParams.set(n,`${e}`),this}range(e,t,{foreignTable:r,referencedTable:n=r}={}){const a=void 0===n?"offset":`${n}.offset`,s=void 0===n?"limit":`${n}.limit`;return this.url.searchParams.set(a,`${e}`),this.url.searchParams.set(s,""+(t-e+1)),this}abortSignal(e){return this.signal=e,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return"GET"===this.method?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain({analyze:e=!1,verbose:t=!1,settings:r=!1,buffers:n=!1,wal:a=!1,format:s="text"}={}){var i;const o=[e?"analyze":null,t?"verbose":null,r?"settings":null,n?"buffers":null,a?"wal":null].filter(Boolean).join("|"),l=null!==(i=this.headers.Accept)&&void 0!==i?i:"application/json";return this.headers.Accept=`application/vnd.pgrst.plan+${s}; for="${l}"; options=${o};`,this}rollback(){var e;return(null!==(e=this.headers.Prefer)&&void 0!==e?e:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}};Eu.default=Hu;var Gu=r&&r.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Tu,"__esModule",{value:!0});const qu=Gu(Eu);let Ku=class extends qu.default{eq(e,t){return this.url.searchParams.append(e,`eq.${t}`),this}neq(e,t){return this.url.searchParams.append(e,`neq.${t}`),this}gt(e,t){return this.url.searchParams.append(e,`gt.${t}`),this}gte(e,t){return this.url.searchParams.append(e,`gte.${t}`),this}lt(e,t){return this.url.searchParams.append(e,`lt.${t}`),this}lte(e,t){return this.url.searchParams.append(e,`lte.${t}`),this}like(e,t){return this.url.searchParams.append(e,`like.${t}`),this}likeAllOf(e,t){return this.url.searchParams.append(e,`like(all).{${t.join(",")}}`),this}likeAnyOf(e,t){return this.url.searchParams.append(e,`like(any).{${t.join(",")}}`),this}ilike(e,t){return this.url.searchParams.append(e,`ilike.${t}`),this}ilikeAllOf(e,t){return this.url.searchParams.append(e,`ilike(all).{${t.join(",")}}`),this}ilikeAnyOf(e,t){return this.url.searchParams.append(e,`ilike(any).{${t.join(",")}}`),this}is(e,t){return this.url.searchParams.append(e,`is.${t}`),this}in(e,t){const r=Array.from(new Set(t)).map(e=>"string"==typeof e&&new RegExp("[,()]").test(e)?`"${e}"`:`${e}`).join(",");return this.url.searchParams.append(e,`in.(${r})`),this}contains(e,t){return"string"==typeof t?this.url.searchParams.append(e,`cs.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cs.{${t.join(",")}}`):this.url.searchParams.append(e,`cs.${JSON.stringify(t)}`),this}containedBy(e,t){return"string"==typeof t?this.url.searchParams.append(e,`cd.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cd.{${t.join(",")}}`):this.url.searchParams.append(e,`cd.${JSON.stringify(t)}`),this}rangeGt(e,t){return this.url.searchParams.append(e,`sr.${t}`),this}rangeGte(e,t){return this.url.searchParams.append(e,`nxl.${t}`),this}rangeLt(e,t){return this.url.searchParams.append(e,`sl.${t}`),this}rangeLte(e,t){return this.url.searchParams.append(e,`nxr.${t}`),this}rangeAdjacent(e,t){return this.url.searchParams.append(e,`adj.${t}`),this}overlaps(e,t){return"string"==typeof t?this.url.searchParams.append(e,`ov.${t}`):this.url.searchParams.append(e,`ov.{${t.join(",")}}`),this}textSearch(e,t,{config:r,type:n}={}){let a="";"plain"===n?a="pl":"phrase"===n?a="ph":"websearch"===n&&(a="w");const s=void 0===r?"":`(${r})`;return this.url.searchParams.append(e,`${a}fts${s}.${t}`),this}match(e){return Object.entries(e).forEach(([e,t])=>{this.url.searchParams.append(e,`eq.${t}`)}),this}not(e,t,r){return this.url.searchParams.append(e,`not.${t}.${r}`),this}or(e,{foreignTable:t,referencedTable:r=t}={}){const n=r?`${r}.or`:"or";return this.url.searchParams.append(n,`(${e})`),this}filter(e,t,r){return this.url.searchParams.append(e,`${t}.${r}`),this}};Tu.default=Ku;var Xu=r&&r.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Su,"__esModule",{value:!0});const Yu=Xu(Tu);Su.default=class{constructor(e,{headers:t={},schema:r,fetch:n}){this.url=e,this.headers=t,this.schema=r,this.fetch=n}select(e,{head:t=!1,count:r}={}){const n=t?"HEAD":"GET";let a=!1;const s=(null!=e?e:"*").split("").map(e=>/\s/.test(e)&&!a?"":('"'===e&&(a=!a),e)).join("");return this.url.searchParams.set("select",s),r&&(this.headers.Prefer=`count=${r}`),new Yu.default({method:n,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(e,{count:t,defaultToNull:r=!0}={}){const n=[];if(this.headers.Prefer&&n.push(this.headers.Prefer),t&&n.push(`count=${t}`),r||n.push("missing=default"),this.headers.Prefer=n.join(","),Array.isArray(e)){const t=e.reduce((e,t)=>e.concat(Object.keys(t)),[]);if(t.length>0){const e=[...new Set(t)].map(e=>`"${e}"`);this.url.searchParams.set("columns",e.join(","))}}return new Yu.default({method:"POST",url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}upsert(e,{onConflict:t,ignoreDuplicates:r=!1,count:n,defaultToNull:a=!0}={}){const s=[`resolution=${r?"ignore":"merge"}-duplicates`];if(void 0!==t&&this.url.searchParams.set("on_conflict",t),this.headers.Prefer&&s.push(this.headers.Prefer),n&&s.push(`count=${n}`),a||s.push("missing=default"),this.headers.Prefer=s.join(","),Array.isArray(e)){const t=e.reduce((e,t)=>e.concat(Object.keys(t)),[]);if(t.length>0){const e=[...new Set(t)].map(e=>`"${e}"`);this.url.searchParams.set("columns",e.join(","))}}return new Yu.default({method:"POST",url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}update(e,{count:t}={}){const r=[];return this.headers.Prefer&&r.push(this.headers.Prefer),t&&r.push(`count=${t}`),this.headers.Prefer=r.join(","),new Yu.default({method:"PATCH",url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}delete({count:e}={}){const t=[];return e&&t.push(`count=${e}`),this.headers.Prefer&&t.unshift(this.headers.Prefer),this.headers.Prefer=t.join(","),new Yu.default({method:"DELETE",url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}};var Ju={},Zu={};Object.defineProperty(Zu,"__esModule",{value:!0}),Zu.version=void 0,Zu.version="0.0.0-automated",Object.defineProperty(Ju,"__esModule",{value:!0}),Ju.DEFAULT_HEADERS=void 0;const Qu=Zu;Ju.DEFAULT_HEADERS={"X-Client-Info":`postgrest-js/${Qu.version}`};var eh=r&&r.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(ju,"__esModule",{value:!0});const th=eh(Su),rh=eh(Tu),nh=Ju;ju.default=class e{constructor(e,{headers:t={},schema:r,fetch:n}={}){this.url=e,this.headers=Object.assign(Object.assign({},nh.DEFAULT_HEADERS),t),this.schemaName=r,this.fetch=n}from(e){const t=new URL(`${this.url}/${e}`);return new th.default(t,{headers:Object.assign({},this.headers),schema:this.schemaName,fetch:this.fetch})}schema(t){return new e(this.url,{headers:this.headers,schema:t,fetch:this.fetch})}rpc(e,t={},{head:r=!1,get:n=!1,count:a}={}){let s;const i=new URL(`${this.url}/rpc/${e}`);let o;r||n?(s=r?"HEAD":"GET",Object.entries(t).filter(([e,t])=>void 0!==t).map(([e,t])=>[e,Array.isArray(t)?`{${t.join(",")}}`:`${t}`]).forEach(([e,t])=>{i.searchParams.append(e,t)})):(s="POST",o=t);const l=Object.assign({},this.headers);return a&&(l.Prefer=`count=${a}`),new rh.default({method:s,url:i,headers:l,schema:this.schemaName,body:o,fetch:this.fetch,allowEmpty:!1})}};var ah=r&&r.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Nu,"__esModule",{value:!0}),Nu.PostgrestError=Nu.PostgrestBuilder=Nu.PostgrestTransformBuilder=Nu.PostgrestFilterBuilder=Nu.PostgrestQueryBuilder=Nu.PostgrestClient=void 0;const sh=ah(ju);Nu.PostgrestClient=sh.default;const ih=ah(Su);Nu.PostgrestQueryBuilder=ih.default;const oh=ah(Tu);Nu.PostgrestFilterBuilder=oh.default;const lh=ah(Eu);Nu.PostgrestTransformBuilder=lh.default;const ch=ah(Cu);Nu.PostgrestBuilder=ch.default;const dh=ah(Fu);Nu.PostgrestError=dh.default;var uh=Nu.default={PostgrestClient:sh.default,PostgrestQueryBuilder:ih.default,PostgrestFilterBuilder:oh.default,PostgrestTransformBuilder:lh.default,PostgrestBuilder:ch.default,PostgrestError:dh.default};const{PostgrestClient:hh,PostgrestQueryBuilder:fh,PostgrestFilterBuilder:mh,PostgrestTransformBuilder:ph,PostgrestBuilder:gh,PostgrestError:xh}=uh;class vh{static dynamicRequire(e){try{return"undefined"!=typeof process&&process.versions&&process.versions.node&&"undefined"!=typeof require?require(e):null}catch(t){return null}}static detectEnvironment(){var e,t;if("undefined"!=typeof WebSocket)return{type:"native",constructor:WebSocket};if("undefined"!=typeof globalThis&&void 0!==globalThis.WebSocket)return{type:"native",constructor:globalThis.WebSocket};if("undefined"!=typeof global&&void 0!==global.WebSocket)return{type:"native",constructor:global.WebSocket};if("undefined"!=typeof globalThis&&void 0!==globalThis.WebSocketPair&&void 0===globalThis.WebSocket)return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if("undefined"!=typeof globalThis&&globalThis.EdgeRuntime||"undefined"!=typeof navigator&&(null===(e=navigator.userAgent)||void 0===e?void 0:e.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if("undefined"!=typeof process&&process.versions&&process.versions.node){const e=parseInt(process.versions.node.split(".")[0]);if(e>=22)try{if(void 0!==globalThis.WebSocket)return{type:"native",constructor:globalThis.WebSocket};const e=this.dynamicRequire("undici");if(e&&e.WebSocket)return{type:"native",constructor:e.WebSocket};throw new Error("undici not available")}catch(r){return{type:"unsupported",error:`Node.js ${e} detected but native WebSocket not found.`,workaround:'Install the "ws" package or check your Node.js installation.'}}try{const e=this.dynamicRequire("ws");if(e)return{type:"ws",constructor:null!==(t=e.WebSocket)&&void 0!==t?t:e};throw new Error("ws package not available")}catch(r){return{type:"unsupported",error:`Node.js ${e} detected without WebSocket support.`,workaround:'Install the "ws" package: npm install ws'}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const e=this.detectEnvironment();if(e.constructor)return e.constructor;let t=e.error||"WebSocket not supported in this environment.";throw e.workaround&&(t+=`\n\nSuggested solution: ${e.workaround}`),new Error(t)}static createWebSocket(e,t){return new(this.getWebSocketConstructor())(e,t)}static isWebSocketSupported(){try{const e=this.detectEnvironment();return"native"===e.type||"ws"===e.type}catch(e){return!1}}}const bh=1e4;var yh,wh,_h,kh,Nh,jh,Sh,Th,Eh,Ch,Ah;(wh=yh||(yh={}))[wh.connecting=0]="connecting",wh[wh.open=1]="open",wh[wh.closing=2]="closing",wh[wh.closed=3]="closed",(kh=_h||(_h={})).closed="closed",kh.errored="errored",kh.joined="joined",kh.joining="joining",kh.leaving="leaving",(jh=Nh||(Nh={})).close="phx_close",jh.error="phx_error",jh.join="phx_join",jh.reply="phx_reply",jh.leave="phx_leave",jh.access_token="access_token",(Sh||(Sh={})).websocket="websocket",(Eh=Th||(Th={})).Connecting="connecting",Eh.Open="open",Eh.Closing="closing",Eh.Closed="closed";class Oh{constructor(){this.HEADER_LENGTH=1}decode(e,t){return e.constructor===ArrayBuffer?t(this._binaryDecode(e)):t("string"==typeof e?JSON.parse(e):{})}_binaryDecode(e){const t=new DataView(e),r=new TextDecoder;return this._decodeBroadcast(e,t,r)}_decodeBroadcast(e,t,r){const n=t.getUint8(1),a=t.getUint8(2);let s=this.HEADER_LENGTH+2;const i=r.decode(e.slice(s,s+n));s+=n;const o=r.decode(e.slice(s,s+a));s+=a;return{ref:null,topic:i,event:o,payload:JSON.parse(r.decode(e.slice(s,e.byteLength)))}}}class Ih{constructor(e,t){this.callback=e,this.timerCalc=t,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=t}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}(Ah=Ch||(Ch={})).abstime="abstime",Ah.bool="bool",Ah.date="date",Ah.daterange="daterange",Ah.float4="float4",Ah.float8="float8",Ah.int2="int2",Ah.int4="int4",Ah.int4range="int4range",Ah.int8="int8",Ah.int8range="int8range",Ah.json="json",Ah.jsonb="jsonb",Ah.money="money",Ah.numeric="numeric",Ah.oid="oid",Ah.reltime="reltime",Ah.text="text",Ah.time="time",Ah.timestamp="timestamp",Ah.timestamptz="timestamptz",Ah.timetz="timetz",Ah.tsrange="tsrange",Ah.tstzrange="tstzrange";const Rh=(e,t,r={})=>{var n;const a=null!==(n=r.skipTypes)&&void 0!==n?n:[];return Object.keys(t).reduce((r,n)=>(r[n]=Ph(n,e,t,a),r),{})},Ph=(e,t,r,n)=>{const a=t.find(t=>t.name===e),s=null==a?void 0:a.type,i=r[e];return s&&!n.includes(s)?Dh(s,i):Lh(i)},Dh=(e,t)=>{if("_"===e.charAt(0)){const r=e.slice(1,e.length);return Bh(t,r)}switch(e){case Ch.bool:return Mh(t);case Ch.float4:case Ch.float8:case Ch.int2:case Ch.int4:case Ch.int8:case Ch.numeric:case Ch.oid:return Fh(t);case Ch.json:case Ch.jsonb:return Uh(t);case Ch.timestamp:return $h(t);case Ch.abstime:case Ch.date:case Ch.daterange:case Ch.int4range:case Ch.int8range:case Ch.money:case Ch.reltime:case Ch.text:case Ch.time:case Ch.timestamptz:case Ch.timetz:case Ch.tsrange:case Ch.tstzrange:default:return Lh(t)}},Lh=e=>e,Mh=e=>{switch(e){case"t":return!0;case"f":return!1;default:return e}},Fh=e=>{if("string"==typeof e){const t=parseFloat(e);if(!Number.isNaN(t))return t}return e},Uh=e=>{if("string"==typeof e)try{return JSON.parse(e)}catch(t){return console.log(`JSON parse error: ${t}`),e}return e},Bh=(e,t)=>{if("string"!=typeof e)return e;const r=e.length-1,n=e[r];if("{"===e[0]&&"}"===n){let n;const s=e.slice(1,r);try{n=JSON.parse("["+s+"]")}catch(a){n=s?s.split(","):[]}return n.map(e=>Dh(t,e))}return e},$h=e=>"string"==typeof e?e.replace(" ","T"):e,zh=e=>{let t=e;return t=t.replace(/^ws/i,"http"),t=t.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),t.replace(/\/+$/,"")+"/api/broadcast"};class Vh{constructor(e,t,r={},n=1e4){this.channel=e,this.event=t,this.payload=r,this.timeout=n,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,t){var r;return this._hasReceived(e)&&t(null===(r=this.receivedResp)||void 0===r?void 0:r.response),this.recHooks.push({status:e,callback:t}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);this.channel._on(this.refEvent,{},e=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=e,this._matchReceive(e)}),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,t){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:t})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:t}){this.recHooks.filter(t=>t.status===e).forEach(e=>e.callback(t))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var Wh,Hh,Gh,qh,Kh,Xh,Yh,Jh;(Hh=Wh||(Wh={})).SYNC="sync",Hh.JOIN="join",Hh.LEAVE="leave";class Zh{constructor(e,t){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const r=(null==t?void 0:t.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(r.state,{},e=>{const{onJoin:t,onLeave:r,onSync:n}=this.caller;this.joinRef=this.channel._joinRef(),this.state=Zh.syncState(this.state,e,t,r),this.pendingDiffs.forEach(e=>{this.state=Zh.syncDiff(this.state,e,t,r)}),this.pendingDiffs=[],n()}),this.channel._on(r.diff,{},e=>{const{onJoin:t,onLeave:r,onSync:n}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(e):(this.state=Zh.syncDiff(this.state,e,t,r),n())}),this.onJoin((e,t,r)=>{this.channel._trigger("presence",{event:"join",key:e,currentPresences:t,newPresences:r})}),this.onLeave((e,t,r)=>{this.channel._trigger("presence",{event:"leave",key:e,currentPresences:t,leftPresences:r})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,t,r,n){const a=this.cloneDeep(e),s=this.transformState(t),i={},o={};return this.map(a,(e,t)=>{s[e]||(o[e]=t)}),this.map(s,(e,t)=>{const r=a[e];if(r){const n=t.map(e=>e.presence_ref),a=r.map(e=>e.presence_ref),s=t.filter(e=>a.indexOf(e.presence_ref)<0),l=r.filter(e=>n.indexOf(e.presence_ref)<0);s.length>0&&(i[e]=s),l.length>0&&(o[e]=l)}else i[e]=t}),this.syncDiff(a,{joins:i,leaves:o},r,n)}static syncDiff(e,t,r,n){const{joins:a,leaves:s}={joins:this.transformState(t.joins),leaves:this.transformState(t.leaves)};return r||(r=()=>{}),n||(n=()=>{}),this.map(a,(t,n)=>{var a;const s=null!==(a=e[t])&&void 0!==a?a:[];if(e[t]=this.cloneDeep(n),s.length>0){const r=e[t].map(e=>e.presence_ref),n=s.filter(e=>r.indexOf(e.presence_ref)<0);e[t].unshift(...n)}r(t,s,n)}),this.map(s,(t,r)=>{let a=e[t];if(!a)return;const s=r.map(e=>e.presence_ref);a=a.filter(e=>s.indexOf(e.presence_ref)<0),e[t]=a,n(t,a,r),0===a.length&&delete e[t]}),e}static map(e,t){return Object.getOwnPropertyNames(e).map(r=>t(r,e[r]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((t,r)=>{const n=e[r];return t[r]="metas"in n?n.metas.map(e=>(e.presence_ref=e.phx_ref,delete e.phx_ref,delete e.phx_ref_prev,e)):n,t},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}(qh=Gh||(Gh={})).ALL="*",qh.INSERT="INSERT",qh.UPDATE="UPDATE",qh.DELETE="DELETE",(Xh=Kh||(Kh={})).BROADCAST="broadcast",Xh.PRESENCE="presence",Xh.POSTGRES_CHANGES="postgres_changes",Xh.SYSTEM="system",(Jh=Yh||(Yh={})).SUBSCRIBED="SUBSCRIBED",Jh.TIMED_OUT="TIMED_OUT",Jh.CLOSED="CLOSED",Jh.CHANNEL_ERROR="CHANNEL_ERROR";class Qh{constructor(e,t={config:{}},r){this.topic=e,this.params=t,this.socket=r,this.bindings={},this.state=_h.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},t.config),this.timeout=this.socket.timeout,this.joinPush=new Vh(this,Nh.join,this.params,this.timeout),this.rejoinTimer=new Ih(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=_h.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(e=>e.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=_h.closed,this.socket._remove(this)}),this._onError(e=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,e),this.state=_h.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=_h.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",e=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,e),this.state=_h.errored,this.rejoinTimer.scheduleTimeout())}),this._on(Nh.reply,{},(e,t)=>{this._trigger(this._replyEventName(t),e)}),this.presence=new Zh(this),this.broadcastEndpointURL=zh(this.socket.endPoint),this.private=this.params.config.private||!1}subscribe(e,t=this.timeout){var r,n;if(this.socket.isConnected()||this.socket.connect(),this.state==_h.closed){const{config:{broadcast:a,presence:s,private:i}}=this.params,o=null!==(n=null===(r=this.bindings.postgres_changes)||void 0===r?void 0:r.map(e=>e.filter))&&void 0!==n?n:[],l=!!this.bindings[Kh.PRESENCE]&&this.bindings[Kh.PRESENCE].length>0,c={},d={broadcast:a,presence:Object.assign(Object.assign({},s),{enabled:l}),postgres_changes:o,private:i};this.socket.accessTokenValue&&(c.access_token=this.socket.accessTokenValue),this._onError(t=>null==e?void 0:e(Yh.CHANNEL_ERROR,t)),this._onClose(()=>null==e?void 0:e(Yh.CLOSED)),this.updateJoinPayload(Object.assign({config:d},c)),this.joinedOnce=!0,this._rejoin(t),this.joinPush.receive("ok",async({postgres_changes:t})=>{var r;if(this.socket.setAuth(),void 0!==t){const n=this.bindings.postgres_changes,a=null!==(r=null==n?void 0:n.length)&&void 0!==r?r:0,s=[];for(let r=0;r<a;r++){const a=n[r],{filter:{event:i,schema:o,table:l,filter:c}}=a,d=t&&t[r];if(!d||d.event!==i||d.schema!==o||d.table!==l||d.filter!==c)return this.unsubscribe(),this.state=_h.errored,void(null==e||e(Yh.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes")));s.push(Object.assign(Object.assign({},a),{id:d.id}))}return this.bindings.postgres_changes=s,void(e&&e(Yh.SUBSCRIBED))}null==e||e(Yh.SUBSCRIBED)}).receive("error",t=>{this.state=_h.errored,null==e||e(Yh.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(t).join(", ")||"error")))}).receive("timeout",()=>{null==e||e(Yh.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,t={}){return await this.send({type:"presence",event:"track",payload:e},t.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,t,r){return this.state===_h.joined&&e===Kh.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(()=>this.subscribe())),this._on(e,t,r)}async send(e,t={}){var r,n;if(this._canPush()||"broadcast"!==e.type)return new Promise(r=>{var n,a,s;const i=this._push(e.type,e,t.timeout||this.timeout);"broadcast"!==e.type||(null===(s=null===(a=null===(n=this.params)||void 0===n?void 0:n.config)||void 0===a?void 0:a.broadcast)||void 0===s?void 0:s.ack)||r("ok"),i.receive("ok",()=>r("ok")),i.receive("error",()=>r("error")),i.receive("timeout",()=>r("timed out"))});{const{event:s,payload:i}=e,o={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:s,payload:i,private:this.private}]})};try{const e=await this._fetchWithTimeout(this.broadcastEndpointURL,o,null!==(r=t.timeout)&&void 0!==r?r:this.timeout);return await(null===(n=e.body)||void 0===n?void 0:n.cancel()),e.ok?"ok":"error"}catch(a){return"AbortError"===a.name?"timed out":"error"}}}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=_h.leaving;const t=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(Nh.close,"leave",this._joinRef())};this.joinPush.destroy();let r=null;return new Promise(n=>{r=new Vh(this,Nh.leave,{},e),r.receive("ok",()=>{t(),n("ok")}).receive("timeout",()=>{t(),n("timed out")}).receive("error",()=>{n("error")}),r.send(),this._canPush()||r.trigger("ok",{})}).finally(()=>{null==r||r.destroy()})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=_h.closed,this.bindings={}}async _fetchWithTimeout(e,t,r){const n=new AbortController,a=setTimeout(()=>n.abort(),r),s=await this.socket.fetch(e,Object.assign(Object.assign({},t),{signal:n.signal}));return clearTimeout(a),s}_push(e,t,r=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let n=new Vh(this,e,t,r);return this._canPush()?n.send():this._addToPushBuffer(n),n}_addToPushBuffer(e){if(e.startTimeout(),this.pushBuffer.push(e),this.pushBuffer.length>100){const e=this.pushBuffer.shift();e&&(e.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${e.event}`,e.payload))}}_onMessage(e,t,r){return t}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,t,r){var n,a;const s=e.toLocaleLowerCase(),{close:i,error:o,leave:l,join:c}=Nh;if(r&&[i,o,l,c].indexOf(s)>=0&&r!==this._joinRef())return;let d=this._onMessage(s,t,r);if(t&&!d)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(s)?null===(n=this.bindings.postgres_changes)||void 0===n||n.filter(e=>{var t,r,n;return"*"===(null===(t=e.filter)||void 0===t?void 0:t.event)||(null===(n=null===(r=e.filter)||void 0===r?void 0:r.event)||void 0===n?void 0:n.toLocaleLowerCase())===s}).map(e=>e.callback(d,r)):null===(a=this.bindings[s])||void 0===a||a.filter(e=>{var r,n,a,i,o,l;if(["broadcast","presence","postgres_changes"].includes(s)){if("id"in e){const s=e.id,i=null===(r=e.filter)||void 0===r?void 0:r.event;return s&&(null===(n=t.ids)||void 0===n?void 0:n.includes(s))&&("*"===i||(null==i?void 0:i.toLocaleLowerCase())===(null===(a=t.data)||void 0===a?void 0:a.type.toLocaleLowerCase()))}{const r=null===(o=null===(i=null==e?void 0:e.filter)||void 0===i?void 0:i.event)||void 0===o?void 0:o.toLocaleLowerCase();return"*"===r||r===(null===(l=null==t?void 0:t.event)||void 0===l?void 0:l.toLocaleLowerCase())}}return e.type.toLocaleLowerCase()===s}).map(e=>{if("object"==typeof d&&"ids"in d){const e=d.data,{schema:t,table:r,commit_timestamp:n,type:a,errors:s}=e,i={schema:t,table:r,commit_timestamp:n,eventType:a,new:{},old:{},errors:s};d=Object.assign(Object.assign({},i),this._getPayloadRecords(e))}e.callback(d,r)})}_isClosed(){return this.state===_h.closed}_isJoined(){return this.state===_h.joined}_isJoining(){return this.state===_h.joining}_isLeaving(){return this.state===_h.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,t,r){const n=e.toLocaleLowerCase(),a={type:n,filter:t,callback:r};return this.bindings[n]?this.bindings[n].push(a):this.bindings[n]=[a],this}_off(e,t){const r=e.toLocaleLowerCase();return this.bindings[r]&&(this.bindings[r]=this.bindings[r].filter(e=>{var n;return!((null===(n=e.type)||void 0===n?void 0:n.toLocaleLowerCase())===r&&Qh.isEqual(e.filter,t))})),this}static isEqual(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const r in e)if(e[r]!==t[r])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(Nh.close,{},e)}_onError(e){this._on(Nh.error,{},t=>e(t))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=_h.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const t={new:{},old:{}};return"INSERT"!==e.type&&"UPDATE"!==e.type||(t.new=Rh(e.columns,e.record)),"UPDATE"!==e.type&&"DELETE"!==e.type||(t.old=Rh(e.columns,e.old_record)),t}}const ef=()=>{},tf=25e3,rf=10,nf=100,af=[1e3,2e3,5e3,1e4];class sf{constructor(e,t){var r;if(this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=bh,this.transport=null,this.heartbeatIntervalMs=tf,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=ef,this.ref=0,this.reconnectTimer=null,this.logger=ef,this.conn=null,this.sendBuffer=[],this.serializer=new Oh,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=e=>{let t;return t=e||("undefined"==typeof fetch?(...e)=>pu(async()=>{const{default:e}=await Promise.resolve().then(()=>Lu);return{default:e}},void 0).then(({default:t})=>t(...e)).catch(e=>{throw new Error(`Failed to load @supabase/node-fetch: ${e.message}. This is required for HTTP requests in Node.js environments without native fetch.`)}):fetch),(...e)=>t(...e)},!(null===(r=null==t?void 0:t.params)||void 0===r?void 0:r.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=t.params.apikey,this.endPoint=`${e}/${Sh.websocket}`,this.httpEndpoint=zh(e),this._initializeOptions(t),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(null==t?void 0:t.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||null!==this.conn&&this.isConnected())){if(this._setConnectionState("connecting"),this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=vh.createWebSocket(this.endpointURL())}catch(e){throw this._setConnectionState("disconnected"),new Error(`WebSocket not available: ${e.message}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:"1.0.0"}))}disconnect(e,t){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const r=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(r),this._setConnectionState("disconnected")},e?this.conn.close(e,null!=t?t:""):this.conn.close(),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(e){const t=await e.unsubscribe();return 0===this.channels.length&&this.disconnect(),t}async removeAllChannels(){const e=await Promise.all(this.channels.map(e=>e.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,t,r){this.logger(e,t,r)}connectionState(){switch(this.conn&&this.conn.readyState){case yh.connecting:return Th.Connecting;case yh.open:return Th.Open;case yh.closing:return Th.Closing;default:return Th.Closed}}isConnected(){return this.connectionState()===Th.Open}isConnecting(){return"connecting"===this._connectionState}isDisconnecting(){return"disconnecting"===this._connectionState}channel(e,t={config:{}}){const r=`realtime:${e}`,n=this.getChannels().find(e=>e.topic===r);if(n)return n;{const r=new Qh(`realtime:${e}`,t,this);return this.channels.push(r),r}}push(e){const{topic:t,event:r,payload:n,ref:a}=e,s=()=>{this.encode(e,e=>{var t;null===(t=this.conn)||void 0===t||t.send(e)})};this.log("push",`${t} ${r} (${a})`,n),this.isConnected()?s():this.sendBuffer.push(s)}async setAuth(e=null){this._authPromise=this._performAuth(e);try{await this._authPromise}finally{this._authPromise=null}}async sendHeartbeat(){var e;if(this.isConnected()){if(this.pendingHeartbeatRef)return this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),this.heartbeatCallback("timeout"),this._wasManualDisconnect=!1,null===(e=this.conn)||void 0===e||e.close(1e3,"heartbeat timeout"),void setTimeout(()=>{var e;this.isConnected()||null===(e=this.reconnectTimer)||void 0===e||e.scheduleTimeout()},nf);this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.heartbeatCallback("sent"),this._setAuthSafely("heartbeat")}else this.heartbeatCallback("disconnected")}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let t=this.channels.find(t=>t.topic===e&&(t._isJoined()||t._isJoining()));t&&(this.log("transport",`leaving duplicate topic "${e}"`),t.unsubscribe())}_remove(e){this.channels=this.channels.filter(t=>t.topic!==e.topic)}_onConnMessage(e){this.decode(e.data,e=>{"phoenix"===e.topic&&"phx_reply"===e.event&&this.heartbeatCallback("ok"===e.payload.status?"ok":"error"),e.ref&&e.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:t,event:r,payload:n,ref:a}=e,s=a?`(${a})`:"",i=n.status||"";this.log("receive",`${i} ${t} ${r} ${s}`.trim(),n),this.channels.filter(e=>e._isMember(t)).forEach(e=>e._trigger(r,n,a)),this._triggerStateCallbacks("message",e)})}_clearTimer(e){var t;"heartbeat"===e&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):"reconnect"===e&&(null===(t=this.reconnectTimer)||void 0===t||t.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_teardownConnection(){this.conn&&(this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null),this._clearAllTimers(),this.channels.forEach(e=>e.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=e=>{this.log("worker","worker error",e.message),this.workerRef.terminate()},this.workerRef.onmessage=e=>{"keepAlive"===e.data.event&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(e){var t;this._setConnectionState("disconnected"),this.log("transport","close",e),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||null===(t=this.reconnectTimer)||void 0===t||t.scheduleTimeout(),this._triggerStateCallbacks("close",e)}_onConnError(e){this._setConnectionState("disconnected"),this.log("transport",`${e}`),this._triggerChanError(),this._triggerStateCallbacks("error",e)}_triggerChanError(){this.channels.forEach(e=>e._trigger(Nh.error))}_appendParams(e,t){if(0===Object.keys(t).length)return e;const r=e.match(/\?/)?"&":"?";return`${e}${r}${new URLSearchParams(t)}`}_workerObjectUrl(e){let t;if(e)t=e;else{const e=new Blob(['\n  addEventListener("message", (e) => {\n    if (e.data.event === "start") {\n      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);\n    }\n  });'],{type:"application/javascript"});t=URL.createObjectURL(e)}return t}_setConnectionState(e,t=!1){this._connectionState=e,"connecting"===e?this._wasManualDisconnect=!1:"disconnecting"===e&&(this._wasManualDisconnect=t)}async _performAuth(e=null){let t;t=e||(this.accessToken?await this.accessToken():this.accessTokenValue),this.accessTokenValue!=t&&(this.accessTokenValue=t,this.channels.forEach(e=>{const r={access_token:t,version:"realtime-js/2.15.0"};t&&e.updateJoinPayload(r),e.joinedOnce&&e._isJoined()&&e._push(Nh.access_token,{access_token:t})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(e="general"){this.setAuth().catch(t=>{this.log("error",`error setting auth in ${e}`,t)})}_triggerStateCallbacks(e,t){try{this.stateChangeCallbacks[e].forEach(r=>{try{r(t)}catch(n){this.log("error",`error in ${e} callback`,n)}})}catch(r){this.log("error",`error triggering ${e} callbacks`,r)}}_setupReconnectionTimer(){this.reconnectTimer=new Ih(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},rf)},this.reconnectAfterMs)}_initializeOptions(e){var t,r,n,a,s,i,o,l;if(this.transport=null!==(t=null==e?void 0:e.transport)&&void 0!==t?t:null,this.timeout=null!==(r=null==e?void 0:e.timeout)&&void 0!==r?r:bh,this.heartbeatIntervalMs=null!==(n=null==e?void 0:e.heartbeatIntervalMs)&&void 0!==n?n:tf,this.worker=null!==(a=null==e?void 0:e.worker)&&void 0!==a&&a,this.accessToken=null!==(s=null==e?void 0:e.accessToken)&&void 0!==s?s:null,(null==e?void 0:e.params)&&(this.params=e.params),(null==e?void 0:e.logger)&&(this.logger=e.logger),((null==e?void 0:e.logLevel)||(null==e?void 0:e.log_level))&&(this.logLevel=e.logLevel||e.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=null!==(i=null==e?void 0:e.reconnectAfterMs)&&void 0!==i?i:e=>af[e-1]||1e4,this.encode=null!==(o=null==e?void 0:e.encode)&&void 0!==o?o:(e,t)=>t(JSON.stringify(e)),this.decode=null!==(l=null==e?void 0:e.decode)&&void 0!==l?l:this.serializer.decode.bind(this.serializer),this.worker){if("undefined"!=typeof window&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=null==e?void 0:e.workerUrl}}}class of extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function lf(e){return"object"==typeof e&&null!==e&&"__isStorageError"in e}class cf extends of{constructor(e,t,r){super(e),this.name="StorageApiError",this.status=t,this.statusCode=r}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class df extends of{constructor(e,t){super(e),this.name="StorageUnknownError",this.originalError=t}}var uf=function(e,t,r,n){return new(r||(r=Promise))(function(a,s){function i(e){try{l(n.next(e))}catch(t){s(t)}}function o(e){try{l(n.throw(e))}catch(t){s(t)}}function l(e){var t;e.done?a(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(i,o)}l((n=n.apply(e,t||[])).next())})};const hf=e=>{let t;return t=e||("undefined"==typeof fetch?(...e)=>pu(async()=>{const{default:e}=await Promise.resolve().then(()=>Lu);return{default:e}},void 0).then(({default:t})=>t(...e)):fetch),(...e)=>t(...e)},ff=e=>{if(Array.isArray(e))return e.map(e=>ff(e));if("function"==typeof e||e!==Object(e))return e;const t={};return Object.entries(e).forEach(([e,r])=>{const n=e.replace(/([-_][a-z])/gi,e=>e.toUpperCase().replace(/[-_]/g,""));t[n]=ff(r)}),t};var mf=function(e,t,r,n){return new(r||(r=Promise))(function(a,s){function i(e){try{l(n.next(e))}catch(t){s(t)}}function o(e){try{l(n.throw(e))}catch(t){s(t)}}function l(e){var t;e.done?a(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(i,o)}l((n=n.apply(e,t||[])).next())})};const pf=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),gf=(e,t,r)=>mf(void 0,void 0,void 0,function*(){const n=yield uf(void 0,void 0,void 0,function*(){return"undefined"==typeof Response?(yield pu(()=>Promise.resolve().then(()=>Lu),void 0)).Response:Response});e instanceof n&&!(null==r?void 0:r.noResolveJson)?e.json().then(r=>{const n=e.status||500,a=(null==r?void 0:r.statusCode)||n+"";t(new cf(pf(r),n,a))}).catch(e=>{t(new df(pf(e),e))}):t(new df(pf(e),e))}),xf=(e,t,r,n)=>{const a={method:e,headers:(null==t?void 0:t.headers)||{}};return"GET"!==e&&n?((e=>{if("object"!=typeof e||null===e)return!1;const t=Object.getPrototypeOf(e);return!(null!==t&&t!==Object.prototype&&null!==Object.getPrototypeOf(t)||Symbol.toStringTag in e||Symbol.iterator in e)})(n)?(a.headers=Object.assign({"Content-Type":"application/json"},null==t?void 0:t.headers),a.body=JSON.stringify(n)):a.body=n,Object.assign(Object.assign({},a),r)):a};function vf(e,t,r,n,a,s){return mf(this,void 0,void 0,function*(){return new Promise((i,o)=>{e(r,xf(t,n,a,s)).then(e=>{if(!e.ok)throw e;return(null==n?void 0:n.noResolveJson)?e:e.json()}).then(e=>i(e)).catch(e=>gf(e,o,n))})})}function bf(e,t,r,n){return mf(this,void 0,void 0,function*(){return vf(e,"GET",t,r,n)})}function yf(e,t,r,n,a){return mf(this,void 0,void 0,function*(){return vf(e,"POST",t,n,a,r)})}function wf(e,t,r,n,a){return mf(this,void 0,void 0,function*(){return vf(e,"PUT",t,n,a,r)})}function _f(e,t,r,n,a){return mf(this,void 0,void 0,function*(){return vf(e,"DELETE",t,n,a,r)})}var kf=function(e,t,r,n){return new(r||(r=Promise))(function(a,s){function i(e){try{l(n.next(e))}catch(t){s(t)}}function o(e){try{l(n.throw(e))}catch(t){s(t)}}function l(e){var t;e.done?a(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(i,o)}l((n=n.apply(e,t||[])).next())})};const Nf={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},jf={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class Sf{constructor(e,t={},r,n){this.url=e,this.headers=t,this.bucketId=r,this.fetch=hf(n)}uploadOrUpdate(e,t,r,n){return kf(this,void 0,void 0,function*(){try{let a;const s=Object.assign(Object.assign({},jf),n);let i=Object.assign(Object.assign({},this.headers),"POST"===e&&{"x-upsert":String(s.upsert)});const o=s.metadata;"undefined"!=typeof Blob&&r instanceof Blob?(a=new FormData,a.append("cacheControl",s.cacheControl),o&&a.append("metadata",this.encodeMetadata(o)),a.append("",r)):"undefined"!=typeof FormData&&r instanceof FormData?(a=r,a.append("cacheControl",s.cacheControl),o&&a.append("metadata",this.encodeMetadata(o))):(a=r,i["cache-control"]=`max-age=${s.cacheControl}`,i["content-type"]=s.contentType,o&&(i["x-metadata"]=this.toBase64(this.encodeMetadata(o)))),(null==n?void 0:n.headers)&&(i=Object.assign(Object.assign({},i),n.headers));const l=this._removeEmptyFolders(t),c=this._getFinalPath(l),d=yield("PUT"==e?wf:yf)(this.fetch,`${this.url}/object/${c}`,a,Object.assign({headers:i},(null==s?void 0:s.duplex)?{duplex:s.duplex}:{}));return{data:{path:l,id:d.Id,fullPath:d.Key},error:null}}catch(a){if(lf(a))return{data:null,error:a};throw a}})}upload(e,t,r){return kf(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,t,r)})}uploadToSignedUrl(e,t,r,n){return kf(this,void 0,void 0,function*(){const a=this._removeEmptyFolders(e),s=this._getFinalPath(a),i=new URL(this.url+`/object/upload/sign/${s}`);i.searchParams.set("token",t);try{let e;const t=Object.assign({upsert:jf.upsert},n),s=Object.assign(Object.assign({},this.headers),{"x-upsert":String(t.upsert)});"undefined"!=typeof Blob&&r instanceof Blob?(e=new FormData,e.append("cacheControl",t.cacheControl),e.append("",r)):"undefined"!=typeof FormData&&r instanceof FormData?(e=r,e.append("cacheControl",t.cacheControl)):(e=r,s["cache-control"]=`max-age=${t.cacheControl}`,s["content-type"]=t.contentType);return{data:{path:a,fullPath:(yield wf(this.fetch,i.toString(),e,{headers:s})).Key},error:null}}catch(o){if(lf(o))return{data:null,error:o};throw o}})}createSignedUploadUrl(e,t){return kf(this,void 0,void 0,function*(){try{let r=this._getFinalPath(e);const n=Object.assign({},this.headers);(null==t?void 0:t.upsert)&&(n["x-upsert"]="true");const a=yield yf(this.fetch,`${this.url}/object/upload/sign/${r}`,{},{headers:n}),s=new URL(this.url+a.url),i=s.searchParams.get("token");if(!i)throw new of("No token returned by API");return{data:{signedUrl:s.toString(),path:e,token:i},error:null}}catch(r){if(lf(r))return{data:null,error:r};throw r}})}update(e,t,r){return kf(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,t,r)})}move(e,t,r){return kf(this,void 0,void 0,function*(){try{return{data:yield yf(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:null==r?void 0:r.destinationBucket},{headers:this.headers}),error:null}}catch(n){if(lf(n))return{data:null,error:n};throw n}})}copy(e,t,r){return kf(this,void 0,void 0,function*(){try{return{data:{path:(yield yf(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:null==r?void 0:r.destinationBucket},{headers:this.headers})).Key},error:null}}catch(n){if(lf(n))return{data:null,error:n};throw n}})}createSignedUrl(e,t,r){return kf(this,void 0,void 0,function*(){try{let n=this._getFinalPath(e),a=yield yf(this.fetch,`${this.url}/object/sign/${n}`,Object.assign({expiresIn:t},(null==r?void 0:r.transform)?{transform:r.transform}:{}),{headers:this.headers});const s=(null==r?void 0:r.download)?`&download=${!0===r.download?"":r.download}`:"";return a={signedUrl:encodeURI(`${this.url}${a.signedURL}${s}`)},{data:a,error:null}}catch(n){if(lf(n))return{data:null,error:n};throw n}})}createSignedUrls(e,t,r){return kf(this,void 0,void 0,function*(){try{const n=yield yf(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:t,paths:e},{headers:this.headers}),a=(null==r?void 0:r.download)?`&download=${!0===r.download?"":r.download}`:"";return{data:n.map(e=>Object.assign(Object.assign({},e),{signedUrl:e.signedURL?encodeURI(`${this.url}${e.signedURL}${a}`):null})),error:null}}catch(n){if(lf(n))return{data:null,error:n};throw n}})}download(e,t){return kf(this,void 0,void 0,function*(){const r=void 0!==(null==t?void 0:t.transform)?"render/image/authenticated":"object",n=this.transformOptsToQueryString((null==t?void 0:t.transform)||{}),a=n?`?${n}`:"";try{const t=this._getFinalPath(e),n=yield bf(this.fetch,`${this.url}/${r}/${t}${a}`,{headers:this.headers,noResolveJson:!0});return{data:yield n.blob(),error:null}}catch(s){if(lf(s))return{data:null,error:s};throw s}})}info(e){return kf(this,void 0,void 0,function*(){const t=this._getFinalPath(e);try{const e=yield bf(this.fetch,`${this.url}/object/info/${t}`,{headers:this.headers});return{data:ff(e),error:null}}catch(r){if(lf(r))return{data:null,error:r};throw r}})}exists(e){return kf(this,void 0,void 0,function*(){const t=this._getFinalPath(e);try{return yield function(e,t,r,n){return mf(this,void 0,void 0,function*(){return vf(e,"HEAD",t,Object.assign(Object.assign({},r),{noResolveJson:!0}),n)})}(this.fetch,`${this.url}/object/${t}`,{headers:this.headers}),{data:!0,error:null}}catch(r){if(lf(r)&&r instanceof df){const e=r.originalError;if([400,404].includes(null==e?void 0:e.status))return{data:!1,error:r}}throw r}})}getPublicUrl(e,t){const r=this._getFinalPath(e),n=[],a=(null==t?void 0:t.download)?`download=${!0===t.download?"":t.download}`:"";""!==a&&n.push(a);const s=void 0!==(null==t?void 0:t.transform)?"render/image":"object",i=this.transformOptsToQueryString((null==t?void 0:t.transform)||{});""!==i&&n.push(i);let o=n.join("&");return""!==o&&(o=`?${o}`),{data:{publicUrl:encodeURI(`${this.url}/${s}/public/${r}${o}`)}}}remove(e){return kf(this,void 0,void 0,function*(){try{return{data:yield _f(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(t){if(lf(t))return{data:null,error:t};throw t}})}list(e,t,r){return kf(this,void 0,void 0,function*(){try{const n=Object.assign(Object.assign(Object.assign({},Nf),t),{prefix:e||""});return{data:yield yf(this.fetch,`${this.url}/object/list/${this.bucketId}`,n,{headers:this.headers},r),error:null}}catch(n){if(lf(n))return{data:null,error:n};throw n}})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return"undefined"!=typeof Buffer?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e.replace(/^\/+/,"")}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const t=[];return e.width&&t.push(`width=${e.width}`),e.height&&t.push(`height=${e.height}`),e.resize&&t.push(`resize=${e.resize}`),e.format&&t.push(`format=${e.format}`),e.quality&&t.push(`quality=${e.quality}`),t.join("&")}}const Tf={"X-Client-Info":"storage-js/2.10.4"};var Ef=function(e,t,r,n){return new(r||(r=Promise))(function(a,s){function i(e){try{l(n.next(e))}catch(t){s(t)}}function o(e){try{l(n.throw(e))}catch(t){s(t)}}function l(e){var t;e.done?a(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(i,o)}l((n=n.apply(e,t||[])).next())})};class Cf{constructor(e,t={},r,n){const a=new URL(e);if(null==n?void 0:n.useNewHostname){/supabase\.(co|in|red)$/.test(a.hostname)&&!a.hostname.includes("storage.supabase.")&&(a.hostname=a.hostname.replace("supabase.","storage.supabase."))}this.url=a.href,this.headers=Object.assign(Object.assign({},Tf),t),this.fetch=hf(r)}listBuckets(){return Ef(this,void 0,void 0,function*(){try{return{data:yield bf(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(e){if(lf(e))return{data:null,error:e};throw e}})}getBucket(e){return Ef(this,void 0,void 0,function*(){try{return{data:yield bf(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(t){if(lf(t))return{data:null,error:t};throw t}})}createBucket(e,t={public:!1}){return Ef(this,void 0,void 0,function*(){try{return{data:yield yf(this.fetch,`${this.url}/bucket`,{id:e,name:e,type:t.type,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(r){if(lf(r))return{data:null,error:r};throw r}})}updateBucket(e,t){return Ef(this,void 0,void 0,function*(){try{return{data:yield wf(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(r){if(lf(r))return{data:null,error:r};throw r}})}emptyBucket(e){return Ef(this,void 0,void 0,function*(){try{return{data:yield yf(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(t){if(lf(t))return{data:null,error:t};throw t}})}deleteBucket(e){return Ef(this,void 0,void 0,function*(){try{return{data:yield _f(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(t){if(lf(t))return{data:null,error:t};throw t}})}}class Af extends Cf{constructor(e,t={},r,n){super(e,t,r,n)}from(e){return new Sf(this.url,this.headers,e,this.fetch)}}let Of="";Of="undefined"!=typeof Deno?"deno":"undefined"!=typeof document?"web":"undefined"!=typeof navigator&&"ReactNative"===navigator.product?"react-native":"node";const If={headers:{"X-Client-Info":`supabase-js-${Of}/2.54.0`}},Rf={schema:"public"},Pf={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},Df={};var Lf=function(e,t,r,n){return new(r||(r=Promise))(function(a,s){function i(e){try{l(n.next(e))}catch(t){s(t)}}function o(e){try{l(n.throw(e))}catch(t){s(t)}}function l(e){var t;e.done?a(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(i,o)}l((n=n.apply(e,t||[])).next())})};const Mf=(e,t,r)=>{const n=(e=>{let t;return t=e||("undefined"==typeof fetch?Iu:fetch),(...e)=>t(...e)})(r),a="undefined"==typeof Headers?Ru:Headers;return(r,s)=>Lf(void 0,void 0,void 0,function*(){var i;const o=null!==(i=yield t())&&void 0!==i?i:e;let l=new a(null==s?void 0:s.headers);return l.has("apikey")||l.set("apikey",e),l.has("Authorization")||l.set("Authorization",`Bearer ${o}`),n(r,Object.assign(Object.assign({},s),{headers:l}))})};var Ff=function(e,t,r,n){return new(r||(r=Promise))(function(a,s){function i(e){try{l(n.next(e))}catch(t){s(t)}}function o(e){try{l(n.throw(e))}catch(t){s(t)}}function l(e){var t;e.done?a(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(i,o)}l((n=n.apply(e,t||[])).next())})};const Uf="2.71.1",Bf=3e4,$f=9e4,zf={"X-Client-Info":`gotrue-js/${Uf}`},Vf="X-Supabase-Api-Version",Wf={timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"},Hf=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i;class Gf extends Error{constructor(e,t,r){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=t,this.code=r}}function qf(e){return"object"==typeof e&&null!==e&&"__isAuthError"in e}class Kf extends Gf{constructor(e,t,r){super(e,t,r),this.name="AuthApiError",this.status=t,this.code=r}}class Xf extends Gf{constructor(e,t){super(e),this.name="AuthUnknownError",this.originalError=t}}class Yf extends Gf{constructor(e,t,r,n){super(e,r,n),this.name=t,this.status=r}}class Jf extends Yf{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}class Zf extends Yf{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class Qf extends Yf{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class em extends Yf{constructor(e,t=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class tm extends Yf{constructor(e,t=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class rm extends Yf{constructor(e,t){super(e,"AuthRetryableFetchError",t,void 0)}}function nm(e){return qf(e)&&"AuthRetryableFetchError"===e.name}class am extends Yf{constructor(e,t,r){super(e,"AuthWeakPasswordError",t,"weak_password"),this.reasons=r}}class sm extends Yf{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const im="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),om=" \t\n\r=".split(""),lm=(()=>{const e=new Array(128);for(let t=0;t<e.length;t+=1)e[t]=-1;for(let t=0;t<om.length;t+=1)e[om[t].charCodeAt(0)]=-2;for(let t=0;t<im.length;t+=1)e[im[t].charCodeAt(0)]=t;return e})();function cm(e,t,r){if(null!==e)for(t.queue=t.queue<<8|e,t.queuedBits+=8;t.queuedBits>=6;){const e=t.queue>>t.queuedBits-6&63;r(im[e]),t.queuedBits-=6}else if(t.queuedBits>0)for(t.queue=t.queue<<6-t.queuedBits,t.queuedBits=6;t.queuedBits>=6;){const e=t.queue>>t.queuedBits-6&63;r(im[e]),t.queuedBits-=6}}function dm(e,t,r){const n=lm[e];if(!(n>-1)){if(-2===n)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(e)}"`)}for(t.queue=t.queue<<6|n,t.queuedBits+=6;t.queuedBits>=8;)r(t.queue>>t.queuedBits-8&255),t.queuedBits-=8}function um(e){const t=[],r=e=>{t.push(String.fromCodePoint(e))},n={utf8seq:0,codepoint:0},a={queue:0,queuedBits:0},s=e=>{!function(e,t,r){if(0===t.utf8seq){if(e<=127)return void r(e);for(let r=1;r<6;r+=1)if(!(e>>7-r&1)){t.utf8seq=r;break}if(2===t.utf8seq)t.codepoint=31&e;else if(3===t.utf8seq)t.codepoint=15&e;else{if(4!==t.utf8seq)throw new Error("Invalid UTF-8 sequence");t.codepoint=7&e}t.utf8seq-=1}else if(t.utf8seq>0){if(e<=127)throw new Error("Invalid UTF-8 sequence");t.codepoint=t.codepoint<<6|63&e,t.utf8seq-=1,0===t.utf8seq&&r(t.codepoint)}}(e,n,r)};for(let i=0;i<e.length;i+=1)dm(e.charCodeAt(i),a,s);return t.join("")}function hm(e,t){if(!(e<=127)){if(e<=2047)return t(192|e>>6),void t(128|63&e);if(e<=65535)return t(224|e>>12),t(128|e>>6&63),void t(128|63&e);if(e<=1114111)return t(240|e>>18),t(128|e>>12&63),t(128|e>>6&63),void t(128|63&e);throw new Error(`Unrecognized Unicode codepoint: ${e.toString(16)}`)}t(e)}function fm(e){const t=[],r={queue:0,queuedBits:0},n=e=>{t.push(e)};for(let a=0;a<e.length;a+=1)dm(e.charCodeAt(a),r,n);return new Uint8Array(t)}function mm(e){const t=[];return function(e,t){for(let r=0;r<e.length;r+=1){let n=e.charCodeAt(r);if(n>55295&&n<=56319){const t=1024*(n-55296)&65535;n=65536+(e.charCodeAt(r+1)-56320&65535|t),r+=1}hm(n,t)}}(e,e=>t.push(e)),new Uint8Array(t)}function pm(e){const t=[],r={queue:0,queuedBits:0},n=e=>{t.push(e)};return e.forEach(e=>cm(e,r,n)),cm(null,r,n),t.join("")}const gm=()=>"undefined"!=typeof window&&"undefined"!=typeof document,xm={tested:!1,writable:!1},vm=()=>{if(!gm())return!1;try{if("object"!=typeof globalThis.localStorage)return!1}catch(t){return!1}if(xm.tested)return xm.writable;const e=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(e,e),globalThis.localStorage.removeItem(e),xm.tested=!0,xm.writable=!0}catch(t){xm.tested=!0,xm.writable=!1}return xm.writable};const bm=e=>{let t;return t=e||("undefined"==typeof fetch?(...e)=>pu(async()=>{const{default:e}=await Promise.resolve().then(()=>Lu);return{default:e}},void 0).then(({default:t})=>t(...e)):fetch),(...e)=>t(...e)},ym=async(e,t,r)=>{await e.setItem(t,JSON.stringify(r))},wm=async(e,t)=>{const r=await e.getItem(t);if(!r)return null;try{return JSON.parse(r)}catch(n){return r}},_m=async(e,t)=>{await e.removeItem(t)};class km{constructor(){this.promise=new km.promiseConstructor((e,t)=>{this.resolve=e,this.reject=t})}}function Nm(e){const t=e.split(".");if(3!==t.length)throw new sm("Invalid JWT structure");for(let r=0;r<t.length;r++)if(!Hf.test(t[r]))throw new sm("JWT not in base64url format");return{header:JSON.parse(um(t[0])),payload:JSON.parse(um(t[1])),signature:fm(t[2]),raw:{header:t[0],payload:t[1]}}}function jm(e){return("0"+e.toString(16)).substr(-2)}async function Sm(e){if(!("undefined"!=typeof crypto&&void 0!==crypto.subtle&&"undefined"!=typeof TextEncoder))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),e;const t=await async function(e){const t=(new TextEncoder).encode(e),r=await crypto.subtle.digest("SHA-256",t),n=new Uint8Array(r);return Array.from(n).map(e=>String.fromCharCode(e)).join("")}(e);return btoa(t).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Tm(e,t,r=!1){const n=function(){const e=new Uint32Array(56);if("undefined"==typeof crypto){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",t=e.length;let r="";for(let n=0;n<56;n++)r+=e.charAt(Math.floor(Math.random()*t));return r}return crypto.getRandomValues(e),Array.from(e,jm).join("")}();let a=n;r&&(a+="/PASSWORD_RECOVERY"),await ym(e,`${t}-code-verifier`,a);const s=await Sm(n);return[s,n===s?"plain":"s256"]}km.promiseConstructor=Promise;const Em=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;const Cm=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function Am(e){if(!Cm.test(e))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function Om(){return new Proxy({},{get:(e,t)=>{if("__isUserNotAvailableProxy"===t)return!0;if("symbol"==typeof t){const e=t.toString();if("Symbol(Symbol.toPrimitive)"===e||"Symbol(Symbol.toStringTag)"===e||"Symbol(util.inspect.custom)"===e)return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${t}" property of the session object is not supported. Please use getUser() instead.`)},set:(e,t)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${t}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(e,t)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${t}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function Im(e){return JSON.parse(JSON.stringify(e))}const Rm=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),Pm=[502,503,504];async function Dm(e){var t,r;if(!("object"==typeof(r=e)&&null!==r&&"status"in r&&"ok"in r&&"json"in r&&"function"==typeof r.json))throw new rm(Rm(e),0);if(Pm.includes(e.status))throw new rm(Rm(e),e.status);let n,a;try{n=await e.json()}catch(i){throw new Xf(Rm(i),i)}const s=function(e){const t=e.headers.get(Vf);if(!t)return null;if(!t.match(Em))return null;try{return new Date(`${t}T00:00:00.0Z`)}catch(i){return null}}(e);if(s&&s.getTime()>=Wf.timestamp&&"object"==typeof n&&n&&"string"==typeof n.code?a=n.code:"object"==typeof n&&n&&"string"==typeof n.error_code&&(a=n.error_code),a){if("weak_password"===a)throw new am(Rm(n),e.status,(null===(t=n.weak_password)||void 0===t?void 0:t.reasons)||[]);if("session_not_found"===a)throw new Jf}else if("object"==typeof n&&n&&"object"==typeof n.weak_password&&n.weak_password&&Array.isArray(n.weak_password.reasons)&&n.weak_password.reasons.length&&n.weak_password.reasons.reduce((e,t)=>e&&"string"==typeof t,!0))throw new am(Rm(n),e.status,n.weak_password.reasons);throw new Kf(Rm(n),e.status||500,a)}async function Lm(e,t,r,n){var a;const s=Object.assign({},null==n?void 0:n.headers);s[Vf]||(s[Vf]=Wf.name),(null==n?void 0:n.jwt)&&(s.Authorization=`Bearer ${n.jwt}`);const i=null!==(a=null==n?void 0:n.query)&&void 0!==a?a:{};(null==n?void 0:n.redirectTo)&&(i.redirect_to=n.redirectTo);const o=Object.keys(i).length?"?"+new URLSearchParams(i).toString():"",l=await async function(e,t,r,n,a,s){const i=((e,t,r,n)=>{const a={method:e,headers:(null==t?void 0:t.headers)||{}};return"GET"===e?a:(a.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},null==t?void 0:t.headers),a.body=JSON.stringify(n),Object.assign(Object.assign({},a),r))})(t,n,a,s);let o;try{o=await e(r,Object.assign({},i))}catch(l){throw console.error(l),new rm(Rm(l),0)}o.ok||await Dm(o);if(null==n?void 0:n.noResolveJson)return o;try{return await o.json()}catch(l){await Dm(l)}}(e,t,r+o,{headers:s,noResolveJson:null==n?void 0:n.noResolveJson},{},null==n?void 0:n.body);return(null==n?void 0:n.xform)?null==n?void 0:n.xform(l):{data:Object.assign({},l),error:null}}function Mm(e){var t;let r=null;var n;(function(e){return e.access_token&&e.refresh_token&&e.expires_in})(e)&&(r=Object.assign({},e),e.expires_at||(r.expires_at=(n=e.expires_in,Math.round(Date.now()/1e3)+n)));return{data:{session:r,user:null!==(t=e.user)&&void 0!==t?t:e},error:null}}function Fm(e){const t=Mm(e);return!t.error&&e.weak_password&&"object"==typeof e.weak_password&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.message&&"string"==typeof e.weak_password.message&&e.weak_password.reasons.reduce((e,t)=>e&&"string"==typeof t,!0)&&(t.data.weak_password=e.weak_password),t}function Um(e){var t;return{data:{user:null!==(t=e.user)&&void 0!==t?t:e},error:null}}function Bm(e){return{data:e,error:null}}function $m(e){const{action_link:t,email_otp:r,hashed_token:n,redirect_to:a,verification_type:s}=e,i=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]])}return r}(e,["action_link","email_otp","hashed_token","redirect_to","verification_type"]);return{data:{properties:{action_link:t,email_otp:r,hashed_token:n,redirect_to:a,verification_type:s},user:Object.assign({},i)},error:null}}function zm(e){return e}const Vm=["global","local","others"];class Wm{constructor({url:e="",headers:t={},fetch:r}){this.url=e,this.headers=t,this.fetch=bm(r),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(e,t=Vm[0]){if(Vm.indexOf(t)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${Vm.join(", ")}`);try{return await Lm(this.fetch,"POST",`${this.url}/logout?scope=${t}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(r){if(qf(r))return{data:null,error:r};throw r}}async inviteUserByEmail(e,t={}){try{return await Lm(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:t.data},headers:this.headers,redirectTo:t.redirectTo,xform:Um})}catch(r){if(qf(r))return{data:{user:null},error:r};throw r}}async generateLink(e){try{const{options:t}=e,r=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]])}return r}(e,["options"]),n=Object.assign(Object.assign({},r),t);return"newEmail"in r&&(n.new_email=null==r?void 0:r.newEmail,delete n.newEmail),await Lm(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:n,headers:this.headers,xform:$m,redirectTo:null==t?void 0:t.redirectTo})}catch(t){if(qf(t))return{data:{properties:null,user:null},error:t};throw t}}async createUser(e){try{return await Lm(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:Um})}catch(t){if(qf(t))return{data:{user:null},error:t};throw t}}async listUsers(e){var t,r,n,a,s,i,o;try{const l={nextPage:null,lastPage:0,total:0},c=await Lm(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:null!==(r=null===(t=null==e?void 0:e.page)||void 0===t?void 0:t.toString())&&void 0!==r?r:"",per_page:null!==(a=null===(n=null==e?void 0:e.perPage)||void 0===n?void 0:n.toString())&&void 0!==a?a:""},xform:zm});if(c.error)throw c.error;const d=await c.json(),u=null!==(s=c.headers.get("x-total-count"))&&void 0!==s?s:0,h=null!==(o=null===(i=c.headers.get("link"))||void 0===i?void 0:i.split(","))&&void 0!==o?o:[];return h.length>0&&(h.forEach(e=>{const t=parseInt(e.split(";")[0].split("=")[1].substring(0,1)),r=JSON.parse(e.split(";")[1].split("=")[1]);l[`${r}Page`]=t}),l.total=parseInt(u)),{data:Object.assign(Object.assign({},d),l),error:null}}catch(l){if(qf(l))return{data:{users:[]},error:l};throw l}}async getUserById(e){Am(e);try{return await Lm(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:Um})}catch(t){if(qf(t))return{data:{user:null},error:t};throw t}}async updateUserById(e,t){Am(e);try{return await Lm(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:t,headers:this.headers,xform:Um})}catch(r){if(qf(r))return{data:{user:null},error:r};throw r}}async deleteUser(e,t=!1){Am(e);try{return await Lm(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:t},xform:Um})}catch(r){if(qf(r))return{data:{user:null},error:r};throw r}}async _listFactors(e){Am(e.userId);try{const{data:t,error:r}=await Lm(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:e=>({data:{factors:e},error:null})});return{data:t,error:r}}catch(t){if(qf(t))return{data:null,error:t};throw t}}async _deleteFactor(e){Am(e.userId),Am(e.id);try{return{data:await Lm(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(t){if(qf(t))return{data:null,error:t};throw t}}}function Hm(e={}){return{getItem:t=>e[t]||null,setItem:(t,r)=>{e[t]=r},removeItem:t=>{delete e[t]}}}const Gm=!!(globalThis&&vm()&&globalThis.localStorage&&"true"===globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug"));class qm extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class Km extends qm{}async function Xm(e,t,r){Gm&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",e,t);const n=new globalThis.AbortController;return t>0&&setTimeout(()=>{n.abort(),Gm&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",e)},t),await Promise.resolve().then(()=>globalThis.navigator.locks.request(e,0===t?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:n.signal},async n=>{if(!n){if(0===t)throw Gm&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",e),new Km(`Acquiring an exclusive Navigator LockManager lock "${e}" immediately failed`);if(Gm)try{const e=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(e,null,"  "))}catch(a){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",a)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await r()}Gm&&console.log("@supabase/gotrue-js: navigatorLock: acquired",e,n.name);try{return await r()}finally{Gm&&console.log("@supabase/gotrue-js: navigatorLock: released",e,n.name)}}))}!function(){if("object"!=typeof globalThis)try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch(e){"undefined"!=typeof self&&(self.globalThis=self)}}();const Ym={url:"http://localhost:9999",storageKey:"supabase.auth.token",autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:zf,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function Jm(e,t,r){return await r()}const Zm={};class Qm{constructor(e){var t,r;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=Qm.nextInstanceID,Qm.nextInstanceID+=1,this.instanceID>0&&gm()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const n=Object.assign(Object.assign({},Ym),e);if(this.logDebugMessages=!!n.debug,"function"==typeof n.debug&&(this.logger=n.debug),this.persistSession=n.persistSession,this.storageKey=n.storageKey,this.autoRefreshToken=n.autoRefreshToken,this.admin=new Wm({url:n.url,headers:n.headers,fetch:n.fetch}),this.url=n.url,this.headers=n.headers,this.fetch=bm(n.fetch),this.lock=n.lock||Jm,this.detectSessionInUrl=n.detectSessionInUrl,this.flowType=n.flowType,this.hasCustomAuthorizationHeader=n.hasCustomAuthorizationHeader,n.lock?this.lock=n.lock:gm()&&(null===(t=null===globalThis||void 0===globalThis?void 0:globalThis.navigator)||void 0===t?void 0:t.locks)?this.lock=Xm:this.lock=Jm,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?(n.storage?this.storage=n.storage:vm()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=Hm(this.memoryStorage)),n.userStorage&&(this.userStorage=n.userStorage)):(this.memoryStorage={},this.storage=Hm(this.memoryStorage)),gm()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(a){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",a)}null===(r=this.broadcastChannel)||void 0===r||r.addEventListener("message",async e=>{this._debug("received broadcast notification from other tab or client",e),await this._notifyAllSubscribers(e.data.event,e.data.session,!1)})}this.initialize()}get jwks(){var e,t;return null!==(t=null===(e=Zm[this.storageKey])||void 0===e?void 0:e.jwks)&&void 0!==t?t:{keys:[]}}set jwks(e){Zm[this.storageKey]=Object.assign(Object.assign({},Zm[this.storageKey]),{jwks:e})}get jwks_cached_at(){var e,t;return null!==(t=null===(e=Zm[this.storageKey])||void 0===e?void 0:e.cachedAt)&&void 0!==t?t:Number.MIN_SAFE_INTEGER}set jwks_cached_at(e){Zm[this.storageKey]=Object.assign(Object.assign({},Zm[this.storageKey]),{cachedAt:e})}_debug(...e){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${Uf}) ${(new Date).toISOString()}`,...e),this}async initialize(){return this.initializePromise||(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))()),await this.initializePromise}async _initialize(){var e;try{const t=function(e){const t={},r=new URL(e);if(r.hash&&"#"===r.hash[0])try{new URLSearchParams(r.hash.substring(1)).forEach((e,r)=>{t[r]=e})}catch(n){}return r.searchParams.forEach((e,r)=>{t[r]=e}),t}(window.location.href);let r="none";if(this._isImplicitGrantCallback(t)?r="implicit":await this._isPKCECallback(t)&&(r="pkce"),gm()&&this.detectSessionInUrl&&"none"!==r){const{data:n,error:a}=await this._getSessionFromURL(t,r);if(a){if(this._debug("#_initialize()","error detecting session from URL",a),function(e){return qf(e)&&"AuthImplicitGrantRedirectError"===e.name}(a)){const t=null===(e=a.details)||void 0===e?void 0:e.code;if("identity_already_exists"===t||"identity_not_found"===t||"single_identity_not_deletable"===t)return{error:a}}return await this._removeSession(),{error:a}}const{session:s,redirectType:i}=n;return this._debug("#_initialize()","detected session in URL",s,"redirect type",i),await this._saveSession(s),setTimeout(async()=>{"recovery"===i?await this._notifyAllSubscribers("PASSWORD_RECOVERY",s):await this._notifyAllSubscribers("SIGNED_IN",s)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(t){return qf(t)?{error:t}:{error:new Xf("Unexpected error during initialization",t)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var t,r,n;try{const a=await Lm(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:null!==(r=null===(t=null==e?void 0:e.options)||void 0===t?void 0:t.data)&&void 0!==r?r:{},gotrue_meta_security:{captcha_token:null===(n=null==e?void 0:e.options)||void 0===n?void 0:n.captchaToken}},xform:Mm}),{data:s,error:i}=a;if(i||!s)return{data:{user:null,session:null},error:i};const o=s.session,l=s.user;return s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",o)),{data:{user:l,session:o},error:null}}catch(a){if(qf(a))return{data:{user:null,session:null},error:a};throw a}}async signUp(e){var t,r,n;try{let a;if("email"in e){const{email:r,password:n,options:s}=e;let i=null,o=null;"pkce"===this.flowType&&([i,o]=await Tm(this.storage,this.storageKey)),a=await Lm(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:null==s?void 0:s.emailRedirectTo,body:{email:r,password:n,data:null!==(t=null==s?void 0:s.data)&&void 0!==t?t:{},gotrue_meta_security:{captcha_token:null==s?void 0:s.captchaToken},code_challenge:i,code_challenge_method:o},xform:Mm})}else{if(!("phone"in e))throw new Qf("You must provide either an email or phone number and a password");{const{phone:t,password:s,options:i}=e;a=await Lm(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:t,password:s,data:null!==(r=null==i?void 0:i.data)&&void 0!==r?r:{},channel:null!==(n=null==i?void 0:i.channel)&&void 0!==n?n:"sms",gotrue_meta_security:{captcha_token:null==i?void 0:i.captchaToken}},xform:Mm})}}const{data:s,error:i}=a;if(i||!s)return{data:{user:null,session:null},error:i};const o=s.session,l=s.user;return s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",o)),{data:{user:l,session:o},error:null}}catch(a){if(qf(a))return{data:{user:null,session:null},error:a};throw a}}async signInWithPassword(e){try{let t;if("email"in e){const{email:r,password:n,options:a}=e;t=await Lm(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:r,password:n,gotrue_meta_security:{captcha_token:null==a?void 0:a.captchaToken}},xform:Fm})}else{if(!("phone"in e))throw new Qf("You must provide either an email or phone number and a password");{const{phone:r,password:n,options:a}=e;t=await Lm(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:r,password:n,gotrue_meta_security:{captcha_token:null==a?void 0:a.captchaToken}},xform:Fm})}}const{data:r,error:n}=t;return n?{data:{user:null,session:null},error:n}:r&&r.session&&r.user?(r.session&&(await this._saveSession(r.session),await this._notifyAllSubscribers("SIGNED_IN",r.session)),{data:Object.assign({user:r.user,session:r.session},r.weak_password?{weakPassword:r.weak_password}:null),error:n}):{data:{user:null,session:null},error:new Zf}}catch(t){if(qf(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOAuth(e){var t,r,n,a;return await this._handleProviderSignIn(e.provider,{redirectTo:null===(t=e.options)||void 0===t?void 0:t.redirectTo,scopes:null===(r=e.options)||void 0===r?void 0:r.scopes,queryParams:null===(n=e.options)||void 0===n?void 0:n.queryParams,skipBrowserRedirect:null===(a=e.options)||void 0===a?void 0:a.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async signInWithWeb3(e){const{chain:t}=e;if("solana"===t)return await this.signInWithSolana(e);throw new Error(`@supabase/auth-js: Unsupported chain "${t}"`)}async signInWithSolana(e){var t,r,n,a,s,i,o,l,c,d,u,h;let f,m;if("message"in e)f=e.message,m=e.signature;else{const{chain:u,wallet:h,statement:p,options:g}=e;let x;if(gm())if("object"==typeof h)x=h;else{const e=window;if(!("solana"in e)||"object"!=typeof e.solana||!("signIn"in e.solana&&"function"==typeof e.solana.signIn||"signMessage"in e.solana&&"function"==typeof e.solana.signMessage))throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.");x=e.solana}else{if("object"!=typeof h||!(null==g?void 0:g.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");x=h}const v=new URL(null!==(t=null==g?void 0:g.url)&&void 0!==t?t:window.location.href);if("signIn"in x&&x.signIn){const e=await x.signIn(Object.assign(Object.assign(Object.assign({issuedAt:(new Date).toISOString()},null==g?void 0:g.signInWithSolana),{version:"1",domain:v.host,uri:v.href}),p?{statement:p}:null));let t;if(Array.isArray(e)&&e[0]&&"object"==typeof e[0])t=e[0];else{if(!(e&&"object"==typeof e&&"signedMessage"in e&&"signature"in e))throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");t=e}if(!("signedMessage"in t&&"signature"in t&&("string"==typeof t.signedMessage||t.signedMessage instanceof Uint8Array)&&t.signature instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields");f="string"==typeof t.signedMessage?t.signedMessage:(new TextDecoder).decode(t.signedMessage),m=t.signature}else{if(!("signMessage"in x&&"function"==typeof x.signMessage&&"publicKey"in x&&"object"==typeof x&&x.publicKey&&"toBase58"in x.publicKey&&"function"==typeof x.publicKey.toBase58))throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");f=[`${v.host} wants you to sign in with your Solana account:`,x.publicKey.toBase58(),...p?["",p,""]:[""],"Version: 1",`URI: ${v.href}`,`Issued At: ${null!==(n=null===(r=null==g?void 0:g.signInWithSolana)||void 0===r?void 0:r.issuedAt)&&void 0!==n?n:(new Date).toISOString()}`,...(null===(a=null==g?void 0:g.signInWithSolana)||void 0===a?void 0:a.notBefore)?[`Not Before: ${g.signInWithSolana.notBefore}`]:[],...(null===(s=null==g?void 0:g.signInWithSolana)||void 0===s?void 0:s.expirationTime)?[`Expiration Time: ${g.signInWithSolana.expirationTime}`]:[],...(null===(i=null==g?void 0:g.signInWithSolana)||void 0===i?void 0:i.chainId)?[`Chain ID: ${g.signInWithSolana.chainId}`]:[],...(null===(o=null==g?void 0:g.signInWithSolana)||void 0===o?void 0:o.nonce)?[`Nonce: ${g.signInWithSolana.nonce}`]:[],...(null===(l=null==g?void 0:g.signInWithSolana)||void 0===l?void 0:l.requestId)?[`Request ID: ${g.signInWithSolana.requestId}`]:[],...(null===(d=null===(c=null==g?void 0:g.signInWithSolana)||void 0===c?void 0:c.resources)||void 0===d?void 0:d.length)?["Resources",...g.signInWithSolana.resources.map(e=>`- ${e}`)]:[]].join("\n");const e=await x.signMessage((new TextEncoder).encode(f),"utf8");if(!(e&&e instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");m=e}}try{const{data:t,error:r}=await Lm(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:f,signature:pm(m)},(null===(u=e.options)||void 0===u?void 0:u.captchaToken)?{gotrue_meta_security:{captcha_token:null===(h=e.options)||void 0===h?void 0:h.captchaToken}}:null),xform:Mm});if(r)throw r;return t&&t.session&&t.user?(t.session&&(await this._saveSession(t.session),await this._notifyAllSubscribers("SIGNED_IN",t.session)),{data:Object.assign({},t),error:r}):{data:{user:null,session:null},error:new Zf}}catch(p){if(qf(p))return{data:{user:null,session:null},error:p};throw p}}async _exchangeCodeForSession(e){const t=await wm(this.storage,`${this.storageKey}-code-verifier`),[r,n]=(null!=t?t:"").split("/");try{const{data:t,error:a}=await Lm(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:r},xform:Mm});if(await _m(this.storage,`${this.storageKey}-code-verifier`),a)throw a;return t&&t.session&&t.user?(t.session&&(await this._saveSession(t.session),await this._notifyAllSubscribers("SIGNED_IN",t.session)),{data:Object.assign(Object.assign({},t),{redirectType:null!=n?n:null}),error:a}):{data:{user:null,session:null,redirectType:null},error:new Zf}}catch(a){if(qf(a))return{data:{user:null,session:null,redirectType:null},error:a};throw a}}async signInWithIdToken(e){try{const{options:t,provider:r,token:n,access_token:a,nonce:s}=e,i=await Lm(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:r,id_token:n,access_token:a,nonce:s,gotrue_meta_security:{captcha_token:null==t?void 0:t.captchaToken}},xform:Mm}),{data:o,error:l}=i;return l?{data:{user:null,session:null},error:l}:o&&o.session&&o.user?(o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",o.session)),{data:o,error:l}):{data:{user:null,session:null},error:new Zf}}catch(t){if(qf(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOtp(e){var t,r,n,a,s;try{if("email"in e){const{email:n,options:a}=e;let s=null,i=null;"pkce"===this.flowType&&([s,i]=await Tm(this.storage,this.storageKey));const{error:o}=await Lm(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:n,data:null!==(t=null==a?void 0:a.data)&&void 0!==t?t:{},create_user:null===(r=null==a?void 0:a.shouldCreateUser)||void 0===r||r,gotrue_meta_security:{captcha_token:null==a?void 0:a.captchaToken},code_challenge:s,code_challenge_method:i},redirectTo:null==a?void 0:a.emailRedirectTo});return{data:{user:null,session:null},error:o}}if("phone"in e){const{phone:t,options:r}=e,{data:i,error:o}=await Lm(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:t,data:null!==(n=null==r?void 0:r.data)&&void 0!==n?n:{},create_user:null===(a=null==r?void 0:r.shouldCreateUser)||void 0===a||a,gotrue_meta_security:{captcha_token:null==r?void 0:r.captchaToken},channel:null!==(s=null==r?void 0:r.channel)&&void 0!==s?s:"sms"}});return{data:{user:null,session:null,messageId:null==i?void 0:i.message_id},error:o}}throw new Qf("You must provide either an email or phone number.")}catch(i){if(qf(i))return{data:{user:null,session:null},error:i};throw i}}async verifyOtp(e){var t,r;try{let n,a;"options"in e&&(n=null===(t=e.options)||void 0===t?void 0:t.redirectTo,a=null===(r=e.options)||void 0===r?void 0:r.captchaToken);const{data:s,error:i}=await Lm(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:a}}),redirectTo:n,xform:Mm});if(i)throw i;if(!s)throw new Error("An error occurred on token verification.");const o=s.session,l=s.user;return(null==o?void 0:o.access_token)&&(await this._saveSession(o),await this._notifyAllSubscribers("recovery"==e.type?"PASSWORD_RECOVERY":"SIGNED_IN",o)),{data:{user:l,session:o},error:null}}catch(n){if(qf(n))return{data:{user:null,session:null},error:n};throw n}}async signInWithSSO(e){var t,r,n;try{let a=null,s=null;return"pkce"===this.flowType&&([a,s]=await Tm(this.storage,this.storageKey)),await Lm(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:null!==(r=null===(t=e.options)||void 0===t?void 0:t.redirectTo)&&void 0!==r?r:void 0}),(null===(n=null==e?void 0:e.options)||void 0===n?void 0:n.captchaToken)?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:a,code_challenge_method:s}),headers:this.headers,xform:Bm})}catch(a){if(qf(a))return{data:null,error:a};throw a}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:t},error:r}=e;if(r)throw r;if(!t)throw new Jf;const{error:n}=await Lm(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:t.access_token});return{data:{user:null,session:null},error:n}})}catch(e){if(qf(e))return{data:{user:null,session:null},error:e};throw e}}async resend(e){try{const t=`${this.url}/resend`;if("email"in e){const{email:r,type:n,options:a}=e,{error:s}=await Lm(this.fetch,"POST",t,{headers:this.headers,body:{email:r,type:n,gotrue_meta_security:{captcha_token:null==a?void 0:a.captchaToken}},redirectTo:null==a?void 0:a.emailRedirectTo});return{data:{user:null,session:null},error:s}}if("phone"in e){const{phone:r,type:n,options:a}=e,{data:s,error:i}=await Lm(this.fetch,"POST",t,{headers:this.headers,body:{phone:r,type:n,gotrue_meta_security:{captcha_token:null==a?void 0:a.captchaToken}}});return{data:{user:null,session:null,messageId:null==s?void 0:s.message_id},error:i}}throw new Qf("You must provide either an email or phone number and a type")}catch(t){if(qf(t))return{data:{user:null,session:null},error:t};throw t}}async getSession(){await this.initializePromise;return await this._acquireLock(-1,async()=>this._useSession(async e=>e))}async _acquireLock(e,t){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const e=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),r=(async()=>(await e,await t()))();return this.pendingInLock.push((async()=>{try{await r}catch(e){}})()),r}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const e=t();for(this.pendingInLock.push((async()=>{try{await e}catch(t){}})()),await e;this.pendingInLock.length;){const e=[...this.pendingInLock];await Promise.all(e),this.pendingInLock.splice(0,e.length)}return await e}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const t=await this.__loadSession();return await e(t)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",(new Error).stack);try{let e=null;const t=await wm(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",t),null!==t&&(this._isValidSession(t)?e=t:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const r=!!e.expires_at&&1e3*e.expires_at-Date.now()<$f;if(this._debug("#__loadSession()",`session has${r?"":" not"} expired`,"expires_at",e.expires_at),!r){if(this.userStorage){const t=await wm(this.userStorage,this.storageKey+"-user");(null==t?void 0:t.user)?e.user=t.user:e.user=Om()}if(this.storage.isServer&&e.user){let t=this.suppressGetSessionWarning;e=new Proxy(e,{get:(e,r,n)=>(t||"user"!==r||(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),t=!0,this.suppressGetSessionWarning=!0),Reflect.get(e,r,n))})}return{data:{session:e},error:null}}const{session:n,error:a}=await this._callRefreshToken(e.refresh_token);return a?{data:{session:null},error:a}:{data:{session:n},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(e){if(e)return await this._getUser(e);await this.initializePromise;return await this._acquireLock(-1,async()=>await this._getUser())}async _getUser(e){try{return e?await Lm(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:Um}):await this._useSession(async e=>{var t,r,n;const{data:a,error:s}=e;if(s)throw s;return(null===(t=a.session)||void 0===t?void 0:t.access_token)||this.hasCustomAuthorizationHeader?await Lm(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:null!==(n=null===(r=a.session)||void 0===r?void 0:r.access_token)&&void 0!==n?n:void 0,xform:Um}):{data:{user:null},error:new Jf}})}catch(t){if(qf(t))return function(e){return qf(e)&&"AuthSessionMissingError"===e.name}(t)&&(await this._removeSession(),await _m(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:t};throw t}}async updateUser(e,t={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,t))}async _updateUser(e,t={}){try{return await this._useSession(async r=>{const{data:n,error:a}=r;if(a)throw a;if(!n.session)throw new Jf;const s=n.session;let i=null,o=null;"pkce"===this.flowType&&null!=e.email&&([i,o]=await Tm(this.storage,this.storageKey));const{data:l,error:c}=await Lm(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:null==t?void 0:t.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:i,code_challenge_method:o}),jwt:s.access_token,xform:Um});if(c)throw c;return s.user=l.user,await this._saveSession(s),await this._notifyAllSubscribers("USER_UPDATED",s),{data:{user:s.user},error:null}})}catch(r){if(qf(r))return{data:{user:null},error:r};throw r}}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new Jf;const t=Date.now()/1e3;let r=t,n=!0,a=null;const{payload:s}=Nm(e.access_token);if(s.exp&&(r=s.exp,n=r<=t),n){const{session:t,error:r}=await this._callRefreshToken(e.refresh_token);if(r)return{data:{user:null,session:null},error:r};if(!t)return{data:{user:null,session:null},error:null};a=t}else{const{data:n,error:s}=await this._getUser(e.access_token);if(s)throw s;a={access_token:e.access_token,refresh_token:e.refresh_token,user:n.user,token_type:"bearer",expires_in:r-t,expires_at:r},await this._saveSession(a),await this._notifyAllSubscribers("SIGNED_IN",a)}return{data:{user:a.user,session:a},error:null}}catch(t){if(qf(t))return{data:{session:null,user:null},error:t};throw t}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async t=>{var r;if(!e){const{data:n,error:a}=t;if(a)throw a;e=null!==(r=n.session)&&void 0!==r?r:void 0}if(!(null==e?void 0:e.refresh_token))throw new Jf;const{session:n,error:a}=await this._callRefreshToken(e.refresh_token);return a?{data:{user:null,session:null},error:a}:n?{data:{user:n.user,session:n},error:null}:{data:{user:null,session:null},error:null}})}catch(t){if(qf(t))return{data:{user:null,session:null},error:t};throw t}}async _getSessionFromURL(e,t){try{if(!gm())throw new em("No browser detected.");if(e.error||e.error_description||e.error_code)throw new em(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(t){case"implicit":if("pkce"===this.flowType)throw new tm("Not a valid PKCE flow url.");break;case"pkce":if("implicit"===this.flowType)throw new em("Not a valid implicit grant flow url.")}if("pkce"===t){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new tm("No code detected.");const{data:t,error:r}=await this._exchangeCodeForSession(e.code);if(r)throw r;const n=new URL(window.location.href);return n.searchParams.delete("code"),window.history.replaceState(window.history.state,"",n.toString()),{data:{session:t.session,redirectType:null},error:null}}const{provider_token:r,provider_refresh_token:n,access_token:a,refresh_token:s,expires_in:i,expires_at:o,token_type:l}=e;if(!(a&&i&&s&&l))throw new em("No session defined in URL");const c=Math.round(Date.now()/1e3),d=parseInt(i);let u=c+d;o&&(u=parseInt(o));const h=u-c;1e3*h<=Bf&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${h}s, should have been closer to ${d}s`);const f=u-d;c-f>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",f,u,c):c-f<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",f,u,c);const{data:m,error:p}=await this._getUser(a);if(p)throw p;const g={provider_token:r,provider_refresh_token:n,access_token:a,expires_in:d,expires_at:u,refresh_token:s,token_type:l,user:m.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:g,redirectType:e.type},error:null}}catch(r){if(qf(r))return{data:{session:null,redirectType:null},error:r};throw r}}_isImplicitGrantCallback(e){return Boolean(e.access_token||e.error_description)}async _isPKCECallback(e){const t=await wm(this.storage,`${this.storageKey}-code-verifier`);return!(!e.code||!t)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async t=>{var r;const{data:n,error:a}=t;if(a)return{error:a};const s=null===(r=n.session)||void 0===r?void 0:r.access_token;if(s){const{error:t}=await this.admin.signOut(s,e);if(t&&(!function(e){return qf(e)&&"AuthApiError"===e.name}(t)||404!==t.status&&401!==t.status&&403!==t.status))return{error:t}}return"others"!==e&&(await this._removeSession(),await _m(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(e){const t="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){const t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)}),r={id:t,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",t),this.stateChangeEmitters.delete(t)}};return this._debug("#onAuthStateChange()","registered callback with id",t),this.stateChangeEmitters.set(t,r),(async()=>{await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(t)})})(),{data:{subscription:r}}}async _emitInitialSession(e){return await this._useSession(async t=>{var r,n;try{const{data:{session:n},error:a}=t;if(a)throw a;await(null===(r=this.stateChangeEmitters.get(e))||void 0===r?void 0:r.callback("INITIAL_SESSION",n)),this._debug("INITIAL_SESSION","callback id",e,"session",n)}catch(a){await(null===(n=this.stateChangeEmitters.get(e))||void 0===n?void 0:n.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",a),console.error(a)}})}async resetPasswordForEmail(e,t={}){let r=null,n=null;"pkce"===this.flowType&&([r,n]=await Tm(this.storage,this.storageKey,!0));try{return await Lm(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:r,code_challenge_method:n,gotrue_meta_security:{captcha_token:t.captchaToken}},headers:this.headers,redirectTo:t.redirectTo})}catch(a){if(qf(a))return{data:null,error:a};throw a}}async getUserIdentities(){var e;try{const{data:t,error:r}=await this.getUser();if(r)throw r;return{data:{identities:null!==(e=t.user.identities)&&void 0!==e?e:[]},error:null}}catch(t){if(qf(t))return{data:null,error:t};throw t}}async linkIdentity(e){var t;try{const{data:r,error:n}=await this._useSession(async t=>{var r,n,a,s,i;const{data:o,error:l}=t;if(l)throw l;const c=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:null===(r=e.options)||void 0===r?void 0:r.redirectTo,scopes:null===(n=e.options)||void 0===n?void 0:n.scopes,queryParams:null===(a=e.options)||void 0===a?void 0:a.queryParams,skipBrowserRedirect:!0});return await Lm(this.fetch,"GET",c,{headers:this.headers,jwt:null!==(i=null===(s=o.session)||void 0===s?void 0:s.access_token)&&void 0!==i?i:void 0})});if(n)throw n;return gm()&&!(null===(t=e.options)||void 0===t?void 0:t.skipBrowserRedirect)&&window.location.assign(null==r?void 0:r.url),{data:{provider:e.provider,url:null==r?void 0:r.url},error:null}}catch(r){if(qf(r))return{data:{provider:e.provider,url:null},error:r};throw r}}async unlinkIdentity(e){try{return await this._useSession(async t=>{var r,n;const{data:a,error:s}=t;if(s)throw s;return await Lm(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:null!==(n=null===(r=a.session)||void 0===r?void 0:r.access_token)&&void 0!==n?n:void 0})})}catch(t){if(qf(t))return{data:null,error:t};throw t}}async _refreshAccessToken(e){const t=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(t,"begin");try{const a=Date.now();return await(r=async r=>(r>0&&await async function(e){return await new Promise(t=>{setTimeout(()=>t(null),e)})}(200*Math.pow(2,r-1)),this._debug(t,"refreshing attempt",r),await Lm(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:Mm})),n=(e,t)=>{const r=200*Math.pow(2,e);return t&&nm(t)&&Date.now()+r-a<Bf},new Promise((e,t)=>{(async()=>{for(let s=0;s<1/0;s++)try{const t=await r(s);if(!n(s,null,t))return void e(t)}catch(a){if(!n(s,a))return void t(a)}})()}))}catch(a){if(this._debug(t,"error",a),qf(a))return{data:{session:null,user:null},error:a};throw a}finally{this._debug(t,"end")}var r,n}_isValidSession(e){return"object"==typeof e&&null!==e&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,t){const r=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:t.redirectTo,scopes:t.scopes,queryParams:t.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",t,"url",r),gm()&&!t.skipBrowserRedirect&&window.location.assign(r),{data:{provider:e,url:r},error:null}}async _recoverAndRefresh(){var e,t;const r="#_recoverAndRefresh()";this._debug(r,"begin");try{const a=await wm(this.storage,this.storageKey);if(a&&this.userStorage){let t=await wm(this.userStorage,this.storageKey+"-user");this.storage.isServer||!Object.is(this.storage,this.userStorage)||t||(t={user:a.user},await ym(this.userStorage,this.storageKey+"-user",t)),a.user=null!==(e=null==t?void 0:t.user)&&void 0!==e?e:Om()}else if(a&&!a.user&&!a.user){const e=await wm(this.storage,this.storageKey+"-user");e&&(null==e?void 0:e.user)?(a.user=e.user,await _m(this.storage,this.storageKey+"-user"),await ym(this.storage,this.storageKey,a)):a.user=Om()}if(this._debug(r,"session from storage",a),!this._isValidSession(a))return this._debug(r,"session is not valid"),void(null!==a&&await this._removeSession());const s=1e3*(null!==(t=a.expires_at)&&void 0!==t?t:1/0)-Date.now()<$f;if(this._debug(r,`session has${s?"":" not"} expired with margin of 90000s`),s){if(this.autoRefreshToken&&a.refresh_token){const{error:e}=await this._callRefreshToken(a.refresh_token);e&&(console.error(e),nm(e)||(this._debug(r,"refresh failed with a non-retryable error, removing the session",e),await this._removeSession()))}}else if(a.user&&!0===a.user.__isUserNotAvailableProxy)try{const{data:e,error:t}=await this._getUser(a.access_token);!t&&(null==e?void 0:e.user)?(a.user=e.user,await this._saveSession(a),await this._notifyAllSubscribers("SIGNED_IN",a)):this._debug(r,"could not get user data, skipping SIGNED_IN notification")}catch(n){console.error("Error getting user data:",n),this._debug(r,"error getting user data, skipping SIGNED_IN notification",n)}else await this._notifyAllSubscribers("SIGNED_IN",a)}catch(a){return this._debug(r,"error",a),void console.error(a)}finally{this._debug(r,"end")}}async _callRefreshToken(e){var t,r;if(!e)throw new Jf;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const n=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(n,"begin");try{this.refreshingDeferred=new km;const{data:t,error:r}=await this._refreshAccessToken(e);if(r)throw r;if(!t.session)throw new Jf;await this._saveSession(t.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",t.session);const n={session:t.session,error:null};return this.refreshingDeferred.resolve(n),n}catch(a){if(this._debug(n,"error",a),qf(a)){const e={session:null,error:a};return nm(a)||await this._removeSession(),null===(t=this.refreshingDeferred)||void 0===t||t.resolve(e),e}throw null===(r=this.refreshingDeferred)||void 0===r||r.reject(a),a}finally{this.refreshingDeferred=null,this._debug(n,"end")}}async _notifyAllSubscribers(e,t,r=!0){const n=`#_notifyAllSubscribers(${e})`;this._debug(n,"begin",t,`broadcast = ${r}`);try{this.broadcastChannel&&r&&this.broadcastChannel.postMessage({event:e,session:t});const n=[],a=Array.from(this.stateChangeEmitters.values()).map(async r=>{try{await r.callback(e,t)}catch(a){n.push(a)}});if(await Promise.all(a),n.length>0){for(let e=0;e<n.length;e+=1)console.error(n[e]);throw n[0]}}finally{this._debug(n,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0;const t=Object.assign({},e),r=t.user&&!0===t.user.__isUserNotAvailableProxy;if(this.userStorage){!r&&t.user&&await ym(this.userStorage,this.storageKey+"-user",{user:t.user});const e=Object.assign({},t);delete e.user;const n=Im(e);await ym(this.storage,this.storageKey,n)}else{const e=Im(t);await ym(this.storage,this.storageKey,e)}}async _removeSession(){this._debug("#_removeSession()"),await _m(this.storage,this.storageKey),await _m(this.storage,this.storageKey+"-code-verifier"),await _m(this.storage,this.storageKey+"-user"),this.userStorage&&await _m(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&gm()&&(null===window||void 0===window?void 0:window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(t){console.error("removing visibilitychange callback failed",t)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),Bf);this.autoRefreshTicker=e,e&&"object"==typeof e&&"function"==typeof e.unref?e.unref():"undefined"!=typeof Deno&&"function"==typeof Deno.unrefTimer&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const t=Date.now();try{return await this._useSession(async e=>{const{data:{session:r}}=e;if(!r||!r.refresh_token||!r.expires_at)return void this._debug("#_autoRefreshTokenTick()","no session");const n=Math.floor((1e3*r.expires_at-t)/Bf);this._debug("#_autoRefreshTokenTick()",`access token expires in ${n} ticks, a tick lasts 30000ms, refresh threshold is 3 ticks`),n<=3&&await this._callRefreshToken(r.refresh_token)})}catch(e){console.error("Auto refresh tick failed with error. This is likely a transient error.",e)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(!(e.isAcquireTimeout||e instanceof qm))throw e;this._debug("auto refresh token tick lock not available")}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!gm()||!(null===window||void 0===window?void 0:window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),null===window||void 0===window||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const t=`#_onVisibilityChanged(${e})`;this._debug(t,"visibilityState",document.visibilityState),"visible"===document.visibilityState?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{"visible"===document.visibilityState?await this._recoverAndRefresh():this._debug(t,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting")}))):"hidden"===document.visibilityState&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,t,r){const n=[`provider=${encodeURIComponent(t)}`];if((null==r?void 0:r.redirectTo)&&n.push(`redirect_to=${encodeURIComponent(r.redirectTo)}`),(null==r?void 0:r.scopes)&&n.push(`scopes=${encodeURIComponent(r.scopes)}`),"pkce"===this.flowType){const[e,t]=await Tm(this.storage,this.storageKey),r=new URLSearchParams({code_challenge:`${encodeURIComponent(e)}`,code_challenge_method:`${encodeURIComponent(t)}`});n.push(r.toString())}if(null==r?void 0:r.queryParams){const e=new URLSearchParams(r.queryParams);n.push(e.toString())}return(null==r?void 0:r.skipBrowserRedirect)&&n.push(`skip_http_redirect=${r.skipBrowserRedirect}`),`${e}?${n.join("&")}`}async _unenroll(e){try{return await this._useSession(async t=>{var r;const{data:n,error:a}=t;return a?{data:null,error:a}:await Lm(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:null===(r=null==n?void 0:n.session)||void 0===r?void 0:r.access_token})})}catch(t){if(qf(t))return{data:null,error:t};throw t}}async _enroll(e){try{return await this._useSession(async t=>{var r,n;const{data:a,error:s}=t;if(s)return{data:null,error:s};const i=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},"phone"===e.factorType?{phone:e.phone}:{issuer:e.issuer}),{data:o,error:l}=await Lm(this.fetch,"POST",`${this.url}/factors`,{body:i,headers:this.headers,jwt:null===(r=null==a?void 0:a.session)||void 0===r?void 0:r.access_token});return l?{data:null,error:l}:("totp"===e.factorType&&(null===(n=null==o?void 0:o.totp)||void 0===n?void 0:n.qr_code)&&(o.totp.qr_code=`data:image/svg+xml;utf-8,${o.totp.qr_code}`),{data:o,error:null})})}catch(t){if(qf(t))return{data:null,error:t};throw t}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var r;const{data:n,error:a}=t;if(a)return{data:null,error:a};const{data:s,error:i}=await Lm(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:{code:e.code,challenge_id:e.challengeId},headers:this.headers,jwt:null===(r=null==n?void 0:n.session)||void 0===r?void 0:r.access_token});return i?{data:null,error:i}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+s.expires_in},s)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",s),{data:s,error:i})})}catch(t){if(qf(t))return{data:null,error:t};throw t}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var r;const{data:n,error:a}=t;return a?{data:null,error:a}:await Lm(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:{channel:e.channel},headers:this.headers,jwt:null===(r=null==n?void 0:n.session)||void 0===r?void 0:r.access_token})})}catch(t){if(qf(t))return{data:null,error:t};throw t}})}async _challengeAndVerify(e){const{data:t,error:r}=await this._challenge({factorId:e.factorId});return r?{data:null,error:r}:await this._verify({factorId:e.factorId,challengeId:t.id,code:e.code})}async _listFactors(){const{data:{user:e},error:t}=await this.getUser();if(t)return{data:null,error:t};const r=(null==e?void 0:e.factors)||[],n=r.filter(e=>"totp"===e.factor_type&&"verified"===e.status),a=r.filter(e=>"phone"===e.factor_type&&"verified"===e.status);return{data:{all:r,totp:n,phone:a},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async e=>{var t,r;const{data:{session:n},error:a}=e;if(a)return{data:null,error:a};if(!n)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:s}=Nm(n.access_token);let i=null;s.aal&&(i=s.aal);let o=i;(null!==(r=null===(t=n.user.factors)||void 0===t?void 0:t.filter(e=>"verified"===e.status))&&void 0!==r?r:[]).length>0&&(o="aal2");return{data:{currentLevel:i,nextLevel:o,currentAuthenticationMethods:s.amr||[]},error:null}}))}async fetchJwk(e,t={keys:[]}){let r=t.keys.find(t=>t.kid===e);if(r)return r;const n=Date.now();if(r=this.jwks.keys.find(t=>t.kid===e),r&&this.jwks_cached_at+6e5>n)return r;const{data:a,error:s}=await Lm(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(s)throw s;return a.keys&&0!==a.keys.length?(this.jwks=a,this.jwks_cached_at=n,r=a.keys.find(t=>t.kid===e),r||null):null}async getClaims(e,t={}){try{let r=e;if(!r){const{data:e,error:t}=await this.getSession();if(t||!e.session)return{data:null,error:t};r=e.session.access_token}const{header:n,payload:a,signature:s,raw:{header:i,payload:o}}=Nm(r);(null==t?void 0:t.allowExpired)||function(e){if(!e)throw new Error("Missing exp claim");if(e<=Math.floor(Date.now()/1e3))throw new Error("JWT has expired")}(a.exp);const l=n.alg&&!n.alg.startsWith("HS")&&n.kid&&"crypto"in globalThis&&"subtle"in globalThis.crypto?await this.fetchJwk(n.kid,(null==t?void 0:t.keys)?{keys:t.keys}:null==t?void 0:t.jwks):null;if(!l){const{error:e}=await this.getUser(r);if(e)throw e;return{data:{claims:a,header:n,signature:s},error:null}}const c=function(e){switch(e){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}(n.alg),d=await crypto.subtle.importKey("jwk",l,c,!0,["verify"]);if(!(await crypto.subtle.verify(c,d,s,mm(`${i}.${o}`))))throw new sm("Invalid JWT signature");return{data:{claims:a,header:n,signature:s},error:null}}catch(r){if(qf(r))return{data:null,error:r};throw r}}}Qm.nextInstanceID=0;const ep=Qm;class tp extends ep{constructor(e){super(e)}}var rp=function(e,t,r,n){return new(r||(r=Promise))(function(a,s){function i(e){try{l(n.next(e))}catch(t){s(t)}}function o(e){try{l(n.throw(e))}catch(t){s(t)}}function l(e){var t;e.done?a(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(i,o)}l((n=n.apply(e,t||[])).next())})};class np{constructor(e,t,r){var n,a,s;if(this.supabaseUrl=e,this.supabaseKey=t,!e)throw new Error("supabaseUrl is required.");if(!t)throw new Error("supabaseKey is required.");const i=(o=e).endsWith("/")?o:o+"/";var o;const l=new URL(i);this.realtimeUrl=new URL("realtime/v1",l),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",l),this.storageUrl=new URL("storage/v1",l),this.functionsUrl=new URL("functions/v1",l);const c=`sb-${l.hostname.split(".")[0]}-auth-token`,d=function(e,t){var r,n;const{db:a,auth:s,realtime:i,global:o}=e,{db:l,auth:c,realtime:d,global:u}=t,h={db:Object.assign(Object.assign({},l),a),auth:Object.assign(Object.assign({},c),s),realtime:Object.assign(Object.assign({},d),i),storage:{},global:Object.assign(Object.assign(Object.assign({},u),o),{headers:Object.assign(Object.assign({},null!==(r=null==u?void 0:u.headers)&&void 0!==r?r:{}),null!==(n=null==o?void 0:o.headers)&&void 0!==n?n:{})}),accessToken:()=>Ff(this,void 0,void 0,function*(){return""})};return e.accessToken?h.accessToken=e.accessToken:delete h.accessToken,h}(null!=r?r:{},{db:Rf,realtime:Df,auth:Object.assign(Object.assign({},Pf),{storageKey:c}),global:If});this.storageKey=null!==(n=d.auth.storageKey)&&void 0!==n?n:"",this.headers=null!==(a=d.global.headers)&&void 0!==a?a:{},d.accessToken?(this.accessToken=d.accessToken,this.auth=new Proxy({},{get:(e,t)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(t)} is not possible`)}})):this.auth=this._initSupabaseAuthClient(null!==(s=d.auth)&&void 0!==s?s:{},this.headers,d.global.fetch),this.fetch=Mf(t,this._getAccessToken.bind(this),d.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},d.realtime)),this.rest=new hh(new URL("rest/v1",l).href,{headers:this.headers,schema:d.db.schema,fetch:this.fetch}),this.storage=new Af(this.storageUrl.href,this.headers,this.fetch,null==r?void 0:r.storage),d.accessToken||this._listenForAuthEvents()}get functions(){return new ku(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,t={},r={}){return this.rest.rpc(e,t,r)}channel(e,t={config:{}}){return this.realtime.channel(e,t)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var e,t;return rp(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:r}=yield this.auth.getSession();return null!==(t=null===(e=r.session)||void 0===e?void 0:e.access_token)&&void 0!==t?t:this.supabaseKey})}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,storage:n,storageKey:a,flowType:s,lock:i,debug:o},l,c){const d={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new tp({url:this.authUrl.href,headers:Object.assign(Object.assign({},d),l),storageKey:a,autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,storage:n,flowType:s,lock:i,debug:o,fetch:c,hasCustomAuthorizationHeader:"Authorization"in this.headers})}_initRealtimeClient(e){return new sf(this.realtimeUrl.href,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},null==e?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((e,t)=>{this._handleTokenChanged(e,"CLIENT",null==t?void 0:t.access_token)})}_handleTokenChanged(e,t,r){"TOKEN_REFRESHED"!==e&&"SIGNED_IN"!==e||this.changedAccessToken===r?"SIGNED_OUT"===e&&(this.realtime.setAuth(),"STORAGE"==t&&this.auth.signOut(),this.changedAccessToken=void 0):this.changedAccessToken=r}}const ap=(e,t,r)=>new np(e,t,r);(function(){if("undefined"!=typeof window)return!1;if("undefined"==typeof process)return!1;const e=process.version;if(null==e)return!1;const t=e.match(/^v(\d+)\./);return!!t&&parseInt(t[1],10)<=18})()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const sp=ap("https://pfkqocxbvnfebuhrjnxm.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InBma3FvY3hidm5mZWJ1aHJqbnhtIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTI0OTMwNjksImV4cCI6MjA2ODA2OTA2OX0.B-IoA9SkLH8tmj9xXObklN9PmDj1jnj9B9lpChDDgMM"),ip={async getAccounts(){try{const{data:e,error:t}=await sp.from("app_5c098b55fc88465db9b331c43b51ef43_advertising_accounts").select("*").order("account_name");if(t)throw t;return e||[]}catch(e){return console.error("Error fetching accounts:",e),this.getLocalAccounts()}},async createAccount(e){try{const{data:t,error:r}=await sp.from("app_5c098b55fc88465db9b331c43b51ef43_advertising_accounts").insert([e]).select();if(r)throw r;return t[0]}catch(t){return console.error("Error creating account:",t),this.createLocalAccount(e)}},async addAccount(e){try{console.log(":",e);const{data:t,error:r}=await sp.from("app_5c098b55fc88465db9b331c43b51ef43_advertising_accounts").insert([{account_id:e.account_id,account_name:e.account_name,balance:e.balance||0,created_at:e.created_at||(new Date).toISOString()}]).select();if(r)throw console.error(":",r),r;return console.log(":",t),t[0]}catch(t){return console.error("Error adding account:",t),this.createLocalAccount(e)}},async updateAccountBalance(e,t){try{console.log(":",{accountId:e,newBalance:t});const{data:r,error:n}=await sp.from("app_5c098b55fc88465db9b331c43b51ef43_advertising_accounts").update({balance:t,updated_at:(new Date).toISOString()}).eq("account_id",e).select();if(n)throw console.error(":",n),n;return console.log(":",r),r[0]}catch(r){return console.error("Error updating balance:",r),this.updateLocalBalance(e,t)}},getLocalAccounts(){const e=localStorage.getItem("advertising_accounts");return e?JSON.parse(e):[{account_name:"",account_id:"QING_001",balance:0},{account_name:"",account_id:"QIAO_002",balance:0},{account_name:"",account_id:"BAI_003",balance:0},{account_name:"",account_id:"DING_004",balance:0},{account_name:"",account_id:"MEI_005",balance:0}]},createLocalAccount(e){const t=this.getLocalAccounts(),r={...e,id:Date.now().toString(),created_at:(new Date).toISOString()};return t.push(r),localStorage.setItem("advertising_accounts",JSON.stringify(t)),r},updateLocalBalance(e,t){const r=this.getLocalAccounts(),n=r.findIndex(t=>t.account_id===e);return-1!==n?(r[n].balance=t,r[n].updated_at=(new Date).toISOString(),localStorage.setItem("advertising_accounts",JSON.stringify(r)),r[n]):null}},op=async()=>{try{const{data:e,error:t}=await sp.from("app_5c098b55fc88465db9b331c43b51ef43_advertising_data").select("*").order("date",{ascending:!1});if(t)throw t;return(e||[]).map(e=>({id:e.id,date:e.date,advertiser:e.advertiser,account_name:e.account_id,account_id:e.account_id,ad_spend:e.spend_amount||e.usd_amount||0,credit_card_amount:e.credit_card_amount||0,payment_info_count:e.payment_info_count||0,credit_card_orders:e.credit_card_orders||0,created_at:e.created_at}))}catch(e){return console.error("Error fetching ad data:",e),cp.getLocalAdvertisingData()}},lp={async addRecharge(e){try{console.log(":",e);const{data:t,error:r}=await sp.from("app_5c098b55fc88465db9b331c43b51ef43_recharge_records").insert([e]).select();if(r)throw console.error(":",r),r;return console.log(":",t),t[0]}catch(t){throw console.error("Error adding recharge:",t),t}},async getRechargeRecords(){try{const{data:e,error:t}=await sp.from("app_5c098b55fc88465db9b331c43b51ef43_recharge_records").select("*").order("created_at",{ascending:!1});if(t)throw console.log(":",t),t;return e||[]}catch(e){return console.log("Error fetching recharge records:",e),[]}},async deleteRecharge(e){try{const{error:t}=await sp.from("app_5c098b55fc88465db9b331c43b51ef43_recharge_records").delete().eq("id",e);if(t)throw console.error(":",t),t;return console.log(":",e),!0}catch(t){throw console.error("Error deleting recharge record:",t),t}},async getRechargeHistory(e=null){try{let t=sp.from("app_5c098b55fc88465db9b331c43b51ef43_recharge_records").select("*").order("created_at",{ascending:!1});e&&(t=t.eq("account_id",e));const{data:r,error:n}=await t;if(n)throw n;return r||[]}catch(t){return console.error("Error fetching recharge history:",t),this.getLocalRechargeHistory(e)}},addLocalRecharge(e){const t=this.getLocalRechargeHistory(),r={...e,id:Date.now().toString(),created_at:(new Date).toISOString()};return t.unshift(r),localStorage.setItem("recharge_records",JSON.stringify(t)),ip.updateLocalBalance(e.account_id,e.new_balance),r},getLocalRechargeHistory(e=null){const t=localStorage.getItem("recharge_records"),r=t?JSON.parse(t):[];return e?r.filter(t=>t.account_id===e):r},async getRecharges(){try{const{data:e,error:t}=await sp.from("app_5c098b55fc88465db9b331c43b51ef43_recharge_records").select("*").order("created_at",{ascending:!1});if(t)throw t;return e||[]}catch(e){return console.error("Error fetching recharges:",e),this.getLocalRechargeHistory()}}},cp={async addAdvertisingData(e){try{const{data:t,error:r}=await sp.from("app_5c098b55fc88465db9b331c43b51ef43_advertising_data").insert([e]).select();if(r)throw r;return t[0]}catch(t){return console.error("Error adding advertising data:",t),this.addLocalAdvertisingData(e)}},async getAdvertisingData(e={}){try{let t=sp.from("app_5c098b55fc88465db9b331c43b51ef43_advertising_data").select("*").order("date",{ascending:!1});e.account_id&&(t=t.eq("account_id",e.account_id)),e.advertiser&&(t=t.eq("advertiser",e.advertiser)),e.start_date&&(t=t.gte("date",e.start_date)),e.end_date&&(t=t.lte("date",e.end_date));const{data:r,error:n}=await t;if(n)throw n;return r||[]}catch(t){return console.error("Error fetching advertising data:",t),this.getLocalAdvertisingData(e)}},addLocalAdvertisingData(e){const t=this.getLocalAdvertisingData(),r={...e,id:Date.now().toString(),created_at:(new Date).toISOString(),updated_at:(new Date).toISOString()};return t.unshift(r),localStorage.setItem("advertising_data",JSON.stringify(t)),r},getLocalAdvertisingData(e={}){const t=localStorage.getItem("advertising_data");let r=t?JSON.parse(t):[];return e.account_id&&(r=r.filter(t=>t.account_id===e.account_id)),e.advertiser&&(r=r.filter(t=>t.advertiser===e.advertiser)),e.start_date&&(r=r.filter(t=>t.date>=e.start_date)),e.end_date&&(r=r.filter(t=>t.date<=e.end_date)),r}},dp={async addDailyOrder(e){try{console.log(":",e);const t={date:e.date,new_card_amount:parseFloat(e.new_card_amount||0),old_card_amount:parseFloat(e.old_card_amount||0),exchange_rate:parseFloat(e.exchange_rate||20),description:e.description||"",advertiser:"system",created_at:(new Date).toISOString()};console.log(":",t);const{data:r,error:n}=await sp.from("app_5c098b55fc88465db9b331c43b51ef43_daily_orders").insert([t]).select();if(n){console.error(":",n);let e="";throw e="23502"===n.code?"":"23505"===n.code?"":`: ${n.message}`,new Error(e)}return console.log(":",r),r[0]}catch(t){throw console.error("Error adding daily order:",t),t}},async getDailyOrders(){try{const{data:e,error:t}=await sp.from("app_5c098b55fc88465db9b331c43b51ef43_daily_orders").select("*").order("created_at",{ascending:!1});if(t)throw console.log(":",t),t;return e||[]}catch(e){return console.log("Error fetching daily orders:",e),[]}},async deleteDailyOrder(e){try{const{error:t}=await sp.from("app_5c098b55fc88465db9b331c43b51ef43_daily_orders").delete().eq("id",e);if(t)throw console.error(":",t),t;return console.log(":",e),!0}catch(t){throw console.error("Error deleting daily order:",t),t}}},up=ap("https://pfkqocxbvnfebuhrjnxm.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InBma3FvY3hidm5mZWJ1aHJqbnhtIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTI0OTMwNjksImV4cCI6MjA2ODA2OTA2OX0.B-IoA9SkLH8tmj9xXObklN9PmDj1jnj9B9lpChDDgMM"),hp={AD_DATA_ENTRIES:"app_e87b41cfe355428b8146f8bae8184e10_ad_data_entries"},fp={async getAll(){const{data:e,error:t}=await up.from(hp.AD_DATA_ENTRIES).select("*").order("date",{ascending:!1});if(t)throw t;return e},async upsert(e){const t={date:e.date,staff:e.staff,ad_spend:e.adSpend,credit_card_amount:e.creditCardOrders,payment_info_count:e.paymentInfoCount,credit_card_orders:e.orderCount,updated_at:(new Date).toISOString()};let r,n;if(e.id?({data:r,error:n}=await up.from(hp.AD_DATA_ENTRIES).update(t).eq("id",e.id).select()):({data:r,error:n}=await up.from(hp.AD_DATA_ENTRIES).upsert(t,{onConflict:"date,staff",ignoreDuplicates:!1}).select()),n)throw n;return r[0]},async delete(e){const{error:t}=await up.from(hp.AD_DATA_ENTRIES).delete().eq("id",e);if(t)throw t}},mp={async getDashboardData(){const{data:e,error:t}=await sp.from("dashboard_data").select("*").order("updated_at",{ascending:!1}).limit(1);if(t)throw console.error("Supabase error fetching dashboard data:",t),new Error(`: ${t.message}`);if(!e||0===e.length){const e=this.getDefaultDashboardData();return await this.updateDashboardData(e),e}return e[0].data},async updateDashboardData(e){var t,r;const{data:n}=await sp.from("dashboard_data").select("*").limit(1);if(n&&n.length>0){const{data:r,error:a}=await sp.from("dashboard_data").update({data:e,updated_at:(new Date).toISOString()}).eq("id",n[0].id).select();if(a)throw console.error("Supabase error updating dashboard data:",a),new Error(`: ${a.message}`);return null==(t=null==r?void 0:r[0])?void 0:t.data}{const{data:t,error:n}=await sp.from("dashboard_data").insert([{data:e,created_at:(new Date).toISOString(),updated_at:(new Date).toISOString()}]).select();if(n)throw console.error("Supabase error creating dashboard data:",n),new Error(`: ${n.message}`);return null==(r=null==t?void 0:t[0])?void 0:r.data}},getDefaultDashboardData:()=>({totalRevenue:2847592,totalCost:1523847,accountsActive:15,conversionRate:3.24,recentTransactions:[{id:1,advertiser:"",amount:15420,type:"revenue",timestamp:(new Date).toISOString()},{id:2,advertiser:"",amount:-8200,type:"cost",timestamp:(new Date).toISOString()},{id:3,advertiser:"",amount:23100,type:"revenue",timestamp:(new Date).toISOString()},{id:4,advertiser:"",amount:-5680,type:"cost",timestamp:(new Date).toISOString()},{id:5,advertiser:"",amount:18900,type:"revenue",timestamp:(new Date).toISOString()}],melonWinners:[{id:1,advertiser:"",revenue:345200,roi:4.2},{id:2,advertiser:"",revenue:289400,roi:3.8},{id:3,advertiser:"",revenue:267800,roi:3.6}]})},pp=()=>{const[e,t]=W.useState([]),[r,n]=W.useState(!0),[a,s]=W.useState(new Set),[i,o]=W.useState(new Set),[l,c]=W.useState((new Date).toISOString().split("T")[0]),[d,u]=W.useState((new Date).toISOString().split("T")[0]),[h,f]=W.useState([]),[m,p]=W.useState(null),[g,x]=W.useState("auto");W.useEffect(()=>{v()},[]),W.useEffect(()=>{b()},[e,l,d]);const v=async()=>{try{n(!0);const e=await fp.getAll(),r={};e.forEach(e=>{const t=`${e.date}_${e.staff}`;r[t]||(r[t]={date:e.date,advertiser:e.staff,ad_spend:0,credit_card_amount:0,payment_info_count:0,credit_card_orders:0,cost_per_payment_info:0,cost_per_order:0,records:[]});const n=r[t];n.ad_spend+=parseFloat(e.ad_spend||0),n.credit_card_amount+=parseFloat(e.credit_card_amount||0),n.payment_info_count+=parseInt(e.payment_info_count||0),n.credit_card_orders+=parseInt(e.credit_card_orders||0),n.records.push(e)}),Object.values(r).forEach(e=>{e.cost_per_payment_info=e.payment_info_count>0?e.ad_spend/e.payment_info_count:0,e.cost_per_order=e.credit_card_orders>0?e.ad_spend/e.credit_card_orders:0});const a=Object.values(r).sort((e,t)=>new Date(t.date)-new Date(e.date));t(a)}catch(e){console.error("Error loading daily stats:",e),t([])}finally{n(!1)}},b=()=>{if(!e.length)return f([]),void p(null);const t=e.filter(e=>{const t=e.date;return t>=l&&t<=d});if(f(t),t.length>0){const e={};["","","","",""].forEach(r=>{const n=t.filter(e=>e.advertiser===r);if(n.length>0){e[r]={advertiser:r,totalAdSpend:n.reduce((e,t)=>e+t.ad_spend,0),totalCreditCardAmount:n.reduce((e,t)=>e+t.credit_card_amount,0),totalPaymentInfoCount:n.reduce((e,t)=>e+t.payment_info_count,0),totalCreditCardOrders:n.reduce((e,t)=>e+t.credit_card_orders,0),daysCount:n.length,avgCostPerPaymentInfo:0,avgCostPerOrder:0,roi:0};const t=e[r];t.avgCostPerPaymentInfo=t.totalPaymentInfoCount>0?t.totalAdSpend/t.totalPaymentInfoCount:0,t.avgCostPerOrder=t.totalCreditCardOrders>0?t.totalAdSpend/t.totalCreditCardOrders:0;const a=20,s=t.totalCreditCardAmount/a;t.roi=t.totalAdSpend>0?s/t.totalAdSpend:0}});const r={totalAdSpend:t.reduce((e,t)=>e+t.ad_spend,0),totalCreditCardAmount:t.reduce((e,t)=>e+t.credit_card_amount,0),totalPaymentInfoCount:t.reduce((e,t)=>e+t.payment_info_count,0),totalCreditCardOrders:t.reduce((e,t)=>e+t.credit_card_orders,0),totalDays:new Set(t.map(e=>e.date)).size,advertiserSummaries:Object.values(e)};p(r)}else p(null)},y=e=>{const t=new Set(a);t.has(e)?t.delete(e):t.add(e),s(t)},w=async(e,t)=>{if(confirm(""))try{o(t=>new Set(t).add(e)),await fp.delete(e),await v(),alert("")}catch(r){console.error(":",r),alert("")}finally{o(t=>{const r=new Set(t);return r.delete(e),r})}},_=e=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:2}).format(e),k=e=>new Intl.NumberFormat("en-US").format(e),N=({stat:e,index:t})=>{const r=e.credit_card_amount/20,n=e.ad_spend>0?r/e.ad_spend:0;return Q.jsxs("div",{className:"bg-white rounded-lg shadow-md border border-gray-200 mb-4",children:[Q.jsxs("div",{className:"p-4 border-b border-gray-100 cursor-pointer",onClick:()=>y(t),children:[Q.jsxs("div",{className:"flex justify-between items-center mb-3",children:[Q.jsxs("div",{className:"flex items-center space-x-3",children:[Q.jsx("span",{className:"text-lg font-semibold text-gray-800",children:e.date}),Q.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-sm font-medium bg-blue-100 text-blue-800",children:e.advertiser})]}),Q.jsx("div",{className:"text-gray-400",children:a.has(t)?"":""})]}),Q.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[Q.jsxs("div",{children:[Q.jsx("div",{className:"text-sm text-gray-500",children:""}),Q.jsx("div",{className:"text-lg font-bold text-green-600",children:_(e.ad_spend)})]}),Q.jsxs("div",{children:[Q.jsx("div",{className:"text-sm text-gray-500",children:"ROI"}),Q.jsx("div",{className:"text-lg font-bold text-red-600",children:n>0?(Math.floor(100*n)/100).toString():"-"})]})]})]}),a.has(t)&&Q.jsxs("div",{className:"p-4 space-y-4",children:[Q.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[Q.jsxs("div",{children:[Q.jsx("div",{className:"text-gray-500",children:"(MX$)"}),Q.jsxs("div",{className:"font-semibold text-blue-600",children:["MX$",k(e.credit_card_amount)]})]}),Q.jsxs("div",{children:[Q.jsx("div",{className:"text-gray-500",children:"(USD)"}),Q.jsx("div",{className:"font-semibold text-green-600",children:_(r)})]}),Q.jsxs("div",{children:[Q.jsx("div",{className:"text-gray-500",children:""}),Q.jsx("div",{className:"font-semibold",children:k(e.payment_info_count)})]}),Q.jsxs("div",{children:[Q.jsx("div",{className:"text-gray-500",children:""}),Q.jsx("div",{className:"font-semibold",children:k(e.credit_card_orders)})]}),Q.jsxs("div",{children:[Q.jsx("div",{className:"text-gray-500",children:""}),Q.jsx("div",{className:"font-semibold text-orange-600",children:e.payment_info_count>0?_(e.cost_per_payment_info):"-"})]}),Q.jsxs("div",{children:[Q.jsx("div",{className:"text-gray-500",children:""}),Q.jsx("div",{className:"font-semibold text-purple-600",children:e.credit_card_orders>0?_(e.cost_per_order):"-"})]})]}),e.records&&e.records.length>0&&Q.jsxs("div",{children:[Q.jsxs("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:["  (",e.records.length," )"]}),Q.jsx("div",{className:"space-y-2",children:e.records.map(e=>Q.jsxs("div",{className:"bg-gray-50 rounded p-3",children:[Q.jsxs("div",{className:"grid grid-cols-2 gap-2 text-xs mb-2",children:[Q.jsxs("div",{children:[Q.jsx("span",{className:"text-gray-500",children:":"})," ",e.account_id||"-"]}),Q.jsxs("div",{children:[Q.jsx("span",{className:"text-gray-500",children:":"})," ",_(e.spend_amount||0)]}),Q.jsxs("div",{children:[Q.jsx("span",{className:"text-gray-500",children:":"})," MX$",k(e.credit_card_amount||0)]}),Q.jsxs("div",{children:[Q.jsx("span",{className:"text-gray-500",children:":"})," ",new Date(e.created_at).toLocaleDateString()]})]}),Q.jsx("button",{onClick:t=>{t.stopPropagation(),w(e.id)},disabled:i.has(e.id),className:"w-full bg-red-500 text-white px-3 py-2 rounded text-sm hover:bg-red-600 transition-colors disabled:opacity-50",children:i.has(e.id)?"...":" "})]},e.id))})]})]})]})};return r?Q.jsx("div",{className:"flex items-center justify-center h-64",children:Q.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):Q.jsxs("div",{className:"space-y-4 px-4 py-6 max-w-7xl mx-auto",children:[Q.jsxs("div",{className:"flex flex-col gap-4",children:[Q.jsxs("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-center gap-4",children:[Q.jsxs("div",{children:[Q.jsx("h2",{className:"text-2xl sm:text-3xl font-bold text-gray-800",children:""}),Q.jsx("p",{className:"text-gray-600",children:""})]}),Q.jsxs("div",{className:"flex flex-col sm:flex-row gap-2",children:[Q.jsxs("div",{className:"hidden md:flex bg-gray-100 rounded-lg p-1",children:[Q.jsx("button",{onClick:()=>x("table"),className:"px-3 py-1 text-sm rounded-md transition-colors "+("table"===g?"bg-white shadow-sm text-blue-600":"text-gray-600 hover:text-gray-800"),children:""}),Q.jsx("button",{onClick:()=>x("cards"),className:"px-3 py-1 text-sm rounded-md transition-colors "+("cards"===g?"bg-white shadow-sm text-blue-600":"text-gray-600 hover:text-gray-800"),children:""})]}),Q.jsxs("button",{onClick:v,className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors duration-200 flex items-center gap-2 justify-center",children:[Q.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:Q.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),""]})]})]}),Q.jsx("div",{className:"bg-white rounded-lg shadow-md p-4",children:Q.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-4",children:[Q.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-4 flex-1",children:[Q.jsxs("div",{className:"flex items-center gap-2",children:[Q.jsx("label",{className:"text-sm font-medium text-gray-700 whitespace-nowrap",children:":"}),Q.jsx("input",{type:"date",value:l,onChange:e=>c(e.target.value),className:"border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),Q.jsxs("div",{className:"flex items-center gap-2",children:[Q.jsx("label",{className:"text-sm font-medium text-gray-700 whitespace-nowrap",children:":"}),Q.jsx("input",{type:"date",value:d,onChange:e=>u(e.target.value),className:"border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})]}),Q.jsxs("div",{className:"text-sm text-gray-600 text-center sm:text-right",children:[" ",Q.jsx("span",{className:"font-semibold text-blue-600",children:h.length})," "]})]})})]}),0===h.length?Q.jsx("div",{className:"bg-white rounded-lg shadow-md p-8 text-center",children:Q.jsx("div",{className:"text-gray-500 text-lg",children:0===e.length?'""':""})}):Q.jsx(Q.Fragment,{children:"cards"===g||"auto"===g&&window.innerWidth<1024?Q.jsx("div",{className:"space-y-4",children:h.map((e,t)=>Q.jsx(N,{stat:e,index:t},`${e.date}-${e.advertiser}`))}):Q.jsx("div",{className:"bg-white rounded-lg shadow-md overflow-hidden",children:Q.jsx("div",{className:"overflow-x-auto",children:Q.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[Q.jsx("thead",{className:"bg-gradient-to-r from-blue-50 to-indigo-50",children:Q.jsxs("tr",{children:[Q.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""}),Q.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""}),Q.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""}),Q.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""}),Q.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"(MX$)"}),Q.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"(USD)"}),Q.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""}),Q.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""}),Q.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""}),Q.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""}),Q.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"ROI"}),Q.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""})]})}),Q.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:h.map((e,t)=>{var r;return Q.jsxs(H.Fragment,{children:[Q.jsxs("tr",{className:"hover:bg-gray-50 transition-colors duration-200",children:[Q.jsx("td",{className:"px-4 py-4 whitespace-nowrap",children:Q.jsx("button",{onClick:()=>y(t),className:"text-blue-600 hover:text-blue-800 transition-colors",children:a.has(t)?Q.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:Q.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})}):Q.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:Q.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})})}),Q.jsx("td",{className:"px-4 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:e.date}),Q.jsx("td",{className:"px-4 py-4 whitespace-nowrap",children:Q.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:e.advertiser})}),Q.jsx("td",{className:"px-4 py-4 whitespace-nowrap text-sm text-gray-900 font-semibold text-green-600",children:_(e.ad_spend)}),Q.jsxs("td",{className:"px-4 py-4 whitespace-nowrap text-sm text-gray-900 font-semibold text-blue-600",children:["MX$",k(e.credit_card_amount)]}),Q.jsx("td",{className:"px-4 py-4 whitespace-nowrap text-sm text-gray-900 font-semibold text-green-600",children:(()=>{const t=e.credit_card_amount/20;return _(t)})()}),Q.jsx("td",{className:"px-4 py-4 whitespace-nowrap text-sm text-gray-900",children:k(e.payment_info_count)}),Q.jsx("td",{className:"px-4 py-4 whitespace-nowrap text-sm text-gray-900",children:k(e.credit_card_orders)}),Q.jsx("td",{className:"px-4 py-4 whitespace-nowrap text-sm text-gray-900 font-semibold text-orange-600",children:e.payment_info_count>0?_(e.cost_per_payment_info):"-"}),Q.jsx("td",{className:"px-4 py-4 whitespace-nowrap text-sm text-gray-900 font-semibold text-purple-600",children:e.credit_card_orders>0?_(e.cost_per_order):"-"}),Q.jsx("td",{className:"px-4 py-4 whitespace-nowrap text-sm text-gray-900 font-semibold text-red-600",children:(()=>{const t=e.credit_card_amount/20,r=e.ad_spend>0?t/e.ad_spend:0;return r>0?(Math.floor(100*r)/100).toString():"-"})()}),Q.jsx("td",{className:"px-4 py-4 whitespace-nowrap text-sm text-gray-500",children:Q.jsxs("span",{className:"text-xs bg-gray-100 px-2 py-1 rounded",children:[(null==(r=e.records)?void 0:r.length)||0," "]})})]}),a.has(t)&&e.records&&Q.jsx("tr",{children:Q.jsx("td",{colSpan:"12",className:"px-4 py-0",children:Q.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 my-2",children:[Q.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-3",children:" "}),Q.jsx("div",{className:"space-y-2",children:e.records.map(e=>Q.jsxs("div",{className:"bg-white rounded border p-3 flex justify-between items-center",children:[Q.jsxs("div",{className:"grid grid-cols-4 gap-4 flex-1 text-xs",children:[Q.jsxs("div",{children:[Q.jsx("span",{className:"text-gray-500",children:":"})," ",e.account_id||"-"]}),Q.jsxs("div",{children:[Q.jsx("span",{className:"text-gray-500",children:":"})," ",_(e.spend_amount||0)]}),Q.jsxs("div",{children:[Q.jsx("span",{className:"text-gray-500",children:":"})," MX$",k(e.credit_card_amount||0)]}),Q.jsxs("div",{children:[Q.jsx("span",{className:"text-gray-500",children:":"})," ",new Date(e.created_at).toLocaleString()]})]}),Q.jsx("button",{onClick:()=>w(e.id),disabled:i.has(e.id),className:"ml-4 bg-red-500 text-white px-3 py-1 rounded text-xs hover:bg-red-600 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:i.has(e.id)?"...":" "})]},e.id))})]})})})]},`${e.date}-${e.advertiser}`)})})]})})})}),m&&Q.jsxs("div",{className:"space-y-4",children:[Q.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 rounded-lg p-4 sm:p-6",children:[Q.jsxs("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:[" ",l===d?`${l} `:`${l}  ${d} `]}),Q.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-6 gap-3 sm:gap-4",children:[Q.jsxs("div",{className:"text-center",children:[Q.jsx("div",{className:"text-lg sm:text-2xl font-bold text-green-600",children:_(m.totalAdSpend)}),Q.jsx("div",{className:"text-xs sm:text-sm text-gray-600",children:""})]}),Q.jsxs("div",{className:"text-center",children:[Q.jsxs("div",{className:"text-sm sm:text-xl font-bold text-blue-600",children:["MX$",k(m.totalCreditCardAmount)]}),Q.jsx("div",{className:"text-sm sm:text-lg font-bold text-green-600",children:_(m.totalCreditCardAmount/20)}),Q.jsx("div",{className:"text-xs sm:text-sm text-gray-600",children:"(MX$/USD)"})]}),Q.jsxs("div",{className:"text-center",children:[Q.jsx("div",{className:"text-lg sm:text-2xl font-bold text-red-600",children:(()=>{const e=m.totalAdSpend>0?m.totalCreditCardAmount/20/m.totalAdSpend:0;return e>0?(Math.floor(100*e)/100).toString():"-"})()}),Q.jsx("div",{className:"text-xs sm:text-sm text-gray-600",children:"ROI"})]}),Q.jsxs("div",{className:"text-center",children:[Q.jsx("div",{className:"text-lg sm:text-2xl font-bold text-orange-600",children:k(m.totalPaymentInfoCount)}),Q.jsx("div",{className:"text-xs sm:text-sm text-gray-600",children:""})]}),Q.jsxs("div",{className:"text-center",children:[Q.jsx("div",{className:"text-lg sm:text-2xl font-bold text-purple-600",children:k(m.totalCreditCardOrders)}),Q.jsx("div",{className:"text-xs sm:text-sm text-gray-600",children:""})]}),Q.jsxs("div",{className:"text-center",children:[Q.jsx("div",{className:"text-lg sm:text-2xl font-bold text-gray-600",children:m.totalDays}),Q.jsx("div",{className:"text-xs sm:text-sm text-gray-600",children:""})]})]})]}),m.advertiserSummaries&&m.advertiserSummaries.length>0&&Q.jsxs("div",{className:"bg-white rounded-lg shadow-md p-4 sm:p-6",children:[Q.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:" "}),Q.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-5 gap-4",children:m.advertiserSummaries.map(e=>Q.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[Q.jsxs("div",{className:"text-center mb-3",children:[Q.jsx("div",{className:"inline-flex items-center px-3 py-1 rounded-full text-sm font-medium bg-blue-100 text-blue-800",children:e.advertiser}),Q.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:[e.daysCount," "]})]}),Q.jsxs("div",{className:"space-y-2 text-sm",children:[Q.jsxs("div",{className:"flex justify-between",children:[Q.jsx("span",{className:"text-gray-600",children:":"}),Q.jsx("span",{className:"font-semibold text-green-600",children:_(e.totalAdSpend)})]}),Q.jsxs("div",{className:"flex justify-between",children:[Q.jsx("span",{className:"text-gray-600",children:"(USD):"}),Q.jsx("span",{className:"font-semibold text-blue-600",children:_(e.totalCreditCardAmount/20)})]}),Q.jsxs("div",{className:"flex justify-between",children:[Q.jsx("span",{className:"text-gray-600",children:":"}),Q.jsx("span",{className:"font-semibold text-orange-600",children:k(e.totalPaymentInfoCount)})]}),Q.jsxs("div",{className:"flex justify-between",children:[Q.jsx("span",{className:"text-gray-600",children:":"}),Q.jsx("span",{className:"font-semibold text-purple-600",children:k(e.totalCreditCardOrders)})]}),Q.jsxs("div",{className:"flex justify-between",children:[Q.jsx("span",{className:"text-gray-600",children:"ROI:"}),Q.jsx("span",{className:"font-semibold text-red-600",children:e.roi>0?(Math.floor(100*e.roi)/100).toString():"-"})]})]})]},e.advertiser))})]})]})]})},gp=({isVisible:e,onComplete:t})=>{const[r,n]=W.useState([]);return W.useEffect(()=>{if(e){const e=[];[{x:20,y:30,delay:0},{x:80,y:25,delay:500},{x:50,y:40,delay:1e3},{x:30,y:20,delay:1500},{x:70,y:35,delay:2e3}].forEach((t,r)=>{for(let n=0;n<30;n++){const a=n/30*Math.PI*2,s=2+3*Math.random(),i=["#FFD700","#FF6B6B","#4ECDC4","#45B7D1","#96CEB4","#FCEA2B","#FF9FF3","#54A0FF"];e.push({id:`${r}-${n}`,x:t.x,y:t.y,initialX:t.x,initialY:t.y,vx:Math.cos(a)*s,vy:Math.sin(a)*s,color:i[Math.floor(Math.random()*i.length)],size:3+4*Math.random(),delay:t.delay,life:1})}}),n(e);const r=setInterval(()=>{n(e=>e.map(e=>Date.now()-e.delay<0?e:{...e,x:e.x+e.vx,y:e.y+e.vy,vy:e.vy+.1,life:e.life-.02,size:.99*e.size}).filter(e=>e.life>0))},50),a=setTimeout(()=>{clearInterval(r),n([]),t()},3e3);return()=>{clearInterval(r),clearTimeout(a)}}},[e,t]),e?Q.jsxs("div",{className:"fixed inset-0 z-50 pointer-events-none overflow-hidden",children:[Q.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-20 animate-pulse"}),r.map(e=>Q.jsx("div",{className:"absolute rounded-full animate-pulse",style:{left:`${e.x}%`,top:`${e.y}%`,backgroundColor:e.color,width:`${e.size}px`,height:`${e.size}px`,opacity:e.life,boxShadow:`0 0 ${2*e.size}px ${e.color}`,transform:`scale(${e.life})`,transition:"all 0.05s ease-out"}},e.id)),Q.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:Q.jsxs("div",{className:"text-center animate-bounce",children:[Q.jsx("div",{className:"text-6xl mb-4 animate-pulse",children:""}),Q.jsx("div",{className:"text-3xl font-bold text-yellow-400 drop-shadow-lg animate-pulse",children:""}),Q.jsx("div",{className:"text-xl text-white drop-shadow-lg mt-2 animate-pulse",children:"ROI"})]})}),[...Array(20)].map((e,t)=>Q.jsx("div",{className:"absolute animate-ping",style:{left:100*Math.random()+"%",top:100*Math.random()+"%",animationDelay:2*Math.random()+"s",animationDuration:1+2*Math.random()+"s"},children:""},`star-${t}`))]}):null};class xp extends H.Component{constructor(e){super(e),this.state={hasError:!1,error:null}}static getDerivedStateFromError(e){return{hasError:!0,error:e}}componentDidCatch(e,t){console.error("ROI:",e,t)}render(){return this.state.hasError?Q.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-8 text-center",children:[Q.jsx("div",{className:"text-red-500 text-5xl mb-4",children:""}),Q.jsx("h3",{className:"text-xl font-semibold text-gray-600 mb-2",children:""}),Q.jsx("p",{className:"text-gray-500 mb-4",children:""}),Q.jsx("button",{onClick:()=>window.location.reload(),className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg",children:""})]}):this.props.children}}const vp=()=>{const[e,t]=W.useState(!0),[r,n]=W.useState([]),[a,s]=W.useState((new Date).toISOString().split("T")[0]),[i,o]=W.useState(!0);W.useEffect(()=>{l()},[a]);const l=async()=>{try{t(!0);const{data:e,error:r}=await sp.rpc("get_daily_roi_rankings",{target_date:a});if(r){console.error("ROI:",r);const{data:e,error:t}=await sp.from("app_e87b41cfe355428b8146f8bae8184e10_ad_data_entries").select("*").eq("date",a);if(t)throw t;const s={};e.forEach(e=>{const t=e.staff;s[t]||(s[t]={advertiser:t,creditCardAmount:0,creditCardAmountUSD:0,adSpend:0,orders:0,paymentInfo:0,recordCount:0}),s[t].creditCardAmount+=parseFloat(e.credit_card_amount||0),s[t].adSpend+=parseFloat(e.ad_spend||0),s[t].orders+=parseInt(e.credit_card_orders||0),s[t].paymentInfo+=parseInt(e.payment_info_count||0),s[t].recordCount+=1});const i=Object.values(s).map(e=>{const t=e.creditCardAmount/20,r=e.adSpend>0?t/e.adSpend:0;return{...e,creditCardAmountUSD:t,roi:r,roiPercentage:100*r}}).filter(e=>e.adSpend>0).sort((e,t)=>t.roi-e.roi);n(i)}else{const t=(e||[]).map(e=>({advertiser:e.staff||"",creditCardAmount:parseFloat(e.total_credit_card||0),creditCardAmountUSD:parseFloat(e.total_credit_card||0)/20,adSpend:parseFloat(e.total_ad_spend||0),orders:parseInt(e.total_orders||0),paymentInfo:parseInt(e.total_payment_info||0),recordCount:parseInt(e.record_count||0),roi:parseFloat(e.roi||0),roiPercentage:100*parseFloat(e.roi||0)})).filter(e=>e.adSpend>0);n(t)}}catch(e){console.error("Error loading ROI rankings:",e),n([])}finally{t(!1)}},c=(e,t="USD")=>{const r=parseFloat(e)||0;return"MX$"===t?`MX$${r.toLocaleString("es-MX",{minimumFractionDigits:2})}`:new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:2}).format(r)},d=e=>{const t=parseInt(e)||0;return new Intl.NumberFormat("en-US").format(t)},u=e=>{switch(e){case 0:return"";case 1:return"";case 2:return"";case 3:return"";default:return`#${e+1}`}},h=(e,t)=>0===e?" ":1===e?" ":2===e?" ":3===e?" ":e===t-1&&t>4?" ":"",f=e=>{switch(e){case 0:return"from-yellow-400 to-yellow-600 text-white";case 1:return"from-gray-400 to-gray-600 text-white";case 2:return"from-orange-400 to-orange-600 text-white";default:return"from-blue-50 to-blue-100 text-gray-800"}};return e?Q.jsx("div",{className:"flex items-center justify-center h-64",children:Q.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):Q.jsxs(xp,{children:[Q.jsx(gp,{isVisible:i,onComplete:()=>o(!1)}),Q.jsxs("div",{className:"space-y-6",children:[Q.jsxs("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-center gap-4",children:[Q.jsxs("div",{children:[Q.jsx("h2",{className:"text-2xl sm:text-3xl font-bold text-gray-800",children:""}),Q.jsx("p",{className:"text-gray-600",children:"ROI/"})]}),Q.jsxs("div",{className:"flex items-center gap-4",children:[Q.jsx("input",{type:"date",value:a,onChange:e=>s(e.target.value),className:"border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-transparent"}),Q.jsxs("button",{onClick:l,className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors duration-200 flex items-center gap-2",children:[Q.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:Q.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),""]})]})]}),0===r.length?Q.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-8 text-center",children:[Q.jsx("div",{className:"text-gray-400 text-5xl mb-4",children:""}),Q.jsx("h3",{className:"text-xl font-semibold text-gray-600 mb-2",children:""}),Q.jsxs("p",{className:"text-gray-500",children:['"" ',a," "]})]}):Q.jsx("div",{className:"space-y-4",children:r.map((e,t)=>Q.jsxs("div",{className:`bg-gradient-to-r ${f(t)} rounded-xl p-6 shadow-lg transform hover:scale-105 transition-all duration-300`,children:[Q.jsxs("div",{className:"flex items-center justify-between",children:[Q.jsxs("div",{className:"flex items-center space-x-4",children:[Q.jsx("div",{className:"text-3xl font-bold",children:u(t)}),Q.jsxs("div",{children:[Q.jsxs("h3",{className:"text-xl font-bold",children:[e.advertiser,Q.jsx("span",{className:"ml-3 px-3 py-1 bg-white bg-opacity-40 text-sm font-bold rounded-full border border-white border-opacity-50",children:h(t,r.length)})]}),Q.jsxs("p",{className:"text-sm opacity-80",children:[e.recordCount," "]})]})]}),Q.jsxs("div",{className:"text-right",children:[Q.jsx("div",{className:"text-2xl font-bold",children:e.roi.toFixed(2)}),Q.jsx("p",{className:"text-sm opacity-80",children:"ROI"})]})]}),Q.jsxs("div",{className:"mt-4 grid grid-cols-2 md:grid-cols-4 gap-4",children:[Q.jsxs("div",{className:"text-center",children:[Q.jsx("div",{className:"text-lg font-semibold",children:c(e.creditCardAmount,"MX$")}),Q.jsxs("div",{className:"text-xs opacity-80",children:["(",c(e.creditCardAmountUSD)," USD)"]}),Q.jsx("p",{className:"text-xs opacity-80",children:""})]}),Q.jsxs("div",{className:"text-center",children:[Q.jsx("div",{className:"text-lg font-semibold",children:c(e.adSpend)}),Q.jsx("p",{className:"text-xs opacity-80",children:""})]}),Q.jsxs("div",{className:"text-center",children:[Q.jsx("div",{className:"text-lg font-semibold",children:d(e.orders)}),Q.jsx("p",{className:"text-xs opacity-80",children:""})]}),Q.jsxs("div",{className:"text-center",children:[Q.jsx("div",{className:"text-lg font-semibold",children:d(e.paymentInfo)}),Q.jsx("p",{className:"text-xs opacity-80",children:""})]})]}),Q.jsxs("div",{className:"mt-4",children:[Q.jsxs("div",{className:"flex justify-between text-xs opacity-80 mb-1",children:[Q.jsx("span",{children:"ROI"}),Q.jsx("span",{children:e.roi.toFixed(2)})]}),Q.jsx("div",{className:"w-full bg-white bg-opacity-30 rounded-full h-2",children:Q.jsx("div",{className:"bg-white rounded-full h-2 transition-all duration-500",style:{width:`${Math.min(50*e.roi,100)}%`}})})]})]},e.advertiser))}),r.length>0&&Q.jsxs("div",{className:"bg-gradient-to-r from-indigo-50 to-purple-50 rounded-lg p-6",children:[Q.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:" "}),Q.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[Q.jsxs("div",{className:"text-center",children:[Q.jsx("div",{className:"text-2xl font-bold text-green-600",children:c(r.reduce((e,t)=>e+t.creditCardAmount,0),"MX$")}),Q.jsxs("div",{className:"text-xs text-gray-500",children:["(",c(r.reduce((e,t)=>e+t.creditCardAmountUSD,0))," USD)"]}),Q.jsx("div",{className:"text-sm text-gray-600",children:""})]}),Q.jsxs("div",{className:"text-center",children:[Q.jsx("div",{className:"text-2xl font-bold text-red-600",children:c(r.reduce((e,t)=>e+t.adSpend,0))}),Q.jsx("div",{className:"text-sm text-gray-600",children:""})]}),Q.jsxs("div",{className:"text-center",children:[Q.jsx("div",{className:"text-2xl font-bold text-blue-600",children:(()=>{const e=r.reduce((e,t)=>e+(t.creditCardAmountUSD||0),0),t=r.reduce((e,t)=>e+(t.adSpend||0),0);return t>0?(e/t).toFixed(2):"0.00"})()}),Q.jsx("div",{className:"text-sm text-gray-600",children:"ROI"})]}),Q.jsxs("div",{className:"text-center",children:[Q.jsx("div",{className:"text-2xl font-bold text-purple-600",children:r.length}),Q.jsx("div",{className:"text-sm text-gray-600",children:""})]})]})]})]})]})},bp=()=>{const[e,t]=W.useState((new Date).toISOString().split("T")[0]),[r,n]=W.useState([]),[a,s]=W.useState(!0);W.useEffect(()=>{i()},[e]);const i=async()=>{try{s(!0);const{data:t,error:r}=await sp.from("app_e87b41cfe355428b8146f8bae8184e10_ad_data_entries").select("*").order("created_at",{ascending:!1});if(r)throw console.error(":",r),r;const a=t.filter(t=>t.date===e),i={};a.forEach(e=>{const t=e.staff;i[t]||(i[t]={advertiser:t,adSpend:0,creditCardAmount:0,paymentInfoCount:0,orderCount:0,records:[]});const r=i[t];r.adSpend+=parseFloat(e.ad_spend||0),r.creditCardAmount+=parseFloat(e.credit_card_amount||0),r.paymentInfoCount+=parseInt(e.payment_info_count||0),r.orderCount+=parseInt(e.credit_card_orders||0),r.records.push(e)});const o=Object.values(i).map(e=>({id:e.advertiser,advertiser:e.advertiser,adSpend:e.adSpend,creditCardAmount:e.creditCardAmount,paymentInfoCount:e.paymentInfoCount,orderCount:e.orderCount,orderCost:e.orderCount>0?e.creditCardAmount/e.orderCount:0,paymentCost:e.paymentInfoCount>0?e.creditCardAmount/e.paymentInfoCount:0}));o.sort((e,t)=>t.creditCardAmount-e.creditCardAmount),o.forEach((e,t)=>{e.rank=t+1}),n(o)}catch(t){console.error("Error loading leaderboard data:",t),n([])}finally{s(!1)}},o=e=>`MX$${e.toLocaleString()}`,l=e=>`$${e.toLocaleString()}`,c=.05,d=e=>{switch(e){case 1:return"";case 2:return"";case 3:return"";default:return""}},u=e=>{switch(e){case 1:return"from-yellow-400 to-yellow-600";case 2:return"from-gray-400 to-gray-600";case 3:return"from-orange-400 to-orange-600";default:return"from-blue-400 to-blue-600"}};return Q.jsxs("div",{className:"space-y-6",children:[Q.jsxs("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-center gap-4",children:[Q.jsxs("div",{className:"flex items-center space-x-3",children:[Q.jsx("h2",{className:"text-2xl sm:text-3xl font-bold text-gray-800",children:""}),Q.jsx("span",{className:"text-xl sm:text-2xl",children:""})]}),Q.jsxs("div",{className:"flex items-center space-x-2 sm:space-x-4",children:[Q.jsx("label",{className:"text-sm font-medium text-gray-700",children:":"}),Q.jsx("input",{type:"date",value:e,onChange:e=>t(e.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm"})]})]}),a?Q.jsx("div",{className:"bg-white rounded-xl p-8 shadow-lg text-center",children:Q.jsx("div",{className:"text-gray-500 text-lg",children:"..."})}):0===r.length?Q.jsxs("div",{className:"bg-white rounded-xl p-8 shadow-lg text-center",children:[Q.jsx("div",{className:"text-gray-500 text-lg",children:""}),Q.jsx("div",{className:"text-sm text-gray-400 mt-2",children:""})]}):Q.jsxs("div",{className:"space-y-4",children:[r.slice(0,3).length>0&&Q.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 sm:gap-6 mb-6 sm:mb-8",children:r.slice(0,3).map(e=>Q.jsxs("div",{className:`bg-gradient-to-br ${u(e.rank)} rounded-xl p-6 text-white shadow-2xl transform hover:scale-105 transition-all duration-300`,children:[Q.jsxs("div",{className:"flex items-center justify-between mb-4",children:[Q.jsx("div",{className:"text-3xl",children:d(e.rank)}),Q.jsxs("div",{className:"text-right",children:[Q.jsxs("div",{className:"text-2xl font-bold",children:["#",e.rank]}),Q.jsx("div",{className:"text-sm opacity-90",children:""})]})]}),Q.jsxs("div",{className:"text-center",children:[Q.jsx("div",{className:"w-16 h-16 bg-white bg-opacity-20 rounded-full flex items-center justify-center mx-auto mb-3",children:Q.jsx("span",{className:"text-2xl font-bold",children:e.advertiser})}),Q.jsx("h3",{className:"text-xl font-bold mb-2",children:e.advertiser}),Q.jsxs("div",{className:"space-y-2",children:[Q.jsxs("div",{children:[Q.jsx("div",{className:"text-2xl font-bold",children:o(e.creditCardAmount)}),Q.jsxs("div",{className:"text-sm opacity-80",children:[" ",l((e.creditCardAmount*c).toFixed(2))]})]}),Q.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[Q.jsxs("div",{children:[Q.jsx("div",{className:"font-semibold",children:e.orderCount}),Q.jsx("div",{className:"opacity-80",children:""})]}),Q.jsxs("div",{children:[Q.jsx("div",{className:"font-semibold",children:o(e.orderCost)}),Q.jsx("div",{className:"opacity-80",children:""})]})]})]})]})]},e.id))}),Q.jsxs("div",{className:"bg-white rounded-xl shadow-lg overflow-hidden",children:[Q.jsx("div",{className:"bg-gradient-to-r from-purple-600 to-blue-600 px-6 py-4",children:Q.jsxs("h3",{className:"text-xl font-semibold text-white",children:[e,"  ()"]})}),Q.jsx("div",{className:"overflow-x-auto",children:Q.jsxs("table",{className:"w-full",children:[Q.jsx("thead",{className:"bg-gray-50",children:Q.jsxs("tr",{children:[Q.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""}),Q.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""}),Q.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""}),Q.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""}),Q.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""}),Q.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""}),Q.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""}),Q.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""})]})}),Q.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:r.map((e,t)=>Q.jsxs("tr",{className:(t%2==0?"bg-white":"bg-gray-50")+" hover:bg-blue-50 transition-colors duration-200",children:[Q.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:Q.jsxs("div",{className:"flex items-center",children:[Q.jsx("span",{className:"text-2xl mr-2",children:d(e.rank)}),Q.jsxs("span",{className:"text-lg font-bold text-gray-900",children:["#",e.rank]})]})}),Q.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:Q.jsxs("div",{className:"flex items-center",children:[Q.jsx("div",{className:`w-10 h-10 bg-gradient-to-r ${u(e.rank)} rounded-full flex items-center justify-center text-white font-bold`,children:e.advertiser}),Q.jsx("div",{className:"ml-3 text-lg font-medium text-gray-900",children:e.advertiser})]})}),Q.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[Q.jsx("div",{className:"text-lg font-bold text-blue-600",children:o(e.creditCardAmount)}),Q.jsxs("div",{className:"text-sm text-gray-500",children:[" ",l((e.creditCardAmount*c).toFixed(2))]})]}),Q.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-lg font-semibold text-purple-600",children:l(e.adSpend)}),Q.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-center text-lg font-medium text-gray-900",children:e.orderCount}),Q.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-lg font-semibold text-green-600",children:o(e.orderCost)}),Q.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-center text-lg font-medium text-gray-900",children:e.paymentInfoCount}),Q.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-lg font-semibold text-orange-600",children:o(e.paymentCost)})]},e.id))})]})})]})]})]})};(()=>{try{const e=localStorage.getItem("advertisingData");return e?JSON.parse(e):[]}catch(e){return console.error(":",e),[]}})();const yp=()=>{const[e,t]=W.useState("csv"),[r,n]=W.useState("week"),[a,s]=W.useState((new Date).toISOString().split("T")[0]),[i,o]=W.useState((new Date).toISOString().split("T")[0]),[l,c]=W.useState(!1),[d,u]=W.useState([]),[h,f]=W.useState([]),[m,p]=W.useState(!0),g=e=>{if(!e||0===e.length)return void alert("");const t=[["","","","ID","","","","","",""].join(","),...e.map(e=>Object.values(e).map(e=>`"${e}"`).join(","))].join("\n"),r=new Blob(["\ufeff"+t],{type:"text/csv;charset=utf-8;"}),n=document.createElement("a"),s=URL.createObjectURL(r);n.setAttribute("href",s);const o=a===i?a:`${a}_to_${i}`;n.setAttribute("download",`advertising_data_export_${o}.csv`),n.style.visibility="hidden",document.body.appendChild(n),n.click(),document.body.removeChild(n)},x=async()=>{p(!0);try{const e=await op(),t=await lp.getRecharges();console.log("Ad Data:",e),console.log("Recharge Data:",t);const r=e.map(e=>{const r=t.find(t=>t.account_id&&e.account_name&&t.account_id.includes(e.account_name)&&t.created_at&&e.date&&new Date(t.created_at).toDateString()===new Date(e.date).toDateString()),n=e.payment_info_count>0?parseFloat(e.ad_spend)/parseInt(e.payment_info_count):0,a=e.credit_card_orders>0?parseFloat(e.ad_spend)/parseInt(e.credit_card_orders):0;return{date:e.date,advertiser:e.advertiser,accountName:e.account_name||"",accountId:e.account_id||"",rechargeAmount:r?parseFloat(r.usd_amount||0).toFixed(2):"0.00",creditCardAmount:parseFloat(e.credit_card_amount||0).toFixed(2),paymentInfoCount:parseInt(e.payment_info_count||0),creditCardOrders:parseInt(e.credit_card_orders||0),costPerPaymentInfo:n.toFixed(2),costPerOrder:a.toFixed(2),adSpend:parseFloat(e.ad_spend||0).toFixed(2)}});u(r)}catch(e){console.error("Error loading preview data:",e),u([])}finally{p(!1)}};W.useEffect(()=>{x()},[]),W.useEffect(()=>{(()=>{if(!d.length)return void f([]);const e=d.filter(e=>{const t=e.date;return t>=a&&t<=i});f(e)})()},[d,a,i]);return Q.jsxs("div",{className:"space-y-6",children:[Q.jsxs("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-center gap-4",children:[Q.jsxs("div",{children:[Q.jsx("h2",{className:"text-2xl sm:text-3xl font-bold text-gray-800",children:""}),Q.jsx("p",{className:"text-gray-600",children:""})]}),Q.jsxs("button",{onClick:x,className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors duration-200 flex items-center gap-2",children:[Q.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:Q.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),""]})]}),Q.jsxs("div",{className:"bg-white rounded-xl p-6 shadow-lg",children:[Q.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:""}),Q.jsxs("div",{className:"mb-6 p-4 bg-gray-50 rounded-lg",children:[Q.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-3",children:" "}),Q.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-4",children:[Q.jsxs("div",{className:"flex items-center gap-2",children:[Q.jsx("label",{className:"text-sm font-medium text-gray-700",children:":"}),Q.jsx("input",{type:"date",value:a,onChange:e=>s(e.target.value),className:"border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-green-500 focus:border-transparent"})]}),Q.jsxs("div",{className:"flex items-center gap-2",children:[Q.jsx("label",{className:"text-sm font-medium text-gray-700",children:":"}),Q.jsx("input",{type:"date",value:i,onChange:e=>o(e.target.value),className:"border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-green-500 focus:border-transparent"})]}),Q.jsxs("div",{className:"text-sm text-gray-600",children:[" ",Q.jsx("span",{className:"font-semibold text-green-600",children:h.length})," "]})]})]}),Q.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 sm:gap-6",children:[Q.jsxs("div",{children:[Q.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""}),Q.jsxs("select",{value:e,onChange:e=>t(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm",children:[Q.jsx("option",{value:"csv",children:"CSV "}),Q.jsx("option",{value:"excel",children:"Excel "}),Q.jsx("option",{value:"json",children:"JSON "})]})]}),Q.jsx("div",{className:"flex items-end sm:col-span-2 lg:col-span-1",children:0!==h.length||l?Q.jsx("button",{onClick:async()=>{c(!0);try{const t=h.map(e=>({"":e.date,"":e.advertiser,"":e.accountName,"ID":e.accountId,"":e.rechargeAmount,"":e.creditCardAmount,"":e.paymentInfoCount,"":e.creditCardOrders,"":e.costPerPaymentInfo,"":e.costPerOrder}));"csv"===e?g(t):"excel"===e?g(t):"json"===e&&(e=>{if(!e||0===e.length)return void alert("");const t=JSON.stringify(e,null,2),r=new Blob([t],{type:"application/json"}),n=document.createElement("a"),s=URL.createObjectURL(r);n.setAttribute("href",s);const o=a===i?a:`${a}_to_${i}`;n.setAttribute("download",`advertising_data_export_${o}.json`),n.style.visibility="hidden",document.body.appendChild(n),n.click(),document.body.removeChild(n)})(t)}catch(t){console.error("Export error:",t),alert("")}finally{c(!1)}},disabled:l||0===h.length,className:"w-full bg-gradient-to-r from-green-600 to-blue-600 text-white px-4 sm:px-6 py-2 rounded-lg hover:from-green-700 hover:to-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-200 font-medium text-sm sm:text-base flex items-center justify-center gap-2",children:l?Q.jsxs(Q.Fragment,{children:[Q.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),"..."]}):Q.jsxs(Q.Fragment,{children:["  (",h.length," )"]})}):Q.jsxs("div",{className:"w-full",children:[Q.jsx("div",{className:"bg-gray-100 text-gray-500 px-4 sm:px-6 py-2 rounded-lg text-center font-medium text-sm sm:text-base",children:" "}),Q.jsx("p",{className:"text-xs text-gray-400 mt-1 text-center",children:""})]})})]})]}),m?Q.jsx("div",{className:"flex items-center justify-center h-64 bg-white rounded-xl shadow-lg",children:Q.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):h.length>0?Q.jsxs("div",{className:"bg-white rounded-xl shadow-lg overflow-hidden",children:[Q.jsx("div",{className:"bg-gradient-to-r from-green-600 to-blue-600 px-6 py-4",children:Q.jsxs("h3",{className:"text-xl font-semibold text-white",children:[a===i?`${a} `:`${a}  ${i} `," (",h.length," )"]})}),Q.jsx("div",{className:"p-4 sm:p-6 bg-gray-50 border-b",children:Q.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-3 sm:gap-4",children:[Q.jsxs("div",{className:"text-center",children:[Q.jsxs("div",{className:"text-lg sm:text-2xl font-bold text-blue-600",children:["$",h.reduce((e,t)=>e+parseFloat(t.creditCardAmount),0).toLocaleString()]}),Q.jsx("div",{className:"text-xs sm:text-sm text-gray-600",children:""})]}),Q.jsxs("div",{className:"text-center",children:[Q.jsxs("div",{className:"text-lg sm:text-2xl font-bold text-purple-600",children:["$",h.reduce((e,t)=>e+parseFloat(t.adSpend),0).toLocaleString()]}),Q.jsx("div",{className:"text-xs sm:text-sm text-gray-600",children:""})]}),Q.jsxs("div",{className:"text-center",children:[Q.jsx("div",{className:"text-lg sm:text-2xl font-bold text-green-600",children:h.reduce((e,t)=>e+parseInt(t.creditCardOrders),0)}),Q.jsx("div",{className:"text-xs sm:text-sm text-gray-600",children:""})]}),Q.jsxs("div",{className:"text-center",children:[Q.jsxs("div",{className:"text-lg sm:text-2xl font-bold text-yellow-600",children:["$",h.reduce((e,t)=>e+parseFloat(t.rechargeAmount),0).toLocaleString()]}),Q.jsx("div",{className:"text-xs sm:text-sm text-gray-600",children:""})]})]})}),Q.jsx("div",{className:"overflow-x-auto",children:Q.jsxs("table",{className:"w-full",children:[Q.jsx("thead",{className:"bg-gray-100",children:Q.jsxs("tr",{children:[Q.jsx("th",{className:"px-2 sm:px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:""}),Q.jsx("th",{className:"px-2 sm:px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:""}),Q.jsx("th",{className:"px-2 sm:px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase hidden sm:table-cell",children:""}),Q.jsx("th",{className:"px-2 sm:px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:""}),Q.jsx("th",{className:"px-2 sm:px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:""}),Q.jsx("th",{className:"px-2 sm:px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase hidden lg:table-cell",children:""}),Q.jsx("th",{className:"px-2 sm:px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase hidden lg:table-cell",children:""}),Q.jsx("th",{className:"px-2 sm:px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase hidden sm:table-cell",children:""})]})}),Q.jsx("tbody",{className:"divide-y divide-gray-200",children:h.map((e,t)=>Q.jsxs("tr",{className:t%2==0?"bg-white":"bg-gray-50",children:[Q.jsx("td",{className:"px-2 sm:px-4 py-3 text-xs sm:text-sm text-gray-900",children:e.date}),Q.jsx("td",{className:"px-2 sm:px-4 py-3",children:Q.jsxs("div",{className:"flex items-center",children:[Q.jsx("div",{className:"w-6 h-6 sm:w-8 sm:h-8 bg-gradient-to-r from-blue-500 to-purple-500 rounded-full flex items-center justify-center text-white font-medium text-xs sm:text-sm",children:e.advertiser}),Q.jsx("span",{className:"ml-2 font-medium text-xs sm:text-sm",children:e.advertiser})]})}),Q.jsx("td",{className:"px-2 sm:px-4 py-3 font-mono text-xs sm:text-sm hidden sm:table-cell",children:e.accountName}),Q.jsxs("td",{className:"px-2 sm:px-4 py-3 font-semibold text-purple-600 text-xs sm:text-sm",children:["$",e.adSpend]}),Q.jsxs("td",{className:"px-2 sm:px-4 py-3 font-semibold text-blue-600 text-xs sm:text-sm",children:["$",e.creditCardAmount]}),Q.jsx("td",{className:"px-2 sm:px-4 py-3 text-center font-medium text-xs sm:text-sm hidden lg:table-cell",children:e.paymentInfoCount}),Q.jsx("td",{className:"px-2 sm:px-4 py-3 text-center font-medium text-xs sm:text-sm hidden lg:table-cell",children:e.creditCardOrders}),Q.jsxs("td",{className:"px-2 sm:px-4 py-3 font-semibold text-yellow-600 text-xs sm:text-sm hidden sm:table-cell",children:["$",e.rechargeAmount]})]},t))})]})})]}):d.length>0&&0===h.length?Q.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-xl p-8 text-center",children:[Q.jsx("div",{className:"text-yellow-600 text-lg font-medium mb-2",children:" "}),Q.jsx("p",{className:"text-yellow-700",children:""})]}):Q.jsxs("div",{className:"bg-white rounded-xl p-8 shadow-lg text-center",children:[Q.jsx("div",{className:"text-gray-500 text-lg",children:""}),Q.jsx("div",{className:"text-gray-400 text-sm mt-2",children:'""'})]}),Q.jsxs("div",{className:"bg-blue-50 rounded-xl p-6",children:[Q.jsx("h4",{className:"text-lg font-semibold text-blue-800 mb-3",children:" "}),Q.jsxs("div",{className:"text-blue-700 space-y-2",children:[Q.jsxs("p",{children:[" ",Q.jsx("strong",{children:"CSV"}),": Excel"]}),Q.jsxs("p",{children:[" ",Q.jsx("strong",{children:"Excel"}),": CSVExcel"]}),Q.jsxs("p",{children:[" ",Q.jsx("strong",{children:"JSON"}),": "]}),Q.jsx("p",{children:" ID"}),Q.jsx("p",{children:" Supabase"})]})]})]})},wp=()=>{const[e,t]=W.useState([]),[r,n]=W.useState("single"),[a,s]=W.useState({date:(new Date).toISOString().split("T")[0],advertiser:"",accountId:"",accountName:"",amount:""}),[i,o]=W.useState([{date:(new Date).toISOString().split("T")[0],advertiser:"",accountId:"",accountName:"",amount:""}]),[l,c]=W.useState(!1),d=["","","","",""],u=.055;W.useEffect(()=>{h()},[]);const h=async()=>{try{const e=await ip.getAccounts();t(e)}catch(e){console.error("Error loading accounts:",e)}},f=e=>{const{name:t,value:r}=e.target;s(e=>({...e,[t]:r}))},m=(e,t,r)=>{const n=[...i];n[e][t]=r,o(n)},p=(e,t)=>new Intl.NumberFormat("es-MX",{style:"currency",currency:"USD"===t?"USD":"MXN",minimumFractionDigits:2}).format(e);return Q.jsxs("div",{className:"space-y-6",children:[Q.jsx("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-center gap-4",children:Q.jsxs("div",{children:[Q.jsx("h2",{className:"text-2xl sm:text-3xl font-bold text-gray-800",children:""}),Q.jsx("p",{className:"text-gray-600",children:""})]})}),Q.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6",children:[Q.jsxs("h3",{className:"text-lg font-semibold mb-4 flex items-center",children:[Q.jsx("span",{className:"w-2 h-2 bg-green-500 rounded-full mr-2"}),""]}),Q.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:e.map(e=>Q.jsx("div",{className:"bg-gradient-to-r from-green-50 to-blue-50 p-4 rounded-lg border",children:Q.jsxs("div",{className:"flex justify-between items-center",children:[Q.jsxs("div",{children:[Q.jsx("div",{className:"font-semibold text-gray-800",children:e.account_name}),Q.jsx("div",{className:"text-sm text-gray-500",children:e.account_id})]}),Q.jsxs("div",{className:"text-right",children:[Q.jsx("div",{className:"font-bold text-lg text-green-600",children:p(e.balance||0,"MX$")}),Q.jsxs("div",{className:"text-xs text-gray-500",children:[" ",p((e.balance||0)*u,"USD")]})]})]})},e.account_id))})]}),Q.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6",children:[Q.jsxs("h3",{className:"text-lg font-semibold mb-4 flex items-center",children:[Q.jsx("span",{className:"w-2 h-2 bg-blue-500 rounded-full mr-2"}),""]}),Q.jsxs("div",{className:"mb-6",children:[Q.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""}),Q.jsxs("div",{className:"flex space-x-4",children:[Q.jsxs("label",{className:"flex items-center",children:[Q.jsx("input",{type:"radio",value:"single",checked:"single"===r,onChange:e=>n(e.target.value),className:"mr-2"}),Q.jsx("span",{className:"text-sm text-gray-700",children:""})]}),Q.jsxs("label",{className:"flex items-center",children:[Q.jsx("input",{type:"radio",value:"multiple",checked:"multiple"===r,onChange:e=>n(e.target.value),className:"mr-2"}),Q.jsx("span",{className:"text-sm text-gray-700",children:""})]})]})]}),"single"===r&&Q.jsxs("form",{onSubmit:async t=>{if(t.preventDefault(),a.accountId&&a.accountName&&a.amount){c(!0);try{const t=parseFloat(a.amount),r=t/u,n=await lp.getRechargeRecords(),i=n.filter(e=>e.account_id===a.accountId&&e.created_at.split("T")[0]===a.date).length+1;let o;o=1===i?` ${t} USD - ${a.advertiser} - ${a.date}`:2===i?` ${t} USD - ${a.advertiser} - ${a.date}`:3===i?` ${t} USD - ${a.advertiser} - ${a.date}`:`${i} ${t} USD - ${a.advertiser} - ${a.date}`;const l=e.find(e=>e.account_id===a.accountId),c=(l?l.balance:0)+r,d={account_id:a.accountId,amount:r,currency:"MX$",usd_amount:t,description:o,new_balance:c};await lp.addRecharge(d),await h(),s({date:(new Date).toISOString().split("T")[0],advertiser:"",accountId:"",accountName:"",amount:""}),alert("")}catch(r){console.error("Error processing single recharge:",r),alert("")}finally{c(!1)}}else alert("")},className:"space-y-4",children:[Q.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4",children:[Q.jsxs("div",{children:[Q.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:" *"}),Q.jsx("input",{type:"date",name:"date",value:a.date,onChange:f,required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),Q.jsxs("div",{children:[Q.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:" *"}),Q.jsx("select",{name:"advertiser",value:a.advertiser,onChange:f,required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:d.map(e=>Q.jsx("option",{value:e,children:e},e))})]}),Q.jsxs("div",{children:[Q.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:" *"}),Q.jsx("input",{type:"text",name:"accountName",value:a.accountName,onChange:f,placeholder:"",required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),Q.jsxs("div",{children:[Q.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"ID *"}),Q.jsx("input",{type:"text",name:"accountId",value:a.accountId,onChange:f,placeholder:"ID",required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),Q.jsxs("div",{children:[Q.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:" (USD) *"}),Q.jsx("input",{type:"number",step:"0.01",min:"0",name:"amount",value:a.amount,onChange:f,placeholder:"",required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"}),a.amount&&Q.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:[" ",p(parseFloat(a.amount)/u,"MX$")]})]})]}),Q.jsx("button",{type:"submit",disabled:l,className:"w-full bg-gradient-to-r from-blue-600 to-purple-600 text-white py-2 px-4 rounded-md hover:from-blue-700 hover:to-purple-700 focus:outline-none focus:ring-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-200",children:l?"...":""})]}),"multiple"===r&&Q.jsxs("form",{onSubmit:async t=>{t.preventDefault();const r=i.filter(e=>e.accountId&&e.accountName&&e.amount);if(0!==r.length){c(!0);try{const t=[],n=await lp.getRechargeRecords();for(const a of r){const r=parseFloat(a.amount),s=r/u,i=n.filter(e=>e.account_id===a.accountId&&e.created_at.split("T")[0]===a.date).length+1;let o;o=1===i?` ${r} USD - ${a.advertiser} - ${a.date} - ${a.accountName}`:2===i?` ${r} USD - ${a.advertiser} - ${a.date} - ${a.accountName}`:3===i?` ${r} USD - ${a.advertiser} - ${a.date} - ${a.accountName}`:`${i} ${r} USD - ${a.advertiser} - ${a.date} - ${a.accountName}`;const l=e.find(e=>e.account_id===a.accountId),c=(l?l.balance:0)+s,d={account_id:a.accountId,amount:s,currency:"MX$",usd_amount:r,description:o,new_balance:c},h=await lp.addRecharge(d);t.push(h),n.push(h)}await h(),o([{date:(new Date).toISOString().split("T")[0],advertiser:"",accountId:"",accountName:"",amount:""}]),alert(` ${t.length} `)}catch(n){console.error("Error processing multiple recharge:",n),alert("")}finally{c(!1)}}else alert("ID")},className:"space-y-4",children:[Q.jsx("div",{className:"space-y-3",children:i.map((e,t)=>Q.jsxs("div",{className:"border border-gray-200 rounded-md p-4 bg-gray-50",children:[Q.jsxs("div",{className:"flex justify-between items-center mb-3",children:[Q.jsxs("h4",{className:"text-sm font-medium text-gray-700",children:[" ",t+1]}),i.length>1&&Q.jsx("button",{type:"button",onClick:()=>(e=>{if(i.length>1){const t=i.filter((t,r)=>r!==e);o(t)}})(t),className:"text-red-500 hover:text-red-700 text-sm",children:""})]}),Q.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-3",children:[Q.jsxs("div",{children:[Q.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:" *"}),Q.jsx("input",{type:"date",value:e.date,onChange:e=>m(t,"date",e.target.value),required:!0,className:"w-full px-2 py-1 text-xs border border-gray-300 rounded focus:outline-none focus:ring-1 focus:ring-blue-500"})]}),Q.jsxs("div",{children:[Q.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:" *"}),Q.jsx("select",{value:e.advertiser,onChange:e=>m(t,"advertiser",e.target.value),required:!0,className:"w-full px-2 py-1 text-xs border border-gray-300 rounded focus:outline-none focus:ring-1 focus:ring-blue-500",children:d.map(e=>Q.jsx("option",{value:e,children:e},e))})]}),Q.jsxs("div",{children:[Q.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:" *"}),Q.jsx("input",{type:"text",value:e.accountName,onChange:e=>m(t,"accountName",e.target.value),placeholder:"",required:!0,className:"w-full px-2 py-1 text-xs border border-gray-300 rounded focus:outline-none focus:ring-1 focus:ring-blue-500"})]}),Q.jsxs("div",{children:[Q.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"ID *"}),Q.jsx("input",{type:"text",value:e.accountId,onChange:e=>m(t,"accountId",e.target.value),placeholder:"ID",required:!0,className:"w-full px-2 py-1 text-xs border border-gray-300 rounded focus:outline-none focus:ring-1 focus:ring-blue-500"})]}),Q.jsxs("div",{children:[Q.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:" (USD) *"}),Q.jsx("input",{type:"number",step:"0.01",min:"0",value:e.amount,onChange:e=>m(t,"amount",e.target.value),className:"w-full px-2 py-1 text-xs border border-gray-300 rounded focus:outline-none focus:ring-1 focus:ring-blue-500",placeholder:"",required:!0}),e.amount&&Q.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:[" ",p(parseFloat(e.amount)/u,"MX$")]})]})]})]},t))}),Q.jsxs("div",{className:"flex space-x-2",children:[Q.jsx("button",{type:"button",onClick:()=>{o([...i,{date:(new Date).toISOString().split("T")[0],advertiser:"",accountId:"",accountName:"",amount:""}])},className:"flex-1 bg-gray-500 text-white py-2 px-4 rounded-md hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-gray-500 transition-all duration-200",children:"+ "}),Q.jsx("button",{type:"submit",disabled:l,className:"flex-1 bg-gradient-to-r from-green-600 to-blue-600 text-white py-2 px-4 rounded-md hover:from-green-700 hover:to-blue-700 focus:outline-none focus:ring-2 focus:ring-green-500 disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-200",children:l?"...":""})]})]})]}),Q.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-xl p-4 sm:p-6",children:[Q.jsx("h3",{className:"text-lg font-semibold text-blue-800 mb-3",children:" "}),Q.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm text-blue-700",children:[Q.jsxs("div",{children:[Q.jsx("h4",{className:"font-medium mb-2",children:""}),Q.jsxs("ul",{className:"space-y-1",children:[Q.jsx("li",{children:" "}),Q.jsx("li",{children:" "}),Q.jsx("li",{children:" "}),Q.jsx("li",{children:" "})]})]}),Q.jsxs("div",{children:[Q.jsx("h4",{className:"font-medium mb-2",children:""}),Q.jsxs("ul",{className:"space-y-1",children:[Q.jsx("li",{children:" "}),Q.jsx("li",{children:" "}),Q.jsx("li",{children:" "}),Q.jsx("li",{children:" IDUSD"})]})]})]}),Q.jsx("div",{className:"mt-4 p-3 bg-yellow-100 border border-yellow-300 rounded-lg",children:Q.jsxs("p",{className:"text-yellow-800 text-sm",children:[" ",Q.jsx("strong",{children:""}),'""(USD)1 USD = 18.18 MX$']})})]})]})},_p=()=>{const[e,t]=W.useState([]),[r,n]=W.useState([]),[a,s]=W.useState(!1),[i,o]=W.useState((new Date).toISOString().split("T")[0]),[l,c]=W.useState({}),[d,u]=W.useState(""),[h,f]=W.useState(""),[m,p]=W.useState(""),[g,x]=W.useState(""),[v,b]=W.useState(""),[y,w]=W.useState({}),_=["","","","",""],k=async()=>{s(!0);try{const[e,r]=await Promise.all([ip.getAccounts(),lp.getRechargeRecords()]);t(e),n(r),N(e,r)}catch(e){console.error("Error loading data:",e),alert("")}finally{s(!1)}},N=(e,t)=>{const r={};_.forEach(n=>{const a=t.filter(e=>e.advertiser===n&&e.created_at.split("T")[0]===i),s=a.reduce((e,t)=>e+parseFloat(t.amount||0),0),o={};a.forEach(t=>{const r=t.account_id;if(!o[r]){const t=e.find(e=>e.account_id===r);o[r]={account_id:r,account_name:(null==t?void 0:t.account_name)||r,total_amount:0,recharge_count:0}}o[r].total_amount+=parseFloat(t.amount||0),o[r].recharge_count+=1}),r[n]={advertiser:n,daily_recharge_amount:s,daily_count:a.length,account_details:Object.values(o)}}),c(r)};W.useEffect(()=>{k()},[]),W.useEffect(()=>{e.length>0&&r.length>0&&N(e,r)},[i,e,r]);const j=r.filter(e=>e.created_at.split("T")[0]===i);return Q.jsxs("div",{className:"space-y-6 pb-20",children:[Q.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[Q.jsx("h1",{className:"text-2xl font-bold text-gray-800 mb-4",children:""}),Q.jsxs("div",{className:"flex items-center space-x-4",children:[Q.jsx("label",{className:"text-sm font-medium text-gray-700",children:""}),Q.jsx("input",{type:"date",value:i,onChange:e=>o(e.target.value),className:"px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"}),Q.jsx("button",{onClick:k,disabled:a,className:"px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600 disabled:bg-gray-400",children:a?"...":""})]})]}),Q.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[Q.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-4",children:""}),Q.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-6 gap-4",children:[Q.jsxs("div",{children:[Q.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""}),Q.jsx("input",{type:"text",value:d,onChange:e=>u(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:""})]}),Q.jsxs("div",{children:[Q.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"ID"}),Q.jsx("input",{type:"text",value:h,onChange:e=>f(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"ID"})]}),Q.jsxs("div",{children:[Q.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""}),Q.jsxs("select",{value:m,onChange:e=>p(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[Q.jsx("option",{value:"",children:""}),_.map(e=>Q.jsx("option",{value:e,children:e},e))]})]}),Q.jsxs("div",{children:[Q.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"($)"}),Q.jsx("input",{type:"number",value:g,onChange:e=>x(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:""})]}),Q.jsxs("div",{children:[Q.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""}),Q.jsx("input",{type:"text",value:v,onChange:e=>b(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:""})]}),Q.jsx("div",{className:"flex items-end",children:Q.jsx("button",{onClick:async()=>{if(d&&h&&m&&g)try{const t=parseFloat(g),n=(new Date).toISOString().split("T")[0],a=r.filter(e=>e.account_id===h&&e.created_at.split("T")[0]===n).length+1;let s=v;s||(s=1===a?` $${t} - ${d} (${m})`:2===a?` $${t} - ${d} (${m})`:3===a?` $${t} - ${d} (${m})`:`${a} $${t} - ${d} (${m})`);let i=e.find(e=>e.account_id===h),o=t;if(i)o=parseFloat(i.balance||0)+t,await ip.updateAccountBalance(h,o);else{const e={account_id:h,account_name:d,balance:t,created_at:(new Date).toISOString()};await ip.addAccount(e)}const l={account_id:h,amount:t,currency:"USD",usd_amount:t,advertiser:m,description:s,new_balance:o,created_at:(new Date).toISOString()};await lp.addRecharge(l),alert(""),u(""),f(""),p(""),x(""),b(""),k()}catch(t){console.error(":",t),alert("")}else alert("ID")},className:"w-full px-4 py-2 bg-green-500 text-white rounded hover:bg-green-600",children:""})})]})]}),Q.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[Q.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-4",children:""}),Q.jsx("div",{className:"space-y-4 mb-6",children:Object.keys(y).map((e,t)=>{var r,n,a,s;return Q.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4 p-4 bg-gray-50 rounded-lg border",children:[Q.jsxs("div",{children:[Q.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""}),Q.jsx("input",{type:"text",value:(null==(r=y[e])?void 0:r.accountName)||"",onChange:t=>w(r=>({...r,[e]:{...r[e],accountName:t.target.value}})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:""})]}),Q.jsxs("div",{children:[Q.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"ID"}),Q.jsx("input",{type:"text",value:(null==(n=y[e])?void 0:n.accountId)||"",onChange:t=>w(r=>({...r,[e]:{...r[e],accountId:t.target.value}})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"ID"})]}),Q.jsxs("div",{children:[Q.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""}),Q.jsxs("select",{value:(null==(a=y[e])?void 0:a.advertiser)||"",onChange:t=>w(r=>({...r,[e]:{...r[e],advertiser:t.target.value}})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[Q.jsx("option",{value:"",children:""}),_.map(e=>Q.jsx("option",{value:e,children:e},e))]})]}),Q.jsxs("div",{children:[Q.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"($)"}),Q.jsx("input",{type:"number",value:(null==(s=y[e])?void 0:s.amount)||"",onChange:t=>w(r=>({...r,[e]:{...r[e],amount:t.target.value}})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:""})]}),Q.jsx("div",{className:"flex items-end",children:Q.jsx("button",{onClick:()=>{const t={...y};delete t[e],w(t)},className:"w-full px-4 py-2 bg-red-500 text-white rounded hover:bg-red-600",children:""})})]},e)})}),Q.jsxs("div",{className:"flex space-x-4",children:[Q.jsx("button",{onClick:()=>{const e=`batch_${Date.now()}`;w(t=>({...t,[e]:{accountName:"",accountId:"",advertiser:"",amount:""}}))},className:"px-6 py-2 bg-green-500 text-white rounded hover:bg-green-600",children:"+ "}),Q.jsx("button",{onClick:async()=>{const t=Object.entries(y).filter(([e,t])=>t&&t.accountName&&t.accountId&&t.advertiser&&t.amount&&parseFloat(t.amount)>0);if(0!==t.length)try{const n=(new Date).toISOString().split("T")[0];for(const[a,s]of t){const{accountName:t,accountId:a,advertiser:i,amount:o}=s,l=parseFloat(o),c=r.filter(e=>e.account_id===a&&e.created_at.split("T")[0]===n).length+1;let d;d=1===c?` $${l} - ${t} (${i})`:2===c?` $${l} - ${t} (${i})`:3===c?` $${l} - ${t} (${i})`:`${c} $${l} - ${t} (${i})`;let u=e.find(e=>e.account_id===a),h=l;if(u)h=parseFloat(u.balance||0)+l,await ip.updateAccountBalance(a,h);else{const e={account_id:a,account_name:t,balance:l,created_at:(new Date).toISOString()};await ip.addAccount(e)}const f={account_id:a,amount:l,currency:"USD",usd_amount:l,advertiser:i,description:d,new_balance:h,created_at:(new Date).toISOString()};await lp.addRecharge(f)}alert(""),w({}),k()}catch(n){console.error(":",n),alert("")}else alert("ID")},className:"px-6 py-2 bg-blue-500 text-white rounded hover:bg-blue-600",children:""})]})]}),Q.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[Q.jsxs("h2",{className:"text-xl font-semibold text-gray-800 mb-4",children:[i," "]}),a?Q.jsxs("div",{className:"text-center py-8",children:[Q.jsx("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500"}),Q.jsx("p",{className:"mt-2 text-gray-600",children:"..."})]}):Q.jsx("div",{className:"space-y-6",children:_.map(e=>{const t=l[e]||{daily_recharge_amount:0,daily_count:0,account_details:[]};return Q.jsxs("div",{className:"bg-gray-50 rounded-lg p-6 border",children:[Q.jsxs("div",{className:"flex justify-between items-center mb-4",children:[Q.jsx("h3",{className:"font-semibold text-gray-800 text-xl",children:e}),Q.jsxs("div",{className:"text-right",children:[Q.jsxs("p",{className:"text-lg font-bold text-green-600",children:[": $",t.daily_recharge_amount.toLocaleString()]}),Q.jsxs("p",{className:"text-sm text-gray-600",children:[t.daily_count," "]})]})]}),t.account_details.length>0?Q.jsxs("div",{className:"space-y-3",children:[Q.jsx("h4",{className:"font-medium text-gray-700 text-sm",children:":"}),Q.jsx("div",{className:"grid grid-cols-1 gap-3",children:t.account_details.map((e,t)=>Q.jsx("div",{className:"bg-white rounded-lg p-3 border border-gray-200",children:Q.jsxs("div",{className:"flex justify-between items-center",children:[Q.jsxs("div",{children:[Q.jsx("p",{className:"font-medium text-gray-800",children:e.account_name}),Q.jsxs("p",{className:"text-sm text-gray-500",children:["ID: ",e.account_id]})]}),Q.jsxs("div",{className:"text-right",children:[Q.jsxs("p",{className:"font-bold text-green-600",children:["$",e.total_amount.toLocaleString()]}),Q.jsxs("p",{className:"text-xs text-gray-500",children:[e.recharge_count," "]})]})]})},e.account_id))})]}):Q.jsx("div",{className:"text-center py-4 text-gray-500 text-sm",children:""})]},e)})})]}),Q.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[Q.jsxs("h2",{className:"text-xl font-semibold text-gray-800 mb-4",children:[i,"  (",j.length," )"]}),0===j.length?Q.jsx("div",{className:"text-center py-8 text-gray-500",children:""}):Q.jsx("div",{className:"overflow-x-auto",children:Q.jsxs("table",{className:"min-w-full table-auto border-collapse",children:[Q.jsx("thead",{children:Q.jsxs("tr",{className:"bg-gray-50",children:[Q.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider border-b",children:""}),Q.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider border-b",children:"ID"}),Q.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider border-b",children:""}),Q.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider border-b",children:""}),Q.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider border-b",children:""}),Q.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider border-b",children:""}),Q.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider border-b",children:""})]})}),Q.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:j.map((e,t)=>{return Q.jsxs("tr",{className:"hover:bg-gray-50",children:[Q.jsx("td",{className:"px-4 py-4 whitespace-nowrap text-sm text-gray-900 border-b",children:(r=e.created_at,new Date(r).toLocaleString("zh-CN"))}),Q.jsx("td",{className:"px-4 py-4 whitespace-nowrap text-sm text-gray-600 border-b",children:e.account_id}),Q.jsx("td",{className:"px-4 py-4 whitespace-nowrap text-sm font-medium text-purple-600 border-b",children:e.advertiser||"-"}),Q.jsxs("td",{className:"px-4 py-4 whitespace-nowrap text-sm font-medium text-green-600 border-b",children:["$",parseFloat(e.amount||0).toLocaleString()]}),Q.jsx("td",{className:"px-4 py-4 text-sm text-gray-600 border-b max-w-xs truncate",children:e.description}),Q.jsxs("td",{className:"px-4 py-4 whitespace-nowrap text-sm font-medium text-blue-600 border-b",children:["$",parseFloat(e.new_balance||0).toLocaleString()]}),Q.jsx("td",{className:"px-4 py-4 whitespace-nowrap text-sm border-b",children:Q.jsx("button",{onClick:()=>(async e=>{if(window.confirm(""))try{await lp.deleteRecharge(e),alert(""),k()}catch(t){console.error("Error deleting recharge:",t),alert("")}})(e.id),className:"px-3 py-1 bg-red-500 text-white text-xs rounded hover:bg-red-600 transition-colors",title:"",children:""})})]},e.id||t);var r})})]})})]})]})},kp=()=>{var e,t,r,n,a,s,i,o,l;const[c,d]=W.useState((new Date).toISOString().split("T")[0]),[u,h]=W.useState(20),[f,m]=W.useState(!1),[p,g]=W.useState([]),[x,v]=W.useState({}),[b,y]=W.useState(""),[w,_]=W.useState(""),[k,N]=W.useState(""),j=async()=>{m(!0);try{const e=await dp.getDailyOrders();g(e),S(e)}catch(e){console.error(":",e),alert("")}finally{m(!1)}},S=e=>{const t=e.filter(e=>e.date===c),r=t.reduce((e,t)=>e+parseFloat(t.new_card_amount||0),0),n=t.reduce((e,t)=>e+parseFloat(t.old_card_amount||0),0),a=t.filter(e=>parseFloat(e.new_card_amount||0)>0).length,s=t.filter(e=>parseFloat(e.old_card_amount||0)>0).length,i={new_card:{count:a,amount:r,usd_amount:r/u},old_card:{count:s,amount:n,usd_amount:n/u},total:{amount:r+n,usd_amount:(r+n)/u,record_count:t.length}};v(i)};W.useEffect(()=>{j()},[]),W.useEffect(()=>{p.length>0&&S(p)},[c,u,p]);const T=(e,t="MX$")=>`${t}${parseFloat(e||0).toLocaleString("es-MX",{minimumFractionDigits:2})}`,E=p.filter(e=>e.date===c);return Q.jsxs("div",{className:"space-y-6 pb-20",children:[Q.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[Q.jsx("h1",{className:"text-2xl font-bold text-gray-800 mb-4",children:" "}),Q.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[Q.jsxs("div",{children:[Q.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""}),Q.jsx("input",{type:"date",value:c,onChange:e=>d(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),Q.jsxs("div",{children:[Q.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"MX$  (USD)"}),Q.jsx("input",{type:"number",step:"0.01",value:u,onChange:e=>h(parseFloat(e.target.value)||20),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:": 20.00"})]}),Q.jsx("div",{className:"flex items-end",children:Q.jsx("button",{onClick:j,disabled:f,className:"w-full px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600 disabled:bg-gray-400",children:f?"...":""})})]})]}),Q.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[Q.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-4",children:" "}),Q.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4",children:[Q.jsxs("div",{children:[Q.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:" (MX$)"}),Q.jsx("input",{type:"number",step:"0.01",value:b,onChange:e=>y(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:""})]}),Q.jsxs("div",{children:[Q.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:" (MX$)"}),Q.jsx("input",{type:"number",step:"0.01",value:w,onChange:e=>_(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:""})]}),Q.jsxs("div",{children:[Q.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""}),Q.jsx("input",{type:"text",value:k,onChange:e=>N(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:""})]}),Q.jsxs("div",{children:[Q.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"USD "}),Q.jsxs("div",{className:"w-full px-3 py-2 bg-gray-100 border border-gray-300 rounded-md text-gray-700",children:["$",((parseFloat(b||0)+parseFloat(w||0))/u).toFixed(2)]})]}),Q.jsx("div",{className:"flex items-end",children:Q.jsx("button",{onClick:async()=>{if(b||w)try{const e={date:c,new_card_amount:parseFloat(b||0),old_card_amount:parseFloat(w||0),exchange_rate:u,description:k||`${c} `,created_at:(new Date).toISOString()};await dp.addDailyOrder(e),alert(""),y(""),_(""),N(""),j()}catch(e){console.error(":",e),alert("")}else alert("")},className:"w-full px-4 py-2 bg-green-500 text-white rounded hover:bg-green-600",children:""})})]})]}),Q.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[Q.jsxs("h2",{className:"text-xl font-semibold text-gray-800 mb-4",children:[" ",c," "]}),f?Q.jsxs("div",{className:"text-center py-8",children:[Q.jsx("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500"}),Q.jsx("p",{className:"mt-2 text-gray-600",children:"..."})]}):Q.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[Q.jsx("div",{className:"bg-gradient-to-r from-blue-50 to-blue-100 rounded-lg p-6 border border-blue-200",children:Q.jsxs("div",{className:"text-center",children:[Q.jsx("h3",{className:"text-lg font-semibold text-blue-800 mb-2",children:" "}),Q.jsxs("p",{className:"text-2xl font-bold text-blue-600 mb-1",children:[(null==(e=x.new_card)?void 0:e.count)||0," "]}),Q.jsx("p",{className:"text-xl font-semibold text-blue-600 mb-1",children:T((null==(t=x.new_card)?void 0:t.amount)||0)}),Q.jsxs("p",{className:"text-sm text-blue-500",children:["($",((null==(r=x.new_card)?void 0:r.usd_amount)||0).toFixed(2)," USD)"]})]})}),Q.jsx("div",{className:"bg-gradient-to-r from-purple-50 to-purple-100 rounded-lg p-6 border border-purple-200",children:Q.jsxs("div",{className:"text-center",children:[Q.jsx("h3",{className:"text-lg font-semibold text-purple-800 mb-2",children:" "}),Q.jsxs("p",{className:"text-2xl font-bold text-purple-600 mb-1",children:[(null==(n=x.old_card)?void 0:n.count)||0," "]}),Q.jsx("p",{className:"text-xl font-semibold text-purple-600 mb-1",children:T((null==(a=x.old_card)?void 0:a.amount)||0)}),Q.jsxs("p",{className:"text-sm text-purple-500",children:["($",((null==(s=x.old_card)?void 0:s.usd_amount)||0).toFixed(2)," USD)"]})]})}),Q.jsx("div",{className:"bg-gradient-to-r from-green-50 to-green-100 rounded-lg p-6 border border-green-200",children:Q.jsxs("div",{className:"text-center",children:[Q.jsx("h3",{className:"text-lg font-semibold text-green-800 mb-2",children:" "}),Q.jsxs("p",{className:"text-2xl font-bold text-green-600 mb-1",children:[(null==(i=x.total)?void 0:i.record_count)||0," "]}),Q.jsx("p",{className:"text-xl font-semibold text-green-600 mb-1",children:T((null==(o=x.total)?void 0:o.amount)||0)}),Q.jsxs("p",{className:"text-sm text-green-500",children:["($",((null==(l=x.total)?void 0:l.usd_amount)||0).toFixed(2)," USD)"]})]})})]})]}),Q.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[Q.jsxs("h2",{className:"text-xl font-semibold text-gray-800 mb-4",children:[" ",c,"  (",E.length," )"]}),0===E.length?Q.jsx("div",{className:"text-center py-8 text-gray-500",children:""}):Q.jsx("div",{className:"overflow-x-auto",children:Q.jsxs("table",{className:"min-w-full table-auto border-collapse",children:[Q.jsx("thead",{children:Q.jsxs("tr",{className:"bg-gray-50",children:[Q.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider border-b",children:""}),Q.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider border-b",children:""}),Q.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider border-b",children:""}),Q.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider border-b",children:" (MX$)"}),Q.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider border-b",children:"USD "}),Q.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider border-b",children:""}),Q.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider border-b",children:""})]})}),Q.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:E.map((e,t)=>{return Q.jsxs("tr",{className:"hover:bg-gray-50",children:[Q.jsx("td",{className:"px-4 py-4 whitespace-nowrap text-sm text-gray-900 border-b",children:(r=e.created_at,new Date(r).toLocaleString("zh-CN"))}),Q.jsx("td",{className:"px-4 py-4 whitespace-nowrap text-sm font-medium text-blue-600 border-b",children:T(e.new_card_amount)}),Q.jsx("td",{className:"px-4 py-4 whitespace-nowrap text-sm font-medium text-purple-600 border-b",children:T(e.old_card_amount)}),Q.jsx("td",{className:"px-4 py-4 whitespace-nowrap text-sm font-bold text-green-600 border-b",children:T(parseFloat(e.new_card_amount||0)+parseFloat(e.old_card_amount||0))}),Q.jsxs("td",{className:"px-4 py-4 whitespace-nowrap text-sm font-medium text-gray-900 border-b",children:["$",((parseFloat(e.new_card_amount||0)+parseFloat(e.old_card_amount||0))/(e.exchange_rate||u)).toFixed(2)]}),Q.jsx("td",{className:"px-4 py-4 text-sm text-gray-600 border-b max-w-xs truncate",children:e.description}),Q.jsx("td",{className:"px-4 py-4 whitespace-nowrap text-sm border-b",children:Q.jsx("button",{onClick:()=>(async e=>{if(confirm(""))try{await dp.deleteDailyOrder(e),alert(""),j()}catch(t){console.error(":",t),alert("")}})(e.id),className:"px-3 py-1 bg-red-500 text-white text-xs rounded hover:bg-red-600 transition-colors",title:"",children:""})})]},e.id||t);var r})})]})})]})]})};ap("https://pfkqocxbvnfebuhrjnxm.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InBma3FvY3hidm5mZWJ1aHJqbnhtIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTI0OTMwNjksImV4cCI6MjA2ODA2OTA2OX0.B-IoA9SkLH8tmj9xXObklN9PmDj1jnj9B9lpChDDgMM");
/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */
var Np=1252,jp=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],Sp={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},Tp=function(e){-1!=jp.indexOf(e)&&(Np=Sp[0]=e)};var Ep=function(e){Tp(e)};function Cp(){Ep(1200),Tp(1252)}function Ap(e){for(var t=[],r=0,n=e.length;r<n;++r)t[r]=e.charCodeAt(r);return t}function Op(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r+1)+(e.charCodeAt(2*r)<<8));return t.join("")}var Ip,Rp=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1);return 255==t&&254==r?function(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r)+(e.charCodeAt(2*r+1)<<8));return t.join("")}(e.slice(2)):254==t&&255==r?Op(e.slice(2)):65279==t?e.slice(1):e},Pp=function(e){return String.fromCharCode(e)},Dp=function(e){return String.fromCharCode(e)},Lp="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Mp(e){for(var t="",r=0,n=0,a=0,s=0,i=0,o=0,l=0,c=0;c<e.length;)s=(r=e.charCodeAt(c++))>>2,i=(3&r)<<4|(n=e.charCodeAt(c++))>>4,o=(15&n)<<2|(a=e.charCodeAt(c++))>>6,l=63&a,isNaN(n)?o=l=64:isNaN(a)&&(l=64),t+=Lp.charAt(s)+Lp.charAt(i)+Lp.charAt(o)+Lp.charAt(l);return t}function Fp(e){var t="",r=0,n=0,a=0,s=0,i=0,o=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var l=0;l<e.length;)r=Lp.indexOf(e.charAt(l++))<<2|(s=Lp.indexOf(e.charAt(l++)))>>4,t+=String.fromCharCode(r),n=(15&s)<<4|(i=Lp.indexOf(e.charAt(l++)))>>2,64!==i&&(t+=String.fromCharCode(n)),a=(3&i)<<6|(o=Lp.indexOf(e.charAt(l++))),64!==o&&(t+=String.fromCharCode(a));return t}var Up=function(){return"undefined"!=typeof Buffer&&"undefined"!=typeof process&&void 0!==process.versions&&!!process.versions.node}(),Bp=function(){if("undefined"!=typeof Buffer){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch(t){e=!0}return e?function(e,t){return t?new Buffer(e,t):new Buffer(e)}:Buffer.from.bind(Buffer)}return function(){}}();function $p(e){return Up?Buffer.alloc?Buffer.alloc(e):new Buffer(e):"undefined"!=typeof Uint8Array?new Uint8Array(e):new Array(e)}function zp(e){return Up?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):"undefined"!=typeof Uint8Array?new Uint8Array(e):new Array(e)}var Vp=function(e){return Up?Bp(e,"binary"):e.split("").map(function(e){return 255&e.charCodeAt(0)})};function Wp(e){if(Array.isArray(e))return e.map(function(e){return String.fromCharCode(e)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function Hp(e){if("undefined"==typeof ArrayBuffer)throw new Error("Unsupported");if(e instanceof ArrayBuffer)return Hp(new Uint8Array(e));for(var t=new Array(e.length),r=0;r<e.length;++r)t[r]=e[r];return t}var Gp=Up?function(e){return Buffer.concat(e.map(function(e){return Buffer.isBuffer(e)?e:Bp(e)}))}:function(e){if("undefined"!=typeof Uint8Array){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var n=new Uint8Array(r),a=0;for(t=0,r=0;t<e.length;r+=a,++t)if(a=e[t].length,e[t]instanceof Uint8Array)n.set(e[t],r);else{if("string"==typeof e[t])throw"wtf";n.set(new Uint8Array(e[t]),r)}return n}return[].concat.apply([],e.map(function(e){return Array.isArray(e)?e:[].slice.call(e)}))};var qp=/\u0000/g,Kp=/[\u0001-\u0006]/g;function Xp(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function Yp(e,t){var r=""+e;return r.length>=t?r:ax("0",t-r.length)+r}function Jp(e,t){var r=""+e;return r.length>=t?r:ax(" ",t-r.length)+r}function Zp(e,t){var r=""+e;return r.length>=t?r:r+ax(" ",t-r.length)}var Qp=Math.pow(2,32);function eg(e,t){return e>Qp||e<-Qp?function(e,t){var r=""+Math.round(e);return r.length>=t?r:ax("0",t-r.length)+r}(e,t):function(e,t){var r=""+e;return r.length>=t?r:ax("0",t-r.length)+r}(Math.round(e),t)}function tg(e,t){return t=t||0,e.length>=7+t&&103==(32|e.charCodeAt(t))&&101==(32|e.charCodeAt(t+1))&&110==(32|e.charCodeAt(t+2))&&101==(32|e.charCodeAt(t+3))&&114==(32|e.charCodeAt(t+4))&&97==(32|e.charCodeAt(t+5))&&108==(32|e.charCodeAt(t+6))}var rg=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],ng=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];var ag={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},sg={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},ig={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function og(e,t,r){for(var n=e<0?-1:1,a=e*n,s=0,i=1,o=0,l=1,c=0,d=0,u=Math.floor(a);c<t&&(o=(u=Math.floor(a))*i+s,d=u*c+l,!(a-u<5e-8));)a=1/(a-u),s=i,i=o,l=c,c=d;if(d>t&&(c>t?(d=l,o=s):(d=c,o=i)),!r)return[0,n*o,d];var h=Math.floor(n*o/d);return[h,n*o-h*d,d]}function lg(e,t,r){if(e>2958465||e<0)return null;var n=0|e,a=Math.floor(86400*(e-n)),s=0,i=[],o={D:n,T:a,u:86400*(e-n)-a,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),t&&t.date1904&&(n+=1462),o.u>.9999&&(o.u=0,86400==++a&&(o.T=a=0,++n,++o.D)),60===n)i=r?[1317,10,29]:[1900,2,29],s=3;else if(0===n)i=r?[1317,8,29]:[1900,1,0],s=6;else{n>60&&--n;var l=new Date(1900,0,1);l.setDate(l.getDate()+n-1),i=[l.getFullYear(),l.getMonth()+1,l.getDate()],s=l.getDay(),n<60&&(s=(s+6)%7),r&&(s=function(e,t){t[0]-=581;var r=e.getDay();e<60&&(r=(r+6)%7);return r}(l,i))}return o.y=i[0],o.m=i[1],o.d=i[2],o.S=a%60,a=Math.floor(a/60),o.M=a%60,a=Math.floor(a/60),o.H=a,o.q=s,o}var cg=new Date(1899,11,31,0,0,0),dg=cg.getTime(),ug=new Date(1900,2,1,0,0,0);function hg(e,t){var r=e.getTime();return t?r-=1262304e5:e>=ug&&(r+=864e5),(r-(dg+6e4*(e.getTimezoneOffset()-cg.getTimezoneOffset())))/864e5}function fg(e){return-1==e.indexOf(".")?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function mg(e){var t,r=Math.floor(Math.log(Math.abs(e))*Math.LOG10E);return t=r>=-4&&r<=-1?e.toPrecision(10+r):Math.abs(r)<=9?function(e){var t=e<0?12:11,r=fg(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10)).length<=t?r:e.toExponential(5)}(e):10===r?e.toFixed(10).substr(0,12):function(e){var t=fg(e.toFixed(11));return t.length>(e<0?12:11)||"0"===t||"-0"===t?e.toPrecision(6):t}(e),fg(function(e){return-1==e.indexOf("E")?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}(t.toUpperCase()))}function pg(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(0|e)===e?e.toString(10):mg(e);case"undefined":return"";case"object":if(null==e)return"";if(e instanceof Date)return Lg(14,hg(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function gg(e,t,r,n){var a,s="",i=0,o=0,l=r.y,c=0;switch(e){case 98:l=r.y+543;case 121:switch(t.length){case 1:case 2:a=l%100,c=2;break;default:a=l%1e4,c=4}break;case 109:switch(t.length){case 1:case 2:a=r.m,c=t.length;break;case 3:return ng[r.m-1][1];case 5:return ng[r.m-1][0];default:return ng[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:a=r.d,c=t.length;break;case 3:return rg[r.q][0];default:return rg[r.q][1]}break;case 104:switch(t.length){case 1:case 2:a=1+(r.H+11)%12,c=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:a=r.H,c=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:a=r.M,c=t.length;break;default:throw"bad minute format: "+t}break;case 115:if("s"!=t&&"ss"!=t&&".0"!=t&&".00"!=t&&".000"!=t)throw"bad second format: "+t;return 0!==r.u||"s"!=t&&"ss"!=t?(o=n>=2?3===n?1e3:100:1===n?10:1,(i=Math.round(o*(r.S+r.u)))>=60*o&&(i=0),"s"===t?0===i?"0":""+i/o:(s=Yp(i,2+n),"ss"===t?s.substr(0,2):"."+s.substr(2,t.length-1))):Yp(r.S,t.length);case 90:switch(t){case"[h]":case"[hh]":a=24*r.D+r.H;break;case"[m]":case"[mm]":a=60*(24*r.D+r.H)+r.M;break;case"[s]":case"[ss]":a=60*(60*(24*r.D+r.H)+r.M)+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}c=3===t.length?1:2;break;case 101:a=l,c=1}return c>0?Yp(a,c):""}function xg(e){if(e.length<=3)return e;for(var t=e.length%3,r=e.substr(0,t);t!=e.length;t+=3)r+=(r.length>0?",":"")+e.substr(t,3);return r}var vg=/%/g;function bg(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(0==t)return"0.0E+0";if(t<0)return"-"+bg(e,-t);var a=e.indexOf(".");-1===a&&(a=e.indexOf("E"));var s=Math.floor(Math.log(t)*Math.LOG10E)%a;if(s<0&&(s+=a),-1===(r=(t/Math.pow(10,s)).toPrecision(n+1+(a+s)%a)).indexOf("e")){var i=Math.floor(Math.log(t)*Math.LOG10E);for(-1===r.indexOf(".")?r=r.charAt(0)+"."+r.substr(1)+"E+"+(i-r.length+s):r+="E+"+(i-s);"0."===r.substr(0,2);)r=(r=r.charAt(0)+r.substr(2,a)+"."+r.substr(2+a)).replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(e,t,r,n){return t+r+n.substr(0,(a+s)%a)+"."+n.substr(s)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var yg=/# (\?+)( ?)\/( ?)(\d+)/;var wg=/^#*0*\.([0#]+)/,_g=/\).*[0#]/,kg=/\(###\) ###\\?-####/;function Ng(e){for(var t,r="",n=0;n!=e.length;++n)switch(t=e.charCodeAt(n)){case 35:break;case 63:r+=" ";break;case 48:r+="0";break;default:r+=String.fromCharCode(t)}return r}function jg(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function Sg(e,t){var r=e-Math.floor(e),n=Math.pow(10,t);return t<(""+Math.round(r*n)).length?0:Math.round(r*n)}function Tg(e,t,r){if(40===e.charCodeAt(0)&&!t.match(_g)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Tg("n",n,r):"("+Tg("n",n,-r)+")"}if(44===t.charCodeAt(t.length-1))return function(e,t,r){for(var n=t.length-1;44===t.charCodeAt(n-1);)--n;return Ag(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}(e,t,r);if(-1!==t.indexOf("%"))return function(e,t,r){var n=t.replace(vg,""),a=t.length-n.length;return Ag(e,n,r*Math.pow(10,2*a))+ax("%",a)}(e,t,r);if(-1!==t.indexOf("E"))return bg(t,r);if(36===t.charCodeAt(0))return"$"+Tg(e,t.substr(" "==t.charAt(1)?2:1),r);var a,s,i,o,l=Math.abs(r),c=r<0?"-":"";if(t.match(/^00+$/))return c+eg(l,t.length);if(t.match(/^[#?]+$/))return"0"===(a=eg(r,0))&&(a=""),a.length>t.length?a:Ng(t.substr(0,t.length-a.length))+a;if(s=t.match(yg))return function(e,t,r){var n=parseInt(e[4],10),a=Math.round(t*n),s=Math.floor(a/n),i=a-s*n,o=n;return r+(0===s?"":""+s)+" "+(0===i?ax(" ",e[1].length+1+e[4].length):Jp(i,e[1].length)+e[2]+"/"+e[3]+Yp(o,e[4].length))}(s,l,c);if(t.match(/^#+0+$/))return c+eg(l,t.length-t.indexOf("0"));if(s=t.match(wg))return a=jg(r,s[1].length).replace(/^([^\.]+)$/,"$1."+Ng(s[1])).replace(/\.$/,"."+Ng(s[1])).replace(/\.(\d*)$/,function(e,t){return"."+t+ax("0",Ng(s[1]).length-t.length)}),-1!==t.indexOf("0.")?a:a.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),s=t.match(/^(0*)\.(#*)$/))return c+jg(l,s[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=t.match(/^#{1,3},##0(\.?)$/))return c+xg(eg(l,0));if(s=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Tg(e,t,-r):xg(""+(Math.floor(r)+function(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}(r,s[1].length)))+"."+Yp(Sg(r,s[1].length),s[1].length);if(s=t.match(/^#,#*,#0/))return Tg(e,t.replace(/^#,#*,/,""),r);if(s=t.match(/^([0#]+)(\\?-([0#]+))+$/))return a=Xp(Tg(e,t.replace(/[\\-]/g,""),r)),i=0,Xp(Xp(t.replace(/\\/g,"")).replace(/[0#]/g,function(e){return i<a.length?a.charAt(i++):"0"===e?"0":""}));if(t.match(kg))return"("+(a=Tg(e,"##########",r)).substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var d="";if(s=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(s[4].length,7),o=og(l,Math.pow(10,i)-1,!1),a=""+c," "==(d=Ag("n",s[1],o[1])).charAt(d.length-1)&&(d=d.substr(0,d.length-1)+"0"),a+=d+s[2]+"/"+s[3],(d=Zp(o[2],i)).length<s[4].length&&(d=Ng(s[4].substr(s[4].length-d.length))+d),a+=d;if(s=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(Math.max(s[1].length,s[4].length),7),c+((o=og(l,Math.pow(10,i)-1,!0))[0]||(o[1]?"":"0"))+" "+(o[1]?Jp(o[1],i)+s[2]+"/"+s[3]+Zp(o[2],i):ax(" ",2*i+1+s[2].length+s[3].length));if(s=t.match(/^[#0?]+$/))return a=eg(r,0),t.length<=a.length?a:Ng(t.substr(0,t.length-a.length))+a;if(s=t.match(/^([#0?]+)\.([#0]+)$/)){a=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),i=a.indexOf(".");var u=t.indexOf(".")-i,h=t.length-a.length-u;return Ng(t.substr(0,u)+a+t.substr(t.length-h))}if(s=t.match(/^00,000\.([#0]*0)$/))return i=Sg(r,s[1].length),r<0?"-"+Tg(e,t,-r):xg(function(e){return e<2147483647&&e>-2147483648?""+(e>=0?0|e:e-1|0):""+Math.floor(e)}(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(e){return"00,"+(e.length<3?Yp(0,3-e.length):"")+e})+"."+Yp(i,s[1].length);switch(t){case"###,##0.00":return Tg(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var f=xg(eg(l,0));return"0"!==f?c+f:"";case"###,###.00":return Tg(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return Tg(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function Eg(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(0==t)return"0.0E+0";if(t<0)return"-"+Eg(e,-t);var a=e.indexOf(".");-1===a&&(a=e.indexOf("E"));var s=Math.floor(Math.log(t)*Math.LOG10E)%a;if(s<0&&(s+=a),!(r=(t/Math.pow(10,s)).toPrecision(n+1+(a+s)%a)).match(/[Ee]/)){var i=Math.floor(Math.log(t)*Math.LOG10E);-1===r.indexOf(".")?r=r.charAt(0)+"."+r.substr(1)+"E+"+(i-r.length+s):r+="E+"+(i-s),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(e,t,r,n){return t+r+n.substr(0,(a+s)%a)+"."+n.substr(s)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function Cg(e,t,r){if(40===e.charCodeAt(0)&&!t.match(_g)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Cg("n",n,r):"("+Cg("n",n,-r)+")"}if(44===t.charCodeAt(t.length-1))return function(e,t,r){for(var n=t.length-1;44===t.charCodeAt(n-1);)--n;return Ag(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}(e,t,r);if(-1!==t.indexOf("%"))return function(e,t,r){var n=t.replace(vg,""),a=t.length-n.length;return Ag(e,n,r*Math.pow(10,2*a))+ax("%",a)}(e,t,r);if(-1!==t.indexOf("E"))return Eg(t,r);if(36===t.charCodeAt(0))return"$"+Cg(e,t.substr(" "==t.charAt(1)?2:1),r);var a,s,i,o,l=Math.abs(r),c=r<0?"-":"";if(t.match(/^00+$/))return c+Yp(l,t.length);if(t.match(/^[#?]+$/))return a=""+r,0===r&&(a=""),a.length>t.length?a:Ng(t.substr(0,t.length-a.length))+a;if(s=t.match(yg))return function(e,t,r){return r+(0===t?"":""+t)+ax(" ",e[1].length+2+e[4].length)}(s,l,c);if(t.match(/^#+0+$/))return c+Yp(l,t.length-t.indexOf("0"));if(s=t.match(wg))return a=(a=(""+r).replace(/^([^\.]+)$/,"$1."+Ng(s[1])).replace(/\.$/,"."+Ng(s[1]))).replace(/\.(\d*)$/,function(e,t){return"."+t+ax("0",Ng(s[1]).length-t.length)}),-1!==t.indexOf("0.")?a:a.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),s=t.match(/^(0*)\.(#*)$/))return c+(""+l).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=t.match(/^#{1,3},##0(\.?)$/))return c+xg(""+l);if(s=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Cg(e,t,-r):xg(""+r)+"."+ax("0",s[1].length);if(s=t.match(/^#,#*,#0/))return Cg(e,t.replace(/^#,#*,/,""),r);if(s=t.match(/^([0#]+)(\\?-([0#]+))+$/))return a=Xp(Cg(e,t.replace(/[\\-]/g,""),r)),i=0,Xp(Xp(t.replace(/\\/g,"")).replace(/[0#]/g,function(e){return i<a.length?a.charAt(i++):"0"===e?"0":""}));if(t.match(kg))return"("+(a=Cg(e,"##########",r)).substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var d="";if(s=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(s[4].length,7),o=og(l,Math.pow(10,i)-1,!1),a=""+c," "==(d=Ag("n",s[1],o[1])).charAt(d.length-1)&&(d=d.substr(0,d.length-1)+"0"),a+=d+s[2]+"/"+s[3],(d=Zp(o[2],i)).length<s[4].length&&(d=Ng(s[4].substr(s[4].length-d.length))+d),a+=d;if(s=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(Math.max(s[1].length,s[4].length),7),c+((o=og(l,Math.pow(10,i)-1,!0))[0]||(o[1]?"":"0"))+" "+(o[1]?Jp(o[1],i)+s[2]+"/"+s[3]+Zp(o[2],i):ax(" ",2*i+1+s[2].length+s[3].length));if(s=t.match(/^[#0?]+$/))return a=""+r,t.length<=a.length?a:Ng(t.substr(0,t.length-a.length))+a;if(s=t.match(/^([#0]+)\.([#0]+)$/)){a=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),i=a.indexOf(".");var u=t.indexOf(".")-i,h=t.length-a.length-u;return Ng(t.substr(0,u)+a+t.substr(t.length-h))}if(s=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+Cg(e,t,-r):xg(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(e){return"00,"+(e.length<3?Yp(0,3-e.length):"")+e})+"."+Yp(0,s[1].length);switch(t){case"###,###":case"##,###":case"#,###":var f=xg(""+l);return"0"!==f?c+f:"";default:if(t.match(/\.[0#?]*$/))return Cg(e,t.slice(0,t.lastIndexOf(".")),r)+Ng(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function Ag(e,t,r){return(0|r)===r?Cg(e,t,r):Tg(e,t,r)}var Og=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Ig(e){for(var t=0,r="",n="";t<e.length;)switch(r=e.charAt(t)){case"G":tg(e,t)&&(t+=6),t++;break;case'"':for(;34!==e.charCodeAt(++t)&&t<e.length;);++t;break;case"\\":case"_":t+=2;break;case"@":++t;break;case"B":case"b":if("1"===e.charAt(t+1)||"2"===e.charAt(t+1))return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if("A/P"===e.substr(t,3).toUpperCase())return!0;if("AM/PM"===e.substr(t,5).toUpperCase())return!0;if("/"===e.substr(t,5).toUpperCase())return!0;++t;break;case"[":for(n=r;"]"!==e.charAt(t++)&&t<e.length;)n+=e.charAt(t);if(n.match(Og))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||"\\"==r&&"-"==e.charAt(t+1)&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t," "!=e.charAt(t)&&"*"!=e.charAt(t)||++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;default:++t}return!1}var Rg=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function Pg(e,t){if(null==t)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0}return!1}function Dg(e,t){var r=function(e){for(var t=[],r=!1,n=0,a=0;n<e.length;++n)switch(e.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:t[t.length]=e.substr(a,n-a),a=n+1}if(t[t.length]=e.substr(a),!0===r)throw new Error("Format |"+e+"| unterminated string ");return t}(e),n=r.length,a=r[n-1].indexOf("@");if(n<4&&a>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if("number"!=typeof t)return[4,4===r.length||a>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=a>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=a>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=a>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"]}var s=t>0?r[0]:t<0?r[1]:r[2];if(-1===r[0].indexOf("[")&&-1===r[1].indexOf("["))return[n,s];if(null!=r[0].match(/\[[=<>]/)||null!=r[1].match(/\[[=<>]/)){var i=r[0].match(Rg),o=r[1].match(Rg);return Pg(t,i)?[n,r[0]]:Pg(t,o)?[n,r[1]]:[n,r[null!=i&&null!=o?2:1]]}return[n,s]}function Lg(e,t,r){null==r&&(r={});var n="";switch(typeof e){case"string":n="m/d/yy"==e&&r.dateNF?r.dateNF:e;break;case"number":null==(n=14==e&&r.dateNF?r.dateNF:(null!=r.table?r.table:ag)[e])&&(n=r.table&&r.table[sg[e]]||ag[sg[e]]),null==n&&(n=ig[e]||"General")}if(tg(n,0))return pg(t,r);t instanceof Date&&(t=hg(t,r.date1904));var a=Dg(n,t);if(tg(a[1]))return pg(t,r);if(!0===t)t="TRUE";else if(!1===t)t="FALSE";else if(""===t||null==t)return"";return function(e,t,r,n){for(var a,s,i,o=[],l="",c=0,d="",u="t",h="H";c<e.length;)switch(d=e.charAt(c)){case"G":if(!tg(e,c))throw new Error("unrecognized character "+d+" in "+e);o[o.length]={t:"G",v:"General"},c+=7;break;case'"':for(l="";34!==(i=e.charCodeAt(++c))&&c<e.length;)l+=String.fromCharCode(i);o[o.length]={t:"t",v:l},++c;break;case"\\":var f=e.charAt(++c),m="("===f||")"===f?f:"t";o[o.length]={t:m,v:f},++c;break;case"_":o[o.length]={t:"t",v:" "},c+=2;break;case"@":o[o.length]={t:"T",v:t},++c;break;case"B":case"b":if("1"===e.charAt(c+1)||"2"===e.charAt(c+1)){if(null==a&&null==(a=lg(t,r,"2"===e.charAt(c+1))))return"";o[o.length]={t:"X",v:e.substr(c,2)},u=d,c+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":d=d.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0)return"";if(null==a&&null==(a=lg(t,r)))return"";for(l=d;++c<e.length&&e.charAt(c).toLowerCase()===d;)l+=d;"m"===d&&"h"===u.toLowerCase()&&(d="M"),"h"===d&&(d=h),o[o.length]={t:d,v:l},u=d;break;case"A":case"a":case"":var p={t:d,v:d};if(null==a&&(a=lg(t,r)),"A/P"===e.substr(c,3).toUpperCase()?(null!=a&&(p.v=a.H>=12?"P":"A"),p.t="T",h="h",c+=3):"AM/PM"===e.substr(c,5).toUpperCase()?(null!=a&&(p.v=a.H>=12?"PM":"AM"),p.t="T",c+=5,h="h"):"/"===e.substr(c,5).toUpperCase()?(null!=a&&(p.v=a.H>=12?"":""),p.t="T",c+=5,h="h"):(p.t="t",++c),null==a&&"T"===p.t)return"";o[o.length]=p,u=d;break;case"[":for(l=d;"]"!==e.charAt(c++)&&c<e.length;)l+=e.charAt(c);if("]"!==l.slice(-1))throw'unterminated "[" block: |'+l+"|";if(l.match(Og)){if(null==a&&null==(a=lg(t,r)))return"";o[o.length]={t:"Z",v:l.toLowerCase()},u=l.charAt(1)}else l.indexOf("$")>-1&&(l=(l.match(/\$([^-\[\]]*)/)||[])[1]||"$",Ig(e)||(o[o.length]={t:"t",v:l}));break;case".":if(null!=a){for(l=d;++c<e.length&&"0"===(d=e.charAt(c));)l+=d;o[o.length]={t:"s",v:l};break}case"0":case"#":for(l=d;++c<e.length&&"0#?.,E+-%".indexOf(d=e.charAt(c))>-1;)l+=d;o[o.length]={t:"n",v:l};break;case"?":for(l=d;e.charAt(++c)===d;)l+=d;o[o.length]={t:d,v:l},u=d;break;case"*":++c," "!=e.charAt(c)&&"*"!=e.charAt(c)||++c;break;case"(":case")":o[o.length]={t:1===n?"t":d,v:d},++c;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(l=d;c<e.length&&"0123456789".indexOf(e.charAt(++c))>-1;)l+=e.charAt(c);o[o.length]={t:"D",v:l};break;case" ":o[o.length]={t:d,v:d},++c;break;case"$":o[o.length]={t:"t",v:"$"},++c;break;default:if(-1===",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(d))throw new Error("unrecognized character "+d+" in "+e);o[o.length]={t:"t",v:d},++c}var g,x=0,v=0;for(c=o.length-1,u="t";c>=0;--c)switch(o[c].t){case"h":case"H":o[c].t=h,u="h",x<1&&(x=1);break;case"s":(g=o[c].v.match(/\.0+$/))&&(v=Math.max(v,g[0].length-1)),x<3&&(x=3);case"d":case"y":case"M":case"e":u=o[c].t;break;case"m":"s"===u&&(o[c].t="M",x<2&&(x=2));break;case"X":break;case"Z":x<1&&o[c].v.match(/[Hh]/)&&(x=1),x<2&&o[c].v.match(/[Mm]/)&&(x=2),x<3&&o[c].v.match(/[Ss]/)&&(x=3)}switch(x){case 0:break;case 1:a.u>=.5&&(a.u=0,++a.S),a.S>=60&&(a.S=0,++a.M),a.M>=60&&(a.M=0,++a.H);break;case 2:a.u>=.5&&(a.u=0,++a.S),a.S>=60&&(a.S=0,++a.M)}var b,y="";for(c=0;c<o.length;++c)switch(o[c].t){case"t":case"T":case" ":case"D":break;case"X":o[c].v="",o[c].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":o[c].v=gg(o[c].t.charCodeAt(0),o[c].v,a,v),o[c].t="t";break;case"n":case"?":for(b=c+1;null!=o[b]&&("?"===(d=o[b].t)||"D"===d||(" "===d||"t"===d)&&null!=o[b+1]&&("?"===o[b+1].t||"t"===o[b+1].t&&"/"===o[b+1].v)||"("===o[c].t&&(" "===d||"n"===d||")"===d)||"t"===d&&("/"===o[b].v||" "===o[b].v&&null!=o[b+1]&&"?"==o[b+1].t));)o[c].v+=o[b].v,o[b]={v:"",t:";"},++b;y+=o[c].v,c=b-1;break;case"G":o[c].t="t",o[c].v=pg(t,r)}var w,_,k="";if(y.length>0){40==y.charCodeAt(0)?(w=t<0&&45===y.charCodeAt(0)?-t:t,_=Ag("n",y,w)):(_=Ag("n",y,w=t<0&&n>1?-t:t),w<0&&o[0]&&"t"==o[0].t&&(_=_.substr(1),o[0].v="-"+o[0].v)),b=_.length-1;var N=o.length;for(c=0;c<o.length;++c)if(null!=o[c]&&"t"!=o[c].t&&o[c].v.indexOf(".")>-1){N=c;break}var j=o.length;if(N===o.length&&-1===_.indexOf("E")){for(c=o.length-1;c>=0;--c)null!=o[c]&&-1!=="n?".indexOf(o[c].t)&&(b>=o[c].v.length-1?(b-=o[c].v.length,o[c].v=_.substr(b+1,o[c].v.length)):b<0?o[c].v="":(o[c].v=_.substr(0,b+1),b=-1),o[c].t="t",j=c);b>=0&&j<o.length&&(o[j].v=_.substr(0,b+1)+o[j].v)}else if(N!==o.length&&-1===_.indexOf("E")){for(b=_.indexOf(".")-1,c=N;c>=0;--c)if(null!=o[c]&&-1!=="n?".indexOf(o[c].t)){for(s=o[c].v.indexOf(".")>-1&&c===N?o[c].v.indexOf(".")-1:o[c].v.length-1,k=o[c].v.substr(s+1);s>=0;--s)b>=0&&("0"===o[c].v.charAt(s)||"#"===o[c].v.charAt(s))&&(k=_.charAt(b--)+k);o[c].v=k,o[c].t="t",j=c}for(b>=0&&j<o.length&&(o[j].v=_.substr(0,b+1)+o[j].v),b=_.indexOf(".")+1,c=N;c<o.length;++c)if(null!=o[c]&&(-1!=="n?(".indexOf(o[c].t)||c===N)){for(s=o[c].v.indexOf(".")>-1&&c===N?o[c].v.indexOf(".")+1:0,k=o[c].v.substr(0,s);s<o[c].v.length;++s)b<_.length&&(k+=_.charAt(b++));o[c].v=k,o[c].t="t",j=c}}}for(c=0;c<o.length;++c)null!=o[c]&&"n?".indexOf(o[c].t)>-1&&(w=n>1&&t<0&&c>0&&"-"===o[c-1].v?-t:t,o[c].v=Ag(o[c].t,o[c].v,w),o[c].t="t");var S="";for(c=0;c!==o.length;++c)null!=o[c]&&(S+=o[c].v);return S}(a[1],t,r,a[0])}function Mg(e,t){if("number"!=typeof t){t=+t||-1;for(var r=0;r<392;++r)if(null!=ag[r]){if(ag[r]==e){t=r;break}}else t<0&&(t=r);t<0&&(t=391)}return ag[t]=e,t}function Fg(){var e;e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"/ "hh""mm""ss" "',ag=e}var Ug={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},Bg=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;var $g=function(){var e={};e.version="1.2.0";var t=function(){for(var e=0,t=new Array(256),r=0;256!=r;++r)e=1&(e=1&(e=1&(e=1&(e=1&(e=1&(e=1&(e=1&(e=r)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1,t[r]=e;return"undefined"!=typeof Int32Array?new Int32Array(t):t}();var r=function(e){var t=0,r=0,n=0,a="undefined"!=typeof Int32Array?new Int32Array(4096):new Array(4096);for(n=0;256!=n;++n)a[n]=e[n];for(n=0;256!=n;++n)for(r=e[n],t=256+n;t<4096;t+=256)r=a[t]=r>>>8^e[255&r];var s=[];for(n=1;16!=n;++n)s[n-1]="undefined"!=typeof Int32Array?a.subarray(256*n,256*n+256):a.slice(256*n,256*n+256);return s}(t),n=r[0],a=r[1],s=r[2],i=r[3],o=r[4],l=r[5],c=r[6],d=r[7],u=r[8],h=r[9],f=r[10],m=r[11],p=r[12],g=r[13],x=r[14];return e.table=t,e.bstr=function(e,r){for(var n=-1^r,a=0,s=e.length;a<s;)n=n>>>8^t[255&(n^e.charCodeAt(a++))];return~n},e.buf=function(e,r){for(var v=-1^r,b=e.length-15,y=0;y<b;)v=x[e[y++]^255&v]^g[e[y++]^v>>8&255]^p[e[y++]^v>>16&255]^m[e[y++]^v>>>24]^f[e[y++]]^h[e[y++]]^u[e[y++]]^d[e[y++]]^c[e[y++]]^l[e[y++]]^o[e[y++]]^i[e[y++]]^s[e[y++]]^a[e[y++]]^n[e[y++]]^t[e[y++]];for(b+=15;y<b;)v=v>>>8^t[255&(v^e[y++])];return~v},e.str=function(e,r){for(var n=-1^r,a=0,s=e.length,i=0,o=0;a<s;)(i=e.charCodeAt(a++))<128?n=n>>>8^t[255&(n^i)]:i<2048?n=(n=n>>>8^t[255&(n^(192|i>>6&31))])>>>8^t[255&(n^(128|63&i))]:i>=55296&&i<57344?(i=64+(1023&i),o=1023&e.charCodeAt(a++),n=(n=(n=(n=n>>>8^t[255&(n^(240|i>>8&7))])>>>8^t[255&(n^(128|i>>2&63))])>>>8^t[255&(n^(128|o>>6&15|(3&i)<<4))])>>>8^t[255&(n^(128|63&o))]):n=(n=(n=n>>>8^t[255&(n^(224|i>>12&15))])>>>8^t[255&(n^(128|i>>6&63))])>>>8^t[255&(n^(128|63&i))];return~n},e}(),zg=function(){var e,t={};function r(e){if("/"==e.charAt(e.length-1))return-1===e.slice(0,-1).indexOf("/")?e:r(e.slice(0,-1));var t=e.lastIndexOf("/");return-1===t?e:e.slice(0,t+1)}function n(e){if("/"==e.charAt(e.length-1))return n(e.slice(0,-1));var t=e.lastIndexOf("/");return-1===t?e:e.slice(t+1)}function a(e,t){"string"==typeof t&&(t=new Date(t));var r=t.getHours();r=(r=r<<6|t.getMinutes())<<5|t.getSeconds()>>>1,e.write_shift(2,r);var n=t.getFullYear()-1980;n=(n=n<<4|t.getMonth()+1)<<5|t.getDate(),e.write_shift(2,n)}function s(e){Iv(e,0);for(var t={},r=0;e.l<=e.length-4;){var n=e.read_shift(2),a=e.read_shift(2),s=e.l+a,i={};if(21589===n)1&(r=e.read_shift(1))&&(i.mtime=e.read_shift(4)),a>5&&(2&r&&(i.atime=e.read_shift(4)),4&r&&(i.ctime=e.read_shift(4))),i.mtime&&(i.mt=new Date(1e3*i.mtime));e.l=s,t[n]=i}return t}function i(){return e||(e={})}function o(e,t){if(80==e[0]&&75==e[1])return ne(e,t);if(109==(32|e[0])&&105==(32|e[1]))return function(e,t){if("mime-version:"!=_(e.slice(0,13)).toLowerCase())throw new Error("Unsupported MAD header");var r=t&&t.root||"",n=(Up&&Buffer.isBuffer(e)?e.toString("binary"):_(e)).split("\r\n"),a=0,s="";for(a=0;a<n.length;++a)if(s=n[a],/^Content-Location:/i.test(s)&&(s=s.slice(s.indexOf("file")),r||(r=s.slice(0,s.lastIndexOf("/")+1)),s.slice(0,r.length)!=r))for(;r.length>0&&(r=(r=r.slice(0,r.length-1)).slice(0,r.lastIndexOf("/")+1),s.slice(0,r.length)!=r););var i=(n[1]||"").match(/boundary="(.*?)"/);if(!i)throw new Error("MAD cannot find boundary");var o="--"+(i[1]||""),l=[],c=[],d={FileIndex:l,FullPaths:c};h(d);var u,f=0;for(a=0;a<n.length;++a){var m=n[a];m!==o&&m!==o+"--"||(f++&&ce(d,n.slice(u,a),r),u=a)}return d}(e,t);if(e.length<512)throw new Error("CFB file size "+e.length+" < 512");var r,n,a,s,i,o,f=512,m=[],p=e.slice(0,512);Iv(p,0);var g=function(e){if(80==e[e.l]&&75==e[e.l+1])return[0,0];e.chk(v,"Header Signature: "),e.l+=16;var t=e.read_shift(2,"u");return[e.read_shift(2,"u"),t]}(p);switch(r=g[0]){case 3:f=512;break;case 4:f=4096;break;case 0:if(0==g[1])return ne(e,t);default:throw new Error("Major Version: Expected 3 or 4 saw "+r)}512!==f&&Iv(p=e.slice(0,f),28);var b=e.slice(0,f);!function(e,t){var r=9;switch(e.l+=2,r=e.read_shift(2)){case 9:if(3!=t)throw new Error("Sector Shift: Expected 9 saw "+r);break;case 12:if(4!=t)throw new Error("Sector Shift: Expected 12 saw "+r);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+r)}e.chk("0600","Mini Sector Shift: "),e.chk("000000000000","Reserved: ")}(p,r);var y=p.read_shift(4,"i");if(3===r&&0!==y)throw new Error("# Directory Sectors: Expected 0 saw "+y);p.l+=4,s=p.read_shift(4,"i"),p.l+=4,p.chk("00100000","Mini Stream Cutoff Size: "),i=p.read_shift(4,"i"),n=p.read_shift(4,"i"),o=p.read_shift(4,"i"),a=p.read_shift(4,"i");for(var w=-1,k=0;k<109&&!((w=p.read_shift(4,"i"))<0);++k)m[k]=w;var N=function(e,t){for(var r=Math.ceil(e.length/t)-1,n=[],a=1;a<r;++a)n[a-1]=e.slice(a*t,(a+1)*t);return n[r-1]=e.slice(r*t),n}(e,f);c(o,a,N,f,m);var j=function(e,t,r,n){var a=e.length,s=[],i=[],o=[],l=[],c=n-1,d=0,u=0,h=0,f=0;for(d=0;d<a;++d)if(o=[],(h=d+t)>=a&&(h-=a),!i[h]){l=[];var m=[];for(u=h;u>=0;){m[u]=!0,i[u]=!0,o[o.length]=u,l.push(e[u]);var p=r[Math.floor(4*u/n)];if(n<4+(f=4*u&c))throw new Error("FAT boundary crossed: "+u+" 4 "+n);if(!e[p])break;if(m[u=Nv(e[p],f)])break}s[h]={nodes:o,data:ev([l])}}return s}(N,s,m,f);j[s].name="!Directory",n>0&&i!==x&&(j[i].name="!MiniFAT"),j[m[0]].name="!FAT",j.fat_addrs=m,j.ssz=f;var S=[],T=[],E=[];!function(e,t,r,n,a,s,i,o){for(var c,h=0,f=n.length?2:0,m=t[e].data,p=0,g=0;p<m.length;p+=128){var v=m.slice(p,p+128);Iv(v,64),g=v.read_shift(2),c=rv(v,0,g-f),n.push(c);var b={name:c,type:v.read_shift(1),color:v.read_shift(1),L:v.read_shift(4,"i"),R:v.read_shift(4,"i"),C:v.read_shift(4,"i"),clsid:v.read_shift(16),state:v.read_shift(4,"i"),start:0,size:0};0!==v.read_shift(2)+v.read_shift(2)+v.read_shift(2)+v.read_shift(2)&&(b.ct=u(v,v.l-8)),0!==v.read_shift(2)+v.read_shift(2)+v.read_shift(2)+v.read_shift(2)&&(b.mt=u(v,v.l-8)),b.start=v.read_shift(4,"i"),b.size=v.read_shift(4,"i"),b.size<0&&b.start<0&&(b.size=b.type=0,b.start=x,b.name=""),5===b.type?(h=b.start,a>0&&h!==x&&(t[h].name="!StreamData")):b.size>=4096?(b.storage="fat",void 0===t[b.start]&&(t[b.start]=d(r,b.start,t.fat_addrs,t.ssz)),t[b.start].name=b.name,b.content=t[b.start].data.slice(0,b.size)):(b.storage="minifat",b.size<0?b.size=0:h!==x&&b.start!==x&&t[h]&&(b.content=l(b,t[h].data,(t[o]||{}).data))),b.content&&Iv(b.content,0),s[c]=b,i.push(b)}}(s,j,N,S,n,{},T,i),function(e,t,r){for(var n=0,a=0,s=0,i=0,o=0,l=r.length,c=[],d=[];n<l;++n)c[n]=d[n]=n,t[n]=r[n];for(;o<d.length;++o)a=e[n=d[o]].L,s=e[n].R,i=e[n].C,c[n]===n&&(-1!==a&&c[a]!==a&&(c[n]=c[a]),-1!==s&&c[s]!==s&&(c[n]=c[s])),-1!==i&&(c[i]=n),-1!==a&&n!=c[n]&&(c[a]=c[n],d.lastIndexOf(a)<o&&d.push(a)),-1!==s&&n!=c[n]&&(c[s]=c[n],d.lastIndexOf(s)<o&&d.push(s));for(n=1;n<l;++n)c[n]===n&&(-1!==s&&c[s]!==s?c[n]=c[s]:-1!==a&&c[a]!==a&&(c[n]=c[a]));for(n=1;n<l;++n)if(0!==e[n].type){if((o=n)!=c[o])do{o=c[o],t[n]=t[o]+"/"+t[n]}while(0!==o&&-1!==c[o]&&o!=c[o]);c[n]=-1}for(t[0]+="/",n=1;n<l;++n)2!==e[n].type&&(t[n]+="/")}(T,E,S),S.shift();var C={FileIndex:T,FullPaths:E};return t&&t.raw&&(C.raw={header:b,sectors:N}),C}function l(e,t,r){for(var n=e.start,a=e.size,s=[],i=n;r&&a>0&&i>=0;)s.push(t.slice(i*g,i*g+g)),a-=g,i=Nv(r,4*i);return 0===s.length?Pv(0):Gp(s).slice(0,e.size)}function c(e,t,r,n,a){var s=x;if(e===x){if(0!==t)throw new Error("DIFAT chain shorter than expected")}else if(-1!==e){var i=r[e],o=(n>>>2)-1;if(!i)return;for(var l=0;l<o&&(s=Nv(i,4*l))!==x;++l)a.push(s);c(Nv(i,n-4),t-1,r,n,a)}}function d(e,t,r,n,a){var s=[],i=[];a||(a=[]);var o=n-1,l=0,c=0;for(l=t;l>=0;){a[l]=!0,s[s.length]=l,i.push(e[l]);var d=r[Math.floor(4*l/n)];if(n<4+(c=4*l&o))throw new Error("FAT boundary crossed: "+l+" 4 "+n);if(!e[d])break;l=Nv(e[d],c)}return{nodes:s,data:ev([i])}}function u(e,t){return new Date(1e3*(kv(e,t+4)/1e7*Math.pow(2,32)+kv(e,t)/1e7-11644473600))}function h(e,t){var r=t||{},n=r.root||"Root Entry";if(e.FullPaths||(e.FullPaths=[]),e.FileIndex||(e.FileIndex=[]),e.FullPaths.length!==e.FileIndex.length)throw new Error("inconsistent CFB structure");0===e.FullPaths.length&&(e.FullPaths[0]=n+"/",e.FileIndex[0]={name:n,type:5}),r.CLSID&&(e.FileIndex[0].clsid=r.CLSID),function(e){var t="Sh33tJ5";if(zg.find(e,"/"+t))return;var r=Pv(4);r[0]=55,r[1]=r[3]=50,r[2]=54,e.FileIndex.push({name:t,type:2,content:r,size:4,L:69,R:69,C:69}),e.FullPaths.push(e.FullPaths[0]+t),f(e)}(e)}function f(e,t){h(e);for(var a=!1,s=!1,i=e.FullPaths.length-1;i>=0;--i){var o=e.FileIndex[i];switch(o.type){case 0:s?a=!0:(e.FileIndex.pop(),e.FullPaths.pop());break;case 1:case 2:case 5:s=!0,isNaN(o.R*o.L*o.C)&&(a=!0),o.R>-1&&o.L>-1&&o.R==o.L&&(a=!0);break;default:a=!0}}if(a||t){var l=new Date(1987,1,19),c=0,d=Object.create?Object.create(null):{},u=[];for(i=0;i<e.FullPaths.length;++i)d[e.FullPaths[i]]=!0,0!==e.FileIndex[i].type&&u.push([e.FullPaths[i],e.FileIndex[i]]);for(i=0;i<u.length;++i){var f=r(u[i][0]);(s=d[f])||(u.push([f,{name:n(f).replace("/",""),type:1,clsid:y,ct:l,mt:l,content:null}]),d[f]=!0)}for(u.sort(function(e,t){return function(e,t){for(var r=e.split("/"),n=t.split("/"),a=0,s=0,i=Math.min(r.length,n.length);a<i;++a){if(s=r[a].length-n[a].length)return s;if(r[a]!=n[a])return r[a]<n[a]?-1:1}return r.length-n.length}(e[0],t[0])}),e.FullPaths=[],e.FileIndex=[],i=0;i<u.length;++i)e.FullPaths[i]=u[i][0],e.FileIndex[i]=u[i][1];for(i=0;i<u.length;++i){var m=e.FileIndex[i],p=e.FullPaths[i];if(m.name=n(p).replace("/",""),m.L=m.R=m.C=-(m.color=1),m.size=m.content?m.content.length:0,m.start=0,m.clsid=m.clsid||y,0===i)m.C=u.length>1?1:-1,m.size=0,m.type=5;else if("/"==p.slice(-1)){for(c=i+1;c<u.length&&r(e.FullPaths[c])!=p;++c);for(m.C=c>=u.length?-1:c,c=i+1;c<u.length&&r(e.FullPaths[c])!=r(p);++c);m.R=c>=u.length?-1:c,m.type=1}else r(e.FullPaths[i+1]||"")==r(p)&&(m.R=i+1),m.type=2}}}function m(e,t){var r=t||{};if("mad"==r.fileType)return function(e,t){for(var r=t||{},n=r.boundary||"SheetJS",a=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+(n="------="+n).slice(2)+'"',"","",""],s=e.FullPaths[0],i=s,o=e.FileIndex[0],l=1;l<e.FullPaths.length;++l)if(i=e.FullPaths[l].slice(s.length),(o=e.FileIndex[l]).size&&o.content&&"Sh33tJ5"!=i){i=i.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(e){return"_x"+e.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(e){return"_u"+e.charCodeAt(0).toString(16)+"_"});for(var c=o.content,d=Up&&Buffer.isBuffer(c)?c.toString("binary"):_(c),u=0,h=Math.min(1024,d.length),f=0,m=0;m<=h;++m)(f=d.charCodeAt(m))>=32&&f<128&&++u;var p=u>=4*h/5;a.push(n),a.push("Content-Location: "+(r.root||"file:///C:/SheetJS/")+i),a.push("Content-Transfer-Encoding: "+(p?"quoted-printable":"base64")),a.push("Content-Type: "+ie(o,i)),a.push(""),a.push(p?le(d):oe(d))}return a.push(n+"--\r\n"),a.join("\r\n")}(e,r);if(f(e),"zip"===r.fileType)return function(e,t){var r=t||{},n=[],s=[],i=Pv(1),o=r.compression?8:0,l=0,c=0,d=0,u=0,h=0,f=e.FullPaths[0],m=f,p=e.FileIndex[0],g=[],x=0;for(c=1;c<e.FullPaths.length;++c)if(m=e.FullPaths[c].slice(f.length),(p=e.FileIndex[c]).size&&p.content&&"Sh33tJ5"!=m){var v=u,b=Pv(m.length);for(d=0;d<m.length;++d)b.write_shift(1,127&m.charCodeAt(d));b=b.slice(0,b.l),g[h]=$g.buf(p.content,0);var y=p.content;8==o&&(y=k(y)),(i=Pv(30)).write_shift(4,67324752),i.write_shift(2,20),i.write_shift(2,l),i.write_shift(2,o),p.mt?a(i,p.mt):i.write_shift(4,0),i.write_shift(-4,g[h]),i.write_shift(4,y.length),i.write_shift(4,p.content.length),i.write_shift(2,b.length),i.write_shift(2,0),u+=i.length,n.push(i),u+=b.length,n.push(b),u+=y.length,n.push(y),(i=Pv(46)).write_shift(4,33639248),i.write_shift(2,0),i.write_shift(2,20),i.write_shift(2,l),i.write_shift(2,o),i.write_shift(4,0),i.write_shift(-4,g[h]),i.write_shift(4,y.length),i.write_shift(4,p.content.length),i.write_shift(2,b.length),i.write_shift(2,0),i.write_shift(2,0),i.write_shift(2,0),i.write_shift(2,0),i.write_shift(4,0),i.write_shift(4,v),x+=i.l,s.push(i),x+=b.length,s.push(b),++h}return i=Pv(22),i.write_shift(4,101010256),i.write_shift(2,0),i.write_shift(2,0),i.write_shift(2,h),i.write_shift(2,h),i.write_shift(4,x),i.write_shift(4,u),i.write_shift(2,0),Gp([Gp(n),Gp(s),i])}(e,r);var n=function(e){for(var t=0,r=0,n=0;n<e.FileIndex.length;++n){var a=e.FileIndex[n];if(a.content){var s=a.content.length;s>0&&(s<4096?t+=s+63>>6:r+=s+511>>9)}}for(var i=e.FullPaths.length+3>>2,o=t+127>>7,l=(t+7>>3)+r+i+o,c=l+127>>7,d=c<=109?0:Math.ceil((c-109)/127);l+c+d+127>>7>c;)d=++c<=109?0:Math.ceil((c-109)/127);var u=[1,d,c,o,i,r,t,0];return e.FileIndex[0].size=t<<6,u[7]=(e.FileIndex[0].start=u[0]+u[1]+u[2]+u[3]+u[4]+u[5])+(u[6]+7>>3),u}(e),s=Pv(n[7]<<9),i=0,o=0;for(i=0;i<8;++i)s.write_shift(1,b[i]);for(i=0;i<8;++i)s.write_shift(2,0);for(s.write_shift(2,62),s.write_shift(2,3),s.write_shift(2,65534),s.write_shift(2,9),s.write_shift(2,6),i=0;i<3;++i)s.write_shift(2,0);for(s.write_shift(4,0),s.write_shift(4,n[2]),s.write_shift(4,n[0]+n[1]+n[2]+n[3]-1),s.write_shift(4,0),s.write_shift(4,4096),s.write_shift(4,n[3]?n[0]+n[1]+n[2]-1:x),s.write_shift(4,n[3]),s.write_shift(-4,n[1]?n[0]-1:x),s.write_shift(4,n[1]),i=0;i<109;++i)s.write_shift(-4,i<n[2]?n[1]+i:-1);if(n[1])for(o=0;o<n[1];++o){for(;i<236+127*o;++i)s.write_shift(-4,i<n[2]?n[1]+i:-1);s.write_shift(-4,o===n[1]-1?x:o+1)}var l=function(e){for(o+=e;i<o-1;++i)s.write_shift(-4,i+1);e&&(++i,s.write_shift(-4,x))};for(o=i=0,o+=n[1];i<o;++i)s.write_shift(-4,w.DIFSECT);for(o+=n[2];i<o;++i)s.write_shift(-4,w.FATSECT);l(n[3]),l(n[4]);for(var c=0,d=0,u=e.FileIndex[0];c<e.FileIndex.length;++c)(u=e.FileIndex[c]).content&&((d=u.content.length)<4096||(u.start=o,l(d+511>>9)));for(l(n[6]+7>>3);511&s.l;)s.write_shift(-4,w.ENDOFCHAIN);for(o=i=0,c=0;c<e.FileIndex.length;++c)(u=e.FileIndex[c]).content&&(!(d=u.content.length)||d>=4096||(u.start=o,l(d+63>>6)));for(;511&s.l;)s.write_shift(-4,w.ENDOFCHAIN);for(i=0;i<n[4]<<2;++i){var h=e.FullPaths[i];if(h&&0!==h.length){u=e.FileIndex[i],0===i&&(u.start=u.size?u.start-1:x);var m=0===i&&r.root||u.name;if(d=2*(m.length+1),s.write_shift(64,m,"utf16le"),s.write_shift(2,d),s.write_shift(1,u.type),s.write_shift(1,u.color),s.write_shift(-4,u.L),s.write_shift(-4,u.R),s.write_shift(-4,u.C),u.clsid)s.write_shift(16,u.clsid,"hex");else for(c=0;c<4;++c)s.write_shift(4,0);s.write_shift(4,u.state||0),s.write_shift(4,0),s.write_shift(4,0),s.write_shift(4,0),s.write_shift(4,0),s.write_shift(4,u.start),s.write_shift(4,u.size),s.write_shift(4,0)}else{for(c=0;c<17;++c)s.write_shift(4,0);for(c=0;c<3;++c)s.write_shift(4,-1);for(c=0;c<12;++c)s.write_shift(4,0)}}for(i=1;i<e.FileIndex.length;++i)if((u=e.FileIndex[i]).size>=4096)if(s.l=u.start+1<<9,Up&&Buffer.isBuffer(u.content))u.content.copy(s,s.l,0,u.size),s.l+=u.size+511&-512;else{for(c=0;c<u.size;++c)s.write_shift(1,u.content[c]);for(;511&c;++c)s.write_shift(1,0)}for(i=1;i<e.FileIndex.length;++i)if((u=e.FileIndex[i]).size>0&&u.size<4096)if(Up&&Buffer.isBuffer(u.content))u.content.copy(s,s.l,0,u.size),s.l+=u.size+63&-64;else{for(c=0;c<u.size;++c)s.write_shift(1,u.content[c]);for(;63&c;++c)s.write_shift(1,0)}if(Up)s.l=s.length;else for(;s.l<s.length;)s.write_shift(1,0);return s}t.version="1.2.1";var p,g=64,x=-2,v="d0cf11e0a1b11ae1",b=[208,207,17,224,161,177,26,225],y="00000000000000000000000000000000",w={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:x,FREESECT:-1,HEADER_SIGNATURE:v,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:y,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function _(e){for(var t=new Array(e.length),r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function k(e){return p?p.deflateRawSync(e):K(e)}var N=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],j=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],S=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function T(e){var t=139536&(e<<1|e<<11)|558144&(e<<5|e<<15);return 255&(t>>16|t>>8|t)}for(var E="undefined"!=typeof Uint8Array,C=E?new Uint8Array(256):[],A=0;A<256;++A)C[A]=T(A);function O(e,t){var r=C[255&e];return t<=8?r>>>8-t:(r=r<<8|C[e>>8&255],t<=16?r>>>16-t:(r=r<<8|C[e>>16&255])>>>24-t)}function I(e,t){var r=7&t,n=t>>>3;return(e[n]|(r<=6?0:e[n+1]<<8))>>>r&3}function R(e,t){var r=7&t,n=t>>>3;return(e[n]|(r<=5?0:e[n+1]<<8))>>>r&7}function P(e,t){var r=7&t,n=t>>>3;return(e[n]|(r<=3?0:e[n+1]<<8))>>>r&31}function D(e,t){var r=7&t,n=t>>>3;return(e[n]|(r<=1?0:e[n+1]<<8))>>>r&127}function L(e,t,r){var n=7&t,a=t>>>3,s=(1<<r)-1,i=e[a]>>>n;return r<8-n?i&s:(i|=e[a+1]<<8-n,r<16-n?i&s:(i|=e[a+2]<<16-n,r<24-n?i&s:(i|=e[a+3]<<24-n)&s))}function M(e,t,r){var n=7&t,a=t>>>3;return n<=5?e[a]|=(7&r)<<n:(e[a]|=r<<n&255,e[a+1]=(7&r)>>8-n),t+3}function F(e,t,r){return r=(1&r)<<(7&t),e[t>>>3]|=r,t+1}function U(e,t,r){var n=t>>>3;return r<<=7&t,e[n]|=255&r,r>>>=8,e[n+1]=r,t+8}function B(e,t,r){var n=t>>>3;return r<<=7&t,e[n]|=255&r,r>>>=8,e[n+1]=255&r,e[n+2]=r>>>8,t+16}function $(e,t){var r=e.length,n=2*r>t?2*r:t+5,a=0;if(r>=t)return e;if(Up){var s=zp(n);if(e.copy)e.copy(s);else for(;a<e.length;++a)s[a]=e[a];return s}if(E){var i=new Uint8Array(n);if(i.set)i.set(e);else for(;a<r;++a)i[a]=e[a];return i}return e.length=n,e}function z(e){for(var t=new Array(e),r=0;r<e;++r)t[r]=0;return t}function V(e,t,r){var n=1,a=0,s=0,i=0,o=0,l=e.length,c=E?new Uint16Array(32):z(32);for(s=0;s<32;++s)c[s]=0;for(s=l;s<r;++s)e[s]=0;l=e.length;var d=E?new Uint16Array(l):z(l);for(s=0;s<l;++s)c[a=e[s]]++,n<a&&(n=a),d[s]=0;for(c[0]=0,s=1;s<=n;++s)c[s+16]=o=o+c[s-1]<<1;for(s=0;s<l;++s)0!=(o=e[s])&&(d[s]=c[o+16]++);var u=0;for(s=0;s<l;++s)if(0!=(u=e[s]))for(o=O(d[s],n)>>n-u,i=(1<<n+4-u)-1;i>=0;--i)t[o|i<<u]=15&u|s<<4;return n}var W=E?new Uint16Array(512):z(512),H=E?new Uint16Array(32):z(32);if(!E){for(var G=0;G<512;++G)W[G]=0;for(G=0;G<32;++G)H[G]=0}!function(){for(var e=[],t=0;t<32;t++)e.push(5);V(e,H,32);var r=[];for(t=0;t<=143;t++)r.push(8);for(;t<=255;t++)r.push(9);for(;t<=279;t++)r.push(7);for(;t<=287;t++)r.push(8);V(r,W,288)}();var q=function(){for(var e=E?new Uint8Array(32768):[],t=0,r=0;t<S.length-1;++t)for(;r<S[t+1];++r)e[r]=t;for(;r<32768;++r)e[r]=29;var n=E?new Uint8Array(259):[];for(t=0,r=0;t<j.length-1;++t)for(;r<j[t+1];++r)n[r]=t;return function(t,r){return t.length<8?function(e,t){for(var r=0;r<e.length;){var n=Math.min(65535,e.length-r),a=r+n==e.length;for(t.write_shift(1,+a),t.write_shift(2,n),t.write_shift(2,65535&~n);n-- >0;)t[t.l++]=e[r++]}return t.l}(t,r):function(t,r){for(var a=0,s=0,i=E?new Uint16Array(32768):[];s<t.length;){var o=Math.min(65535,t.length-s);if(o<10){for(7&(a=M(r,a,+!(s+o!=t.length)))&&(a+=8-(7&a)),r.l=a/8|0,r.write_shift(2,o),r.write_shift(2,65535&~o);o-- >0;)r[r.l++]=t[s++];a=8*r.l}else{a=M(r,a,+!(s+o!=t.length)+2);for(var l=0;o-- >0;){var c=t[s],d=-1,u=0;if((d=i[l=32767&(l<<5^c)])&&((d|=-32768&s)>s&&(d-=32768),d<s))for(;t[d+u]==t[s+u]&&u<250;)++u;if(u>2){(c=n[u])<=22?a=U(r,a,C[c+1]>>1)-1:(U(r,a,3),U(r,a+=5,C[c-23]>>5),a+=3);var h=c<8?0:c-4>>2;h>0&&(B(r,a,u-j[c]),a+=h),c=e[s-d],a=U(r,a,C[c]>>3),a-=3;var f=c<4?0:c-2>>1;f>0&&(B(r,a,s-d-S[c]),a+=f);for(var m=0;m<u;++m)i[l]=32767&s,l=32767&(l<<5^t[s]),++s;o-=u-1}else c<=143?c+=48:a=F(r,a,1),a=U(r,a,C[c]),i[l]=32767&s,++s}a=U(r,a,0)-1}}return r.l=(a+7)/8|0,r.l}(t,r)}}();function K(e){var t=Pv(50+Math.floor(1.1*e.length)),r=q(e,t);return t.slice(0,r)}var X=E?new Uint16Array(32768):z(32768),Y=E?new Uint16Array(32768):z(32768),J=E?new Uint16Array(128):z(128),Z=1,Q=1;function ee(e,t){var r=P(e,t)+257,n=P(e,t+=5)+1,a=function(e,t){var r=7&t,n=t>>>3;return(e[n]|(r<=4?0:e[n+1]<<8))>>>r&15}(e,t+=5)+4;t+=4;for(var s=0,i=E?new Uint8Array(19):z(19),o=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],l=1,c=E?new Uint8Array(8):z(8),d=E?new Uint8Array(8):z(8),u=i.length,h=0;h<a;++h)i[N[h]]=s=R(e,t),l<s&&(l=s),c[s]++,t+=3;var f=0;for(c[0]=0,h=1;h<=l;++h)d[h]=f=f+c[h-1]<<1;for(h=0;h<u;++h)0!=(f=i[h])&&(o[h]=d[f]++);var m=0;for(h=0;h<u;++h)if(0!=(m=i[h])){f=C[o[h]]>>8-m;for(var p=(1<<7-m)-1;p>=0;--p)J[f|p<<m]=7&m|h<<3}var g=[];for(l=1;g.length<r+n;)switch(t+=7&(f=J[D(e,t)]),f>>>=3){case 16:for(s=3+I(e,t),t+=2,f=g[g.length-1];s-- >0;)g.push(f);break;case 17:for(s=3+R(e,t),t+=3;s-- >0;)g.push(0);break;case 18:for(s=11+D(e,t),t+=7;s-- >0;)g.push(0);break;default:g.push(f),l<f&&(l=f)}var x=g.slice(0,r),v=g.slice(r);for(h=r;h<286;++h)x[h]=0;for(h=n;h<30;++h)v[h]=0;return Z=V(x,X,286),Q=V(v,Y,30),t}function te(e,t){var r=function(e,t){if(3==e[0]&&!(3&e[1]))return[$p(t),2];for(var r=0,n=0,a=zp(t||1<<18),s=0,i=a.length>>>0,o=0,l=0;!(1&n);)if(n=R(e,r),r+=3,n>>>1!=0)for(n>>1==1?(o=9,l=5):(r=ee(e,r),o=Z,l=Q);;){!t&&i<s+32767&&(i=(a=$(a,s+32767)).length);var c=L(e,r,o),d=n>>>1==1?W[c]:X[c];if(r+=15&d,(d>>>=4)>>>8&255){if(256==d)break;var u=(d-=257)<8?0:d-4>>2;u>5&&(u=0);var h=s+j[d];u>0&&(h+=L(e,r,u),r+=u),c=L(e,r,l),r+=15&(d=n>>>1==1?H[c]:Y[c]);var f=(d>>>=4)<4?0:d-2>>1,m=S[d];for(f>0&&(m+=L(e,r,f),r+=f),!t&&i<h&&(i=(a=$(a,h+100)).length);s<h;)a[s]=a[s-m],++s}else a[s++]=d}else{7&r&&(r+=8-(7&r));var p=e[r>>>3]|e[(r>>>3)+1]<<8;if(r+=32,p>0)for(!t&&i<s+p&&(i=(a=$(a,s+p)).length);p-- >0;)a[s++]=e[r>>>3],r+=8}return t?[a,r+7>>>3]:[a.slice(0,s),r+7>>>3]}(e.slice(e.l||0),t);return e.l+=r[1],r[0]}function re(e,t){if(!e)throw new Error(t);"undefined"!=typeof console&&console.error(t)}function ne(e,t){var r=e;Iv(r,0);var n={FileIndex:[],FullPaths:[]};h(n,{root:t.root});for(var a=r.length-4;(80!=r[a]||75!=r[a+1]||5!=r[a+2]||6!=r[a+3])&&a>=0;)--a;r.l=a+4,r.l+=4;var i=r.read_shift(2);r.l+=6;var o=r.read_shift(4);for(r.l=o,a=0;a<i;++a){r.l+=20;var l=r.read_shift(4),c=r.read_shift(4),d=r.read_shift(2),u=r.read_shift(2),f=r.read_shift(2);r.l+=8;var m=r.read_shift(4),p=s(r.slice(r.l+d,r.l+d+u));r.l+=d+u+f;var g=r.l;r.l=m+4,ae(r,l,c,n,p),r.l=g}return n}function ae(e,t,r,n,a){e.l+=2;var i=e.read_shift(2),o=e.read_shift(2),l=function(e){var t=65535&e.read_shift(2),r=65535&e.read_shift(2),n=new Date,a=31&r,s=15&(r>>>=5);r>>>=4,n.setMilliseconds(0),n.setFullYear(r+1980),n.setMonth(s-1),n.setDate(a);var i=31&t,o=63&(t>>>=5);return t>>>=6,n.setHours(t),n.setMinutes(o),n.setSeconds(i<<1),n}(e);if(8257&i)throw new Error("Unsupported ZIP encryption");e.read_shift(4);for(var c=e.read_shift(4),d=e.read_shift(4),u=e.read_shift(2),h=e.read_shift(2),f="",m=0;m<u;++m)f+=String.fromCharCode(e[e.l++]);if(h){var g=s(e.slice(e.l,e.l+h));(g[21589]||{}).mt&&(l=g[21589].mt),((a||{})[21589]||{}).mt&&(l=a[21589].mt)}e.l+=h;var x=e.slice(e.l,e.l+c);switch(o){case 8:x=function(e,t){if(!p)return te(e,t);var r=new(0,p.InflateRaw),n=r._processChunk(e.slice(e.l),r._finishFlushFlag);return e.l+=r.bytesRead,n}(e,d);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+o)}var v=!1;8&i&&(134695760==e.read_shift(4)&&(e.read_shift(4),v=!0),c=e.read_shift(4),d=e.read_shift(4)),c!=t&&re(v,"Bad compressed size: "+t+" != "+c),d!=r&&re(v,"Bad uncompressed size: "+r+" != "+d),de(n,f,x,{unsafe:!0,mt:l})}var se={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function ie(e,t){if(e.ctype)return e.ctype;var r=e.name||"",n=r.match(/\.([^\.]+)$/);return n&&se[n[1]]||t&&(n=(r=t).match(/[\.\\]([^\.\\])+$/))&&se[n[1]]?se[n[1]]:"application/octet-stream"}function oe(e){for(var t=Mp(e),r=[],n=0;n<t.length;n+=76)r.push(t.slice(n,n+76));return r.join("\r\n")+"\r\n"}function le(e){var t=e.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(e){var t=e.charCodeAt(0).toString(16).toUpperCase();return"="+(1==t.length?"0"+t:t)});"\n"==(t=t.replace(/ $/gm,"=20").replace(/\t$/gm,"=09")).charAt(0)&&(t="=0D"+t.slice(1));for(var r=[],n=(t=t.replace(/\r(?!\n)/gm,"=0D").replace(/\n\n/gm,"\n=0A").replace(/([^\r\n])\n/gm,"$1=0A")).split("\r\n"),a=0;a<n.length;++a){var s=n[a];if(0!=s.length)for(var i=0;i<s.length;){var o=76,l=s.slice(i,i+o);"="==l.charAt(o-1)?o--:"="==l.charAt(o-2)?o-=2:"="==l.charAt(o-3)&&(o-=3),l=s.slice(i,i+o),(i+=o)<s.length&&(l+="="),r.push(l)}else r.push("")}return r.join("\r\n")}function ce(e,t,r){for(var n,a="",s="",i="",o=0;o<10;++o){var l=t[o];if(!l||l.match(/^\s*$/))break;var c=l.match(/^(.*?):\s*([^\s].*)$/);if(c)switch(c[1].toLowerCase()){case"content-location":a=c[2].trim();break;case"content-type":i=c[2].trim();break;case"content-transfer-encoding":s=c[2].trim()}}switch(++o,s.toLowerCase()){case"base64":n=Vp(Fp(t.slice(o).join("")));break;case"quoted-printable":n=function(e){for(var t=[],r=0;r<e.length;++r){for(var n=e[r];r<=e.length&&"="==n.charAt(n.length-1);)n=n.slice(0,n.length-1)+e[++r];t.push(n)}for(var a=0;a<t.length;++a)t[a]=t[a].replace(/[=][0-9A-Fa-f]{2}/g,function(e){return String.fromCharCode(parseInt(e.slice(1),16))});return Vp(t.join("\r\n"))}(t.slice(o));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+s)}var d=de(e,a.slice(r.length),n,{unsafe:!0});i&&(d.ctype=i)}function de(e,t,r,a){var s=a&&a.unsafe;s||h(e);var i=!s&&zg.find(e,t);if(!i){var o=e.FullPaths[0];t.slice(0,o.length)==o?o=t:("/"!=o.slice(-1)&&(o+="/"),o=(o+t).replace("//","/")),i={name:n(t),type:2},e.FileIndex.push(i),e.FullPaths.push(o),s||zg.utils.cfb_gc(e)}return i.content=r,i.size=r?r.length:0,a&&(a.CLSID&&(i.clsid=a.CLSID),a.mt&&(i.mt=a.mt),a.ct&&(i.ct=a.ct)),i}return t.find=function(e,t){var r=e.FullPaths.map(function(e){return e.toUpperCase()}),n=r.map(function(e){var t=e.split("/");return t[t.length-("/"==e.slice(-1)?2:1)]}),a=!1;47===t.charCodeAt(0)?(a=!0,t=r[0].slice(0,-1)+t):a=-1!==t.indexOf("/");var s=t.toUpperCase(),i=!0===a?r.indexOf(s):n.indexOf(s);if(-1!==i)return e.FileIndex[i];var o=!s.match(Kp);for(s=s.replace(qp,""),o&&(s=s.replace(Kp,"!")),i=0;i<r.length;++i){if((o?r[i].replace(Kp,"!"):r[i]).replace(qp,"")==s)return e.FileIndex[i];if((o?n[i].replace(Kp,"!"):n[i]).replace(qp,"")==s)return e.FileIndex[i]}return null},t.read=function(t,r){var n=r&&r.type;switch(n||Up&&Buffer.isBuffer(t)&&(n="buffer"),n||"base64"){case"file":return function(t,r){return i(),o(e.readFileSync(t),r)}(t,r);case"base64":return o(Vp(Fp(t)),r);case"binary":return o(Vp(t),r)}return o(t,r)},t.parse=o,t.write=function(t,r){var n=m(t,r);switch(r&&r.type||"buffer"){case"file":return i(),e.writeFileSync(r.filename,n),n;case"binary":return"string"==typeof n?n:_(n);case"base64":return Mp("string"==typeof n?n:_(n));case"buffer":if(Up)return Buffer.isBuffer(n)?n:Bp(n);case"array":return"string"==typeof n?Vp(n):n}return n},t.writeFile=function(t,r,n){i();var a=m(t,n);e.writeFileSync(r,a)},t.utils={cfb_new:function(e){var t={};return h(t,e),t},cfb_add:de,cfb_del:function(e,t){h(e);var r=zg.find(e,t);if(r)for(var n=0;n<e.FileIndex.length;++n)if(e.FileIndex[n]==r)return e.FileIndex.splice(n,1),e.FullPaths.splice(n,1),!0;return!1},cfb_mov:function(e,t,r){h(e);var a=zg.find(e,t);if(a)for(var s=0;s<e.FileIndex.length;++s)if(e.FileIndex[s]==a)return e.FileIndex[s].name=n(r),e.FullPaths[s]=r,!0;return!1},cfb_gc:function(e){f(e,!0)},ReadShift:Sv,CheckField:Ov,prep_blob:Iv,bconcat:Gp,use_zlib:function(e){try{var t=new(0,e.InflateRaw);if(t._processChunk(new Uint8Array([3,0]),t._finishFlushFlag),!t.bytesRead)throw new Error("zlib does not expose bytesRead");p=e}catch(r){console.error("cannot use native zlib: "+(r.message||r))}},_deflateRaw:K,_inflateRaw:te,consts:w},t}();function Vg(e){for(var t=Object.keys(e),r=[],n=0;n<t.length;++n)Object.prototype.hasOwnProperty.call(e,t[n])&&r.push(t[n]);return r}function Wg(e){for(var t=[],r=Vg(e),n=0;n!==r.length;++n)t[e[r[n]]]=r[n];return t}var Hg=new Date(1899,11,30,0,0,0);function Gg(e,t){return(e.getTime()-(Hg.getTime()+6e4*(e.getTimezoneOffset()-Hg.getTimezoneOffset())))/864e5}var qg=new Date,Kg=Hg.getTime()+6e4*(qg.getTimezoneOffset()-Hg.getTimezoneOffset()),Xg=qg.getTimezoneOffset();function Yg(e){var t=new Date;return t.setTime(24*e*60*60*1e3+Kg),t.getTimezoneOffset()!==Xg&&t.setTime(t.getTime()+6e4*(t.getTimezoneOffset()-Xg)),t}function Jg(e){var t=0,r=0,n=!1,a=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!a)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var s=1;s!=a.length;++s)if(a[s]){switch(r=1,s>3&&(n=!0),a[s].slice(a[s].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+a[s].slice(a[s].length-1));case"D":r*=24;case"H":r*=60;case"M":if(!n)throw new Error("Unsupported ISO Duration Field: M");r*=60}t+=r*parseInt(a[s],10)}return t}var Zg=new Date("2017-02-19T19:06:09.000Z"),Qg=isNaN(Zg.getFullYear())?new Date("2/19/17"):Zg,ex=2017==Qg.getFullYear();function tx(e,t){var r=new Date(e);if(ex)return t>0?r.setTime(r.getTime()+60*r.getTimezoneOffset()*1e3):t<0&&r.setTime(r.getTime()-60*r.getTimezoneOffset()*1e3),r;if(e instanceof Date)return e;if(1917==Qg.getFullYear()&&!isNaN(r.getFullYear())){var n=r.getFullYear();return e.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var a=e.match(/\d+/g)||["2017","2","19","0","0","0"],s=new Date(+a[0],+a[1]-1,+a[2],+a[3]||0,+a[4]||0,+a[5]||0);return e.indexOf("Z")>-1&&(s=new Date(s.getTime()-60*s.getTimezoneOffset()*1e3)),s}function rx(e,t){if(Up&&Buffer.isBuffer(e)){if(t){if(255==e[0]&&254==e[1])return Bx(e.slice(2).toString("utf16le"));if(254==e[1]&&255==e[2])return Bx(Op(e.slice(2).toString("binary")))}return e.toString("binary")}if("undefined"!=typeof TextDecoder)try{if(t){if(255==e[0]&&254==e[1])return Bx(new TextDecoder("utf-16le").decode(e.slice(2)));if(254==e[0]&&255==e[1])return Bx(new TextDecoder("utf-16be").decode(e.slice(2)))}var r={"":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(e){return r[e]||e})}catch(s){}for(var n=[],a=0;a!=e.length;++a)n.push(String.fromCharCode(e[a]));return n.join("")}function nx(e){if("undefined"!=typeof JSON&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if("object"!=typeof e||null==e)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=nx(e[r]));return t}function ax(e,t){for(var r="";r.length<t;)r+=e;return r}function sx(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,n=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return isNaN(t=Number(n))?(n=n.replace(/[(](.*)[)]/,function(e,t){return r=-r,t}),isNaN(t=Number(n))?t:t/r):t/r}var ix=["january","february","march","april","may","june","july","august","september","october","november","december"];function ox(e){var t=new Date(e),r=new Date(NaN),n=t.getYear(),a=t.getMonth(),s=t.getDate();if(isNaN(s))return r;var i=e.toLowerCase();if(i.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if((i=i.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,"")).length>3&&-1==ix.indexOf(i))return r}else if(i.match(/[a-z]/))return r;return n<0||n>8099?r:(a>0||s>1)&&101!=n?t:e.match(/[^-0-9:,\/\\]/)?r:t}var lx=function(){var e=5=="abacaba".split(/(:?b)/i).length;return function(t,r,n){if(e||"string"==typeof r)return t.split(r);for(var a=t.split(r),s=[a[0]],i=1;i<a.length;++i)s.push(n),s.push(a[i]);return s}}();function cx(e){return e?e.content&&e.type?rx(e.content,!0):e.data?Rp(e.data):e.asNodeBuffer&&Up?Rp(e.asNodeBuffer().toString("binary")):e.asBinary?Rp(e.asBinary()):e._data&&e._data.getContent?Rp(rx(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function dx(e){if(!e)return null;if(e.data)return Ap(e.data);if(e.asNodeBuffer&&Up)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return"string"==typeof t?Ap(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}function ux(e,t){for(var r=e.FullPaths||Vg(e.files),n=t.toLowerCase().replace(/[\/]/g,"\\"),a=n.replace(/\\/g,"/"),s=0;s<r.length;++s){var i=r[s].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==i||a==i)return e.files?e.files[r[s]]:e.FileIndex[s]}return null}function hx(e,t){var r=ux(e,t);if(null==r)throw new Error("Cannot find file "+t+" in zip");return r}function fx(e,t,r){if(!r)return(n=hx(e,t))&&".bin"===n.name.slice(-4)?dx(n):cx(n);var n;if(!t)return null;try{return fx(e,t)}catch(a){return null}}function mx(e,t,r){if(!r)return cx(hx(e,t));if(!t)return null;try{return mx(e,t)}catch(n){return null}}function px(e){for(var t=e.FullPaths||Vg(e.files),r=[],n=0;n<t.length;++n)"/"!=t[n].slice(-1)&&r.push(t[n].replace(/^Root Entry[\/]/,""));return r.sort()}function gx(e,t,r){if(e.FullPaths){var n;if("string"==typeof r)return n=Up?Bp(r):function(e){for(var t=[],r=0,n=e.length+250,a=$p(e.length+255),s=0;s<e.length;++s){var i=e.charCodeAt(s);if(i<128)a[r++]=i;else if(i<2048)a[r++]=192|i>>6&31,a[r++]=128|63&i;else if(i>=55296&&i<57344){i=64+(1023&i);var o=1023&e.charCodeAt(++s);a[r++]=240|i>>8&7,a[r++]=128|i>>2&63,a[r++]=128|o>>6&15|(3&i)<<4,a[r++]=128|63&o}else a[r++]=224|i>>12&15,a[r++]=128|i>>6&63,a[r++]=128|63&i;r>n&&(t.push(a.slice(0,r)),r=0,a=$p(65535),n=65530)}return t.push(a.slice(0,r)),Gp(t)}(r),zg.utils.cfb_add(e,t,n);zg.utils.cfb_add(e,t,r)}else e.file(t,r)}function xx(e,t){switch(t.type){case"base64":return zg.read(e,{type:"base64"});case"binary":return zg.read(e,{type:"binary"});case"buffer":case"array":return zg.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function vx(e,t){if("/"==e.charAt(0))return e.slice(1);var r=t.split("/");"/"!=t.slice(-1)&&r.pop();for(var n=e.split("/");0!==n.length;){var a=n.shift();".."===a?r.pop():"."!==a&&r.push(a)}return r.join("/")}var bx='<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r\n',yx=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,wx=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/gm,_x=bx.match(wx)?wx:/<[^>]*>/g,kx=/<\w*:/,Nx=/<(\/?)\w+:/;function jx(e,t,r){for(var n={},a=0,s=0;a!==e.length&&(32!==(s=e.charCodeAt(a))&&10!==s&&13!==s);++a);if(t||(n[0]=e.slice(0,a)),a===e.length)return n;var i=e.match(yx),o=0,l="",c=0,d="",u="",h=1;if(i)for(c=0;c!=i.length;++c){for(u=i[c],s=0;s!=u.length&&61!==u.charCodeAt(s);++s);for(d=u.slice(0,s).trim();32==u.charCodeAt(s+1);)++s;for(h=34==(a=u.charCodeAt(s+1))||39==a?1:0,l=u.slice(s+1+h,u.length-h),o=0;o!=d.length&&58!==d.charCodeAt(o);++o);if(o===d.length)d.indexOf("_")>0&&(d=d.slice(0,d.indexOf("_"))),n[d]=l,n[d.toLowerCase()]=l;else{var f=(5===o&&"xmlns"===d.slice(0,5)?"xmlns":"")+d.slice(o+1);if(n[f]&&"ext"==d.slice(o-3,o))continue;n[f]=l,n[f.toLowerCase()]=l}}return n}function Sx(e){return e.replace(Nx,"<$1")}var Tx={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},Ex=Wg(Tx),Cx=function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/gi,t=/_x([\da-fA-F]{4})_/gi;return function r(n){var a=n+"",s=a.indexOf("<![CDATA[");if(-1==s)return a.replace(e,function(e,t){return Tx[e]||String.fromCharCode(parseInt(t,e.indexOf("x")>-1?16:10))||e}).replace(t,function(e,t){return String.fromCharCode(parseInt(t,16))});var i=a.indexOf("]]>");return r(a.slice(0,s))+a.slice(s+9,i)+r(a.slice(i+3))}}(),Ax=/[&<>'"]/g,Ox=/[\u0000-\u001f]/g;function Ix(e){return(e+"").replace(Ax,function(e){return Ex[e]}).replace(/\n/g,"<br/>").replace(Ox,function(e){return"&#x"+("000"+e.charCodeAt(0).toString(16)).slice(-4)+";"})}var Rx=function(){var e=/&#(\d+);/g;function t(e,t){return String.fromCharCode(parseInt(t,10))}return function(r){return r.replace(e,t)}}();function Px(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function Dx(e){for(var t="",r=0,n=0,a=0,s=0,i=0,o=0;r<e.length;)(n=e.charCodeAt(r++))<128?t+=String.fromCharCode(n):(a=e.charCodeAt(r++),n>191&&n<224?(i=(31&n)<<6,i|=63&a,t+=String.fromCharCode(i)):(s=e.charCodeAt(r++),n<240?t+=String.fromCharCode((15&n)<<12|(63&a)<<6|63&s):(o=((7&n)<<18|(63&a)<<12|(63&s)<<6|63&(i=e.charCodeAt(r++)))-65536,t+=String.fromCharCode(55296+(o>>>10&1023)),t+=String.fromCharCode(56320+(1023&o)))));return t}function Lx(e){var t,r,n,a=$p(2*e.length),s=1,i=0,o=0;for(r=0;r<e.length;r+=s)s=1,(n=e.charCodeAt(r))<128?t=n:n<224?(t=64*(31&n)+(63&e.charCodeAt(r+1)),s=2):n<240?(t=4096*(15&n)+64*(63&e.charCodeAt(r+1))+(63&e.charCodeAt(r+2)),s=3):(s=4,t=262144*(7&n)+4096*(63&e.charCodeAt(r+1))+64*(63&e.charCodeAt(r+2))+(63&e.charCodeAt(r+3)),o=55296+((t-=65536)>>>10&1023),t=56320+(1023&t)),0!==o&&(a[i++]=255&o,a[i++]=o>>>8,o=0),a[i++]=t%256,a[i++]=t>>>8;return a.slice(0,i).toString("ucs2")}function Mx(e){return Bp(e,"binary").toString("utf8")}var Fx="foo bar baz",Ux=Up&&(Mx(Fx)==Dx(Fx)&&Mx||Lx(Fx)==Dx(Fx)&&Lx)||Dx,Bx=Up?function(e){return Bp(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,n=0,a=0;r<e.length;)switch(n=e.charCodeAt(r++),!0){case n<128:t.push(String.fromCharCode(n));break;case n<2048:t.push(String.fromCharCode(192+(n>>6))),t.push(String.fromCharCode(128+(63&n)));break;case n>=55296&&n<57344:n-=55296,a=e.charCodeAt(r++)-56320+(n<<10),t.push(String.fromCharCode(240+(a>>18&7))),t.push(String.fromCharCode(144+(a>>12&63))),t.push(String.fromCharCode(128+(a>>6&63))),t.push(String.fromCharCode(128+(63&a)));break;default:t.push(String.fromCharCode(224+(n>>12))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(63&n)))}return t.join("")},$x=function(){var e={};return function(t,r){var n=t+"|"+(r||"");return e[n]?e[n]:e[n]=new RegExp("<(?:\\w+:)?"+t+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+t+">",r||"")}}(),zx=function(){var e=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(e){return[new RegExp("&"+e[0]+";","ig"),e[1]]});return function(t){for(var r=t.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,"\n").replace(/<[^>]*>/g,""),n=0;n<e.length;++n)r=r.replace(e[n][0],e[n][1]);return r}}(),Vx=function(){var e={};return function(t){return void 0!==e[t]?e[t]:e[t]=new RegExp("<(?:vt:)?"+t+">([\\s\\S]*?)</(?:vt:)?"+t+">","g")}}(),Wx=/<\/?(?:vt:)?variant>/g,Hx=/<(?:vt:)([^>]*)>([\s\S]*)</;function Gx(e,t){var r=jx(e),n=e.match(Vx(r.baseType))||[],a=[];if(n.length!=r.size){if(t.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return a}return n.forEach(function(e){var t=e.replace(Wx,"").match(Hx);t&&a.push({v:Ux(t[2]),t:t[1]})}),a}var qx=/(^\s|\s$|\n)/;function Kx(e,t,r){return"<"+e+(null!=r?function(e){return Vg(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}(r):"")+(null!=t?(t.match(qx)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function Xx(e){if(Up&&Buffer.isBuffer(e))return e.toString("utf8");if("string"==typeof e)return e;if("undefined"!=typeof Uint8Array&&e instanceof Uint8Array)return Ux(Wp(Hp(e)));throw new Error("Bad input format: expected Buffer or string")}var Yx=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/gm,Jx="http://schemas.openxmlformats.org/package/2006/content-types",Zx=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"];var Qx=function(e){for(var t=[],r=0;r<e[0].length;++r)if(e[0][r])for(var n=0,a=e[0][r].length;n<a;n+=10240)t.push.apply(t,e[0][r].slice(n,n+10240));return t},ev=Up?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(e){return Buffer.isBuffer(e)?e:Bp(e)})):Qx(e)}:Qx,tv=function(e,t,r){for(var n=[],a=t;a<r;a+=2)n.push(String.fromCharCode(wv(e,a)));return n.join("").replace(qp,"")},rv=Up?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(qp,""):tv(e,t,r)}:tv,nv=function(e,t,r){for(var n=[],a=t;a<t+r;++a)n.push(("0"+e[a].toString(16)).slice(-2));return n.join("")},av=Up?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):nv(e,t,r)}:nv,sv=function(e,t,r){for(var n=[],a=t;a<r;a++)n.push(String.fromCharCode(yv(e,a)));return n.join("")},iv=Up?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf8",t,r):sv(e,t,r)}:sv,ov=function(e,t){var r=kv(e,t);return r>0?iv(e,t+4,t+4+r-1):""},lv=ov,cv=function(e,t){var r=kv(e,t);return r>0?iv(e,t+4,t+4+r-1):""},dv=cv,uv=function(e,t){var r=2*kv(e,t);return r>0?iv(e,t+4,t+4+r-1):""},hv=uv,fv=function(e,t){var r=kv(e,t);return r>0?rv(e,t+4,t+4+r):""},mv=fv,pv=function(e,t){var r=kv(e,t);return r>0?iv(e,t+4,t+4+r):""},gv=pv,xv=function(e,t){return function(e,t){for(var r=1-2*(e[t+7]>>>7),n=((127&e[t+7])<<4)+(e[t+6]>>>4&15),a=15&e[t+6],s=5;s>=0;--s)a=256*a+e[t+s];return 2047==n?0==a?r*(1/0):NaN:(0==n?n=-1022:(n-=1023,a+=Math.pow(2,52)),r*Math.pow(2,n-52)*a)}(e,t)},vv=xv,bv=function(e){return Array.isArray(e)||"undefined"!=typeof Uint8Array&&e instanceof Uint8Array};Up&&(lv=function(e,t){if(!Buffer.isBuffer(e))return ov(e,t);var r=e.readUInt32LE(t);return r>0?e.toString("utf8",t+4,t+4+r-1):""},dv=function(e,t){if(!Buffer.isBuffer(e))return cv(e,t);var r=e.readUInt32LE(t);return r>0?e.toString("utf8",t+4,t+4+r-1):""},hv=function(e,t){if(!Buffer.isBuffer(e))return uv(e,t);var r=2*e.readUInt32LE(t);return e.toString("utf16le",t+4,t+4+r-1)},mv=function(e,t){if(!Buffer.isBuffer(e))return fv(e,t);var r=e.readUInt32LE(t);return e.toString("utf16le",t+4,t+4+r)},gv=function(e,t){if(!Buffer.isBuffer(e))return pv(e,t);var r=e.readUInt32LE(t);return e.toString("utf8",t+4,t+4+r)},vv=function(e,t){return Buffer.isBuffer(e)?e.readDoubleLE(t):xv(e,t)},bv=function(e){return Buffer.isBuffer(e)||Array.isArray(e)||"undefined"!=typeof Uint8Array&&e instanceof Uint8Array});var yv=function(e,t){return e[t]},wv=function(e,t){return 256*e[t+1]+e[t]},_v=function(e,t){var r=256*e[t+1]+e[t];return r<32768?r:-1*(65535-r+1)},kv=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},Nv=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},jv=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function Sv(e,t){var r,n,a,s,i,o,l="",c=[];switch(t){case"dbcs":if(o=this.l,Up&&Buffer.isBuffer(this))l=this.slice(this.l,this.l+2*e).toString("utf16le");else for(i=0;i<e;++i)l+=String.fromCharCode(wv(this,o)),o+=2;e*=2;break;case"utf8":l=iv(this,this.l,this.l+e);break;case"utf16le":e*=2,l=rv(this,this.l,this.l+e);break;case"wstr":return Sv.call(this,e,"dbcs");case"lpstr-ansi":l=lv(this,this.l),e=4+kv(this,this.l);break;case"lpstr-cp":l=dv(this,this.l),e=4+kv(this,this.l);break;case"lpwstr":l=hv(this,this.l),e=4+2*kv(this,this.l);break;case"lpp4":e=4+kv(this,this.l),l=mv(this,this.l),2&e&&(e+=2);break;case"8lpp4":e=4+kv(this,this.l),l=gv(this,this.l),3&e&&(e+=4-(3&e));break;case"cstr":for(e=0,l="";0!==(a=yv(this,this.l+e++));)c.push(Pp(a));l=c.join("");break;case"_wstr":for(e=0,l="";0!==(a=wv(this,this.l+e));)c.push(Pp(a)),e+=2;e+=2,l=c.join("");break;case"dbcs-cont":for(l="",o=this.l,i=0;i<e;++i){if(this.lens&&-1!==this.lens.indexOf(o))return a=yv(this,o),this.l=o+1,s=Sv.call(this,e-i,a?"dbcs-cont":"sbcs-cont"),c.join("")+s;c.push(Pp(wv(this,o))),o+=2}l=c.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(l="",o=this.l,i=0;i!=e;++i){if(this.lens&&-1!==this.lens.indexOf(o))return a=yv(this,o),this.l=o+1,s=Sv.call(this,e-i,a?"dbcs-cont":"sbcs-cont"),c.join("")+s;c.push(Pp(yv(this,o))),o+=1}l=c.join("");break;default:switch(e){case 1:return r=yv(this,this.l),this.l++,r;case 2:return r=("i"===t?_v:wv)(this,this.l),this.l+=2,r;case 4:case-4:return"i"!==t&&128&this[this.l+3]?(n=kv(this,this.l),this.l+=4,n):(r=(e>0?Nv:jv)(this,this.l),this.l+=4,r);case 8:case-8:if("f"===t)return n=8==e?vv(this,this.l):vv([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,n;e=8;case 16:l=av(this,this.l,e)}}return this.l+=e,l}var Tv=function(e,t,r){e[r]=255&t,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},Ev=function(e,t,r){e[r]=255&t,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},Cv=function(e,t,r){e[r]=255&t,e[r+1]=t>>>8&255};function Av(e,t,r){var n=0,a=0;if("dbcs"===r){for(a=0;a!=t.length;++a)Cv(this,t.charCodeAt(a),this.l+2*a);n=2*t.length}else if("sbcs"===r){for(t=t.replace(/[^\x00-\x7F]/g,"_"),a=0;a!=t.length;++a)this[this.l+a]=255&t.charCodeAt(a);n=t.length}else{if("hex"===r){for(;a<e;++a)this[this.l++]=parseInt(t.slice(2*a,2*a+2),16)||0;return this}if("utf16le"===r){var s=Math.min(this.l+e,this.length);for(a=0;a<Math.min(t.length,e);++a){var i=t.charCodeAt(a);this[this.l++]=255&i,this[this.l++]=i>>8}for(;this.l<s;)this[this.l++]=0;return this}switch(e){case 1:n=1,this[this.l]=255&t;break;case 2:n=2,this[this.l]=255&t,t>>>=8,this[this.l+1]=255&t;break;case 3:n=3,this[this.l]=255&t,t>>>=8,this[this.l+1]=255&t,t>>>=8,this[this.l+2]=255&t;break;case 4:n=4,Tv(this,t,this.l);break;case 8:if(n=8,"f"===r){!function(e,t,r){var n=(t<0||1/t==-1/0?1:0)<<7,a=0,s=0,i=n?-t:t;isFinite(i)?0==i?a=s=0:(a=Math.floor(Math.log(i)/Math.LN2),s=i*Math.pow(2,52-a),a<=-1023&&(!isFinite(s)||s<Math.pow(2,52))?a=-1022:(s-=Math.pow(2,52),a+=1023)):(a=2047,s=isNaN(t)?26985:0);for(var o=0;o<=5;++o,s/=256)e[r+o]=255&s;e[r+6]=(15&a)<<4|15&s,e[r+7]=a>>4|n}(this,t,this.l);break}case 16:break;case-4:n=4,Ev(this,t,this.l)}}return this.l+=n,this}function Ov(e,t){var r=av(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function Iv(e,t){e.l=t,e.read_shift=Sv,e.chk=Ov,e.write_shift=Av}function Rv(e,t){e.l+=t}function Pv(e){var t=$p(e);return Iv(t,0),t}function Dv(e,t,r){if(e){var n,a,s;Iv(e,e.l||0);for(var i=e.length,o=0,l=0;e.l<i;){128&(o=e.read_shift(1))&&(o=(127&o)+((127&e.read_shift(1))<<7));var c=zk[o]||zk[65535];for(s=127&(n=e.read_shift(1)),a=1;a<4&&128&n;++a)s+=(127&(n=e.read_shift(1)))<<7*a;l=e.l+s;var d=c.f&&c.f(e,s,r);if(e.l=l,t(d,c,o))return}}}function Lv(){var e=[],t=Up?256:2048,r=function(e){var t=Pv(e);return Iv(t,0),t},n=r(t),a=function(){n&&(n.length>n.l&&((n=n.slice(0,n.l)).l=n.length),n.length>0&&e.push(n),n=null)},s=function(e){return n&&e<n.length-n.l?n:(a(),n=r(Math.max(e+1,t)))};return{next:s,push:function(e){a(),null==(n=e).l&&(n.l=n.length),s(t)},end:function(){return a(),Gp(e)},_bufs:e}}function Mv(e,t,r){var n=nx(e);if(t.s?(n.cRel&&(n.c+=t.s.c),n.rRel&&(n.r+=t.s.r)):(n.cRel&&(n.c+=t.c),n.rRel&&(n.r+=t.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function Fv(e,t,r){var n=nx(e);return n.s=Mv(n.s,t.s,r),n.e=Mv(n.e,t.s,r),n}function Uv(e,t){if(e.cRel&&e.c<0)for(e=nx(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=nx(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=Gv(e);return e.cRel||null==e.cRel||(r=r.replace(/^([A-Z])/,"$$$1")),e.rRel||null==e.rRel||(r=function(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}(r)),r}function Bv(e,t){return 0!=e.s.r||e.s.rRel||e.e.r!=(t.biff>=12?1048575:t.biff>=8?65536:16384)||e.e.rRel?0!=e.s.c||e.s.cRel||e.e.c!=(t.biff>=12?16383:255)||e.e.cRel?Uv(e.s,t.biff)+":"+Uv(e.e,t.biff):(e.s.rRel?"":"$")+zv(e.s.r)+":"+(e.e.rRel?"":"$")+zv(e.e.r):(e.s.cRel?"":"$")+Wv(e.s.c)+":"+(e.e.cRel?"":"$")+Wv(e.e.c)}function $v(e){return parseInt(e.replace(/\$(\d+)$/,"$1"),10)-1}function zv(e){return""+(e+1)}function Vv(e){for(var t=e.replace(/^\$([A-Z])/,"$1"),r=0,n=0;n!==t.length;++n)r=26*r+t.charCodeAt(n)-64;return r-1}function Wv(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function Hv(e){for(var t=0,r=0,n=0;n<e.length;++n){var a=e.charCodeAt(n);a>=48&&a<=57?t=10*t+(a-48):a>=65&&a<=90&&(r=26*r+(a-64))}return{c:r-1,r:t-1}}function Gv(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function qv(e){var t=e.indexOf(":");return-1==t?{s:Hv(e),e:Hv(e)}:{s:Hv(e.slice(0,t)),e:Hv(e.slice(t+1))}}function Kv(e,t){return void 0===t||"number"==typeof t?Kv(e.s,e.e):("string"!=typeof e&&(e=Gv(e)),"string"!=typeof t&&(t=Gv(t)),e==t?e:e+":"+t)}function Xv(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,a=0,s=e.length;for(r=0;n<s&&!((a=e.charCodeAt(n)-64)<1||a>26);++n)r=26*r+a;for(t.s.c=--r,r=0;n<s&&!((a=e.charCodeAt(n)-48)<0||a>9);++n)r=10*r+a;if(t.s.r=--r,n===s||10!=a)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++n,r=0;n!=s&&!((a=e.charCodeAt(n)-64)<1||a>26);++n)r=26*r+a;for(t.e.c=--r,r=0;n!=s&&!((a=e.charCodeAt(n)-48)<0||a>9);++n)r=10*r+a;return t.e.r=--r,t}function Yv(e,t){var r="d"==e.t&&t instanceof Date;if(null!=e.z)try{return e.w=Lg(e.z,r?Gg(t):t)}catch(n){}try{return e.w=Lg((e.XF||{}).numFmtId||(r?14:0),r?Gg(t):t)}catch(n){return""+t}}function Jv(e,t,r){return null==e||null==e.t||"z"==e.t?"":void 0!==e.w?e.w:("d"==e.t&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),"e"==e.t?Nb[e.v]||e.v:Yv(e,null==t?e.v:t))}function Zv(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",n={};return n[r]=e,{SheetNames:[r],Sheets:n}}function Qv(e,t,r){var n=r||{},a=e?Array.isArray(e):n.dense,s=e||(a?[]:{}),i=0,o=0;if(s&&null!=n.origin){if("number"==typeof n.origin)i=n.origin;else{var l="string"==typeof n.origin?Hv(n.origin):n.origin;i=l.r,o=l.c}s["!ref"]||(s["!ref"]="A1:A1")}var c={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(s["!ref"]){var d=Xv(s["!ref"]);c.s.c=d.s.c,c.s.r=d.s.r,c.e.c=Math.max(c.e.c,d.e.c),c.e.r=Math.max(c.e.r,d.e.r),-1==i&&(c.e.r=i=d.e.r+1)}for(var u=0;u!=t.length;++u)if(t[u]){if(!Array.isArray(t[u]))throw new Error("aoa_to_sheet expects an array of arrays");for(var h=0;h!=t[u].length;++h)if(void 0!==t[u][h]){var f={v:t[u][h]},m=i+u,p=o+h;if(c.s.r>m&&(c.s.r=m),c.s.c>p&&(c.s.c=p),c.e.r<m&&(c.e.r=m),c.e.c<p&&(c.e.c=p),!t[u][h]||"object"!=typeof t[u][h]||Array.isArray(t[u][h])||t[u][h]instanceof Date)if(Array.isArray(f.v)&&(f.f=t[u][h][1],f.v=f.v[0]),null===f.v)if(f.f)f.t="n";else if(n.nullError)f.t="e",f.v=0;else{if(!n.sheetStubs)continue;f.t="z"}else"number"==typeof f.v?f.t="n":"boolean"==typeof f.v?f.t="b":f.v instanceof Date?(f.z=n.dateNF||ag[14],n.cellDates?(f.t="d",f.w=Lg(f.z,Gg(f.v))):(f.t="n",f.v=Gg(f.v),f.w=Lg(f.z,f.v))):f.t="s";else f=t[u][h];if(a)s[m]||(s[m]=[]),s[m][p]&&s[m][p].z&&(f.z=s[m][p].z),s[m][p]=f;else{var g=Gv({c:p,r:m});s[g]&&s[g].z&&(f.z=s[g].z),s[g]=f}}}return c.s.c<1e7&&(s["!ref"]=Kv(c)),s}function eb(e,t){return Qv(null,e,t)}function tb(e){var t=e.read_shift(4);return 0===t?"":e.read_shift(t,"dbcs")}function rb(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function nb(e,t){var r=e.l,n=e.read_shift(1),a=tb(e),s=[],i={t:a,h:a};if(1&n){for(var o=e.read_shift(4),l=0;l!=o;++l)s.push(rb(e));i.r=s}else i.r=[{ich:0,ifnt:0}];return e.l=r+t,i}var ab=nb;function sb(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function ib(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}var ob=tb;function lb(e){var t=e.read_shift(4);return 0===t||4294967295===t?"":e.read_shift(t,"dbcs")}var cb=tb,db=lb;function ub(e){var t=e.slice(e.l,e.l+4),r=1&t[0],n=2&t[0];e.l+=4;var a=0===n?vv([0,0,0,0,252&t[0],t[1],t[2],t[3]],0):Nv(t,0)>>2;return r?a/100:a}function hb(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}var fb=hb;function mb(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function pb(e,t){var r=e.read_shift(4);switch(r){case 0:return"";case 4294967295:case 4294967294:return{2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"}[e.read_shift(4)]||""}if(r>400)throw new Error("Unsupported Clipboard: "+r.toString(16));return e.l-=4,e.read_shift(0,1==t?"lpstr":"lpwstr")}var gb=80,xb=[gb,81],vb={1:{n:"CodePage",t:2},2:{n:"Category",t:gb},3:{n:"PresentationFormat",t:gb},4:{n:"ByteCount",t:3},5:{n:"LineCount",t:3},6:{n:"ParagraphCount",t:3},7:{n:"SlideCount",t:3},8:{n:"NoteCount",t:3},9:{n:"HiddenCount",t:3},10:{n:"MultimediaClipCount",t:3},11:{n:"ScaleCrop",t:11},12:{n:"HeadingPairs",t:4108},13:{n:"TitlesOfParts",t:4126},14:{n:"Manager",t:gb},15:{n:"Company",t:gb},16:{n:"LinksUpToDate",t:11},17:{n:"CharacterCount",t:3},19:{n:"SharedDoc",t:11},22:{n:"HyperlinksChanged",t:11},23:{n:"AppVersion",t:3,p:"version"},24:{n:"DigSig",t:65},26:{n:"ContentType",t:gb},27:{n:"ContentStatus",t:gb},28:{n:"Language",t:gb},29:{n:"Version",t:gb},255:{},2147483648:{n:"Locale",t:19},2147483651:{n:"Behavior",t:19},1919054434:{}},bb={1:{n:"CodePage",t:2},2:{n:"Title",t:gb},3:{n:"Subject",t:gb},4:{n:"Author",t:gb},5:{n:"Keywords",t:gb},6:{n:"Comments",t:gb},7:{n:"Template",t:gb},8:{n:"LastAuthor",t:gb},9:{n:"RevNumber",t:gb},10:{n:"EditTime",t:64},11:{n:"LastPrinted",t:64},12:{n:"CreatedDate",t:64},13:{n:"ModifiedDate",t:64},14:{n:"PageCount",t:3},15:{n:"WordCount",t:3},16:{n:"CharCount",t:3},17:{n:"Thumbnail",t:71},18:{n:"Application",t:gb},19:{n:"DocSecurity",t:3},255:{},2147483648:{n:"Locale",t:19},2147483651:{n:"Behavior",t:19},1919054434:{}},yb={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},wb=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function _b(e){return e.map(function(e){return[e>>16&255,e>>8&255,255&e]})}var kb=nx(_b([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0])),Nb={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},jb={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},Sb={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"};var Tb={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function Eb(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function Cb(e,t){var r={"!id":{}};if(!e)return r;"/"!==t.charAt(0)&&(t="/"+t);var n={};return(e.match(_x)||[]).forEach(function(e){var a=jx(e);if("<Relationship"===a[0]){var s={};s.Type=a.Type,s.Target=a.Target,s.Id=a.Id,a.TargetMode&&(s.TargetMode=a.TargetMode);var i="External"===a.TargetMode?a.Target:vx(a.Target,t);r[i]=s,n[a.Id]=s}}),r["!id"]=n,r}var Ab=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],Ob=function(){for(var e=new Array(Ab.length),t=0;t<Ab.length;++t){var r=Ab[t],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);e[t]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return e}();function Ib(e){var t={};e=Ux(e);for(var r=0;r<Ab.length;++r){var n=Ab[r],a=e.match(Ob[r]);null!=a&&a.length>0&&(t[n[1]]=Cx(a[1])),"date"===n[2]&&t[n[1]]&&(t[n[1]]=tx(t[n[1]]))}return t}var Rb=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]];function Pb(e,t,r,n){var a=[];if("string"==typeof e)a=Gx(e,n);else for(var s=0;s<e.length;++s)a=a.concat(e[s].map(function(e){return{v:e}}));var i="string"==typeof t?Gx(t,n).map(function(e){return e.v}):t,o=0,l=0;if(i.length>0)for(var c=0;c!==a.length;c+=2){switch(l=+a[c+1].v,a[c].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":r.Worksheets=l,r.SheetNames=i.slice(o,o+l);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":r.NamedRanges=l,r.DefinedNames=i.slice(o,o+l);break;case"Charts":case"Diagramme":r.Chartsheets=l,r.ChartNames=i.slice(o,o+l)}o+=l}}var Db=/<[^>]+>[^<]*/g;var Lb,Mb={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"};function Fb(e,t,r){Lb||(Lb=Wg(Mb)),e[t=Lb[t]||t]=r}function Ub(e){var t=e.read_shift(4),r=e.read_shift(4);return new Date(1e3*(r/1e7*Math.pow(2,32)+t/1e7-11644473600)).toISOString().replace(/\.000/,"")}function Bb(e,t,r){var n=e.l,a=e.read_shift(0,"lpstr-cp");if(r)for(;e.l-n&3;)++e.l;return a}function $b(e,t,r){return e.read_shift(0,"lpwstr")}function zb(e,t,r){return 31===t?$b(e):Bb(e,0,r)}function Vb(e,t,r){return zb(e,t,!1===r?0:4)}function Wb(e){var t=e.l,r=qb(e,81);return 0==e[e.l]&&0==e[e.l+1]&&e.l-t&2&&(e.l+=2),[r,qb(e,3)]}function Hb(e,t){for(var r=e.read_shift(4),n={},a=0;a!=r;++a){var s=e.read_shift(4),i=e.read_shift(4);n[s]=e.read_shift(i,1200===t?"utf16le":"utf8").replace(qp,"").replace(Kp,"!"),1200===t&&i%2&&(e.l+=2)}return 3&e.l&&(e.l=e.l>>3<<2),n}function Gb(e){var t=e.read_shift(4),r=e.slice(e.l,e.l+t);return e.l+=t,(3&t)>0&&(e.l+=4-(3&t)&3),r}function qb(e,t,r){var n,a=e.read_shift(2),s=r||{};if(e.l+=2,12!==t&&a!==t&&-1===xb.indexOf(t)&&(4126!=(65534&t)||4126!=(65534&a)))throw new Error("Expected type "+t+" saw "+a);switch(12===t?a:t){case 2:return n=e.read_shift(2,"i"),s.raw||(e.l+=2),n;case 3:return n=e.read_shift(4,"i");case 11:return 0!==e.read_shift(4);case 19:return n=e.read_shift(4);case 30:return Bb(e,0,4).replace(qp,"");case 31:return $b(e);case 64:return Ub(e);case 65:return Gb(e);case 71:return function(e){var t={};return t.Size=e.read_shift(4),e.l+=t.Size+3-(t.Size-1)%4,t}(e);case 80:return Vb(e,a,!s.raw).replace(qp,"");case 81:return function(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return zb(e,t,0)}(e,a).replace(qp,"");case 4108:return function(e){for(var t=e.read_shift(4),r=[],n=0;n<t/2;++n)r.push(Wb(e));return r}(e);case 4126:case 4127:return 4127==a?function(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n){var a=e.l;r[n]=e.read_shift(0,"lpwstr").replace(qp,""),e.l-a&2&&(e.l+=2)}return r}(e):function(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n)r[n]=e.read_shift(0,"lpstr-cp").replace(qp,"");return r}(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+a)}}function Kb(e,t){var r=e.l,n=e.read_shift(4),a=e.read_shift(4),s=[],i=0,o=0,l=-1,c={};for(i=0;i!=a;++i){var d=e.read_shift(4),u=e.read_shift(4);s[i]=[d,u+r]}s.sort(function(e,t){return e[1]-t[1]});var h={};for(i=0;i!=a;++i){if(e.l!==s[i][1]){var f=!0;if(i>0&&t)switch(t[s[i-1][0]].t){case 2:e.l+2===s[i][1]&&(e.l+=2,f=!1);break;case 80:case 4108:e.l<=s[i][1]&&(e.l=s[i][1],f=!1)}if((!t||0==i)&&e.l<=s[i][1]&&(f=!1,e.l=s[i][1]),f)throw new Error("Read Error: Expected address "+s[i][1]+" at "+e.l+" :"+i)}if(t){var m=t[s[i][0]];if(h[m.n]=qb(e,m.t,{raw:!0}),"version"===m.p&&(h[m.n]=String(h[m.n]>>16)+"."+("0000"+String(65535&h[m.n])).slice(-4)),"CodePage"==m.n)switch(h[m.n]){case 0:h[m.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:Ep(o=h[m.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+h[m.n])}}else if(1===s[i][0]){if(o=h.CodePage=qb(e,2),Ep(o),-1!==l){var p=e.l;e.l=s[l][1],c=Hb(e,o),e.l=p}}else if(0===s[i][0]){if(0===o){l=i,e.l=s[i+1][1];continue}c=Hb(e,o)}else{var g,x=c[s[i][0]];switch(e[e.l]){case 65:e.l+=4,g=Gb(e);break;case 30:case 31:e.l+=4,g=Vb(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,g=e.read_shift(4,"i");break;case 19:e.l+=4,g=e.read_shift(4);break;case 5:e.l+=4,g=e.read_shift(8,"f");break;case 11:e.l+=4,g=Jb(e,4);break;case 64:e.l+=4,g=tx(Ub(e));break;default:throw new Error("unparsed value: "+e[e.l])}h[x]=g}}return e.l=r+n,h}function Xb(e,t,r){var n=e.content;if(!n)return{};Iv(n,0);var a,s,i,o,l=0;n.chk("feff","Byte Order: "),n.read_shift(2);var c=n.read_shift(4),d=n.read_shift(16);if(d!==zg.utils.consts.HEADER_CLSID&&d!==r)throw new Error("Bad PropertySet CLSID "+d);if(1!==(a=n.read_shift(4))&&2!==a)throw new Error("Unrecognized #Sets: "+a);if(s=n.read_shift(16),o=n.read_shift(4),1===a&&o!==n.l)throw new Error("Length mismatch: "+o+" !== "+n.l);2===a&&(i=n.read_shift(16),l=n.read_shift(4));var u,h=Kb(n,t),f={SystemIdentifier:c};for(var m in h)f[m]=h[m];if(f.FMTID=s,1===a)return f;if(l-n.l==2&&(n.l+=2),n.l!==l)throw new Error("Length mismatch 2: "+n.l+" !== "+l);try{u=Kb(n,null)}catch(p){}for(m in u)f[m]=u[m];return f.FMTID=[s,i],f}function Yb(e,t){return e.read_shift(t),null}function Jb(e,t){return 1===e.read_shift(t)}function Zb(e){return e.read_shift(2,"u")}function Qb(e,t){return function(e,t,r){for(var n=[],a=e.l+t;e.l<a;)n.push(r(e,a-e.l));if(a!==e.l)throw new Error("Slurp error");return n}(e,t,Zb)}function ey(e,t,r){var n=e.read_shift(r&&r.biff>=12?2:1),a="sbcs-cont";(r&&r.biff,r&&8!=r.biff)?12==r.biff&&(a="wstr"):e.read_shift(1)&&(a="dbcs-cont");return r.biff>=2&&r.biff<=5&&(a="cpstr"),n?e.read_shift(n,a):""}function ty(e){var t,r=e.read_shift(2),n=e.read_shift(1),a=4&n,s=8&n,i=1+(1&n),o=0,l={};s&&(o=e.read_shift(2)),a&&(t=e.read_shift(4));var c=2==i?"dbcs-cont":"sbcs-cont",d=0===r?"":e.read_shift(r,c);return s&&(e.l+=4*o),a&&(e.l+=t),l.t=d,s||(l.raw="<t>"+l.t+"</t>",l.r=l.t),l}function ry(e,t,r){if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}return 0===e.read_shift(1)?e.read_shift(t,"sbcs-cont"):e.read_shift(t,"dbcs-cont")}function ny(e,t,r){var n=e.read_shift(r&&2==r.biff?1:2);return 0===n?(e.l++,""):ry(e,n,r)}function ay(e,t,r){if(r.biff>5)return ny(e,0,r);var n=e.read_shift(1);return 0===n?(e.l++,""):e.read_shift(n,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function sy(e,t){var r=e.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return function(e){var t=e.read_shift(4),r=e.l,n=!1;t>24&&(e.l+=t-24,"795881f43b1d7f48af2c825dc4852763"===e.read_shift(16)&&(n=!0),e.l=r);var a=e.read_shift((n?t-24:t)>>1,"utf16le").replace(qp,"");return n&&(e.l+=24),a}(e);case"0303000000000000c000000000000046":return function(e){for(var t=e.read_shift(2),r="";t-- >0;)r+="../";var n=e.read_shift(0,"lpstr-ansi");if(e.l+=2,57005!=e.read_shift(2))throw new Error("Bad FileMoniker");if(0===e.read_shift(4))return r+n.replace(/\\/g,"/");var a=e.read_shift(4);if(3!=e.read_shift(2))throw new Error("Bad FileMoniker");return r+e.read_shift(a>>1,"utf16le").replace(qp,"")}(e);default:throw new Error("Unsupported Moniker "+r)}}function iy(e){var t=e.read_shift(4);return t>0?e.read_shift(t,"utf16le").replace(qp,""):""}function oy(e){return[e.read_shift(1),e.read_shift(1),e.read_shift(1),e.read_shift(1)]}function ly(e,t){var r=oy(e);return r[3]=0,r}function cy(e){return{r:e.read_shift(2),c:e.read_shift(2),ixfe:e.read_shift(2)}}function dy(e,t,r){var n=r.biff>8?4:2;return[e.read_shift(n),e.read_shift(n,"i"),e.read_shift(n,"i")]}function uy(e){return[e.read_shift(2),ub(e)]}function hy(e){var t=e.read_shift(2),r=e.read_shift(2);return{s:{c:e.read_shift(2),r:t},e:{c:e.read_shift(2),r:r}}}function fy(e){var t=e.read_shift(2),r=e.read_shift(2);return{s:{c:e.read_shift(1),r:t},e:{c:e.read_shift(1),r:r}}}var my=fy;function py(e){e.l+=4;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return e.l+=12,[r,t,n]}function gy(e){e.l+=2,e.l+=e.read_shift(2)}var xy={0:gy,4:gy,5:gy,6:gy,7:function(e){return e.l+=4,e.cf=e.read_shift(2),{}},8:gy,9:gy,10:gy,11:gy,12:gy,13:function(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t},14:gy,15:gy,16:gy,17:gy,18:gy,19:gy,20:gy,21:py};function vy(e,t){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=e.read_shift(2),(t-=2)>=2&&(r.dt=e.read_shift(2),e.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return e.read_shift(t),r}function by(e,t,r){var n=0;r&&2==r.biff||(n=e.read_shift(2));var a=e.read_shift(2);return r&&2==r.biff&&(n=1-(a>>15),a&=32767),[{Unsynced:1&n,DyZero:(2&n)>>1,ExAsc:(4&n)>>2,ExDsc:(8&n)>>3},a]}var yy=ay;function wy(e,t,r){var n=e.l+t,a=8!=r.biff&&r.biff?2:4,s=e.read_shift(a),i=e.read_shift(a),o=e.read_shift(2),l=e.read_shift(2);return e.l=n,{s:{r:s,c:o},e:{r:i,c:l}}}function _y(e,t,r){var n=cy(e);2!=r.biff&&9!=t||++e.l;var a=function(e){var t=e.read_shift(1);return 1===e.read_shift(1)?t:1===t}(e);return n.val=a,n.t=!0===a||!1===a?"b":"e",n}var ky=function(e,t,r){return 0===t?"":ay(e,0,r)};function Ny(e,t,r){var n,a=e.read_shift(2),s={fBuiltIn:1&a,fWantAdvise:a>>>1&1,fWantPict:a>>>2&1,fOle:a>>>3&1,fOleLink:a>>>4&1,cf:a>>>5&1023,fIcon:a>>>15&1};return 14849===r.sbcch&&(n=function(e,t,r){e.l+=4,t-=4;var n=e.l+t,a=ey(e,0,r),s=e.read_shift(2);if(s!==(n-=e.l))throw new Error("Malformed AddinUdf: padding = "+n+" != "+s);return e.l+=s,a}(e,t-2,r)),s.body=n||e.read_shift(t-2),"string"==typeof n&&(s.Name=n),s}var jy=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function Sy(e,t,r){var n=e.l+t,a=e.read_shift(2),s=e.read_shift(1),i=e.read_shift(1),o=e.read_shift(r&&2==r.biff?1:2),l=0;(!r||r.biff>=5)&&(5!=r.biff&&(e.l+=2),l=e.read_shift(2),5==r.biff&&(e.l+=2),e.l+=4);var c=ry(e,i,r);32&a&&(c=jy[c.charCodeAt(0)]);var d=n-e.l;r&&2==r.biff&&--d;var u=n!=e.l&&0!==o&&d>0?function(e,t,r,n){var a,s=e.l+t,i=m_(e,n,r);s!==e.l&&(a=f_(e,s-e.l,i,r));return[i,a]}(e,d,r,o):[];return{chKey:s,Name:c,itab:l,rgce:u}}function Ty(e,t,r){if(r.biff<8)return function(e,t,r){3==e[e.l+1]&&e[e.l]++;var n=ey(e,0,r);return 3==n.charCodeAt(0)?n.slice(1):n}(e,0,r);for(var n=[],a=e.l+t,s=e.read_shift(r.biff>8?4:2);0!==s--;)n.push(dy(e,r.biff,r));if(e.l!=a)throw new Error("Bad ExternSheet: "+e.l+" != "+a);return n}function Ey(e,t,r){var n=my(e);switch(r.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[n,y_(e,t,r)]}var Cy={8:function(e,t){var r=e.l+t;e.l+=10;var n=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var a=e.read_shift(1);return e.l+=a,e.l=r,{fmt:n}}};function Ay(e,t,r){if(!r.cellStyles)return Rv(e,t);var n=r&&r.biff>=12?4:2,a=e.read_shift(n),s=e.read_shift(n),i=e.read_shift(n),o=e.read_shift(n),l=e.read_shift(2);2==n&&(e.l+=2);var c={s:a,e:s,w:i,ixfe:o,flags:l};return(r.biff>=5||!r.biff)&&(c.level=l>>8&7),c}var Oy=cy,Iy=Qb,Ry=ny;var Py=[2,3,48,49,131,139,140,245],Dy=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=Wg({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(t,r){var n=r||{};n.dateNF||(n.dateNF="yyyymmdd");var a=eb(function(t,r){var n=[],a=$p(1);switch(r.type){case"base64":a=Vp(Fp(t));break;case"binary":a=Vp(t);break;case"buffer":case"array":a=t}Iv(a,0);var s=a.read_shift(1),i=!!(136&s),o=!1,l=!1;switch(s){case 2:case 3:case 131:case 139:case 245:break;case 48:case 49:o=!0,i=!0;break;case 140:l=!0;break;default:throw new Error("DBF Unsupported Version: "+s.toString(16))}var c=0,d=521;2==s&&(c=a.read_shift(2)),a.l+=3,2!=s&&(c=a.read_shift(4)),c>1048576&&(c=1e6),2!=s&&(d=a.read_shift(2));var u=a.read_shift(2),h=r.codepage||1252;2!=s&&(a.l+=16,a.read_shift(1),0!==a[a.l]&&(h=e[a[a.l]]),a.l+=1,a.l+=2),l&&(a.l+=36);for(var f=[],m={},p=Math.min(a.length,2==s?521:d-10-(o?264:0)),g=l?32:11;a.l<p&&13!=a[a.l];)switch((m={}).name=Ip.utils.decode(h,a.slice(a.l,a.l+g)).replace(/[\u0000\r\n].*$/g,""),a.l+=g,m.type=String.fromCharCode(a.read_shift(1)),2==s||l||(m.offset=a.read_shift(4)),m.len=a.read_shift(1),2==s&&(m.offset=a.read_shift(2)),m.dec=a.read_shift(1),m.name.length&&f.push(m),2!=s&&(a.l+=l?13:14),m.type){case"B":o&&8==m.len||!r.WTF||console.log("Skipping "+m.name+":"+m.type);break;case"G":case"P":r.WTF&&console.log("Skipping "+m.name+":"+m.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+m.type)}if(13!==a[a.l]&&(a.l=d-1),13!==a.read_shift(1))throw new Error("DBF Terminator not found "+a.l+" "+a[a.l]);a.l=d;var x=0,v=0;for(n[0]=[],v=0;v!=f.length;++v)n[0][v]=f[v].name;for(;c-- >0;)if(42!==a[a.l])for(++a.l,n[++x]=[],v=0,v=0;v!=f.length;++v){var b=a.slice(a.l,a.l+f[v].len);a.l+=f[v].len,Iv(b,0);var y=Ip.utils.decode(h,b);switch(f[v].type){case"C":y.trim().length&&(n[x][v]=y.replace(/\s+$/,""));break;case"D":8===y.length?n[x][v]=new Date(+y.slice(0,4),+y.slice(4,6)-1,+y.slice(6,8)):n[x][v]=y;break;case"F":n[x][v]=parseFloat(y.trim());break;case"+":case"I":n[x][v]=l?2147483648^b.read_shift(-4,"i"):b.read_shift(4,"i");break;case"L":switch(y.trim().toUpperCase()){case"Y":case"T":n[x][v]=!0;break;case"N":case"F":n[x][v]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+y+"|")}break;case"M":if(!i)throw new Error("DBF Unexpected MEMO for type "+s.toString(16));n[x][v]="##MEMO##"+(l?parseInt(y.trim(),10):b.read_shift(4));break;case"N":(y=y.replace(/\u0000/g,"").trim())&&"."!=y&&(n[x][v]=+y||0);break;case"@":n[x][v]=new Date(b.read_shift(-8,"f")-621356832e5);break;case"T":n[x][v]=new Date(864e5*(b.read_shift(4)-2440588)+b.read_shift(4));break;case"Y":n[x][v]=b.read_shift(4,"i")/1e4+b.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":n[x][v]=-b.read_shift(-8,"f");break;case"B":if(o&&8==f[v].len){n[x][v]=b.read_shift(8,"f");break}case"G":case"P":b.l+=f[v].len;break;case"0":if("_NullFlags"===f[v].name)break;default:throw new Error("DBF Unsupported data type "+f[v].type)}}else a.l+=u;if(2!=s&&a.l<a.length&&26!=a[a.l++])throw new Error("DBF EOF Marker missing "+(a.l-1)+" of "+a.length+" "+a[a.l-1].toString(16));return r&&r.sheetRows&&(n=n.slice(0,r.sheetRows)),r.DBF=f,n}(t,n),n);return a["!cols"]=n.DBF.map(function(e){return{wch:e.len,DBF:e}}),delete n.DBF,a}var n={B:8,C:250,L:1,D:8,"?":0,"":0};return{to_workbook:function(e,t){try{return Zv(r(e,t),t)}catch(n){if(t&&t.WTF)throw n}return{SheetNames:[],Sheets:{}}},to_sheet:r,from_sheet:function(e,r){var a=r||{};if(+a.codepage>=0&&Ep(+a.codepage),"string"==a.type)throw new Error("Cannot write DBF to JS string");var s=Lv(),i=EN(e,{header:1,raw:!0,cellDates:!0}),o=i[0],l=i.slice(1),c=e["!cols"]||[],d=0,u=0,h=0,f=1;for(d=0;d<o.length;++d)if(((c[d]||{}).DBF||{}).name)o[d]=c[d].DBF.name,++h;else if(null!=o[d]){if(++h,"number"==typeof o[d]&&(o[d]=o[d].toString(10)),"string"!=typeof o[d])throw new Error("DBF Invalid column name "+o[d]+" |"+typeof o[d]+"|");if(o.indexOf(o[d])!==d)for(u=0;u<1024;++u)if(-1==o.indexOf(o[d]+"_"+u)){o[d]+="_"+u;break}}var m=Xv(e["!ref"]),p=[],g=[],x=[];for(d=0;d<=m.e.c-m.s.c;++d){var v="",b="",y=0,w=[];for(u=0;u<l.length;++u)null!=l[u][d]&&w.push(l[u][d]);if(0!=w.length&&null!=o[d]){for(u=0;u<w.length;++u){switch(typeof w[u]){case"number":b="B";break;case"string":default:b="C";break;case"boolean":b="L";break;case"object":b=w[u]instanceof Date?"D":"C"}y=Math.max(y,String(w[u]).length),v=v&&v!=b?"C":b}y>250&&(y=250),"C"==(b=((c[d]||{}).DBF||{}).type)&&c[d].DBF.len>y&&(y=c[d].DBF.len),"B"==v&&"N"==b&&(v="N",x[d]=c[d].DBF.dec,y=c[d].DBF.len),g[d]="C"==v||"N"==b?y:n[v]||0,f+=g[d],p[d]=v}else p[d]="?"}var _=s.next(32);for(_.write_shift(4,318902576),_.write_shift(4,l.length),_.write_shift(2,296+32*h),_.write_shift(2,f),d=0;d<4;++d)_.write_shift(4,0);for(_.write_shift(4,(+t[Np]||3)<<8),d=0,u=0;d<o.length;++d)if(null!=o[d]){var k=s.next(32),N=(o[d].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);k.write_shift(1,N,"sbcs"),k.write_shift(1,"?"==p[d]?"C":p[d],"sbcs"),k.write_shift(4,u),k.write_shift(1,g[d]||n[p[d]]||0),k.write_shift(1,x[d]||0),k.write_shift(1,2),k.write_shift(4,0),k.write_shift(1,0),k.write_shift(4,0),k.write_shift(4,0),u+=g[d]||n[p[d]]||0}var j=s.next(264);for(j.write_shift(4,13),d=0;d<65;++d)j.write_shift(4,0);for(d=0;d<l.length;++d){var S=s.next(f);for(S.write_shift(1,0),u=0;u<o.length;++u)if(null!=o[u])switch(p[u]){case"L":S.write_shift(1,null==l[d][u]?63:l[d][u]?84:70);break;case"B":S.write_shift(8,l[d][u]||0,"f");break;case"N":var T="0";for("number"==typeof l[d][u]&&(T=l[d][u].toFixed(x[u]||0)),h=0;h<g[u]-T.length;++h)S.write_shift(1,32);S.write_shift(1,T,"sbcs");break;case"D":l[d][u]?(S.write_shift(4,("0000"+l[d][u].getFullYear()).slice(-4),"sbcs"),S.write_shift(2,("00"+(l[d][u].getMonth()+1)).slice(-2),"sbcs"),S.write_shift(2,("00"+l[d][u].getDate()).slice(-2),"sbcs")):S.write_shift(8,"00000000","sbcs");break;case"C":var E=String(null!=l[d][u]?l[d][u]:"").slice(0,g[u]);for(S.write_shift(1,E,"sbcs"),h=0;h<g[u]-E.length;++h)S.write_shift(1,32)}}return s.next(1).write_shift(1,26),s.end()}}}(),Ly=function(){var e={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("N("+Vg(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(t,r){var n=e[r];return"number"==typeof n?Dp(n):n},n=function(e,t,r){var n=t.charCodeAt(0)-32<<4|r.charCodeAt(0)-48;return 59==n?e:Dp(n)};function a(e,a){var s,i=e.split(/[\n\r]+/),o=-1,l=-1,c=0,d=0,u=[],h=[],f=null,m={},p=[],g=[],x=[],v=0;for(+a.codepage>=0&&Ep(+a.codepage);c!==i.length;++c){v=0;var b,y=i[c].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(t,r),w=y.replace(/;;/g,"\0").split(";").map(function(e){return e.replace(/\u0000/g,";")}),_=w[0];if(y.length>0)switch(_){case"ID":case"E":case"B":case"O":case"W":break;case"P":"P"==w[1].charAt(0)&&h.push(y.slice(3).replace(/;;/g,";"));break;case"C":var k=!1,N=!1,j=!1,S=!1,T=-1,E=-1;for(d=1;d<w.length;++d)switch(w[d].charAt(0)){case"A":case"G":break;case"X":l=parseInt(w[d].slice(1))-1,N=!0;break;case"Y":for(o=parseInt(w[d].slice(1))-1,N||(l=0),s=u.length;s<=o;++s)u[s]=[];break;case"K":'"'===(b=w[d].slice(1)).charAt(0)?b=b.slice(1,b.length-1):"TRUE"===b?b=!0:"FALSE"===b?b=!1:isNaN(sx(b))?isNaN(ox(b).getDate())||(b=tx(b)):(b=sx(b),null!==f&&Ig(f)&&(b=Yg(b))),k=!0;break;case"E":S=!0;var C=zw(w[d].slice(1),{r:o,c:l});u[o][l]=[u[o][l],C];break;case"S":j=!0,u[o][l]=[u[o][l],"S5S"];break;case"R":T=parseInt(w[d].slice(1))-1;break;case"C":E=parseInt(w[d].slice(1))-1;break;default:if(a&&a.WTF)throw new Error("SYLK bad record "+y)}if(k&&(u[o][l]&&2==u[o][l].length?u[o][l][0]=b:u[o][l]=b,f=null),j){if(S)throw new Error("SYLK shared formula cannot have own formula");var A=T>-1&&u[T][E];if(!A||!A[1])throw new Error("SYLK shared formula cannot find base");u[o][l][1]=Hw(A[1],{r:o-T,c:l-E})}break;case"F":var O=0;for(d=1;d<w.length;++d)switch(w[d].charAt(0)){case"X":l=parseInt(w[d].slice(1))-1,++O;break;case"Y":for(o=parseInt(w[d].slice(1))-1,s=u.length;s<=o;++s)u[s]=[];break;case"M":v=parseInt(w[d].slice(1))/20;break;case"F":case"G":case"S":case"D":case"N":break;case"P":f=h[parseInt(w[d].slice(1))];break;case"W":for(x=w[d].slice(1).split(" "),s=parseInt(x[0],10);s<=parseInt(x[1],10);++s)v=parseInt(x[2],10),g[s-1]=0===v?{hidden:!0}:{wch:v},vw(g[s-1]);break;case"C":g[l=parseInt(w[d].slice(1))-1]||(g[l]={});break;case"R":p[o=parseInt(w[d].slice(1))-1]||(p[o]={}),v>0?(p[o].hpt=v,p[o].hpx=ww(v)):0===v&&(p[o].hidden=!0);break;default:if(a&&a.WTF)throw new Error("SYLK bad record "+y)}O<1&&(f=null);break;default:if(a&&a.WTF)throw new Error("SYLK bad record "+y)}}return p.length>0&&(m["!rows"]=p),g.length>0&&(m["!cols"]=g),a&&a.sheetRows&&(u=u.slice(0,a.sheetRows)),[u,m]}function s(e,t){var r=function(e,t){switch(t.type){case"base64":return a(Fp(e),t);case"binary":return a(e,t);case"buffer":return a(Up&&Buffer.isBuffer(e)?e.toString("binary"):Wp(e),t);case"array":return a(rx(e),t)}throw new Error("Unrecognized type "+t.type)}(e,t),n=r[0],s=r[1],i=eb(n,t);return Vg(s).forEach(function(e){i[e]=s[e]}),i}function i(e,t,r,n){var a="C;Y"+(r+1)+";X"+(n+1)+";K";switch(e.t){case"n":a+=e.v||0,e.f&&!e.F&&(a+=";E"+Ww(e.f,{r:r,c:n}));break;case"b":a+=e.v?"TRUE":"FALSE";break;case"e":a+=e.w||e.v;break;case"d":a+='"'+(e.w||e.v)+'"';break;case"s":a+='"'+e.v.replace(/"/g,"").replace(/;/g,";;")+'"'}return a}return e["|"]=254,{to_workbook:function(e,t){return Zv(s(e,t),t)},to_sheet:s,from_sheet:function(e,t){var r,n,a=["ID;PWXL;N;E"],s=[],o=Xv(e["!ref"]),l=Array.isArray(e),c="\r\n";a.push("P;PGeneral"),a.push("F;P0;DG0G8;M255"),e["!cols"]&&(n=a,e["!cols"].forEach(function(e,t){var r="F;W"+(t+1)+" "+(t+1)+" ";e.hidden?r+="0":("number"!=typeof e.width||e.wpx||(e.wpx=fw(e.width)),"number"!=typeof e.wpx||e.wch||(e.wch=mw(e.wpx)),"number"==typeof e.wch&&(r+=Math.round(e.wch)))," "!=r.charAt(r.length-1)&&n.push(r)})),e["!rows"]&&function(e,t){t.forEach(function(t,r){var n="F;";t.hidden?n+="M0;":t.hpt?n+="M"+20*t.hpt+";":t.hpx&&(n+="M"+20*yw(t.hpx)+";"),n.length>2&&e.push(n+"R"+(r+1))})}(a,e["!rows"]),a.push("B;Y"+(o.e.r-o.s.r+1)+";X"+(o.e.c-o.s.c+1)+";D"+[o.s.c,o.s.r,o.e.c,o.e.r].join(" "));for(var d=o.s.r;d<=o.e.r;++d)for(var u=o.s.c;u<=o.e.c;++u){var h=Gv({r:d,c:u});(r=l?(e[d]||[])[u]:e[h])&&(null!=r.v||r.f&&!r.F)&&s.push(i(r,0,d,u))}return a.join(c)+c+s.join(c)+c+"E"+c}}}(),My=function(){function e(e,t){for(var r=e.split("\n"),n=-1,a=-1,s=0,i=[];s!==r.length;++s)if("BOT"!==r[s].trim()){if(!(n<0)){for(var o=r[s].trim().split(","),l=o[0],c=o[1],d=r[++s]||"";1&(d.match(/["]/g)||[]).length&&s<r.length-1;)d+="\n"+r[++s];switch(d=d.trim(),+l){case-1:if("BOT"===d){i[++n]=[],a=0;continue}if("EOD"!==d)throw new Error("Unrecognized DIF special command "+d);break;case 0:"TRUE"===d?i[n][a]=!0:"FALSE"===d?i[n][a]=!1:isNaN(sx(c))?isNaN(ox(c).getDate())?i[n][a]=c:i[n][a]=tx(c):i[n][a]=sx(c),++a;break;case 1:(d=(d=d.slice(1,d.length-1)).replace(/""/g,'"'))&&d.match(/^=".*"$/)&&(d=d.slice(2,-1)),i[n][a++]=""!==d?d:null}if("EOD"===d)break}}else i[++n]=[],a=0;return t&&t.sheetRows&&(i=i.slice(0,t.sheetRows)),i}function t(t,r){return eb(function(t,r){switch(r.type){case"base64":return e(Fp(t),r);case"binary":return e(t,r);case"buffer":return e(Up&&Buffer.isBuffer(t)?t.toString("binary"):Wp(t),r);case"array":return e(rx(t),r)}throw new Error("Unrecognized type "+r.type)}(t,r),r)}return{to_workbook:function(e,r){return Zv(t(e,r),r)},to_sheet:t,from_sheet:function(){var e=function(e,t,r,n,a){e.push(t),e.push(r+","+n),e.push('"'+a.replace(/"/g,'""')+'"')},t=function(e,t,r,n){e.push(t+","+r),e.push(1==t?'"'+n.replace(/"/g,'""')+'"':n)};return function(r){var n,a=[],s=Xv(r["!ref"]),i=Array.isArray(r);e(a,"TABLE",0,1,"sheetjs"),e(a,"VECTORS",0,s.e.r-s.s.r+1,""),e(a,"TUPLES",0,s.e.c-s.s.c+1,""),e(a,"DATA",0,0,"");for(var o=s.s.r;o<=s.e.r;++o){t(a,-1,0,"BOT");for(var l=s.s.c;l<=s.e.c;++l){var c=Gv({r:o,c:l});if(n=i?(r[o]||[])[l]:r[c])switch(n.t){case"n":var d=n.w;d||null==n.v||(d=n.v),null==d?n.f&&!n.F?t(a,1,0,"="+n.f):t(a,1,0,""):t(a,0,d,"V");break;case"b":t(a,0,n.v?1:0,n.v?"TRUE":"FALSE");break;case"s":t(a,1,0,isNaN(n.v)?n.v:'="'+n.v+'"');break;case"d":n.w||(n.w=Lg(n.z||ag[14],Gg(tx(n.v)))),t(a,0,n.w,"V");break;default:t(a,1,0,"")}else t(a,1,0,"")}}t(a,-1,0,"EOD");return a.join("\r\n")}}()}}(),Fy=function(){function e(e){return e.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,"\n")}function t(e){return e.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(t,r){return eb(function(t,r){for(var n=t.split("\n"),a=-1,s=-1,i=0,o=[];i!==n.length;++i){var l=n[i].trim().split(":");if("cell"===l[0]){var c=Hv(l[1]);if(o.length<=c.r)for(a=o.length;a<=c.r;++a)o[a]||(o[a]=[]);switch(a=c.r,s=c.c,l[2]){case"t":o[a][s]=e(l[3]);break;case"v":o[a][s]=+l[3];break;case"vtf":var d=l[l.length-1];case"vtc":"nl"===l[3]?o[a][s]=!!+l[4]:o[a][s]=+l[4],"vtf"==l[2]&&(o[a][s]=[o[a][s],d])}}}return r&&r.sheetRows&&(o=o.slice(0,r.sheetRows)),o}(t,r),r)}var n=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join("\n"),a=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join("\n")+"\n",s=["# SocialCalc Spreadsheet Control Save","part:sheet"].join("\n"),i="--SocialCalcSpreadsheetControlSave--";function o(e){if(!e||!e["!ref"])return"";for(var r,n=[],a=[],s="",i=qv(e["!ref"]),o=Array.isArray(e),l=i.s.r;l<=i.e.r;++l)for(var c=i.s.c;c<=i.e.c;++c)if(s=Gv({r:l,c:c}),(r=o?(e[l]||[])[c]:e[s])&&null!=r.v&&"z"!==r.t){switch(a=["cell",s,"t"],r.t){case"s":case"str":a.push(t(r.v));break;case"n":r.f?(a[2]="vtf",a[3]="n",a[4]=r.v,a[5]=t(r.f)):(a[2]="v",a[3]=r.v);break;case"b":a[2]="vt"+(r.f?"f":"c"),a[3]="nl",a[4]=r.v?"1":"0",a[5]=t(r.f||(r.v?"TRUE":"FALSE"));break;case"d":var d=Gg(tx(r.v));a[2]="vtc",a[3]="nd",a[4]=""+d,a[5]=r.w||Lg(r.z||ag[14],d);break;case"e":continue}n.push(a.join(":"))}return n.push("sheet:c:"+(i.e.c-i.s.c+1)+":r:"+(i.e.r-i.s.r+1)+":tvf:1"),n.push("valueformat:1:text-wiki"),n.join("\n")}return{to_workbook:function(e,t){return Zv(r(e,t),t)},to_sheet:r,from_sheet:function(e){return[n,a,s,a,o(e),i].join("\n")}}}(),Uy=function(){function e(e,t,r,n,a){a.raw?t[r][n]=e:""===e||("TRUE"===e?t[r][n]=!0:"FALSE"===e?t[r][n]=!1:isNaN(sx(e))?isNaN(ox(e).getDate())?t[r][n]=e:t[r][n]=tx(e):t[r][n]=sx(e))}var t={44:",",9:"\t",59:";",124:"|"},r={44:3,9:2,59:1,124:0};function n(e){for(var n={},a=!1,s=0,i=0;s<e.length;++s)34==(i=e.charCodeAt(s))?a=!a:!a&&i in t&&(n[i]=(n[i]||0)+1);for(s in i=[],n)Object.prototype.hasOwnProperty.call(n,s)&&i.push([n[s],s]);if(!i.length)for(s in n=r)Object.prototype.hasOwnProperty.call(n,s)&&i.push([n[s],s]);return i.sort(function(e,t){return e[0]-t[0]||r[e[1]]-r[t[1]]}),t[i.pop()[1]]||44}function a(e,t){var r=t||{},a="",s=r.dense?[]:{},i={s:{c:0,r:0},e:{c:0,r:0}};"sep="==e.slice(0,4)?13==e.charCodeAt(5)&&10==e.charCodeAt(6)?(a=e.charAt(4),e=e.slice(7)):13==e.charCodeAt(5)||10==e.charCodeAt(5)?(a=e.charAt(4),e=e.slice(6)):a=n(e.slice(0,1024)):a=r&&r.FS?r.FS:n(e.slice(0,1024));var o=0,l=0,c=0,d=0,u=0,h=a.charCodeAt(0),f=!1,m=0,p=e.charCodeAt(0);e=e.replace(/\r\n/gm,"\n");var g,x,v=null!=r.dateNF?(g=r.dateNF,x=(x="number"==typeof g?ag[g]:g).replace(Bg,"(\\d+)"),new RegExp("^"+x+"$")):null;function b(){var t=e.slice(d,u),n={};if('"'==t.charAt(0)&&'"'==t.charAt(t.length-1)&&(t=t.slice(1,-1).replace(/""/g,'"')),0===t.length)n.t="z";else if(r.raw)n.t="s",n.v=t;else if(0===t.trim().length)n.t="s",n.v=t;else if(61==t.charCodeAt(0))34==t.charCodeAt(1)&&34==t.charCodeAt(t.length-1)?(n.t="s",n.v=t.slice(2,-1).replace(/""/g,'"')):1!=t.length?(n.t="n",n.f=t.slice(1)):(n.t="s",n.v=t);else if("TRUE"==t)n.t="b",n.v=!0;else if("FALSE"==t)n.t="b",n.v=!1;else if(isNaN(c=sx(t)))if(!isNaN(ox(t).getDate())||v&&t.match(v)){n.z=r.dateNF||ag[14];var a=0;v&&t.match(v)&&(t=function(e,t,r){var n=-1,a=-1,s=-1,i=-1,o=-1,l=-1;(t.match(Bg)||[]).forEach(function(e,t){var c=parseInt(r[t+1],10);switch(e.toLowerCase().charAt(0)){case"y":n=c;break;case"d":s=c;break;case"h":i=c;break;case"s":l=c;break;case"m":i>=0?o=c:a=c}}),l>=0&&-1==o&&a>=0&&(o=a,a=-1);var c=(""+(n>=0?n:(new Date).getFullYear())).slice(-4)+"-"+("00"+(a>=1?a:1)).slice(-2)+"-"+("00"+(s>=1?s:1)).slice(-2);7==c.length&&(c="0"+c),8==c.length&&(c="20"+c);var d=("00"+(i>=0?i:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2);return-1==i&&-1==o&&-1==l?c:-1==n&&-1==a&&-1==s?d:c+"T"+d}(0,r.dateNF,t.match(v)||[]),a=1),r.cellDates?(n.t="d",n.v=tx(t,a)):(n.t="n",n.v=Gg(tx(t,a))),!1!==r.cellText&&(n.w=Lg(n.z,n.v instanceof Date?Gg(n.v):n.v)),r.cellNF||delete n.z}else n.t="s",n.v=t;else n.t="n",!1!==r.cellText&&(n.w=t),n.v=c;if("z"==n.t||(r.dense?(s[o]||(s[o]=[]),s[o][l]=n):s[Gv({c:l,r:o})]=n),d=u+1,p=e.charCodeAt(d),i.e.c<l&&(i.e.c=l),i.e.r<o&&(i.e.r=o),m==h)++l;else if(l=0,++o,r.sheetRows&&r.sheetRows<=o)return!0}e:for(;u<e.length;++u)switch(m=e.charCodeAt(u)){case 34:34===p&&(f=!f);break;case h:case 10:case 13:if(!f&&b())break e}return u-d>0&&b(),s["!ref"]=Kv(i),s}function s(t,r){return r&&r.PRN?r.FS||"sep="==t.slice(0,4)||t.indexOf("\t")>=0||t.indexOf(",")>=0||t.indexOf(";")>=0?a(t,r):eb(function(t,r){var n=r||{},a=[];if(!t||0===t.length)return a;for(var s=t.split(/[\r\n]/),i=s.length-1;i>=0&&0===s[i].length;)--i;for(var o=10,l=0,c=0;c<=i;++c)-1==(l=s[c].indexOf(" "))?l=s[c].length:l++,o=Math.max(o,l);for(c=0;c<=i;++c){a[c]=[];var d=0;for(e(s[c].slice(0,o).trim(),a,c,d,n),d=1;d<=(s[c].length-o)/10+1;++d)e(s[c].slice(o+10*(d-1),o+10*d).trim(),a,c,d,n)}return n.sheetRows&&(a=a.slice(0,n.sheetRows)),a}(t,r),r):a(t,r)}function i(e,t){var r="",n="string"==t.type?[0,0,0,0]:kN(e,t);switch(t.type){case"base64":r=Fp(e);break;case"binary":case"string":r=e;break;case"buffer":65001==t.codepage?r=e.toString("utf8"):(t.codepage,r=Up&&Buffer.isBuffer(e)?e.toString("binary"):Wp(e));break;case"array":r=rx(e);break;default:throw new Error("Unrecognized type "+t.type)}return 239==n[0]&&187==n[1]&&191==n[2]?r=Ux(r.slice(3)):"string"!=t.type&&"buffer"!=t.type&&65001==t.codepage?r=Ux(r):t.type,"socialcalc:version:"==r.slice(0,19)?Fy.to_sheet("string"==t.type?r:Ux(r),t):s(r,t)}return{to_workbook:function(e,t){return Zv(i(e,t),t)},to_sheet:i,from_sheet:function(e){for(var t,r=[],n=Xv(e["!ref"]),a=Array.isArray(e),s=n.s.r;s<=n.e.r;++s){for(var i=[],o=n.s.c;o<=n.e.c;++o){var l=Gv({r:s,c:o});if((t=a?(e[s]||[])[o]:e[l])&&null!=t.v){for(var c=(t.w||(Jv(t),t.w)||"").slice(0,10);c.length<10;)c+=" ";i.push(c+(0===o?" ":""))}else i.push("          ")}r.push(i.join(""))}return r.join("\n")}}}();var By=function(){function e(e,t,r){if(e){Iv(e,e.l||0);for(var n=r.Enum||x;e.l<e.length;){var a=e.read_shift(2),s=n[a]||n[65535],i=e.read_shift(2),o=e.l+i,l=s.f&&s.f(e,i,r);if(e.l=o,t(l,s,a))return}}}function t(t,r){if(!t)return t;var n=r||{},a=n.dense?[]:{},s="Sheet1",i="",o=0,l={},c=[],d=[],u={s:{r:0,c:0},e:{r:0,c:0}},h=n.sheetRows||0;if(0==t[2]&&(8==t[3]||9==t[3])&&t.length>=16&&5==t[14]&&108===t[15])throw new Error("Unsupported Works 3 for Mac file");if(2==t[2])n.Enum=x,e(t,function(e,t,r){switch(r){case 0:n.vers=e,e>=4096&&(n.qpro=!0);break;case 6:u=e;break;case 204:e&&(i=e);break;case 222:i=e;break;case 15:case 51:n.qpro||(e[1].v=e[1].v.slice(1));case 13:case 14:case 16:14==r&&!(112&~e[2])&&(15&e[2])>1&&(15&e[2])<15&&(e[1].z=n.dateNF||ag[14],n.cellDates&&(e[1].t="d",e[1].v=Yg(e[1].v))),n.qpro&&e[3]>o&&(a["!ref"]=Kv(u),l[s]=a,c.push(s),a=n.dense?[]:{},u={s:{r:0,c:0},e:{r:0,c:0}},o=e[3],s=i||"Sheet"+(o+1),i="");var d=n.dense?(a[e[0].r]||[])[e[0].c]:a[Gv(e[0])];if(d){d.t=e[1].t,d.v=e[1].v,null!=e[1].z&&(d.z=e[1].z),null!=e[1].f&&(d.f=e[1].f);break}n.dense?(a[e[0].r]||(a[e[0].r]=[]),a[e[0].r][e[0].c]=e[1]):a[Gv(e[0])]=e[1]}},n);else{if(26!=t[2]&&14!=t[2])throw new Error("Unrecognized LOTUS BOF "+t[2]);n.Enum=v,14==t[2]&&(n.qpro=!0,t.l=0),e(t,function(e,t,r){switch(r){case 204:s=e;break;case 22:e[1].v=e[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(e[3]>o&&(a["!ref"]=Kv(u),l[s]=a,c.push(s),a=n.dense?[]:{},u={s:{r:0,c:0},e:{r:0,c:0}},o=e[3],s="Sheet"+(o+1)),h>0&&e[0].r>=h)break;n.dense?(a[e[0].r]||(a[e[0].r]=[]),a[e[0].r][e[0].c]=e[1]):a[Gv(e[0])]=e[1],u.e.c<e[0].c&&(u.e.c=e[0].c),u.e.r<e[0].r&&(u.e.r=e[0].r);break;case 27:e[14e3]&&(d[e[14e3][0]]=e[14e3][1]);break;case 1537:d[e[0]]=e[1],e[0]==o&&(s=e[1])}},n)}if(a["!ref"]=Kv(u),l[i||s]=a,c.push(i||s),!d.length)return{SheetNames:c,Sheets:l};for(var f={},m=[],p=0;p<d.length;++p)l[c[p]]?(m.push(d[p]||c[p]),f[d[p]]=l[d[p]]||l[c[p]]):(m.push(d[p]),f[d[p]]={"!ref":"A1"});return{SheetNames:m,Sheets:f}}function r(e,t,r){var n=[{c:0,r:0},{t:"n",v:0},0,0];return r.qpro&&20768!=r.vers?(n[0].c=e.read_shift(1),n[3]=e.read_shift(1),n[0].r=e.read_shift(2),e.l+=2):(n[2]=e.read_shift(1),n[0].c=e.read_shift(2),n[0].r=e.read_shift(2)),n}function n(e,t,n){var a=e.l+t,s=r(e,0,n);if(s[1].t="s",20768==n.vers){e.l++;var i=e.read_shift(1);return s[1].v=e.read_shift(i,"utf8"),s}return n.qpro&&e.l++,s[1].v=e.read_shift(a-e.l,"cstr"),s}function a(e,t,r){var n=Pv(7+r.length);n.write_shift(1,255),n.write_shift(2,t),n.write_shift(2,e),n.write_shift(1,39);for(var a=0;a<n.length;++a){var s=r.charCodeAt(a);n.write_shift(1,s>=128?95:s)}return n.write_shift(1,0),n}function s(e,t,r){var n=Pv(7);return n.write_shift(1,255),n.write_shift(2,t),n.write_shift(2,e),n.write_shift(2,r,"i"),n}function i(e,t,r){var n=Pv(13);return n.write_shift(1,255),n.write_shift(2,t),n.write_shift(2,e),n.write_shift(8,r,"f"),n}function o(e,t,r){var n=32768&t;return t=(n?e:0)+((t&=-32769)>=8192?t-16384:t),(n?"":"$")+(r?Wv(t):zv(t))}var l={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},c=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function d(e){var t=[{c:0,r:0},{t:"n",v:0},0];return t[0].r=e.read_shift(2),t[3]=e[e.l++],t[0].c=e[e.l++],t}function u(e,t,r,n){var a=Pv(6+n.length);a.write_shift(2,e),a.write_shift(1,r),a.write_shift(1,t),a.write_shift(1,39);for(var s=0;s<n.length;++s){var i=n.charCodeAt(s);a.write_shift(1,i>=128?95:i)}return a.write_shift(1,0),a}function h(e,t){var r=d(e),n=e.read_shift(4),a=e.read_shift(4),s=e.read_shift(2);if(65535==s)return 0===n&&3221225472===a?(r[1].t="e",r[1].v=15):0===n&&3489660928===a?(r[1].t="e",r[1].v=42):r[1].v=0,r;var i=32768&s;return s=(32767&s)-16446,r[1].v=(1-2*i)*(a*Math.pow(2,s+32)+n*Math.pow(2,s)),r}function f(e,t,r,n){var a=Pv(14);if(a.write_shift(2,e),a.write_shift(1,r),a.write_shift(1,t),0==n)return a.write_shift(4,0),a.write_shift(4,0),a.write_shift(2,65535),a;var s,i=0,o=0,l=0;return n<0&&(i=1,n=-n),o=0|Math.log2(n),2147483648&(l=(n/=Math.pow(2,o-31))>>>0)||(++o,l=(n/=2)>>>0),n-=l,l|=2147483648,l>>>=0,s=(n*=Math.pow(2,32))>>>0,a.write_shift(4,s),a.write_shift(4,l),o+=16383+(i?32768:0),a.write_shift(2,o),a}function m(e,t){var r=d(e),n=e.read_shift(8,"f");return r[1].v=n,r}function p(e,t){return 0==e[e.l+t-1]?e.read_shift(t,"cstr"):""}function g(e,t){var r=Pv(5+e.length);r.write_shift(2,14e3),r.write_shift(2,t);for(var n=0;n<e.length;++n){var a=e.charCodeAt(n);r[r.l++]=a>127?95:a}return r[r.l++]=0,r}var x={0:{n:"BOF",f:Zb},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:function(e,t,r){var n={s:{c:0,r:0},e:{c:0,r:0}};return 8==t&&r.qpro?(n.s.c=e.read_shift(1),e.l++,n.s.r=e.read_shift(2),n.e.c=e.read_shift(1),e.l++,n.e.r=e.read_shift(2),n):(n.s.c=e.read_shift(2),n.s.r=e.read_shift(2),12==t&&r.qpro&&(e.l+=2),n.e.c=e.read_shift(2),n.e.r=e.read_shift(2),12==t&&r.qpro&&(e.l+=2),65535==n.s.c&&(n.s.c=n.e.c=n.s.r=n.e.r=0),n)}},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:function(e,t,n){var a=r(e,0,n);return a[1].v=e.read_shift(2,"i"),a}},14:{n:"NUMBER",f:function(e,t,n){var a=r(e,0,n);return a[1].v=e.read_shift(8,"f"),a}},15:{n:"LABEL",f:n},16:{n:"FORMULA",f:function(e,t,n){var a=e.l+t,s=r(e,0,n);if(s[1].v=e.read_shift(8,"f"),n.qpro)e.l=a;else{var i=e.read_shift(2);!function(e,t){Iv(e,0);var r=[],n=0,a="",s="",i="",d="";for(;e.l<e.length;){var u=e[e.l++];switch(u){case 0:r.push(e.read_shift(8,"f"));break;case 1:s=o(t[0].c,e.read_shift(2),!0),a=o(t[0].r,e.read_shift(2),!1),r.push(s+a);break;case 2:var h=o(t[0].c,e.read_shift(2),!0),f=o(t[0].r,e.read_shift(2),!1);s=o(t[0].c,e.read_shift(2),!0),a=o(t[0].r,e.read_shift(2),!1),r.push(h+f+":"+s+a);break;case 3:if(e.l<e.length)return void console.error("WK1 premature formula end");break;case 4:r.push("("+r.pop()+")");break;case 5:r.push(e.read_shift(2));break;case 6:for(var m="";u=e[e.l++];)m+=String.fromCharCode(u);r.push('"'+m.replace(/"/g,'""')+'"');break;case 8:r.push("-"+r.pop());break;case 23:r.push("+"+r.pop());break;case 22:r.push("NOT("+r.pop()+")");break;case 20:case 21:d=r.pop(),i=r.pop(),r.push(["AND","OR"][u-20]+"("+i+","+d+")");break;default:if(u<32&&c[u])d=r.pop(),i=r.pop(),r.push(i+c[u]+d);else{if(!l[u])return u<=7?console.error("WK1 invalid opcode "+u.toString(16)):u<=24?console.error("WK1 unsupported op "+u.toString(16)):u<=30?console.error("WK1 invalid opcode "+u.toString(16)):u<=115?console.error("WK1 unsupported function opcode "+u.toString(16)):console.error("WK1 unrecognized opcode "+u.toString(16));if(69==(n=l[u][1])&&(n=e[e.l++]),n>r.length)return void console.error("WK1 bad formula parse 0x"+u.toString(16)+":|"+r.join("|")+"|");var p=r.slice(-n);r.length-=n,r.push(l[u][0]+"("+p.join(",")+")")}}}1==r.length?t[1].f=""+r[0]:console.error("WK1 bad formula parse |"+r.join("|")+"|")}(e.slice(e.l,e.l+i),s),e.l+=i}return s}},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:n},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:p},222:{n:"SHEETNAMELP",f:function(e,t){var r=e[e.l++];r>t-1&&(r=t-1);for(var n="";n.length<r;)n+=String.fromCharCode(e[e.l++]);return n}},65535:{n:""}},v={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:function(e,t){var r=d(e);return r[1].t="s",r[1].v=e.read_shift(t-4,"cstr"),r}},23:{n:"NUMBER17",f:h},24:{n:"NUMBER18",f:function(e,t){var r=d(e);r[1].v=e.read_shift(2);var n=r[1].v>>1;if(1&r[1].v)switch(7&n){case 0:n=5e3*(n>>3);break;case 1:n=500*(n>>3);break;case 2:n=(n>>3)/20;break;case 3:n=(n>>3)/200;break;case 4:n=(n>>3)/2e3;break;case 5:n=(n>>3)/2e4;break;case 6:n=(n>>3)/16;break;case 7:n=(n>>3)/64}return r[1].v=n,r}},25:{n:"FORMULA19",f:function(e,t){var r=h(e);return e.l+=t-14,r}},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:function(e,t){for(var r={},n=e.l+t;e.l<n;){var a=e.read_shift(2);if(14e3==a){for(r[a]=[0,""],r[a][0]=e.read_shift(2);e[e.l];)r[a][1]+=String.fromCharCode(e[e.l]),e.l++;e.l++}}return r}},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:function(e,t){var r=d(e),n=e.read_shift(4);return r[1].v=n>>6,r}},38:{n:"??"},39:{n:"NUMBER27",f:m},40:{n:"FORMULA28",f:function(e,t){var r=m(e);return e.l+=t-10,r}},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:p},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:function(e,t,r){if(r.qpro&&!(t<21)){var n=e.read_shift(1);return e.l+=17,e.l+=1,e.l+=2,[n,e.read_shift(t-21,"cstr")]}}},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:function(e,t){var r=t||{};if(+r.codepage>=0&&Ep(+r.codepage),"string"==r.type)throw new Error("Cannot write WK1 to JS string");var n,o,l=Lv(),c=Xv(e["!ref"]),d=Array.isArray(e),u=[];Wk(l,0,(n=1030,(o=Pv(2)).write_shift(2,n),o)),Wk(l,6,function(e){var t=Pv(8);return t.write_shift(2,e.s.c),t.write_shift(2,e.s.r),t.write_shift(2,e.e.c),t.write_shift(2,e.e.r),t}(c));for(var h=Math.min(c.e.r,8191),f=c.s.r;f<=h;++f)for(var m=zv(f),p=c.s.c;p<=c.e.c;++p){f===c.s.r&&(u[p]=Wv(p));var g=u[p]+m,x=d?(e[f]||[])[p]:e[g];if(x&&"z"!=x.t)if("n"==x.t)(0|x.v)==x.v&&x.v>=-32768&&x.v<=32767?Wk(l,13,s(f,p,x.v)):Wk(l,14,i(f,p,x.v));else Wk(l,15,a(f,p,Jv(x).slice(0,239)))}return Wk(l,1),l.end()},book_to_wk3:function(e,t){var r=t||{};if(+r.codepage>=0&&Ep(+r.codepage),"string"==r.type)throw new Error("Cannot write WK3 to JS string");var n=Lv();Wk(n,0,function(e){var t=Pv(26);t.write_shift(2,4096),t.write_shift(2,4),t.write_shift(4,0);for(var r=0,n=0,a=0,s=0;s<e.SheetNames.length;++s){var i=e.SheetNames[s],o=e.Sheets[i];if(o&&o["!ref"]){++a;var l=qv(o["!ref"]);r<l.e.r&&(r=l.e.r),n<l.e.c&&(n=l.e.c)}}r>8191&&(r=8191);return t.write_shift(2,r),t.write_shift(1,a),t.write_shift(1,n),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(1,1),t.write_shift(1,2),t.write_shift(4,0),t.write_shift(4,0),t}(e));for(var a=0,s=0;a<e.SheetNames.length;++a)(e.Sheets[e.SheetNames[a]]||{})["!ref"]&&Wk(n,27,g(e.SheetNames[a],s++));var i=0;for(a=0;a<e.SheetNames.length;++a){var o=e.Sheets[e.SheetNames[a]];if(o&&o["!ref"]){for(var l=Xv(o["!ref"]),c=Array.isArray(o),d=[],h=Math.min(l.e.r,8191),m=l.s.r;m<=h;++m)for(var p=zv(m),x=l.s.c;x<=l.e.c;++x){m===l.s.r&&(d[x]=Wv(x));var v=d[x]+p,b=c?(o[m]||[])[x]:o[v];if(b&&"z"!=b.t)if("n"==b.t)Wk(n,23,f(m,x,i,b.v));else Wk(n,22,u(m,x,i,Jv(b).slice(0,239)))}++i}}return Wk(n,1),n.end()},to_workbook:function(e,r){switch(r.type){case"base64":return t(Vp(Fp(e)),r);case"binary":return t(Vp(e),r);case"buffer":case"array":return t(e,r)}throw"Unsupported type "+r.type}}}();var $y=function(){var e=$x("t"),t=$x("rPr");function r(r){var n=r.match(e);if(!n)return{t:"s",v:""};var a={t:"s",v:Cx(n[1])},s=r.match(t);return s&&(a.s=function(e){var t={},r=e.match(_x),n=0,a=!1;if(r)for(;n!=r.length;++n){var s=jx(r[n]);switch(s[0].replace(/\w*:/g,"")){case"<condense":case"<extend":break;case"<shadow":if(!s.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if("1"==s.val)break;t.cp=Sp[parseInt(s.val,10)];break;case"<outline":if(!s.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=s.val;break;case"<sz":t.sz=s.val;break;case"<strike":if(!s.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!s.val)break;switch(s.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting"}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if("0"==s.val)break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if("0"==s.val)break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":s.rgb&&(t.color=s.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=s.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=s.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":case"<scheme":case"<scheme>":case"<scheme/>":case"</scheme>":case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(47!==s[0].charCodeAt(1)&&!a)throw new Error("Unrecognized rich format "+s[0])}}return t}(s[1])),a}var n=/<(?:\w+:)?r>/g,a=/<\/(?:\w+:)?r>/;return function(e){return e.replace(n,"").split(a).map(r).filter(function(e){return e.v})}}(),zy=function(){var e=/(\r\n|\n)/g;function t(t){var r=[[],t.v,[]];return t.v?(t.s&&function(e,t,r){var n=[];e.u&&n.push("text-decoration: underline;"),e.uval&&n.push("text-underline-style:"+e.uval+";"),e.sz&&n.push("font-size:"+e.sz+"pt;"),e.outline&&n.push("text-effect: outline;"),e.shadow&&n.push("text-shadow: auto;"),t.push('<span style="'+n.join("")+'">'),e.b&&(t.push("<b>"),r.push("</b>")),e.i&&(t.push("<i>"),r.push("</i>")),e.strike&&(t.push("<s>"),r.push("</s>"));var a=e.valign||"";"superscript"==a||"super"==a?a="sup":"subscript"==a&&(a="sub"),""!=a&&(t.push("<"+a+">"),r.push("</"+a+">")),r.push("</span>")}(t.s,r[0],r[2]),r[0].join("")+r[1].replace(e,"<br/>")+r[2].join("")):""}return function(e){return e.map(t).join("")}}(),Vy=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,Wy=/<(?:\w+:)?r>/,Hy=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function Gy(e,t){var r=!t||t.cellHTML,n={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=Cx(Ux(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=Ux(e),r&&(n.h=Ix(n.t))):e.match(Wy)&&(n.r=Ux(e),n.t=Cx(Ux((e.replace(Hy,"").match(Vy)||[]).join("").replace(_x,""))),r&&(n.h=zy($y(n.r)))),n):{t:""}}var qy=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,Ky=/<(?:\w+:)?(?:si|sstItem)>/g,Xy=/<\/(?:\w+:)?(?:si|sstItem)>/;function Yy(e){for(var t=[],r=e.split(""),n=0;n<r.length;++n)t[n]=r[n].charCodeAt(0);return t}function Jy(e,t){var r={};return r.Major=e.read_shift(2),r.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),r}function Zy(e){for(var t=e.read_shift(4),r=e.l+t-4,n={},a=e.read_shift(4),s=[];a-- >0;)s.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(n.name=e.read_shift(0,"lpp4"),n.comps=s,e.l!=r)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+r);return n}function Qy(e){var t=function(e){var t={};return e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=Jy(e,4),t.U=Jy(e,4),t.W=Jy(e,4),t}(e);if(t.ename=e.read_shift(0,"8lpp4"),t.blksz=e.read_shift(4),t.cmode=e.read_shift(4),4!=e.read_shift(4))throw new Error("Bad !Primary record");return t}function ew(e,t){var r=e.l+t,n={};n.Flags=63&e.read_shift(4),e.l+=4,n.AlgID=e.read_shift(4);var a=!1;switch(n.AlgID){case 26126:case 26127:case 26128:a=36==n.Flags;break;case 26625:a=4==n.Flags;break;case 0:a=16==n.Flags||4==n.Flags||36==n.Flags;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!a)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=e.read_shift(4),n.KeySize=e.read_shift(4),n.ProviderType=e.read_shift(4),e.l+=8,n.CSPName=e.read_shift(r-e.l>>1,"utf16le"),e.l=r,n}function tw(e,t){var r={},n=e.l+t;return e.l+=4,r.Salt=e.slice(e.l,e.l+16),e.l+=16,r.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),r.VerifierHash=e.slice(e.l,n),e.l=n,r}function rw(e){if(36!=(63&e.read_shift(4)))throw new Error("EncryptionInfo mismatch");var t=e.read_shift(4);return{t:"Std",h:ew(e,t),v:tw(e,e.length-e.l)}}function nw(){throw new Error("File is password-protected: ECMA-376 Extensible")}function aw(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var r=e.read_shift(e.length-e.l,"utf8"),n={};return r.replace(_x,function(e){var r=jx(e);switch(Sx(r[0])){case"<?xml":case"<encryption":case"</encryption>":case"</keyEncryptors>":case"</keyEncryptor>":break;case"<keyData":t.forEach(function(e){n[e]=r[e]});break;case"<dataIntegrity":n.encryptedHmacKey=r.encryptedHmacKey,n.encryptedHmacValue=r.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"<keyEncryptor":n.uri=r.uri;break;case"<encryptedKey":n.encs.push(r);break;default:throw r[0]}}),n}var sw=function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(e,t){return 255&((r=e^t)/2|128*r);var r};return function(a){for(var s,i,o,l=Yy(a),c=function(e){for(var n=t[e.length-1],a=104,s=e.length-1;s>=0;--s)for(var i=e[s],o=0;7!=o;++o)64&i&&(n^=r[a]),i*=2,--a;return n}(l),d=l.length,u=$p(16),h=0;16!=h;++h)u[h]=0;for(1&~d||(s=c>>8,u[d]=n(e[0],s),--d,s=255&c,i=l[l.length-1],u[d]=n(i,s));d>0;)s=c>>8,u[--d]=n(l[d],s),s=255&c,u[--d]=n(l[d],s);for(d=15,o=15-l.length;o>0;)s=c>>8,u[d]=n(e[o],s),--o,s=255&c,u[--d]=n(l[d],s),--d,--o;return u}}(),iw=function(e){var t=0,r=sw(e);return function(e){var n=function(e,t,r,n,a){var s,i;for(a||(a=t),n||(n=sw(e)),s=0;s!=t.length;++s)i=t[s],i=255&((i^=n[r])>>5|i<<3),a[s]=i,++r;return[a,r,n]}("",e,t,r);return t=n[1],n[0]}};function ow(e,t,r,n){var a={key:Zb(e),verificationBytes:Zb(e)};return r.password&&(a.verifier=function(e){var t,r,n=0,a=Yy(e),s=a.length+1;for((t=$p(s))[0]=a.length,r=1;r!=s;++r)t[r]=a[r-1];for(r=s-1;r>=0;--r)n=((16384&n?1:0)|n<<1&32767)^t[r];return 52811^n}(r.password)),n.valid=a.verificationBytes===a.verifier,n.valid&&(n.insitu=iw(r.password)),a}function lw(e,t,r){var n=r||{};return n.Info=e.read_shift(2),e.l-=2,1===n.Info?n.Data=function(e){var t={},r=t.EncryptionVersionInfo=Jy(e,4);if(1!=r.Major||1!=r.Minor)throw"unrecognized version code "+r.Major+" : "+r.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}(e):n.Data=function(e,t){var r={},n=r.EncryptionVersionInfo=Jy(e,4);if(t-=4,2!=n.Minor)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=e.read_shift(4),t-=4;var a=e.read_shift(4);return t-=4,r.EncryptionHeader=ew(e,a),t-=a,r.EncryptionVerifier=tw(e,t),r}(e,t),n}var cw=function(){function e(e,r){switch(r.type){case"base64":return t(Fp(e),r);case"binary":return t(e,r);case"buffer":return t(Up&&Buffer.isBuffer(e)?e.toString("binary"):Wp(e),r);case"array":return t(rx(e),r)}throw new Error("Unrecognized type "+r.type)}function t(e,t){var r=(t||{}).dense?[]:{},n=e.match(/\\trowd.*?\\row\b/g);if(!n.length)throw new Error("RTF missing table");var a={s:{c:0,r:0},e:{c:0,r:n.length-1}};return n.forEach(function(e,t){Array.isArray(r)&&(r[t]=[]);for(var n,s=/\\\w+\b/g,i=0,o=-1;n=s.exec(e);){if("\\cell"===n[0]){var l=e.slice(i,s.lastIndex-n[0].length);if(" "==l[0]&&(l=l.slice(1)),++o,l.length){var c={v:l,t:"s"};Array.isArray(r)?r[t][o]=c:r[Gv({r:t,c:o})]=c}}i=s.lastIndex}o>a.e.c&&(a.e.c=o)}),r["!ref"]=Kv(a),r}return{to_workbook:function(t,r){return Zv(e(t,r),r)},to_sheet:e,from_sheet:function(e){for(var t,r=["{\\rtf1\\ansi"],n=Xv(e["!ref"]),a=Array.isArray(e),s=n.s.r;s<=n.e.r;++s){r.push("\\trowd\\trautofit1");for(var i=n.s.c;i<=n.e.c;++i)r.push("\\cellx"+(i+1));for(r.push("\\pard\\intbl"),i=n.s.c;i<=n.e.c;++i){var o=Gv({r:s,c:i});(t=a?(e[s]||[])[i]:e[o])&&(null!=t.v||t.f&&!t.F)&&(r.push(" "+(t.w||(Jv(t),t.w))),r.push("\\cell"))}r.push("\\pard\\intbl\\row")}return r.join("")+"}"}}}();function dw(e){for(var t=0,r=1;3!=t;++t)r=256*r+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}function uw(e,t){if(0===t)return e;var r,n,a=function(e){var t=e[0]/255,r=e[1]/255,n=e[2]/255,a=Math.max(t,r,n),s=Math.min(t,r,n),i=a-s;if(0===i)return[0,0,t];var o,l=0,c=a+s;switch(o=i/(c>1?2-c:c),a){case t:l=((r-n)/i+6)%6;break;case r:l=(n-t)/i+2;break;case n:l=(t-r)/i+4}return[l/6,o,c/2]}((n=(r=e).slice("#"===r[0]?1:0).slice(0,6),[parseInt(n.slice(0,2),16),parseInt(n.slice(2,4),16),parseInt(n.slice(4,6),16)]));return a[2]=t<0?a[2]*(1+t):1-(1-a[2])*(1-t),dw(function(e){var t,r=e[0],n=e[1],a=e[2],s=2*n*(a<.5?a:1-a),i=a-s/2,o=[i,i,i],l=6*r;if(0!==n)switch(0|l){case 0:case 6:t=s*l,o[0]+=s,o[1]+=t;break;case 1:t=s*(2-l),o[0]+=t,o[1]+=s;break;case 2:t=s*(l-2),o[1]+=s,o[2]+=t;break;case 3:t=s*(4-l),o[1]+=t,o[2]+=s;break;case 4:t=s*(l-4),o[2]+=s,o[0]+=t;break;case 5:t=s*(6-l),o[2]+=t,o[0]+=s}for(var c=0;3!=c;++c)o[c]=Math.round(255*o[c]);return o}(a))}var hw=6;function fw(e){return Math.floor((e+Math.round(128/hw)/256)*hw)}function mw(e){return Math.floor((e-5)/hw*100+.5)/100}function pw(e){return Math.round((e*hw+5)/hw*256)/256}function gw(e){return pw(mw(fw(e)))}function xw(e){var t=Math.abs(e-gw(e)),r=hw;if(t>.005)for(hw=1;hw<15;++hw)Math.abs(e-gw(e))<=t&&(t=Math.abs(e-gw(e)),r=hw);hw=r}function vw(e){e.width?(e.wpx=fw(e.width),e.wch=mw(e.wpx),e.MDW=hw):e.wpx?(e.wch=mw(e.wpx),e.width=pw(e.wch),e.MDW=hw):"number"==typeof e.wch&&(e.width=pw(e.wch),e.wpx=fw(e.width),e.MDW=hw),e.customWidth&&delete e.customWidth}var bw=96;function yw(e){return 96*e/bw}function ww(e){return e*bw/96}var _w={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};var kw=["numFmtId","fillId","fontId","borderId","xfId"],Nw=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];var jw=function(){var e=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,t=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,r=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,n=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,a=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(s,i,o){var l,c={};return s?((l=(s=s.replace(/<!--([\s\S]*?)-->/gm,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"")).match(e))&&function(e,t,r){t.NumberFmt=[];for(var n=Vg(ag),a=0;a<n.length;++a)t.NumberFmt[n[a]]=ag[n[a]];var s=e[0].match(_x);if(s)for(a=0;a<s.length;++a){var i=jx(s[a]);switch(Sx(i[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":case"</numFmt>":break;case"<numFmt":var o=Cx(Ux(i.formatCode)),l=parseInt(i.numFmtId,10);if(t.NumberFmt[l]=o,l>0){if(l>392){for(l=392;l>60&&null!=t.NumberFmt[l];--l);t.NumberFmt[l]=o}Mg(o,l)}break;default:if(r.WTF)throw new Error("unrecognized "+i[0]+" in numFmts")}}}(l,c,o),(l=s.match(n))&&function(e,t,r,n){t.Fonts=[];var a={},s=!1;(e[0].match(_x)||[]).forEach(function(e){var i=jx(e);switch(Sx(i[0])){case"<fonts":case"<fonts>":case"</fonts>":case"<font":case"<font>":case"<name/>":case"</name>":case"<sz/>":case"</sz>":case"<vertAlign/>":case"</vertAlign>":case"<family/>":case"</family>":case"<scheme/>":case"</scheme>":case"<color/>":case"</color>":case"<extLst":case"<extLst>":case"</extLst>":break;case"</font>":case"<font/>":t.Fonts.push(a),a={};break;case"<name":i.val&&(a.name=Ux(i.val));break;case"<b":a.bold=i.val?Px(i.val):1;break;case"<b/>":a.bold=1;break;case"<i":a.italic=i.val?Px(i.val):1;break;case"<i/>":a.italic=1;break;case"<u":switch(i.val){case"none":a.underline=0;break;case"single":a.underline=1;break;case"double":a.underline=2;break;case"singleAccounting":a.underline=33;break;case"doubleAccounting":a.underline=34}break;case"<u/>":a.underline=1;break;case"<strike":a.strike=i.val?Px(i.val):1;break;case"<strike/>":a.strike=1;break;case"<outline":a.outline=i.val?Px(i.val):1;break;case"<outline/>":a.outline=1;break;case"<shadow":a.shadow=i.val?Px(i.val):1;break;case"<shadow/>":a.shadow=1;break;case"<condense":a.condense=i.val?Px(i.val):1;break;case"<condense/>":a.condense=1;break;case"<extend":a.extend=i.val?Px(i.val):1;break;case"<extend/>":a.extend=1;break;case"<sz":i.val&&(a.sz=+i.val);break;case"<vertAlign":i.val&&(a.vertAlign=i.val);break;case"<family":i.val&&(a.family=parseInt(i.val,10));break;case"<scheme":i.val&&(a.scheme=i.val);break;case"<charset":if("1"==i.val)break;i.codepage=Sp[parseInt(i.val,10)];break;case"<color":if(a.color||(a.color={}),i.auto&&(a.color.auto=Px(i.auto)),i.rgb)a.color.rgb=i.rgb.slice(-6);else if(i.indexed){a.color.index=parseInt(i.indexed,10);var o=kb[a.color.index];81==a.color.index&&(o=kb[1]),o||(o=kb[1]),a.color.rgb=o[0].toString(16)+o[1].toString(16)+o[2].toString(16)}else i.theme&&(a.color.theme=parseInt(i.theme,10),i.tint&&(a.color.tint=parseFloat(i.tint)),i.theme&&r.themeElements&&r.themeElements.clrScheme&&(a.color.rgb=uw(r.themeElements.clrScheme[a.color.theme].rgb,a.color.tint||0)));break;case"<AlternateContent":case"<ext":s=!0;break;case"</AlternateContent>":case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+i[0]+" in fonts")}})}(l,c,i,o),(l=s.match(r))&&function(e,t,r,n){t.Fills=[];var a={},s=!1;(e[0].match(_x)||[]).forEach(function(e){var r=jx(e);switch(Sx(r[0])){case"<fills":case"<fills>":case"</fills>":case"</fill>":case"<gradientFill>":case"<patternFill/>":case"</patternFill>":case"<bgColor/>":case"</bgColor>":case"<fgColor/>":case"</fgColor>":case"<stop":case"<stop/>":case"</stop>":case"<color":case"<color/>":case"</color>":case"<extLst":case"<extLst>":case"</extLst>":break;case"<fill>":case"<fill":case"<fill/>":a={},t.Fills.push(a);break;case"<gradientFill":case"</gradientFill>":t.Fills.push(a),a={};break;case"<patternFill":case"<patternFill>":r.patternType&&(a.patternType=r.patternType);break;case"<bgColor":a.bgColor||(a.bgColor={}),r.indexed&&(a.bgColor.indexed=parseInt(r.indexed,10)),r.theme&&(a.bgColor.theme=parseInt(r.theme,10)),r.tint&&(a.bgColor.tint=parseFloat(r.tint)),r.rgb&&(a.bgColor.rgb=r.rgb.slice(-6));break;case"<fgColor":a.fgColor||(a.fgColor={}),r.theme&&(a.fgColor.theme=parseInt(r.theme,10)),r.tint&&(a.fgColor.tint=parseFloat(r.tint)),null!=r.rgb&&(a.fgColor.rgb=r.rgb.slice(-6));break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+r[0]+" in fills")}})}(l,c,0,o),(l=s.match(a))&&function(e,t,r,n){t.Borders=[];var a={},s=!1;(e[0].match(_x)||[]).forEach(function(e){var r=jx(e);switch(Sx(r[0])){case"<borders":case"<borders>":case"</borders>":case"</border>":case"<left/>":case"<left":case"<left>":case"</left>":case"<right/>":case"<right":case"<right>":case"</right>":case"<top/>":case"<top":case"<top>":case"</top>":case"<bottom/>":case"<bottom":case"<bottom>":case"</bottom>":case"<diagonal":case"<diagonal>":case"<diagonal/>":case"</diagonal>":case"<horizontal":case"<horizontal>":case"<horizontal/>":case"</horizontal>":case"<vertical":case"<vertical>":case"<vertical/>":case"</vertical>":case"<start":case"<start>":case"<start/>":case"</start>":case"<end":case"<end>":case"<end/>":case"</end>":case"<color":case"<color>":case"<color/>":case"</color>":case"<extLst":case"<extLst>":case"</extLst>":break;case"<border":case"<border>":case"<border/>":a={},r.diagonalUp&&(a.diagonalUp=Px(r.diagonalUp)),r.diagonalDown&&(a.diagonalDown=Px(r.diagonalDown)),t.Borders.push(a);break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+r[0]+" in borders")}})}(l,c,0,o),(l=s.match(t))&&function(e,t,r){var n;t.CellXf=[];var a=!1;(e[0].match(_x)||[]).forEach(function(e){var s=jx(e),i=0;switch(Sx(s[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":case"</xf>":case"</alignment>":case"<protection":case"</protection>":case"<protection/>":case"<extLst":case"<extLst>":case"</extLst>":break;case"<xf":case"<xf/>":for(delete(n=s)[0],i=0;i<kw.length;++i)n[kw[i]]&&(n[kw[i]]=parseInt(n[kw[i]],10));for(i=0;i<Nw.length;++i)n[Nw[i]]&&(n[Nw[i]]=Px(n[Nw[i]]));if(t.NumberFmt&&n.numFmtId>392)for(i=392;i>60;--i)if(t.NumberFmt[n.numFmtId]==t.NumberFmt[i]){n.numFmtId=i;break}t.CellXf.push(n);break;case"<alignment":case"<alignment/>":var o={};s.vertical&&(o.vertical=s.vertical),s.horizontal&&(o.horizontal=s.horizontal),null!=s.textRotation&&(o.textRotation=s.textRotation),s.indent&&(o.indent=s.indent),s.wrapText&&(o.wrapText=Px(s.wrapText)),n.alignment=o;break;case"<AlternateContent":case"<ext":a=!0;break;case"</AlternateContent>":case"</ext>":a=!1;break;default:if(r&&r.WTF&&!a)throw new Error("unrecognized "+s[0]+" in cellXfs")}})}(l,c,o),c):c}}();var Sw=Rv;var Tw=Rv;var Ew=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function Cw(e,t,r){t.themeElements.clrScheme=[];var n={};(e[0].match(_x)||[]).forEach(function(e){var a=jx(e);switch(a[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=a.val;break;case"<a:sysClr":n.rgb=a.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":"/"===a[0].charAt(1)?(t.themeElements.clrScheme[Ew.indexOf(a[0])]=n,n={}):n.name=a[0].slice(3,a[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+a[0]+" in clrScheme")}})}function Aw(){}function Ow(){}var Iw=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,Rw=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,Pw=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;var Dw=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function Lw(e,t){var r,n;e&&0!==e.length||((r=[bx])[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",e=r.join(""));var a={};if(!(n=e.match(Dw)))throw new Error("themeElements not found in theme");return function(e,t,r){var n;t.themeElements={},[["clrScheme",Iw,Cw],["fontScheme",Rw,Aw],["fmtScheme",Pw,Ow]].forEach(function(a){if(!(n=e.match(a[1])))throw new Error(a[0]+" not found in themeElements");a[2](n,t,r)})}(n[0],a,t),a.raw=e,a}function Mw(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:case 4:e.l+=4;break;case 1:t.xclrValue=function(e,t){return Rv(e,t)}(e,4);break;case 2:t.xclrValue=oy(e);break;case 3:t.xclrValue=function(e){return e.read_shift(4)}(e)}return e.l+=8,t}function Fw(e){var t=e.read_shift(2),r=e.read_shift(2)-4,n=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=Mw(e);break;case 6:n[1]=function(e,t){return Rv(e,t)}(e,r);break;case 14:case 15:n[1]=e.read_shift(1===r?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+r)}return n}function Uw(e,t){t.forEach(function(e){e[0]})}function Bw(e,t,r,n){var a,s=Array.isArray(e);t.forEach(function(t){var i=Hv(t.ref);if(s?(e[i.r]||(e[i.r]=[]),a=e[i.r][i.c]):a=e[t.ref],!a){a={t:"z"},s?e[i.r][i.c]=a:e[t.ref]=a;var o=Xv(e["!ref"]||"BDWGO1000001:A1");o.s.r>i.r&&(o.s.r=i.r),o.e.r<i.r&&(o.e.r=i.r),o.s.c>i.c&&(o.s.c=i.c),o.e.c<i.c&&(o.e.c=i.c);var l=Kv(o);l!==e["!ref"]&&(e["!ref"]=l)}a.c||(a.c=[]);var c={a:t.author,t:t.t,r:t.r,T:r};t.h&&(c.h=t.h);for(var d=a.c.length-1;d>=0;--d){if(!r&&a.c[d].T)return;r&&!a.c[d].T&&a.c.splice(d,1)}if(r&&n)for(d=0;d<n.length;++d)if(c.a==n[d].id){c.a=n[d].name||c.a;break}a.c.push(c)})}var $w=tb;var zw=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(e,r,n,a){var s=!1,i=!1;0==n.length?i=!0:"["==n.charAt(0)&&(i=!0,n=n.slice(1,-1)),0==a.length?s=!0:"["==a.charAt(0)&&(s=!0,a=a.slice(1,-1));var o=n.length>0?0|parseInt(n,10):0,l=a.length>0?0|parseInt(a,10):0;return s?l+=t.c:--l,i?o+=t.r:--o,r+(s?"":"$")+Wv(l)+(i?"":"$")+zv(o)}return function(n,a){return t=a,n.replace(e,r)}}(),Vw=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,Ww=function(){return function(e,t){return e.replace(Vw,function(e,r,n,a,s,i){var o=Vv(a)-(n?0:t.c),l=$v(i)-(s?0:t.r);return r+"R"+(0==l?"":s?l+1:"["+l+"]")+"C"+(0==o?"":n?o+1:"["+o+"]")})}}();function Hw(e,t){return e.replace(Vw,function(e,r,n,a,s,i){return r+("$"==n?n+a:Wv(Vv(a)+t.c))+("$"==s?s+i:zv($v(i)+t.r))})}function Gw(e,t,r){var n=qv(t).s,a=Hv(r);return Hw(e,{r:a.r-n.r,c:a.c-n.c})}function qw(e){return e.replace(/_xlfn\./g,"")}function Kw(e){e.l+=1}function Xw(e,t){var r=e.read_shift(2);return[16383&r,r>>14&1,r>>15&1]}function Yw(e,t,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return Jw(e);12==r.biff&&(n=4)}var a=e.read_shift(n),s=e.read_shift(n),i=Xw(e),o=Xw(e);return{s:{r:a,c:i[0],cRel:i[1],rRel:i[2]},e:{r:s,c:o[0],cRel:o[1],rRel:o[2]}}}function Jw(e){var t=Xw(e),r=Xw(e),n=e.read_shift(1),a=e.read_shift(1);return{s:{r:t[0],c:n,cRel:t[1],rRel:t[2]},e:{r:r[0],c:a,cRel:r[1],rRel:r[2]}}}function Zw(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return function(e){var t=Xw(e),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}(e);var n=e.read_shift(r&&12==r.biff?4:2),a=Xw(e);return{r:n,c:a[0],cRel:a[1],rRel:a[2]}}function Qw(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:255&r,fQuoted:!!(16384&r),cRel:r>>15,rRel:r>>15}}function e_(e){var t=1&e[e.l+1];return e.l+=4,[t,1]}function t_(e){return[e.read_shift(1),e.read_shift(1)]}function r_(e,t){var r=[e.read_shift(1)];if(12==t)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2}switch(r[0]){case 4:r[1]=Jb(e,1)?"TRUE":"FALSE",12!=t&&(e.l+=7);break;case 37:case 16:r[1]=Nb[e[e.l]],e.l+=12==t?4:8;break;case 0:e.l+=8;break;case 1:r[1]=mb(e);break;case 2:r[1]=ay(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function n_(e,t,r){for(var n=e.read_shift(12==r.biff?4:2),a=[],s=0;s!=n;++s)a.push((12==r.biff?fb:hy)(e));return a}function a_(e,t,r){var n=0,a=0;12==r.biff?(n=e.read_shift(4),a=e.read_shift(4)):(a=1+e.read_shift(1),n=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,0==--a&&(a=256));for(var s=0,i=[];s!=n&&(i[s]=[]);++s)for(var o=0;o!=a;++o)i[s][o]=r_(e,r.biff);return i}function s_(e,t,r){return e.l+=2,[Qw(e)]}function i_(e){return e.l+=6,[]}function o_(e){return e.l+=2,[Zb(e),1&e.read_shift(2)]}var l_=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];var c_={1:{n:"PtgExp",f:function(e,t,r){return e.l++,r&&12==r.biff?[e.read_shift(4,"i"),0]:[e.read_shift(2),e.read_shift(r&&2==r.biff?1:2)]}},2:{n:"PtgTbl",f:Rv},3:{n:"PtgAdd",f:Kw},4:{n:"PtgSub",f:Kw},5:{n:"PtgMul",f:Kw},6:{n:"PtgDiv",f:Kw},7:{n:"PtgPower",f:Kw},8:{n:"PtgConcat",f:Kw},9:{n:"PtgLt",f:Kw},10:{n:"PtgLe",f:Kw},11:{n:"PtgEq",f:Kw},12:{n:"PtgGe",f:Kw},13:{n:"PtgGt",f:Kw},14:{n:"PtgNe",f:Kw},15:{n:"PtgIsect",f:Kw},16:{n:"PtgUnion",f:Kw},17:{n:"PtgRange",f:Kw},18:{n:"PtgUplus",f:Kw},19:{n:"PtgUminus",f:Kw},20:{n:"PtgPercent",f:Kw},21:{n:"PtgParen",f:Kw},22:{n:"PtgMissArg",f:Kw},23:{n:"PtgStr",f:function(e,t,r){return e.l++,ey(e,0,r)}},26:{n:"PtgSheet",f:function(e,t,r){return e.l+=5,e.l+=2,e.l+=2==r.biff?1:4,["PTGSHEET"]}},27:{n:"PtgEndSheet",f:function(e,t,r){return e.l+=2==r.biff?4:5,["PTGENDSHEET"]}},28:{n:"PtgErr",f:function(e){return e.l++,Nb[e.read_shift(1)]}},29:{n:"PtgBool",f:function(e){return e.l++,0!==e.read_shift(1)}},30:{n:"PtgInt",f:function(e){return e.l++,e.read_shift(2)}},31:{n:"PtgNum",f:function(e){return e.l++,mb(e)}},32:{n:"PtgArray",f:function(e,t,r){var n=(96&e[e.l++])>>5;return e.l+=2==r.biff?6:12==r.biff?14:7,[n]}},33:{n:"PtgFunc",f:function(e,t,r){var n=(96&e[e.l])>>5;e.l+=1;var a=e.read_shift(r&&r.biff<=3?1:2);return[A_[a],C_[a],n]}},34:{n:"PtgFuncVar",f:function(e,t,r){var n=e[e.l++],a=e.read_shift(1),s=r&&r.biff<=3?[88==n?-1:0,e.read_shift(1)]:function(e){return[e[e.l+1]>>7,32767&e.read_shift(2)]}(e);return[a,(0===s[0]?C_:E_)[s[1]]]}},35:{n:"PtgName",f:function(e,t,r){var n=e.read_shift(1)>>>5&3,a=!r||r.biff>=8?4:2,s=e.read_shift(a);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12}return[n,0,s]}},36:{n:"PtgRef",f:function(e,t,r){var n=(96&e[e.l])>>5;return e.l+=1,[n,Zw(e,0,r)]}},37:{n:"PtgArea",f:function(e,t,r){return[(96&e[e.l++])>>5,Yw(e,r.biff>=2&&r.biff,r)]}},38:{n:"PtgMemArea",f:function(e,t,r){var n=e.read_shift(1)>>>5&3;return e.l+=r&&2==r.biff?3:4,[n,e.read_shift(r&&2==r.biff?1:2)]}},39:{n:"PtgMemErr",f:Rv},40:{n:"PtgMemNoMem",f:Rv},41:{n:"PtgMemFunc",f:function(e,t,r){return[e.read_shift(1)>>>5&3,e.read_shift(r&&2==r.biff?1:2)]}},42:{n:"PtgRefErr",f:function(e,t,r){var n=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,12==r.biff&&(e.l+=2),[n]}},43:{n:"PtgAreaErr",f:function(e,t,r){var n=(96&e[e.l++])>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}},44:{n:"PtgRefN",f:function(e,t,r){var n=(96&e[e.l])>>5;e.l+=1;var a=function(e,t,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return function(e){var t=e.read_shift(2),r=e.read_shift(1),n=(32768&t)>>15,a=(16384&t)>>14;return t&=16383,1==n&&t>=8192&&(t-=16384),1==a&&r>=128&&(r-=256),{r:t,c:r,cRel:a,rRel:n}}(e);var a=e.read_shift(n>=12?4:2),s=e.read_shift(2),i=(16384&s)>>14,o=(32768&s)>>15;if(s&=16383,1==o)for(;a>524287;)a-=1048576;if(1==i)for(;s>8191;)s-=16384;return{r:a,c:s,cRel:i,rRel:o}}(e,0,r);return[n,a]}},45:{n:"PtgAreaN",f:function(e,t,r){var n=(96&e[e.l++])>>5,a=function(e,t,r){if(r.biff<8)return Jw(e);var n=e.read_shift(12==r.biff?4:2),a=e.read_shift(12==r.biff?4:2),s=Xw(e),i=Xw(e);return{s:{r:n,c:s[0],cRel:s[1],rRel:s[2]},e:{r:a,c:i[0],cRel:i[1],rRel:i[2]}}}(e,0,r);return[n,a]}},46:{n:"PtgMemAreaN",f:function(e){return[e.read_shift(1)>>>5&3,e.read_shift(2)]}},47:{n:"PtgMemNoMemN",f:function(e){return[e.read_shift(1)>>>5&3,e.read_shift(2)]}},57:{n:"PtgNameX",f:function(e,t,r){return 5==r.biff?function(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var n=e.read_shift(2);return e.l+=12,[t,r,n]}(e):[e.read_shift(1)>>>5&3,e.read_shift(2),e.read_shift(4)]}},58:{n:"PtgRef3d",f:function(e,t,r){var n=(96&e[e.l])>>5;e.l+=1;var a=e.read_shift(2);return r&&5==r.biff&&(e.l+=12),[n,a,Zw(e,0,r)]}},59:{n:"PtgArea3d",f:function(e,t,r){var n=(96&e[e.l++])>>5,a=e.read_shift(2,"i");if(r)switch(r.biff){case 5:e.l+=12;break;case 12:0}return[n,a,Yw(e,0,r)]}},60:{n:"PtgRefErr3d",f:function(e,t,r){var n=(96&e[e.l++])>>5,a=e.read_shift(2),s=4;if(r)switch(r.biff){case 5:s=15;break;case 12:s=6}return e.l+=s,[n,a]}},61:{n:"PtgAreaErr3d",f:function(e,t,r){var n=(96&e[e.l++])>>5,a=e.read_shift(2),s=8;if(r)switch(r.biff){case 5:e.l+=12,s=6;break;case 12:s=12}return e.l+=s,[n,a]}},255:{}},d_={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},u_={1:{n:"PtgElfLel",f:o_},2:{n:"PtgElfRw",f:s_},3:{n:"PtgElfCol",f:s_},6:{n:"PtgElfRwV",f:s_},7:{n:"PtgElfColV",f:s_},10:{n:"PtgElfRadical",f:s_},11:{n:"PtgElfRadicalS",f:i_},13:{n:"PtgElfColS",f:i_},15:{n:"PtgElfColSV",f:i_},16:{n:"PtgElfRadicalLel",f:o_},25:{n:"PtgList",f:function(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),a=e.read_shift(2),s=e.read_shift(2);return{ixti:t,coltype:3&r,rt:l_[r>>2&31],idx:n,c:a,C:s}}},29:{n:"PtgSxName",f:function(e){return e.l+=2,[e.read_shift(4)]}},255:{}},h_={0:{n:"PtgAttrNoop",f:function(e){return e.l+=4,[0,0]}},1:{n:"PtgAttrSemi",f:function(e,t,r){var n=255&e[e.l+1]?1:0;return e.l+=r&&2==r.biff?3:4,[n]}},2:{n:"PtgAttrIf",f:function(e,t,r){var n=255&e[e.l+1]?1:0;return e.l+=2,[n,e.read_shift(r&&2==r.biff?1:2)]}},4:{n:"PtgAttrChoose",f:function(e,t,r){e.l+=2;for(var n=e.read_shift(r&&2==r.biff?1:2),a=[],s=0;s<=n;++s)a.push(e.read_shift(r&&2==r.biff?1:2));return a}},8:{n:"PtgAttrGoto",f:function(e,t,r){var n=255&e[e.l+1]?1:0;return e.l+=2,[n,e.read_shift(r&&2==r.biff?1:2)]}},16:{n:"PtgAttrSum",f:function(e,t,r){e.l+=r&&2==r.biff?3:4}},32:{n:"PtgAttrBaxcel",f:e_},33:{n:"PtgAttrBaxcel",f:e_},64:{n:"PtgAttrSpace",f:function(e){return e.read_shift(2),t_(e)}},65:{n:"PtgAttrSpaceSemi",f:function(e){return e.read_shift(2),t_(e)}},128:{n:"PtgAttrIfError",f:function(e){var t=255&e[e.l+1]?1:0;return e.l+=2,[t,e.read_shift(2)]}},255:{}};function f_(e,t,r,n){if(n.biff<8)return Rv(e,t);for(var a=e.l+t,s=[],i=0;i!==r.length;++i)switch(r[i][0]){case"PtgArray":r[i][1]=a_(e,0,n),s.push(r[i][1]);break;case"PtgMemArea":r[i][2]=n_(e,r[i][1],n),s.push(r[i][2]);break;case"PtgExp":n&&12==n.biff&&(r[i][1][1]=e.read_shift(4),s.push(r[i][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[i][0]}return 0!==(t=a-e.l)&&s.push(Rv(e,t)),s}function m_(e,t,r){for(var n,a,s=e.l+t,i=[];s!=e.l;)t=s-e.l,a=e[e.l],n=c_[a]||c_[d_[a]],24!==a&&25!==a||(n=(24===a?u_:h_)[e[e.l+1]]),n&&n.f?i.push([n.n,n.f(e,t,r)]):Rv(e,t);return i}function p_(e){for(var t=[],r=0;r<e.length;++r){for(var n=e[r],a=[],s=0;s<n.length;++s){var i=n[s];if(i)if(2===i[0])a.push('"'+i[1].replace(/"/g,'""')+'"');else a.push(i[1]);else a.push("")}t.push(a.join(","))}return t.join(";")}var g_={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function x_(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var n=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),0==t?"":e.XTI[t-1];if(!n)return"SH33TJSERR1";var a="";if(r.biff>8)switch(e[n[0]][0]){case 357:return a=-1==n[1]?"#REF":e.SheetNames[n[1]],n[1]==n[2]?a:a+":"+e.SheetNames[n[2]];case 358:return null!=r.SID?e.SheetNames[r.SID]:"SH33TJSSAME"+e[n[0]][0];default:return"SH33TJSSRC"+e[n[0]][0]}switch(e[n[0]][0][0]){case 1025:return a=-1==n[1]?"#REF":e.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?a:a+":"+e.SheetNames[n[2]];case 14849:return e[n[0]].slice(1).map(function(e){return e.Name}).join(";;");default:return e[n[0]][0][3]?(a=-1==n[1]?"#REF":e[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?a:a+":"+e[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function v_(e,t,r){var n=x_(e,t,r);return"#REF"==n?n:function(e,t){if(!(e||t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}(n,r)}function b_(e,t,r,n,a){var s,i,o,l,c=a&&a.biff||8,d={s:{c:0,r:0}},u=[],h=0,f=0,m="";if(!e[0]||!e[0][0])return"";for(var p=-1,g="",x=0,v=e[0].length;x<v;++x){var b=e[0][x];switch(b[0]){case"PtgUminus":u.push("-"+u.pop());break;case"PtgUplus":u.push("+"+u.pop());break;case"PtgPercent":u.push(u.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(s=u.pop(),i=u.pop(),p>=0){switch(e[0][p][1][0]){case 0:g=ax(" ",e[0][p][1][1]);break;case 1:g=ax("\r",e[0][p][1][1]);break;default:if(g="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][p][1][0])}i+=g,p=-1}u.push(i+g_[b[0]]+s);break;case"PtgIsect":s=u.pop(),i=u.pop(),u.push(i+" "+s);break;case"PtgUnion":s=u.pop(),i=u.pop(),u.push(i+","+s);break;case"PtgRange":s=u.pop(),i=u.pop(),u.push(i+":"+s);break;case"PtgAttrChoose":case"PtgAttrGoto":case"PtgAttrIf":case"PtgAttrIfError":case"PtgAttrBaxcel":case"PtgAttrSemi":case"PtgMemArea":case"PtgTbl":case"PtgMemErr":case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":case"PtgMemFunc":case"PtgMemNoMem":break;case"PtgRef":o=Mv(b[1][1],d,a),u.push(Uv(o,c));break;case"PtgRefN":o=r?Mv(b[1][1],r,a):b[1][1],u.push(Uv(o,c));break;case"PtgRef3d":h=b[1][1],o=Mv(b[1][2],d,a),m=v_(n,h,a),u.push(m+"!"+Uv(o,c));break;case"PtgFunc":case"PtgFuncVar":var y=b[1][0],w=b[1][1];y||(y=0);var _=0==(y&=127)?[]:u.slice(-y);u.length-=y,"User"===w&&(w=_.shift()),u.push(w+"("+_.join(",")+")");break;case"PtgBool":u.push(b[1]?"TRUE":"FALSE");break;case"PtgInt":case"PtgErr":u.push(b[1]);break;case"PtgNum":u.push(String(b[1]));break;case"PtgStr":u.push('"'+b[1].replace(/"/g,'""')+'"');break;case"PtgAreaN":l=Fv(b[1][1],r?{s:r}:d,a),u.push(Bv(l,a));break;case"PtgArea":l=Fv(b[1][1],d,a),u.push(Bv(l,a));break;case"PtgArea3d":h=b[1][1],l=b[1][2],m=v_(n,h,a),u.push(m+"!"+Bv(l,a));break;case"PtgAttrSum":u.push("SUM("+u.pop()+")");break;case"PtgName":f=b[1][2];var k=(n.names||[])[f-1]||(n[0]||[])[f],N=k?k.Name:"SH33TJSNAME"+String(f);N&&"_xlfn."==N.slice(0,6)&&!a.xlfn&&(N=N.slice(6)),u.push(N);break;case"PtgNameX":var j,S=b[1][1];if(f=b[1][2],!(a.biff<=5)){var T="";if(14849==((n[S]||[])[0]||[])[0]||(1025==((n[S]||[])[0]||[])[0]?n[S][f]&&n[S][f].itab>0&&(T=n.SheetNames[n[S][f].itab-1]+"!"):T=n.SheetNames[f-1]+"!"),n[S]&&n[S][f])T+=n[S][f].Name;else if(n[0]&&n[0][f])T+=n[0][f].Name;else{var E=(x_(n,S,a)||"").split(";;");E[f-1]?T=E[f-1]:T+="SH33TJSERRX"}u.push(T);break}S<0&&(S=-S),n[S]&&(j=n[S][f]),j||(j={Name:"SH33TJSERRY"}),u.push(j.Name);break;case"PtgParen":var C="(",A=")";if(p>=0){switch(g="",e[0][p][1][0]){case 2:C=ax(" ",e[0][p][1][1])+C;break;case 3:C=ax("\r",e[0][p][1][1])+C;break;case 4:A=ax(" ",e[0][p][1][1])+A;break;case 5:A=ax("\r",e[0][p][1][1])+A;break;default:if(a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][p][1][0])}p=-1}u.push(C+u.pop()+A);break;case"PtgRefErr":case"PtgRefErr3d":case"PtgAreaErr":case"PtgAreaErr3d":u.push("#REF!");break;case"PtgExp":o={c:b[1][1],r:b[1][0]};var O={c:r.c,r:r.r};if(n.sharedf[Gv(o)]){var I=n.sharedf[Gv(o)];u.push(b_(I,d,O,n,a))}else{var R=!1;for(s=0;s!=n.arrayf.length;++s)if(i=n.arrayf[s],!(o.c<i[0].s.c||o.c>i[0].e.c||o.r<i[0].s.r||o.r>i[0].e.r)){u.push(b_(i[1],d,O,n,a)),R=!0;break}R||u.push(b[1])}break;case"PtgArray":u.push("{"+p_(b[1])+"}");break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":p=x;break;case"PtgMissArg":u.push("");break;case"PtgList":u.push("Table"+b[1].idx+"[#"+b[1].rt+"]");break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");default:throw new Error("Unrecognized Formula Token: "+String(b))}if(3!=a.biff&&p>=0&&-1==["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"].indexOf(e[0][x][0])){var P=!0;switch((b=e[0][p])[1][0]){case 4:P=!1;case 0:g=ax(" ",b[1][1]);break;case 5:P=!1;case 1:g=ax("\r",b[1][1]);break;default:if(g="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+b[1][0])}u.push((P?g:"")+u.pop()+(P?"":g)),p=-1}}if(u.length>1&&a.WTF)throw new Error("bad formula stack");return u[0]}function y_(e,t,r){var n,a=e.l+t,s=2==r.biff?1:2,i=e.read_shift(s);if(65535==i)return[[],Rv(e,t-2)];var o=m_(e,i,r);return t!==i+s&&(n=f_(e,t-i-s,o,r)),e.l=a,[o,n]}function w_(e,t,r){var n,a=e.l+t,s=e.read_shift(2),i=m_(e,s,r);return 65535==s?[[],Rv(e,t-2)]:(t!==s+2&&(n=f_(e,a-s-2,i,r)),[i,n])}function __(e,t,r){var n=e.l+t,a=cy(e);2==r.biff&&++e.l;var s=function(e){var t;if(65535!==wv(e,e.l+6))return[mb(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=1===e[e.l+2],e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}(e),i=e.read_shift(1);2!=r.biff&&(e.read_shift(1),r.biff>=5&&e.read_shift(4));var o=function(e,t,r){var n,a=e.l+t,s=2==r.biff?1:2,i=e.read_shift(s);if(65535==i)return[[],Rv(e,t-2)];var o=m_(e,i,r);return t!==i+s&&(n=f_(e,t-i-s,o,r)),e.l=a,[o,n]}(e,n-e.l,r);return{cell:a,val:s[0],formula:o,shared:i>>3&1,tt:s[1]}}function k_(e,t,r){var n=e.read_shift(4),a=m_(e,n,r),s=e.read_shift(4);return[a,s>0?f_(e,s,a,r):null]}var N_=k_,j_=k_,S_=k_,T_=k_,E_={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},C_={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},A_={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function O_(e){return"of:"==e.slice(0,3)&&(e=e.slice(3)),61==e.charCodeAt(0)&&61==(e=e.slice(1)).charCodeAt(0)&&(e=e.slice(1)),(e=(e=(e=e.replace(/COM\.MICROSOFT\./g,"")).replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(e,t){return t.replace(/\./g,"")})).replace(/\[.(#[A-Z]*[?!])\]/g,"$1")).replace(/[;~]/g,",").replace(/\|/g,";")}function I_(e){var t=e.split(":");return[t[0].split(".")[0],t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}var R_={},P_={};function D_(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];"xlml"==t&&(r=[1,1,1,1,.5,.5]),null==e.left&&(e.left=r[0]),null==e.right&&(e.right=r[1]),null==e.top&&(e.top=r[2]),null==e.bottom&&(e.bottom=r[3]),null==e.header&&(e.header=r[4]),null==e.footer&&(e.footer=r[5])}}function L_(e,t,r,n,a,s){try{n.cellNF&&(e.z=ag[t])}catch(o){if(n.WTF)throw o}if("z"!==e.t||n.cellStyles){if("d"===e.t&&"string"==typeof e.v&&(e.v=tx(e.v)),(!n||!1!==n.cellText)&&"z"!==e.t)try{if(null==ag[t]&&Mg(Ug[t]||"General",t),"e"===e.t)e.w=e.w||Nb[e.v];else if(0===t)if("n"===e.t)(0|e.v)===e.v?e.w=e.v.toString(10):e.w=mg(e.v);else if("d"===e.t){var i=Gg(e.v);e.w=(0|i)===i?i.toString(10):mg(i)}else{if(void 0===e.v)return"";e.w=pg(e.v,P_)}else"d"===e.t?e.w=Lg(t,Gg(e.v),P_):e.w=Lg(t,e.v,P_)}catch(o){if(n.WTF)throw o}if(n.cellStyles&&null!=r)try{e.s=s.Fills[r],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=uw(a.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),n.WTF&&(e.s.fgColor.raw_rgb=a.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=uw(a.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),n.WTF&&(e.s.bgColor.raw_rgb=a.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(o){if(n.WTF&&s.Fills)throw o}}}var M_=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,F_=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,U_=/<(?:\w:)?hyperlink [^>]*>/gm,B_=/"(\w*:\w*)"/,$_=/<(?:\w:)?col\b[^>]*[\/]?>/g,z_=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,V_=/<(?:\w:)?pageMargins[^>]*\/>/g,W_=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,H_=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,G_=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function q_(e,t,r,n,a,s,i){if(!e)return e;n||(n={"!id":{}});var o=t.dense?[]:{},l={s:{r:2e6,c:2e6},e:{r:0,c:0}},c="",d="",u=e.match(F_);u?(c=e.slice(0,u.index),d=e.slice(u.index+u[0].length)):c=d=e;var h=c.match(W_);h?K_(h[0],o,a,r):(h=c.match(H_))&&function(e,t,r,n,a){K_(e.slice(0,e.indexOf(">")),r,n,a)}(h[0],h[1],o,a,r);var f=(c.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(f>0){var m=c.slice(f,f+50).match(B_);m&&function(e,t){var r=Xv(t);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(e["!ref"]=Kv(r))}(o,m[1])}var p=c.match(G_);p&&p[1]&&function(e,t){t.Views||(t.Views=[{}]);(e.match(X_)||[]).forEach(function(e,r){var n=jx(e);t.Views[r]||(t.Views[r]={}),+n.zoomScale&&(t.Views[r].zoom=+n.zoomScale),Px(n.rightToLeft)&&(t.Views[r].RTL=!0)})}(p[1],a);var g=[];if(t.cellStyles){var x=c.match($_);x&&function(e,t){for(var r=!1,n=0;n!=t.length;++n){var a=jx(t[n],!0);a.hidden&&(a.hidden=Px(a.hidden));var s=parseInt(a.min,10)-1,i=parseInt(a.max,10)-1;for(a.outlineLevel&&(a.level=+a.outlineLevel||0),delete a.min,delete a.max,a.width=+a.width,!r&&a.width&&(r=!0,xw(a.width)),vw(a);s<=i;)e[s++]=nx(a)}}(g,x)}u&&Y_(u[1],o,t,l,s,i);var v=d.match(z_);v&&(o["!autofilter"]=function(e){var t={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return t}(v[0]));var b=[],y=d.match(M_);if(y)for(f=0;f!=y.length;++f)b[f]=Xv(y[f].slice(y[f].indexOf('"')+1));var w=d.match(U_);w&&function(e,t,r){for(var n=Array.isArray(e),a=0;a!=t.length;++a){var s=jx(Ux(t[a]),!0);if(!s.ref)return;var i=((r||{})["!id"]||[])[s.id];i?(s.Target=i.Target,s.location&&(s.Target+="#"+Cx(s.location))):(s.Target="#"+Cx(s.location),i={Target:s.Target,TargetMode:"Internal"}),s.Rel=i,s.tooltip&&(s.Tooltip=s.tooltip,delete s.tooltip);for(var o=Xv(s.ref),l=o.s.r;l<=o.e.r;++l)for(var c=o.s.c;c<=o.e.c;++c){var d=Gv({c:c,r:l});n?(e[l]||(e[l]=[]),e[l][c]||(e[l][c]={t:"z",v:void 0}),e[l][c].l=s):(e[d]||(e[d]={t:"z",v:void 0}),e[d].l=s)}}}(o,w,n);var _,k,N=d.match(V_);if(N&&(o["!margins"]=(_=jx(N[0]),k={},["left","right","top","bottom","header","footer"].forEach(function(e){_[e]&&(k[e]=parseFloat(_[e]))}),k)),!o["!ref"]&&l.e.c>=l.s.c&&l.e.r>=l.s.r&&(o["!ref"]=Kv(l)),t.sheetRows>0&&o["!ref"]){var j=Xv(o["!ref"]);t.sheetRows<=+j.e.r&&(j.e.r=t.sheetRows-1,j.e.r>l.e.r&&(j.e.r=l.e.r),j.e.r<j.s.r&&(j.s.r=j.e.r),j.e.c>l.e.c&&(j.e.c=l.e.c),j.e.c<j.s.c&&(j.s.c=j.e.c),o["!fullref"]=o["!ref"],o["!ref"]=Kv(j))}return g.length>0&&(o["!cols"]=g),b.length>0&&(o["!merges"]=b),o}function K_(e,t,r,n){var a=jx(e);r.Sheets[n]||(r.Sheets[n]={}),a.codeName&&(r.Sheets[n].CodeName=Cx(Ux(a.codeName)))}var X_=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;var Y_=function(){var e=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,a=/ref=["']([^"']*)["']/,s=$x("v"),i=$x("f");return function(o,l,c,d,u,h){for(var f,m,p,g,x,v=0,b="",y=[],w=[],_=0,k=0,N=0,j="",S=0,T=0,E=0,C=0,A=Array.isArray(h.CellXf),O=[],I=[],R=Array.isArray(l),P=[],D={},L=!1,M=!!c.sheetStubs,F=o.split(t),U=0,B=F.length;U!=B;++U){var $=(b=F[U].trim()).length;if(0!==$){var z=0;e:for(v=0;v<$;++v)switch(b[v]){case">":if("/"!=b[v-1]){++v;break e}if(c&&c.cellStyles){if(S=null!=(m=jx(b.slice(z,v),!0)).r?parseInt(m.r,10):S+1,T=-1,c.sheetRows&&c.sheetRows<S)continue;D={},L=!1,m.ht&&(L=!0,D.hpt=parseFloat(m.ht),D.hpx=ww(D.hpt)),"1"==m.hidden&&(L=!0,D.hidden=!0),null!=m.outlineLevel&&(L=!0,D.level=+m.outlineLevel),L&&(P[S-1]=D)}break;case"<":z=v}if(z>=v)break;if(S=null!=(m=jx(b.slice(z,v),!0)).r?parseInt(m.r,10):S+1,T=-1,!(c.sheetRows&&c.sheetRows<S)){d.s.r>S-1&&(d.s.r=S-1),d.e.r<S-1&&(d.e.r=S-1),c&&c.cellStyles&&(D={},L=!1,m.ht&&(L=!0,D.hpt=parseFloat(m.ht),D.hpx=ww(D.hpt)),"1"==m.hidden&&(L=!0,D.hidden=!0),null!=m.outlineLevel&&(L=!0,D.level=+m.outlineLevel),L&&(P[S-1]=D)),y=b.slice(v).split(e);for(var V=0;V!=y.length&&"<"==y[V].trim().charAt(0);++V);for(y=y.slice(V),v=0;v!=y.length;++v)if(0!==(b=y[v].trim()).length){if(w=b.match(r),_=v,k=0,N=0,b="<c "+("<"==b.slice(0,1)?">":"")+b,null!=w&&2===w.length){for(_=0,j=w[1],k=0;k!=j.length&&!((N=j.charCodeAt(k)-64)<1||N>26);++k)_=26*_+N;T=--_}else++T;for(k=0;k!=b.length&&62!==b.charCodeAt(k);++k);if(++k,(m=jx(b.slice(0,k),!0)).r||(m.r=Gv({r:S-1,c:T})),f={t:""},null!=(w=(j=b.slice(k)).match(s))&&""!==w[1]&&(f.v=Cx(w[1])),c.cellFormula){if(null!=(w=j.match(i))&&""!==w[1]){if(f.f=Cx(Ux(w[1])).replace(/\r\n/g,"\n"),c.xlfn||(f.f=qw(f.f)),w[0].indexOf('t="array"')>-1)f.F=(j.match(a)||[])[1],f.F.indexOf(":")>-1&&O.push([Xv(f.F),f.F]);else if(w[0].indexOf('t="shared"')>-1){g=jx(w[0]);var W=Cx(Ux(w[1]));c.xlfn||(W=qw(W)),I[parseInt(g.si,10)]=[g,W,m.r]}}else(w=j.match(/<f[^>]*\/>/))&&I[(g=jx(w[0])).si]&&(f.f=Gw(I[g.si][1],I[g.si][2],m.r));var H=Hv(m.r);for(k=0;k<O.length;++k)H.r>=O[k][0].s.r&&H.r<=O[k][0].e.r&&H.c>=O[k][0].s.c&&H.c<=O[k][0].e.c&&(f.F=O[k][1])}if(null==m.t&&void 0===f.v)if(f.f||f.F)f.v=0,f.t="n";else{if(!M)continue;f.t="z"}else f.t=m.t||"n";switch(d.s.c>T&&(d.s.c=T),d.e.c<T&&(d.e.c=T),f.t){case"n":if(""==f.v||null==f.v){if(!M)continue;f.t="z"}else f.v=parseFloat(f.v);break;case"s":if(void 0===f.v){if(!M)continue;f.t="z"}else p=R_[parseInt(f.v,10)],f.v=p.t,f.r=p.r,c.cellHTML&&(f.h=p.h);break;case"str":f.t="s",f.v=null!=f.v?Ux(f.v):"",c.cellHTML&&(f.h=Ix(f.v));break;case"inlineStr":w=j.match(n),f.t="s",null!=w&&(p=Gy(w[1]))?(f.v=p.t,c.cellHTML&&(f.h=p.h)):f.v="";break;case"b":f.v=Px(f.v);break;case"d":c.cellDates?f.v=tx(f.v,1):(f.v=Gg(tx(f.v,1)),f.t="n");break;case"e":c&&!1===c.cellText||(f.w=f.v),f.v=jb[f.v]}if(E=C=0,x=null,A&&void 0!==m.s&&null!=(x=h.CellXf[m.s])&&(null!=x.numFmtId&&(E=x.numFmtId),c.cellStyles&&null!=x.fillId&&(C=x.fillId)),L_(f,E,C,c,u,h),c.cellDates&&A&&"n"==f.t&&Ig(ag[E])&&(f.t="d",f.v=Yg(f.v)),m.cm&&c.xlmeta){var G=(c.xlmeta.Cell||[])[+m.cm-1];G&&"XLDAPR"==G.type&&(f.D=!0)}if(R){var q=Hv(m.r);l[q.r]||(l[q.r]=[]),l[q.r][q.c]=f}else l[m.r]=f}}}}P.length>0&&(l["!rows"]=P)}}();var J_=fb;function Z_(e){return[ib(e),mb(e),"n"]}var Q_=fb;var ek=["left","right","top","bottom","header","footer"];function tk(e,t,r,n,a,s){var i=s||{"!type":"chart"};if(!e)return s;var o=0,l=0,c="A",d={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(e){var t=function(e){var t,r=[],n=e.match(/^<c:numCache>/);(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/gm)||[]).forEach(function(e){var t=e.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);t&&(r[+t[1]]=n?+t[2]:t[2])});var a=Cx((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/gm)||[]).forEach(function(e){t=e.replace(/<.*?>/g,"")}),[r,a,t]}(e);d.s.r=d.s.c=0,d.e.c=o,c=Wv(o),t[0].forEach(function(e,r){i[c+zv(r)]={t:"n",v:e,z:t[1]},l=r}),d.e.r<l&&(d.e.r=l),++o}),o>0&&(i["!ref"]=Kv(d)),i}var rk=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],nk=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],ak=[],sk=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function ik(e,t){for(var r=0;r!=e.length;++r)for(var n=e[r],a=0;a!=t.length;++a){var s=t[a];if(null==n[s[0]])n[s[0]]=s[1];else switch(s[2]){case"bool":"string"==typeof n[s[0]]&&(n[s[0]]=Px(n[s[0]]));break;case"int":"string"==typeof n[s[0]]&&(n[s[0]]=parseInt(n[s[0]],10))}}}function ok(e,t){for(var r=0;r!=t.length;++r){var n=t[r];if(null==e[n[0]])e[n[0]]=n[1];else switch(n[2]){case"bool":"string"==typeof e[n[0]]&&(e[n[0]]=Px(e[n[0]]));break;case"int":"string"==typeof e[n[0]]&&(e[n[0]]=parseInt(e[n[0]],10))}}}function lk(e){ok(e.WBProps,rk),ok(e.CalcPr,sk),ik(e.WBView,nk),ik(e.Sheets,ak),P_.date1904=Px(e.WBProps.date1904)}var ck="][*?/\\".split("");var dk=/<\w+:workbook/;function uk(e,t){var r={};return e.read_shift(4),r.ArchID=e.read_shift(4),e.l+=t-8,r}function hk(e,t,r){return".bin"===t.slice(-4)?function(e,t){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],a=!1;t||(t={}),t.biff=12;var s=[],i=[[]];return i.SheetNames=[],i.XTI=[],zk[16]={n:"BrtFRTArchID$",f:uk},Dv(e,function(e,o,l){switch(l){case 156:i.SheetNames.push(e.name),r.Sheets.push(e);break;case 153:r.WBProps=e;break;case 39:null!=e.Sheet&&(t.SID=e.Sheet),e.Ref=b_(e.Ptg,0,null,i,t),delete t.SID,delete e.Ptg,s.push(e);break;case 1036:case 361:case 2071:case 158:case 143:case 664:case 353:case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:case 16:break;case 357:case 358:case 355:case 667:i[0].length?i.push([l,e]):i[0]=[l,e],i[i.length-1].XTI=[];break;case 362:0===i.length&&(i[0]=[],i[0].XTI=[]),i[i.length-1].XTI=i[i.length-1].XTI.concat(e),i.XTI=i.XTI.concat(e);break;case 35:case 37:n.push(l),a=!0;break;case 36:case 38:n.pop(),a=!1;break;default:if(o.T);else if(!a||t.WTF&&37!=n[n.length-1]&&35!=n[n.length-1])throw new Error("Unexpected record 0x"+l.toString(16))}},t),lk(r),r.Names=s,r.supbooks=i,r}(e,r):function(e,t){if(!e)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,a="xmlns",s={},i=0;if(e.replace(_x,function(o,l){var c=jx(o);switch(Sx(c[0])){case"<?xml":case"</workbook>":case"<fileVersion/>":case"</fileVersion>":case"<fileSharing":case"<fileSharing/>":case"</workbookPr>":case"<workbookProtection":case"<workbookProtection/>":case"<bookViews":case"<bookViews>":case"</bookViews>":case"</workbookView>":case"<sheets":case"<sheets>":case"</sheets>":case"</sheet>":case"<functionGroups":case"<functionGroups/>":case"<functionGroup":case"<externalReferences":case"</externalReferences>":case"<externalReferences>":case"<externalReference":case"<definedNames/>":case"<definedName/>":case"</calcPr>":case"<oleSize":case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":case"<customWorkbookView":case"</customWorkbookView>":case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":case"<pivotCache":case"<smartTagPr":case"<smartTagPr/>":case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":case"<smartTagType":case"<webPublishing":case"<webPublishing/>":case"<fileRecoveryPr":case"<fileRecoveryPr/>":case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":case"<webPublishObject":case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":case"<ArchID":case"<revisionPtr":break;case"<workbook":o.match(dk)&&(a="xmlns"+o.match(/<(\w+):/)[1]),r.xmlns=c[a];break;case"<fileVersion":delete c[0],r.AppVersion=c;break;case"<workbookPr":case"<workbookPr/>":rk.forEach(function(e){if(null!=c[e[0]])switch(e[2]){case"bool":r.WBProps[e[0]]=Px(c[e[0]]);break;case"int":r.WBProps[e[0]]=parseInt(c[e[0]],10);break;default:r.WBProps[e[0]]=c[e[0]]}}),c.codeName&&(r.WBProps.CodeName=Ux(c.codeName));break;case"<workbookView":case"<workbookView/>":delete c[0],r.WBView.push(c);break;case"<sheet":switch(c.state){case"hidden":c.Hidden=1;break;case"veryHidden":c.Hidden=2;break;default:c.Hidden=0}delete c.state,c.name=Cx(Ux(c.name)),delete c[0],r.Sheets.push(c);break;case"<definedNames>":case"<definedNames":case"<ext":case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</definedNames>":case"</ext>":case"</AlternateContent>":n=!1;break;case"<definedName":(s={}).Name=Ux(c.name),c.comment&&(s.Comment=c.comment),c.localSheetId&&(s.Sheet=+c.localSheetId),Px(c.hidden||"0")&&(s.Hidden=!0),i=l+o.length;break;case"</definedName>":s.Ref=Cx(Ux(e.slice(i,l))),r.Names.push(s);break;case"<calcPr":case"<calcPr/>":delete c[0],r.CalcPr=c;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+c[0]+" in workbook")}return o}),-1===Zx.indexOf(r.xmlns))throw new Error("Unknown Namespace: "+r.xmlns);return lk(r),r}(e,r)}function fk(e,t,r,n,a,s,i,o){return".bin"===t.slice(-4)?function(e,t,r,n,a,s,i){if(!e)return e;var o=t||{};n||(n={"!id":{}});var l,c,d,u,h,f,m,p,g,x,v=o.dense?[]:{},b={s:{r:2e6,c:2e6},e:{r:0,c:0}},y=!1,w=!1,_=[];o.biff=12,o["!row"]=0;var k=0,N=!1,j=[],S={},T=o.supbooks||a.supbooks||[[]];if(T.sharedf=S,T.arrayf=j,T.SheetNames=a.SheetNames||a.Sheets.map(function(e){return e.name}),!o.supbooks&&(o.supbooks=T,a.Names))for(var E=0;E<a.Names.length;++E)T[0][E+1]=a.Names[E];var C,A=[],O=[],I=!1;if(zk[16]={n:"BrtShortReal",f:Z_},Dv(e,function(e,t,E){if(!w)switch(E){case 148:l=e;break;case 0:c=e,o.sheetRows&&o.sheetRows<=c.r&&(w=!0),g=zv(h=c.r),o["!row"]=c.r,(e.hidden||e.hpt||null!=e.level)&&(e.hpt&&(e.hpx=ww(e.hpt)),O[e.r]=e);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(d={t:e[2]},e[2]){case"n":d.v=e[1];break;case"s":p=R_[e[1]],d.v=p.t,d.r=p.r;break;case"b":d.v=!!e[1];break;case"e":d.v=e[1],!1!==o.cellText&&(d.w=Nb[d.v]);break;case"str":d.t="s",d.v=e[1];break;case"is":d.t="s",d.v=e[1].t}if((u=i.CellXf[e[0].iStyleRef])&&L_(d,u.numFmtId,null,o,s,i),f=-1==e[0].c?f+1:e[0].c,o.dense?(v[h]||(v[h]=[]),v[h][f]=d):v[Wv(f)+g]=d,o.cellFormula){for(N=!1,k=0;k<j.length;++k){var R=j[k];c.r>=R[0].s.r&&c.r<=R[0].e.r&&f>=R[0].s.c&&f<=R[0].e.c&&(d.F=Kv(R[0]),N=!0)}!N&&e.length>3&&(d.f=e[3])}if(b.s.r>c.r&&(b.s.r=c.r),b.s.c>f&&(b.s.c=f),b.e.r<c.r&&(b.e.r=c.r),b.e.c<f&&(b.e.c=f),o.cellDates&&u&&"n"==d.t&&Ig(ag[u.numFmtId])){var P=lg(d.v);P&&(d.t="d",d.v=new Date(P.y,P.m-1,P.d,P.H,P.M,P.S,P.u))}C&&("XLDAPR"==C.type&&(d.D=!0),C=void 0);break;case 1:case 12:if(!o.sheetStubs||y)break;d={t:"z",v:void 0},f=-1==e[0].c?f+1:e[0].c,o.dense?(v[h]||(v[h]=[]),v[h][f]=d):v[Wv(f)+g]=d,b.s.r>c.r&&(b.s.r=c.r),b.s.c>f&&(b.s.c=f),b.e.r<c.r&&(b.e.r=c.r),b.e.c<f&&(b.e.c=f),C&&("XLDAPR"==C.type&&(d.D=!0),C=void 0);break;case 176:_.push(e);break;case 49:C=((o.xlmeta||{}).Cell||[])[e-1];break;case 494:var D=n["!id"][e.relId];for(D?(e.Target=D.Target,e.loc&&(e.Target+="#"+e.loc),e.Rel=D):""==e.relId&&(e.Target="#"+e.loc),h=e.rfx.s.r;h<=e.rfx.e.r;++h)for(f=e.rfx.s.c;f<=e.rfx.e.c;++f)o.dense?(v[h]||(v[h]=[]),v[h][f]||(v[h][f]={t:"z",v:void 0}),v[h][f].l=e):(m=Gv({c:f,r:h}),v[m]||(v[m]={t:"z",v:void 0}),v[m].l=e);break;case 426:if(!o.cellFormula)break;j.push(e),(x=o.dense?v[h][f]:v[Wv(f)+g]).f=b_(e[1],0,{r:c.r,c:f},T,o),x.F=Kv(e[0]);break;case 427:if(!o.cellFormula)break;S[Gv(e[0].s)]=e[1],(x=o.dense?v[h][f]:v[Wv(f)+g]).f=b_(e[1],0,{r:c.r,c:f},T,o);break;case 60:if(!o.cellStyles)break;for(;e.e>=e.s;)A[e.e--]={width:e.w/256,hidden:!!(1&e.flags),level:e.level},I||(I=!0,xw(e.w/256)),vw(A[e.e+1]);break;case 161:v["!autofilter"]={ref:Kv(e)};break;case 476:v["!margins"]=e;break;case 147:a.Sheets[r]||(a.Sheets[r]={}),e.name&&(a.Sheets[r].CodeName=e.name),(e.above||e.left)&&(v["!outline"]={above:e.above,left:e.left});break;case 137:a.Views||(a.Views=[{}]),a.Views[0]||(a.Views[0]={}),e.RTL&&(a.Views[0].RTL=!0);break;case 485:case 64:case 1053:case 151:case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:case 37:y=!0;break;case 36:case 38:y=!1;break;default:if(t.T);else if(!y||o.WTF)throw new Error("Unexpected record 0x"+E.toString(16))}},o),delete o.supbooks,delete o["!row"],!v["!ref"]&&(b.s.r<2e6||l&&(l.e.r>0||l.e.c>0||l.s.r>0||l.s.c>0))&&(v["!ref"]=Kv(l||b)),o.sheetRows&&v["!ref"]){var R=Xv(v["!ref"]);o.sheetRows<=+R.e.r&&(R.e.r=o.sheetRows-1,R.e.r>b.e.r&&(R.e.r=b.e.r),R.e.r<R.s.r&&(R.s.r=R.e.r),R.e.c>b.e.c&&(R.e.c=b.e.c),R.e.c<R.s.c&&(R.s.c=R.e.c),v["!fullref"]=v["!ref"],v["!ref"]=Kv(R))}return _.length>0&&(v["!merges"]=_),A.length>0&&(v["!cols"]=A),O.length>0&&(v["!rows"]=O),v}(e,n,r,a,s,i,o):q_(e,n,r,a,s,i,o)}function mk(e,t,r,n,a,s,i,o){return".bin"===t.slice(-4)?function(e,t,r,n,a){if(!e)return e;n||(n={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},i=!1;return Dv(e,function(e,n,o){switch(o){case 550:s["!rel"]=e;break;case 651:a.Sheets[r]||(a.Sheets[r]={}),e.name&&(a.Sheets[r].CodeName=e.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:case 37:case 38:break;case 35:i=!0;break;case 36:i=!1;break;default:if(n.T>0);else if(n.T<0);else if(!i||t.WTF)throw new Error("Unexpected record 0x"+o.toString(16))}},t),n["!id"][s["!rel"]]&&(s["!drawel"]=n["!id"][s["!rel"]]),s}(e,n,r,a,s):function(e,t,r,n,a){if(!e)return e;n||(n={"!id":{}});var s,i={"!type":"chart","!drawel":null,"!rel":""},o=e.match(W_);return o&&K_(o[0],0,a,r),(s=e.match(/drawing r:id="(.*?)"/))&&(i["!rel"]=s[1]),n["!id"][i["!rel"]]&&(i["!drawel"]=n["!id"][i["!rel"]]),i}(e,0,r,a,s)}function pk(e,t,r,n){return".bin"===t.slice(-4)?function(e,t,r){var n={NumberFmt:[]};for(var a in ag)n.NumberFmt[a]=ag[a];n.CellXf=[],n.Fonts=[];var s=[],i=!1;return Dv(e,function(e,a,o){switch(o){case 44:n.NumberFmt[e[0]]=e[1],Mg(e[1],e[0]);break;case 43:n.Fonts.push(e),null!=e.color.theme&&t&&t.themeElements&&t.themeElements.clrScheme&&(e.color.rgb=uw(t.themeElements.clrScheme[e.color.theme].rgb,e.color.tint||0));break;case 1025:case 45:case 46:case 48:case 507:case 572:case 475:case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 47:617==s[s.length-1]&&n.CellXf.push(e);break;case 35:i=!0;break;case 36:i=!1;break;case 37:s.push(o),i=!0;break;case 38:s.pop(),i=!1;break;default:if(a.T>0)s.push(o);else if(a.T<0)s.pop();else if(!i||r.WTF&&37!=s[s.length-1])throw new Error("Unexpected record 0x"+o.toString(16))}}),n}(e,r,n):jw(e,r,n)}function gk(e,t,r){return".bin"===t.slice(-4)?function(e,t){var r=[],n=!1;return Dv(e,function(e,a,s){switch(s){case 159:r.Count=e[0],r.Unique=e[1];break;case 19:r.push(e);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(a.T,!n||t.WTF)throw new Error("Unexpected record 0x"+s.toString(16))}}),r}(e,r):function(e,t){var r=[],n="";if(!e)return r;var a=e.match(qy);if(a){n=a[2].replace(Ky,"").split(Xy);for(var s=0;s!=n.length;++s){var i=Gy(n[s].trim(),t);null!=i&&(r[r.length]=i)}a=jx(a[1]),r.Count=a.count,r.Unique=a.uniqueCount}return r}(e,r)}function xk(e,t,r){return".bin"===t.slice(-4)?function(e,t){var r=[],n=[],a={},s=!1;return Dv(e,function(e,i,o){switch(o){case 632:n.push(e);break;case 635:a=e;break;case 637:a.t=e.t,a.h=e.h,a.r=e.r;break;case 636:if(a.author=n[a.iauthor],delete a.iauthor,t.sheetRows&&a.rfx&&t.sheetRows<=a.rfx.r)break;a.t||(a.t=""),delete a.rfx,r.push(a);break;case 3072:case 37:case 38:break;case 35:s=!0;break;case 36:s=!1;break;default:if(i.T);else if(!s||t.WTF)throw new Error("Unexpected record 0x"+o.toString(16))}}),r}(e,r):function(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],a=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);a&&a[1]&&a[1].split(/<\/\w*:?author>/).forEach(function(e){if(""!==e&&""!==e.trim()){var t=e.match(/<(?:\w+:)?author[^>]*>(.*)/);t&&r.push(t[1])}});var s=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return s&&s[1]&&s[1].split(/<\/\w*:?comment>/).forEach(function(e){if(""!==e&&""!==e.trim()){var a=e.match(/<(?:\w+:)?comment[^>]*>/);if(a){var s=jx(a[0]),i={author:s.authorId&&r[s.authorId]||"sheetjsghost",ref:s.ref,guid:s.guid},o=Hv(s.ref);if(!(t.sheetRows&&t.sheetRows<=o.r)){var l=e.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),c=!!l&&!!l[1]&&Gy(l[1])||{r:"",t:"",h:""};i.r=c.r,"<t></t>"==c.r&&(c.t=c.h=""),i.t=(c.t||"").replace(/\r\n/g,"\n").replace(/\r/g,"\n"),t.cellHTML&&(i.h=c.h),n.push(i)}}}}),n}(e,r)}function vk(e,t,r){return".bin"===t.slice(-4)?function(e){var t=[];return Dv(e,function(e,r,n){if(63===n)t.push(e);else if(!r.T)throw new Error("Unexpected record 0x"+n.toString(16))}),t}(e):function(e){var t=[];if(!e)return t;var r=1;return(e.match(_x)||[]).forEach(function(e){var n=jx(e);switch(n[0]){case"<?xml":case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete n[0],n.i?r=n.i:n.i=r,t.push(n)}}),t}(e)}function bk(e,t,r,n){if(".bin"===r.slice(-4))return function(e,t,r,n){if(!e)return e;var a=n||{},s=!1;Dv(e,function(e,t,r){switch(r){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:s=!0;break;case 36:s=!1;break;default:if(t.T);else if(!s||a.WTF)throw new Error("Unexpected record 0x"+r.toString(16))}},a)}(e,0,0,n)}function yk(e,t,r){return".bin"===t.slice(-4)?function(e,t,r){var n={Types:[],Cell:[],Value:[]},a=r||{},s=[],i=!1,o=2;return Dv(e,function(e,t,r){switch(r){case 335:n.Types.push({name:e.name});break;case 51:e.forEach(function(e){1==o?n.Cell.push({type:n.Types[e[0]-1].name,index:e[1]}):0==o&&n.Value.push({type:n.Types[e[0]-1].name,index:e[1]})});break;case 337:o=e?1:0;break;case 338:o=2;break;case 35:s.push(r),i=!0;break;case 36:s.pop(),i=!1;break;default:if(t.T);else if(!i||a.WTF&&35!=s[s.length-1])throw new Error("Unexpected record 0x"+r.toString(16))}}),n}(e,0,r):function(e,t,r){var n={Types:[],Cell:[],Value:[]};if(!e)return n;var a,s=!1,i=2;return e.replace(_x,function(e){var t=jx(e);switch(Sx(t[0])){case"<?xml":case"<metadata":case"</metadata>":case"<metadataTypes":case"</metadataTypes>":case"</metadataType>":case"</futureMetadata>":case"<bk>":case"</bk>":case"</rc>":case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<metadataType":n.Types.push({name:t.name});break;case"<futureMetadata":for(var o=0;o<n.Types.length;++o)n.Types[o].name==t.name&&(a=n.Types[o]);break;case"<rc":1==i?n.Cell.push({type:n.Types[t.t-1].name,index:+t.v}):0==i&&n.Value.push({type:n.Types[t.t-1].name,index:+t.v});break;case"<cellMetadata":i=1;break;case"</cellMetadata>":case"</valueMetadata>":i=2;break;case"<valueMetadata":i=0;break;case"<ext":s=!0;break;case"</ext>":s=!1;break;case"<rvb":if(!a)break;a.offsets||(a.offsets=[]),a.offsets.push(+t.i);break;default:if(!s&&r.WTF)throw new Error("unrecognized "+t[0]+" in metadata")}return e}),n}(e,0,r)}var wk,_k=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,kk=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function Nk(e,t){var r=e.split(/\s+/),n=[];if(n[0]=r[0],1===r.length)return n;var a,s,i,o=e.match(_k);if(o)for(i=0;i!=o.length;++i)-1===(s=(a=o[i].match(kk))[1].indexOf(":"))?n[a[1]]=a[2].slice(1,a[2].length-1):n["xmlns:"===a[1].slice(0,6)?"xmlns"+a[1].slice(6):a[1].slice(s+1)]=a[2].slice(1,a[2].length-1);return n}function jk(e){var t={};if(1===e.split(/\s+/).length)return t;var r,n,a,s=e.match(_k);if(s)for(a=0;a!=s.length;++a)-1===(n=(r=s[a].match(kk))[1].indexOf(":"))?t[r[1]]=r[2].slice(1,r[2].length-1):t["xmlns:"===r[1].slice(0,6)?"xmlns"+r[1].slice(6):r[1].slice(n+1)]=r[2].slice(1,r[2].length-1);return t}function Sk(e,t,r,n){var a=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":a=Px(n);break;case"i2":case"int":a=parseInt(n,10);break;case"r4":case"float":a=parseFloat(n);break;case"date":case"dateTime.tz":a=tx(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}e[Cx(t)]=a}function Tk(e,t,r){if("z"!==e.t){if(!r||!1!==r.cellText)try{"e"===e.t?e.w=e.w||Nb[e.v]:"General"===t?"n"===e.t?(0|e.v)===e.v?e.w=e.v.toString(10):e.w=mg(e.v):e.w=pg(e.v):e.w=(n=t||"General",a=e.v,"General"===(s=wk[n]||Cx(n))?pg(a):Lg(s,a))}catch(l){if(r.WTF)throw l}var n,a,s;try{var i=wk[t]||t||"General";if(r.cellNF&&(e.z=i),r.cellDates&&"n"==e.t&&Ig(i)){var o=lg(e.v);o&&(e.t="d",e.v=new Date(o.y,o.m-1,o.d,o.H,o.M,o.S,o.u))}}catch(l){if(r.WTF)throw l}}}function Ek(e,t,r){if(r.cellStyles&&t.Interior){var n=t.Interior;n.Pattern&&(n.patternType=_w[n.Pattern]||n.Pattern)}e[t.ID]=t}function Ck(e,t,r,n,a,s,i,o,l,c){var d="General",u=n.StyleID,h={};c=c||{};var f=[],m=0;for(void 0===u&&o&&(u=o.StyleID),void 0===u&&i&&(u=i.StyleID);void 0!==s[u]&&(s[u].nf&&(d=s[u].nf),s[u].Interior&&f.push(s[u].Interior),s[u].Parent);)u=s[u].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=Px(e);break;case"String":n.t="s",n.r=Rx(Cx(e)),n.v=e.indexOf("<")>-1?Cx(t||e).replace(/<.*?>/g,""):n.r;break;case"DateTime":"Z"!=e.slice(-1)&&(e+="Z"),n.v=(tx(e)-new Date(Date.UTC(1899,11,30)))/864e5,n.v!=n.v?n.v=Cx(e):n.v<60&&(n.v=n.v-1),d&&"General"!=d||(d="yyyy-mm-dd");case"Number":void 0===n.v&&(n.v=+e),n.t||(n.t="n");break;case"Error":n.t="e",n.v=jb[e],!1!==c.cellText&&(n.w=e);break;default:""==e&&""==t?n.t="z":(n.t="s",n.v=Rx(t||e))}if(Tk(n,d,c),!1!==c.cellFormula)if(n.Formula){var p=Cx(n.Formula);61==p.charCodeAt(0)&&(p=p.slice(1)),n.f=zw(p,a),delete n.Formula,"RC"==n.ArrayRange?n.F=zw("RC:RC",a):n.ArrayRange&&(n.F=zw(n.ArrayRange,a),l.push([Xv(n.F),n.F]))}else for(m=0;m<l.length;++m)a.r>=l[m][0].s.r&&a.r<=l[m][0].e.r&&a.c>=l[m][0].s.c&&a.c<=l[m][0].e.c&&(n.F=l[m][1]);c.cellStyles&&(f.forEach(function(e){!h.patternType&&e.patternType&&(h.patternType=e.patternType)}),n.s=h),void 0!==n.StyleID&&(n.ixfe=n.StyleID)}function Ak(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,"\n").replace(/\r/g,"\n"),e.v=e.w=e.ixfe=void 0}function Ok(e,t){var r=t||{};Fg();var n=Rp(Xx(e));"binary"!=r.type&&"array"!=r.type&&"base64"!=r.type||(n=Ux(n));var a,s=n.slice(0,1024).toLowerCase(),i=!1;if((1023&(s=s.replace(/".*?"/g,"")).indexOf(">"))>Math.min(1023&s.indexOf(","),1023&s.indexOf(";"))){var o=nx(r);return o.type="string",Uy.to_workbook(n,o)}if(-1==s.indexOf("<?xml")&&["html","table","head","meta","script","style","div"].forEach(function(e){s.indexOf("<"+e)>=0&&(i=!0)}),i)return function(e,t){var r=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||0==r.length)throw new Error("Invalid HTML: could not find <table>");if(1==r.length)return Zv(Hk(r[0],t),t);var n={SheetNames:[],Sheets:{}};return r.forEach(function(e,r){DN(n,Hk(e,t),"Sheet"+(r+1))}),n}(n,r);wk={"General Number":"General","General Date":ag[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":ag[15],"Short Date":ag[14],"Long Time":ag[19],"Medium Time":ag[18],"Short Time":ag[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:ag[2],Standard:ag[4],Percent:ag[10],Scientific:ag[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var l,c,d=[],u={},h=[],f=r.dense?[]:{},m="",p={},g={},x=Nk('<Data ss:Type="String">'),v=0,b=0,y=0,w={s:{r:2e6,c:2e6},e:{r:0,c:0}},_={},k={},N="",j=0,S=[],T={},E={},C=0,A=[],O=[],I={},R=[],P=!1,D=[],L=[],M={},F=0,U=0,B={Sheets:[],WBProps:{date1904:!1}},$={};Yx.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/gm,"");for(var z="";a=Yx.exec(n);)switch(a[3]=(z=a[3]).toLowerCase()){case"data":if("data"==z){if("/"===a[1]){if((l=d.pop())[0]!==a[3])throw new Error("Bad state: "+l.join("|"))}else"/"!==a[0].charAt(a[0].length-2)&&d.push([a[3],!0]);break}if(d[d.length-1][1])break;"/"===a[1]?Ck(n.slice(v,a.index),N,x,"comment"==d[d.length-1][0]?I:p,{c:b,r:y},_,R[b],g,D,r):(N="",x=Nk(a[0]),v=a.index+a[0].length);break;case"cell":if("/"===a[1])if(O.length>0&&(p.c=O),(!r.sheetRows||r.sheetRows>y)&&void 0!==p.v&&(r.dense?(f[y]||(f[y]=[]),f[y][b]=p):f[Wv(b)+zv(y)]=p),p.HRef&&(p.l={Target:Cx(p.HRef)},p.HRefScreenTip&&(p.l.Tooltip=p.HRefScreenTip),delete p.HRef,delete p.HRefScreenTip),(p.MergeAcross||p.MergeDown)&&(F=b+(0|parseInt(p.MergeAcross,10)),U=y+(0|parseInt(p.MergeDown,10)),S.push({s:{c:b,r:y},e:{c:F,r:U}})),r.sheetStubs)if(p.MergeAcross||p.MergeDown){for(var V=b;V<=F;++V)for(var W=y;W<=U;++W)(V>b||W>y)&&(r.dense?(f[W]||(f[W]=[]),f[W][V]={t:"z"}):f[Wv(V)+zv(W)]={t:"z"});b=F+1}else++b;else p.MergeAcross?b=F+1:++b;else(p=jk(a[0])).Index&&(b=+p.Index-1),b<w.s.c&&(w.s.c=b),b>w.e.c&&(w.e.c=b),"/>"===a[0].slice(-2)&&++b,O=[];break;case"row":"/"===a[1]||"/>"===a[0].slice(-2)?(y<w.s.r&&(w.s.r=y),y>w.e.r&&(w.e.r=y),"/>"===a[0].slice(-2)&&(g=Nk(a[0])).Index&&(y=+g.Index-1),b=0,++y):((g=Nk(a[0])).Index&&(y=+g.Index-1),M={},("0"==g.AutoFitHeight||g.Height)&&(M.hpx=parseInt(g.Height,10),M.hpt=yw(M.hpx),L[y]=M),"1"==g.Hidden&&(M.hidden=!0,L[y]=M));break;case"worksheet":if("/"===a[1]){if((l=d.pop())[0]!==a[3])throw new Error("Bad state: "+l.join("|"));h.push(m),w.s.r<=w.e.r&&w.s.c<=w.e.c&&(f["!ref"]=Kv(w),r.sheetRows&&r.sheetRows<=w.e.r&&(f["!fullref"]=f["!ref"],w.e.r=r.sheetRows-1,f["!ref"]=Kv(w))),S.length&&(f["!merges"]=S),R.length>0&&(f["!cols"]=R),L.length>0&&(f["!rows"]=L),u[m]=f}else w={s:{r:2e6,c:2e6},e:{r:0,c:0}},y=b=0,d.push([a[3],!1]),l=Nk(a[0]),m=Cx(l.Name),f=r.dense?[]:{},S=[],D=[],L=[],$={name:m,Hidden:0},B.Sheets.push($);break;case"table":if("/"===a[1]){if((l=d.pop())[0]!==a[3])throw new Error("Bad state: "+l.join("|"))}else{if("/>"==a[0].slice(-2))break;d.push([a[3],!1]),R=[],P=!1}break;case"style":"/"===a[1]?Ek(_,k,r):k=Nk(a[0]);break;case"numberformat":k.nf=Cx(Nk(a[0]).Format||"General"),wk[k.nf]&&(k.nf=wk[k.nf]);for(var H=0;392!=H&&ag[H]!=k.nf;++H);if(392==H)for(H=57;392!=H;++H)if(null==ag[H]){Mg(k.nf,H);break}break;case"column":if("table"!==d[d.length-1][0])break;if((c=Nk(a[0])).Hidden&&(c.hidden=!0,delete c.Hidden),c.Width&&(c.wpx=parseInt(c.Width,10)),!P&&c.wpx>10){P=!0,hw=6;for(var G=0;G<R.length;++G)R[G]&&vw(R[G])}P&&vw(c),R[c.Index-1||R.length]=c;for(var q=0;q<+c.Span;++q)R[R.length]=nx(c);break;case"namedrange":if("/"===a[1])break;B.Names||(B.Names=[]);var K=jx(a[0]),X={Name:K.Name,Ref:zw(K.RefersTo.slice(1),{r:0,c:0})};B.Sheets.length>0&&(X.Sheet=B.Sheets.length-1),B.Names.push(X);break;case"namedcell":case"b":case"i":case"u":case"s":case"em":case"h2":case"h3":case"sub":case"sup":case"span":case"alignment":case"borders":case"border":case"protection":case"paragraphs":case"name":case"pixelsperinch":case"null":break;case"font":if("/>"===a[0].slice(-2))break;"/"===a[1]?N+=n.slice(j,a.index):j=a.index+a[0].length;break;case"interior":if(!r.cellStyles)break;k.Interior=Nk(a[0]);break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if("/>"===a[0].slice(-2))break;"/"===a[1]?Fb(T,z,n.slice(C,a.index)):C=a.index+a[0].length;break;case"styles":case"workbook":if("/"===a[1]){if((l=d.pop())[0]!==a[3])throw new Error("Bad state: "+l.join("|"))}else d.push([a[3],!1]);break;case"comment":if("/"===a[1]){if((l=d.pop())[0]!==a[3])throw new Error("Bad state: "+l.join("|"));Ak(I),O.push(I)}else d.push([a[3],!1]),I={a:(l=Nk(a[0])).Author};break;case"autofilter":if("/"===a[1]){if((l=d.pop())[0]!==a[3])throw new Error("Bad state: "+l.join("|"))}else if("/"!==a[0].charAt(a[0].length-2)){var Y=Nk(a[0]);f["!autofilter"]={ref:zw(Y.Range).replace(/\$/g,"")},d.push([a[3],!0])}break;case"datavalidation":if("/"===a[1]){if((l=d.pop())[0]!==a[3])throw new Error("Bad state: "+l.join("|"))}else"/"!==a[0].charAt(a[0].length-2)&&d.push([a[3],!0]);break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if("/"===a[1]){if((l=d.pop())[0]!==a[3])throw new Error("Bad state: "+l.join("|"))}else"/"!==a[0].charAt(a[0].length-2)&&d.push([a[3],!0]);break;default:if(0==d.length&&"document"==a[3])return eN(n,r);if(0==d.length&&"uof"==a[3])return eN(n,r);var J=!0;switch(d[d.length-1][0]){case"officedocumentsettings":switch(a[3]){case"allowpng":case"removepersonalinformation":case"downloadcomponents":case"locationofcomponents":case"colors":case"color":case"index":case"rgb":case"targetscreensize":case"readonlyrecommended":break;default:J=!1}break;case"componentoptions":switch(a[3]){case"toolbar":case"hideofficelogo":case"spreadsheetautofit":case"label":case"caption":case"maxheight":case"maxwidth":case"nextsheetnumber":break;default:J=!1}break;case"excelworkbook":switch(a[3]){case"date1904":B.WBProps.date1904=!0;break;case"windowheight":case"windowwidth":case"windowtopx":case"windowtopy":case"tabratio":case"protectstructure":case"protectwindow":case"protectwindows":case"activesheet":case"displayinknotes":case"firstvisiblesheet":case"supbook":case"sheetname":case"sheetindex":case"sheetindexfirst":case"sheetindexlast":case"dll":case"acceptlabelsinformulas":case"donotsavelinkvalues":case"iteration":case"maxiterations":case"maxchange":case"path":case"xct":case"count":case"selectedsheets":case"calculation":case"uncalced":case"startupprompt":case"crn":case"externname":case"formula":case"colfirst":case"collast":case"wantadvise":case"boolean":case"error":case"text":case"ole":case"noautorecover":case"publishobjects":case"donotcalculatebeforesave":case"number":case"refmoder1c1":case"embedsavesmarttags":break;default:J=!1}break;case"workbookoptions":switch(a[3]){case"owcversion":case"height":case"width":break;default:J=!1}break;case"worksheetoptions":switch(a[3]){case"visible":if("/>"===a[0].slice(-2));else if("/"===a[1])switch(n.slice(C,a.index)){case"SheetHidden":$.Hidden=1;break;case"SheetVeryHidden":$.Hidden=2}else C=a.index+a[0].length;break;case"header":f["!margins"]||D_(f["!margins"]={},"xlml"),isNaN(+jx(a[0]).Margin)||(f["!margins"].header=+jx(a[0]).Margin);break;case"footer":f["!margins"]||D_(f["!margins"]={},"xlml"),isNaN(+jx(a[0]).Margin)||(f["!margins"].footer=+jx(a[0]).Margin);break;case"pagemargins":var Z=jx(a[0]);f["!margins"]||D_(f["!margins"]={},"xlml"),isNaN(+Z.Top)||(f["!margins"].top=+Z.Top),isNaN(+Z.Left)||(f["!margins"].left=+Z.Left),isNaN(+Z.Right)||(f["!margins"].right=+Z.Right),isNaN(+Z.Bottom)||(f["!margins"].bottom=+Z.Bottom);break;case"displayrighttoleft":B.Views||(B.Views=[]),B.Views[0]||(B.Views[0]={}),B.Views[0].RTL=!0;break;case"freezepanes":case"frozennosplit":case"splithorizontal":case"splitvertical":case"donotdisplaygridlines":case"activerow":case"activecol":case"toprowbottompane":case"leftcolumnrightpane":case"unsynced":case"print":case"printerrors":case"panes":case"scale":case"pane":case"number":case"layout":case"pagesetup":case"selected":case"protectobjects":case"enableselection":case"protectscenarios":case"validprinterinfo":case"horizontalresolution":case"verticalresolution":case"numberofcopies":case"activepane":case"toprowvisible":case"leftcolumnvisible":case"fittopage":case"rangeselection":case"papersizeindex":case"pagelayoutzoom":case"pagebreakzoom":case"filteron":case"fitwidth":case"fitheight":case"commentslayout":case"zoom":case"lefttoright":case"gridlines":case"allowsort":case"allowfilter":case"allowinsertrows":case"allowdeleterows":case"allowinsertcols":case"allowdeletecols":case"allowinserthyperlinks":case"allowformatcells":case"allowsizecols":case"allowsizerows":case"tabcolorindex":case"donotdisplayheadings":case"showpagelayoutzoom":case"blackandwhite":case"donotdisplayzeros":case"displaypagebreak":case"rowcolheadings":case"donotdisplayoutline":case"noorientation":case"allowusepivottables":case"zeroheight":case"viewablerange":case"selection":case"protectcontents":break;case"nosummaryrowsbelowdetail":f["!outline"]||(f["!outline"]={}),f["!outline"].above=!0;break;case"nosummarycolumnsrightdetail":f["!outline"]||(f["!outline"]={}),f["!outline"].left=!0;break;default:J=!1}break;case"pivottable":case"pivotcache":switch(a[3]){case"immediateitemsondrop":case"showpagemultipleitemlabel":case"compactrowindent":case"location":case"pivotfield":case"orientation":case"layoutform":case"layoutsubtotallocation":case"layoutcompactrow":case"position":case"pivotitem":case"datatype":case"datafield":case"sourcename":case"parentfield":case"ptlineitems":case"ptlineitem":case"countofsameitems":case"item":case"itemtype":case"ptsource":case"cacheindex":case"consolidationreference":case"filename":case"reference":case"nocolumngrand":case"norowgrand":case"blanklineafteritems":case"hidden":case"subtotal":case"basefield":case"mapchilditems":case"function":case"refreshonfileopen":case"printsettitles":case"mergelabels":case"defaultversion":case"refreshname":case"refreshdate":case"refreshdatecopy":case"versionlastrefresh":case"versionlastupdate":case"versionupdateablemin":case"versionrefreshablemin":case"calculation":break;default:J=!1}break;case"pagebreaks":switch(a[3]){case"colbreaks":case"colbreak":case"rowbreaks":case"rowbreak":case"colstart":case"colend":case"rowend":break;default:J=!1}break;case"autofilter":switch(a[3]){case"autofiltercolumn":case"autofiltercondition":case"autofilterand":case"autofilteror":break;default:J=!1}break;case"querytable":switch(a[3]){case"id":case"autoformatfont":case"autoformatpattern":case"querysource":case"querytype":case"enableredirections":case"refreshedinxl9":case"urlstring":case"htmltables":case"connection":case"commandtext":case"refreshinfo":case"notitles":case"nextid":case"columninfo":case"overwritecells":case"donotpromptforfile":case"textwizardsettings":case"source":case"number":case"decimal":case"thousandseparator":case"trailingminusnumbers":case"formatsettings":case"fieldtype":case"delimiters":case"tab":case"comma":case"autoformatname":case"versionlastedit":case"versionlastrefresh":break;default:J=!1}break;case"datavalidation":switch(a[3]){case"range":case"type":case"min":case"max":case"sort":case"descending":case"order":case"casesensitive":case"value":case"errorstyle":case"errormessage":case"errortitle":case"inputmessage":case"inputtitle":case"combohide":case"inputhide":case"condition":case"qualifier":case"useblank":case"value1":case"value2":case"format":case"cellrangelist":break;default:J=!1}break;case"sorting":case"conditionalformatting":switch(a[3]){case"range":case"type":case"min":case"max":case"sort":case"descending":case"order":case"casesensitive":case"value":case"errorstyle":case"errormessage":case"errortitle":case"cellrangelist":case"inputmessage":case"inputtitle":case"combohide":case"inputhide":case"condition":case"qualifier":case"useblank":case"value1":case"value2":case"format":break;default:J=!1}break;case"mapinfo":case"schema":case"data":switch(a[3]){case"map":case"entry":case"range":case"xpath":case"field":case"xsdtype":case"filteron":case"aggregate":case"elementtype":case"attributetype":case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":case"row":break;default:J=!1}break;case"smarttags":break;default:J=!1}if(J)break;if(a[3].match(/!\[CDATA/))break;if(!d[d.length-1][1])throw"Unrecognized tag: "+a[3]+"|"+d.join("|");if("customdocumentproperties"===d[d.length-1][0]){if("/>"===a[0].slice(-2))break;"/"===a[1]?Sk(E,z,A,n.slice(C,a.index)):(A=a,C=a.index+a[0].length);break}if(r.WTF)throw"Unrecognized tag: "+a[3]+"|"+d.join("|")}var Q={};return r.bookSheets||r.bookProps||(Q.Sheets=u),Q.SheetNames=h,Q.Workbook=B,Q.SSF=nx(ag),Q.Props=T,Q.Custprops=E,Q}function Ik(e,t){switch(vN(t=t||{}),t.type||"base64"){case"base64":return Ok(Fp(e),t);case"binary":case"buffer":case"file":return Ok(e,t);case"array":return Ok(Wp(e),t)}}function Rk(e){var t={},r=e.content;if(r.l=28,t.AnsiUserType=r.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=function(e){return pb(e,1)}(r),r.length-r.l<=4)return t;var n=r.read_shift(4);return 0==n||n>40?t:(r.l-=4,t.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4||1907505652!==(n=r.read_shift(4))?t:(t.UnicodeClipboardFormat=function(e){return pb(e,2)}(r),0==(n=r.read_shift(4))||n>40?t:(r.l-=4,void(t.Reserved2=r.read_shift(0,"lpwstr")))))}var Pk=[60,1084,2066,2165,2175];function Dk(e,t,r,n,a){var s=n,i=[],o=r.slice(r.l,r.l+s);if(a&&a.enc&&a.enc.insitu&&o.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:case 133:break;default:a.enc.insitu(o)}i.push(o),r.l+=s;for(var l=wv(r,r.l),c=Vk[l],d=0;null!=c&&Pk.indexOf(l)>-1;)s=wv(r,r.l+2),d=r.l+4,2066==l?d+=4:2165!=l&&2175!=l||(d+=12),o=r.slice(d,r.l+4+s),i.push(o),r.l+=4+s,c=Vk[l=wv(r,r.l)];var u=Gp(i);Iv(u,0);var h=0;u.lens=[];for(var f=0;f<i.length;++f)u.lens.push(h),h+=i[f].length;if(u.length<n)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+u.length+" < "+n;return t.f(u,u.length,a)}function Lk(e,t,r){if("z"!==e.t&&e.XF){var n=0;try{n=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=ag[n])}catch(s){if(t.WTF)throw s}if(!t||!1!==t.cellText)try{"e"===e.t?e.w=e.w||Nb[e.v]:0===n||"General"==n?"n"===e.t?(0|e.v)===e.v?e.w=e.v.toString(10):e.w=mg(e.v):e.w=pg(e.v):e.w=Lg(n,e.v,{date1904:!!r,dateNF:t&&t.dateNF})}catch(s){if(t.WTF)throw s}if(t.cellDates&&n&&"n"==e.t&&Ig(ag[n]||String(n))){var a=lg(e.v);a&&(e.t="d",e.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}}function Mk(e,t,r){return{v:e,ixfe:t,t:r}}function Fk(e,t){var r,n,a,s,i,o,l,c,d={opts:{}},u={},h=t.dense?[]:{},f={},m={},p=null,g=[],x="",v={},b="",y={},w=[],_=[],k=[],N={Sheets:[],WBProps:{date1904:!1},Views:[{}]},j={},S=function(e){return e<8?kb[e]:e<64&&k[e-8]||kb[e]},T=function(e,t,n){if(!(M>1||n.sheetRows&&e.r>=n.sheetRows)){if(n.cellStyles&&t.XF&&t.XF.data&&function(e,t,r){var n,a=t.XF.data;a&&a.patternType&&r&&r.cellStyles&&(t.s={},t.s.patternType=a.patternType,(n=dw(S(a.icvFore)))&&(t.s.fgColor={rgb:n}),(n=dw(S(a.icvBack)))&&(t.s.bgColor={rgb:n}))}(0,t,n),delete t.ixfe,delete t.XF,r=e,b=Gv(e),m&&m.s&&m.e||(m={s:{r:0,c:0},e:{r:0,c:0}}),e.r<m.s.r&&(m.s.r=e.r),e.c<m.s.c&&(m.s.c=e.c),e.r+1>m.e.r&&(m.e.r=e.r+1),e.c+1>m.e.c&&(m.e.c=e.c+1),n.cellFormula&&t.f)for(var a=0;a<w.length;++a)if(!(w[a][0].s.c>e.c||w[a][0].s.r>e.r||w[a][0].e.c<e.c||w[a][0].e.r<e.r)){t.F=Kv(w[a][0]),w[a][0].s.c==e.c&&w[a][0].s.r==e.r||delete t.f,t.f&&(t.f=""+b_(w[a][1],0,e,P,E));break}n.dense?(h[e.r]||(h[e.r]=[]),h[e.r][e.c]=t):h[b]=t}},E={enc:!1,sbcch:0,snames:[],sharedf:y,arrayf:w,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(E.password=t.password);var C=[],A=[],O=[],I=[],R=!1,P=[];P.SheetNames=E.snames,P.sharedf=E.sharedf,P.arrayf=E.arrayf,P.names=[],P.XTI=[];var D,L=0,M=0,F=0,U=[],B=[];E.codepage=1200,Ep(1200);for(var $=!1;e.l<e.length-1;){var z=e.l,V=e.read_shift(2);if(0===V&&10===L)break;var W=e.l===e.length?0:e.read_shift(2),H=Vk[V];if(H&&H.f){if(t.bookSheets&&133===L&&133!==V)break;if(L=V,2===H.r||12==H.r){var G=e.read_shift(2);if(W-=2,!E.enc&&G!==V&&((255&G)<<8|G>>8)!==V)throw new Error("rt mismatch: "+G+"!="+V);12==H.r&&(e.l+=10,W-=10)}var q={};if(q=10===V?H.f(e,W,E):Dk(V,H,e,W,E),0==M&&-1===[9,521,1033,2057].indexOf(L))continue;switch(V){case 34:d.opts.Date1904=N.WBProps.date1904=q;break;case 134:d.opts.WriteProtect=!0;break;case 47:if(E.enc||(e.l=0),E.enc=q,!t.password)throw new Error("File is password-protected");if(null==q.valid)throw new Error("Encryption scheme unsupported");if(!q.valid)throw new Error("Password is incorrect");break;case 92:E.lastuser=q;break;case 66:var K=Number(q);switch(K){case 21010:K=1200;break;case 32768:K=1e4;break;case 32769:K=1252}Ep(E.codepage=K),$=!0;break;case 317:E.rrtabid=q;break;case 25:E.winlocked=q;break;case 439:d.opts.RefreshAll=q;break;case 12:d.opts.CalcCount=q;break;case 16:d.opts.CalcDelta=q;break;case 17:d.opts.CalcIter=q;break;case 13:d.opts.CalcMode=q;break;case 14:d.opts.CalcPrecision=q;break;case 95:d.opts.CalcSaveRecalc=q;break;case 15:E.CalcRefMode=q;break;case 2211:d.opts.FullCalc=q;break;case 129:q.fDialog&&(h["!type"]="dialog"),q.fBelow||((h["!outline"]||(h["!outline"]={})).above=!0),q.fRight||((h["!outline"]||(h["!outline"]={})).left=!0);break;case 224:_.push(q);break;case 430:P.push([q]),P[P.length-1].XTI=[];break;case 35:case 547:P[P.length-1].push(q);break;case 24:case 536:D={Name:q.Name,Ref:b_(q.rgce,0,null,P,E)},q.itab>0&&(D.Sheet=q.itab-1),P.names.push(D),P[0]||(P[0]=[],P[0].XTI=[]),P[P.length-1].push(q),"_xlnm._FilterDatabase"==q.Name&&q.itab>0&&q.rgce&&q.rgce[0]&&q.rgce[0][0]&&"PtgArea3d"==q.rgce[0][0][0]&&(B[q.itab-1]={ref:Kv(q.rgce[0][0][1][2])});break;case 22:E.ExternCount=q;break;case 23:0==P.length&&(P[0]=[],P[0].XTI=[]),P[P.length-1].XTI=P[P.length-1].XTI.concat(q),P.XTI=P.XTI.concat(q);break;case 2196:if(E.biff<8)break;null!=D&&(D.Comment=q[1]);break;case 18:h["!protect"]=q;break;case 19:0!==q&&E.WTF&&console.error("Password verifier: "+q);break;case 133:f[q.pos]=q,E.snames.push(q.name);break;case 10:if(--M)break;if(m.e){if(m.e.r>0&&m.e.c>0){if(m.e.r--,m.e.c--,h["!ref"]=Kv(m),t.sheetRows&&t.sheetRows<=m.e.r){var X=m.e.r;m.e.r=t.sheetRows-1,h["!fullref"]=h["!ref"],h["!ref"]=Kv(m),m.e.r=X}m.e.r++,m.e.c++}C.length>0&&(h["!merges"]=C),A.length>0&&(h["!objects"]=A),O.length>0&&(h["!cols"]=O),I.length>0&&(h["!rows"]=I),N.Sheets.push(j)}""===x?v=h:u[x]=h,h=t.dense?[]:{};break;case 9:case 521:case 1033:case 2057:if(8===E.biff&&(E.biff={9:2,521:3,1033:4}[V]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[q.BIFFVer]||8),E.biffguess=0==q.BIFFVer,0==q.BIFFVer&&4096==q.dt&&(E.biff=5,$=!0,Ep(E.codepage=28591)),8==E.biff&&0==q.BIFFVer&&16==q.dt&&(E.biff=2),M++)break;if(h=t.dense?[]:{},E.biff<8&&!$&&($=!0,Ep(E.codepage=t.codepage||1252)),E.biff<5||0==q.BIFFVer&&4096==q.dt){""===x&&(x="Sheet1"),m={s:{r:0,c:0},e:{r:0,c:0}};var Y={pos:e.l-W,name:x};f[Y.pos]=Y,E.snames.push(x)}else x=(f[z]||{name:""}).name;32==q.dt&&(h["!type"]="chart"),64==q.dt&&(h["!type"]="macro"),C=[],A=[],E.arrayf=w=[],O=[],I=[],R=!1,j={Hidden:(f[z]||{hs:0}).hs,name:x};break;case 515:case 3:case 2:"chart"==h["!type"]&&(t.dense?(h[q.r]||[])[q.c]:h[Gv({c:q.c,r:q.r})])&&++q.c,o={ixfe:q.ixfe,XF:_[q.ixfe]||{},v:q.val,t:"n"},F>0&&(o.z=U[o.ixfe>>8&63]),Lk(o,t,d.opts.Date1904),T({c:q.c,r:q.r},o,t);break;case 5:case 517:o={ixfe:q.ixfe,XF:_[q.ixfe],v:q.val,t:q.t},F>0&&(o.z=U[o.ixfe>>8&63]),Lk(o,t,d.opts.Date1904),T({c:q.c,r:q.r},o,t);break;case 638:o={ixfe:q.ixfe,XF:_[q.ixfe],v:q.rknum,t:"n"},F>0&&(o.z=U[o.ixfe>>8&63]),Lk(o,t,d.opts.Date1904),T({c:q.c,r:q.r},o,t);break;case 189:for(var J=q.c;J<=q.C;++J){var Z=q.rkrec[J-q.c][0];o={ixfe:Z,XF:_[Z],v:q.rkrec[J-q.c][1],t:"n"},F>0&&(o.z=U[o.ixfe>>8&63]),Lk(o,t,d.opts.Date1904),T({c:J,r:q.r},o,t)}break;case 6:case 518:case 1030:if("String"==q.val){p=q;break}if((o=Mk(q.val,q.cell.ixfe,q.tt)).XF=_[o.ixfe],t.cellFormula){var Q=q.formula;if(Q&&Q[0]&&Q[0][0]&&"PtgExp"==Q[0][0][0]){var ee=Q[0][0][1][0],te=Q[0][0][1][1],re=Gv({r:ee,c:te});y[re]?o.f=""+b_(q.formula,0,q.cell,P,E):o.F=((t.dense?(h[ee]||[])[te]:h[re])||{}).F}else o.f=""+b_(q.formula,0,q.cell,P,E)}F>0&&(o.z=U[o.ixfe>>8&63]),Lk(o,t,d.opts.Date1904),T(q.cell,o,t),p=q;break;case 7:case 519:if(!p)throw new Error("String record expects Formula");p.val=q,(o=Mk(q,p.cell.ixfe,"s")).XF=_[o.ixfe],t.cellFormula&&(o.f=""+b_(p.formula,0,p.cell,P,E)),F>0&&(o.z=U[o.ixfe>>8&63]),Lk(o,t,d.opts.Date1904),T(p.cell,o,t),p=null;break;case 33:case 545:w.push(q);var ne=Gv(q[0].s);if(n=t.dense?(h[q[0].s.r]||[])[q[0].s.c]:h[ne],t.cellFormula&&n){if(!p)break;if(!ne||!n)break;n.f=""+b_(q[1],0,q[0],P,E),n.F=Kv(q[0])}break;case 1212:if(!t.cellFormula)break;if(b){if(!p)break;y[Gv(p.cell)]=q[0],((n=t.dense?(h[p.cell.r]||[])[p.cell.c]:h[Gv(p.cell)])||{}).f=""+b_(q[0],0,r,P,E)}break;case 253:o=Mk(g[q.isst].t,q.ixfe,"s"),g[q.isst].h&&(o.h=g[q.isst].h),o.XF=_[o.ixfe],F>0&&(o.z=U[o.ixfe>>8&63]),Lk(o,t,d.opts.Date1904),T({c:q.c,r:q.r},o,t);break;case 513:t.sheetStubs&&(o={ixfe:q.ixfe,XF:_[q.ixfe],t:"z"},F>0&&(o.z=U[o.ixfe>>8&63]),Lk(o,t,d.opts.Date1904),T({c:q.c,r:q.r},o,t));break;case 190:if(t.sheetStubs)for(var ae=q.c;ae<=q.C;++ae){var se=q.ixfe[ae-q.c];o={ixfe:se,XF:_[se],t:"z"},F>0&&(o.z=U[o.ixfe>>8&63]),Lk(o,t,d.opts.Date1904),T({c:ae,r:q.r},o,t)}break;case 214:case 516:case 4:(o=Mk(q.val,q.ixfe,"s")).XF=_[o.ixfe],F>0&&(o.z=U[o.ixfe>>8&63]),Lk(o,t,d.opts.Date1904),T({c:q.c,r:q.r},o,t);break;case 0:case 512:1===M&&(m=q);break;case 252:g=q;break;case 1054:if(4==E.biff){U[F++]=q[1];for(var ie=0;ie<F+163&&ag[ie]!=q[1];++ie);ie>=163&&Mg(q[1],F+163)}else Mg(q[1],q[0]);break;case 30:U[F++]=q;for(var oe=0;oe<F+163&&ag[oe]!=q;++oe);oe>=163&&Mg(q,F+163);break;case 229:C=C.concat(q);break;case 93:A[q.cmo[0]]=E.lastobj=q;break;case 438:E.lastobj.TxO=q;break;case 127:E.lastobj.ImData=q;break;case 440:for(i=q[0].s.r;i<=q[0].e.r;++i)for(s=q[0].s.c;s<=q[0].e.c;++s)(n=t.dense?(h[i]||[])[s]:h[Gv({c:s,r:i})])&&(n.l=q[1]);break;case 2048:for(i=q[0].s.r;i<=q[0].e.r;++i)for(s=q[0].s.c;s<=q[0].e.c;++s)(n=t.dense?(h[i]||[])[s]:h[Gv({c:s,r:i})])&&n.l&&(n.l.Tooltip=q[1]);break;case 28:if(E.biff<=5&&E.biff>=2)break;n=t.dense?(h[q[0].r]||[])[q[0].c]:h[Gv(q[0])];var le=A[q[2]];n||(t.dense?(h[q[0].r]||(h[q[0].r]=[]),n=h[q[0].r][q[0].c]={t:"z"}):n=h[Gv(q[0])]={t:"z"},m.e.r=Math.max(m.e.r,q[0].r),m.s.r=Math.min(m.s.r,q[0].r),m.e.c=Math.max(m.e.c,q[0].c),m.s.c=Math.min(m.s.c,q[0].c)),n.c||(n.c=[]),a={a:q[1],t:le.TxO.t},n.c.push(a);break;case 2173:Uw(_[q.ixfe],q.ext);break;case 125:if(!E.cellStyles)break;for(;q.e>=q.s;)O[q.e--]={width:q.w/256,level:q.level||0,hidden:!!(1&q.flags)},R||(R=!0,xw(q.w/256)),vw(O[q.e+1]);break;case 520:var ce={};null!=q.level&&(I[q.r]=ce,ce.level=q.level),q.hidden&&(I[q.r]=ce,ce.hidden=!0),q.hpt&&(I[q.r]=ce,ce.hpt=q.hpt,ce.hpx=ww(q.hpt));break;case 38:case 39:case 40:case 41:h["!margins"]||D_(h["!margins"]={}),h["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[V]]=q;break;case 161:h["!margins"]||D_(h["!margins"]={}),h["!margins"].header=q.header,h["!margins"].footer=q.footer;break;case 574:q.RTL&&(N.Views[0].RTL=!0);break;case 146:k=q;break;case 2198:c=q;break;case 140:l=q;break;case 442:x?j.CodeName=q||j.name:N.WBProps.CodeName=q||"ThisWorkbook"}}else H||console.error("Missing Info for XLS Record 0x"+V.toString(16)),e.l+=W}return d.SheetNames=Vg(f).sort(function(e,t){return Number(e)-Number(t)}).map(function(e){return f[e].name}),t.bookSheets||(d.Sheets=u),!d.SheetNames.length&&v["!ref"]?(d.SheetNames.push("Sheet1"),d.Sheets&&(d.Sheets.Sheet1=v)):d.Preamble=v,d.Sheets&&B.forEach(function(e,t){d.Sheets[d.SheetNames[t]]["!autofilter"]=e}),d.Strings=g,d.SSF=nx(ag),E.enc&&(d.Encryption=E.enc),c&&(d.Themes=c),d.Metadata={},void 0!==l&&(d.Metadata.Country=l),P.names.length>0&&(N.Names=P.names),d.Workbook=N,d}var Uk="e0859ff2f94f6810ab9108002b27b3d9",Bk="02d5cdd59c2e1b10939708002b2cf9ae";function $k(e,t){var r,n,a,s;if(t||(t={}),vN(t),Cp(),t.codepage&&Tp(t.codepage),e.FullPaths){if(zg.find(e,"/encryption"))throw new Error("File is password-protected");r=zg.find(e,"!CompObj"),n=zg.find(e,"/Workbook")||zg.find(e,"/Book")}else{switch(t.type){case"base64":e=Vp(Fp(e));break;case"binary":e=Vp(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e))}Iv(e,0),n={content:e}}if(r&&Rk(r),t.bookProps&&!t.bookSheets)a={};else{var i=Up?"buffer":"array";if(n&&n.content)a=Fk(n.content,t);else if((s=zg.find(e,"PerfectOffice_MAIN"))&&s.content)a=By.to_workbook(s.content,(t.type=i,t));else{if(!(s=zg.find(e,"NativeContent_MAIN"))||!s.content)throw(s=zg.find(e,"MN0"))&&s.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");a=By.to_workbook(s.content,(t.type=i,t))}t.bookVBA&&e.FullPaths&&zg.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(a.vbaraw=function(e){var t=zg.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(r,n){if("/"!==r.slice(-1)&&r.match(/_VBA_PROJECT_CUR/)){var a=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");zg.utils.cfb_add(t,a,e.FileIndex[n].content)}}),zg.write(t)}(e))}var o={};return e.FullPaths&&function(e,t,r){var n=zg.find(e,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var a=Xb(n,vb,Bk);for(var s in a)t[s]=a[s]}catch(c){if(r.WTF)throw c}var i=zg.find(e,"/!SummaryInformation");if(i&&i.size>0)try{var o=Xb(i,bb,Uk);for(var l in o)null==t[l]&&(t[l]=o[l])}catch(c){if(r.WTF)throw c}t.HeadingPairs&&t.TitlesOfParts&&(Pb(t.HeadingPairs,t.TitlesOfParts,t,r),delete t.HeadingPairs,delete t.TitlesOfParts)}(e,o,t),a.Props=a.Custprops=o,t.bookFiles&&(a.cfb=e),a}var zk={0:{f:function(e,t){var r={},n=e.l+t;r.r=e.read_shift(4),e.l+=4;var a=e.read_shift(2);e.l+=1;var s=e.read_shift(1);return e.l=n,7&s&&(r.level=7&s),16&s&&(r.hidden=!0),32&s&&(r.hpt=a/20),r}},1:{f:function(e){return[sb(e)]}},2:{f:function(e){return[sb(e),ub(e),"n"]}},3:{f:function(e){return[sb(e),e.read_shift(1),"e"]}},4:{f:function(e){return[sb(e),e.read_shift(1),"b"]}},5:{f:function(e){return[sb(e),mb(e),"n"]}},6:{f:function(e){return[sb(e),tb(e),"str"]}},7:{f:function(e){return[sb(e),e.read_shift(4),"s"]}},8:{f:function(e,t,r){var n=e.l+t,a=sb(e);a.r=r["!row"];var s=[a,tb(e),"str"];if(r.cellFormula){e.l+=2;var i=j_(e,n-e.l,r);s[3]=b_(i,0,a,r.supbooks,r)}else e.l=n;return s}},9:{f:function(e,t,r){var n=e.l+t,a=sb(e);a.r=r["!row"];var s=[a,mb(e),"n"];if(r.cellFormula){e.l+=2;var i=j_(e,n-e.l,r);s[3]=b_(i,0,a,r.supbooks,r)}else e.l=n;return s}},10:{f:function(e,t,r){var n=e.l+t,a=sb(e);a.r=r["!row"];var s=[a,e.read_shift(1),"b"];if(r.cellFormula){e.l+=2;var i=j_(e,n-e.l,r);s[3]=b_(i,0,a,r.supbooks,r)}else e.l=n;return s}},11:{f:function(e,t,r){var n=e.l+t,a=sb(e);a.r=r["!row"];var s=[a,e.read_shift(1),"e"];if(r.cellFormula){e.l+=2;var i=j_(e,n-e.l,r);s[3]=b_(i,0,a,r.supbooks,r)}else e.l=n;return s}},12:{f:function(e){return[ib(e)]}},13:{f:function(e){return[ib(e),ub(e),"n"]}},14:{f:function(e){return[ib(e),e.read_shift(1),"e"]}},15:{f:function(e){return[ib(e),e.read_shift(1),"b"]}},16:{f:Z_},17:{f:function(e){return[ib(e),tb(e),"str"]}},18:{f:function(e){return[ib(e),e.read_shift(4),"s"]}},19:{f:nb},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:function(e,t,r){var n=e.l+t;e.l+=4,e.l+=1;var a=e.read_shift(4),s=cb(e),i=S_(e,0,r),o=lb(e);e.l=n;var l={Name:s,Ptg:i};return a<268435455&&(l.Sheet=a),o&&(l.Comment=o),l}},40:{},42:{},43:{f:function(e,t,r){var n={};n.sz=e.read_shift(2)/20;var a=function(e){var t=e.read_shift(1);return e.l++,{fBold:1&t,fItalic:2&t,fUnderline:4&t,fStrikeout:8&t,fOutline:16&t,fShadow:32&t,fCondense:64&t,fExtend:128&t}}(e);switch(a.fItalic&&(n.italic=1),a.fCondense&&(n.condense=1),a.fExtend&&(n.extend=1),a.fShadow&&(n.shadow=1),a.fOutline&&(n.outline=1),a.fStrikeout&&(n.strike=1),700===e.read_shift(2)&&(n.bold=1),e.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript"}var s=e.read_shift(1);0!=s&&(n.underline=s);var i=e.read_shift(1);i>0&&(n.family=i);var o=e.read_shift(1);switch(o>0&&(n.charset=o),e.l++,n.color=function(e){var t={},r=e.read_shift(1)>>>1,n=e.read_shift(1),a=e.read_shift(2,"i"),s=e.read_shift(1),i=e.read_shift(1),o=e.read_shift(1);switch(e.l++,r){case 0:t.auto=1;break;case 1:t.index=n;var l=kb[n];l&&(t.rgb=dw(l));break;case 2:t.rgb=dw([s,i,o]);break;case 3:t.theme=n}return 0!=a&&(t.tint=a>0?a/32767:a/32768),t}(e),e.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor"}return n.name=tb(e),n}},44:{f:function(e,t){return[e.read_shift(2),tb(e)]}},45:{f:Sw},46:{f:Tw},47:{f:function(e,t){var r=e.l+t,n=e.read_shift(2),a=e.read_shift(2);return e.l=r,{ixfe:n,numFmtId:a}}},48:{},49:{f:function(e){return e.read_shift(4,"i")}},50:{},51:{f:function(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:Ay},62:{f:function(e){return[sb(e),nb(e),"is"]}},63:{f:function(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=Gv(r);var n=e.read_shift(1);return 2&n&&(t.l="1"),8&n&&(t.a="1"),t}},64:{f:function(){}},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Rv,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:function(e){var t=e.read_shift(2);return e.l+=28,{RTL:32&t}}},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:function(e,t){var r={},n=e[e.l];return++e.l,r.above=!(64&n),r.left=!(128&n),e.l+=18,r.name=ob(e),r}},148:{f:J_,p:16},151:{f:function(){}},152:{},153:{f:function(e,t){var r={},n=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var a=t>8?tb(e):"";return a.length>0&&(r.CodeName=a),r.autoCompressPictures=!!(65536&n),r.backupFile=!!(64&n),r.checkCompatibility=!!(4096&n),r.date1904=!!(1&n),r.filterPrivacy=!!(8&n),r.hidePivotFieldList=!!(1024&n),r.promptedSolutions=!!(16&n),r.publishItems=!!(2048&n),r.refreshAllConnections=!!(262144&n),r.saveExternalLinkValues=!!(128&n),r.showBorderUnselectedTables=!!(4&n),r.showInkAnnotation=!!(32&n),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(32768&n),r.updateLinks=["userSet","never","always"][n>>8&3],r}},154:{},155:{},156:{f:function(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=db(e),r.name=tb(e),r}},157:{},158:{},159:{T:1,f:function(e){return[e.read_shift(4),e.read_shift(4)]}},160:{T:-1},161:{T:1,f:fb},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:Q_},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:function(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:tb(e)}}},336:{T:-1},337:{f:function(e){return e.l+=4,0!=e.read_shift(4)},T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:db},357:{},358:{},359:{},360:{T:1},361:{},362:{f:Ty},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:function(e,t,r){var n=e.l+t,a=hb(e),s=e.read_shift(1),i=[a];if(i[2]=s,r.cellFormula){var o=N_(e,n-e.l,r);i[1]=o}else e.l=n;return i}},427:{f:function(e,t,r){var n=e.l+t,a=[fb(e)];if(r.cellFormula){var s=T_(e,n-e.l,r);a[1]=s,e.l=n}else e.l=n;return a}},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:function(e){var t={};return ek.forEach(function(r){t[r]=mb(e)}),t}},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:function(){}},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:function(e,t){var r=e.l+t,n=fb(e),a=lb(e),s=tb(e),i=tb(e),o=tb(e);e.l=r;var l={rfx:n,relId:a,loc:s,display:o};return i&&(l.Tooltip=i),l}},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:db},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:$w},633:{T:1},634:{T:-1},635:{T:1,f:function(e){var t={};t.iauthor=e.read_shift(4);var r=fb(e);return t.rfx=r.s,t.ref=Gv(r.s),e.l+=16,t}},636:{T:-1},637:{f:ab},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:function(e,t){return e.l+=10,{name:tb(e)}}},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:function(){}},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},Vk={6:{f:__},10:{f:Yb},12:{f:Zb},13:{f:Zb},14:{f:Jb},15:{f:Jb},16:{f:mb},17:{f:Jb},18:{f:Jb},19:{f:Zb},20:{f:ky},21:{f:ky},23:{f:Ty},24:{f:Sy},25:{f:Jb},26:{},27:{},28:{f:function(e,t,r){return function(e,t,r){if(!(r.biff<8)){var n=e.read_shift(2),a=e.read_shift(2),s=e.read_shift(2),i=e.read_shift(2),o=ay(e,0,r);return r.biff<8&&e.read_shift(1),[{r:n,c:a},o,i,s]}}(e,0,r)}},29:{},34:{f:Jb},35:{f:Ny},38:{f:mb},39:{f:mb},40:{f:mb},41:{f:mb},42:{f:Jb},43:{f:Jb},47:{f:function(e,t,r){var n={Type:r.biff>=8?e.read_shift(2):0};return n.Type?lw(e,t-2,n):ow(e,r.biff,r,n),n}},49:{f:function(e,t,r){var n={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10}return n.name=ey(e,0,r),n}},51:{f:Zb},60:{},61:{f:function(e){return{Pos:[e.read_shift(2),e.read_shift(2)],Dim:[e.read_shift(2),e.read_shift(2)],Flags:e.read_shift(2),CurTab:e.read_shift(2),FirstTab:e.read_shift(2),Selected:e.read_shift(2),TabRatio:e.read_shift(2)}}},64:{f:Jb},65:{f:function(){}},66:{f:Zb},77:{},80:{},81:{},82:{},85:{f:Zb},89:{},90:{},91:{},92:{f:function(e,t,r){if(r.enc)return e.l+=t,"";var n=e.l,a=ay(e,0,r);return e.read_shift(t+n-e.l),a}},93:{f:function(e,t,r){if(r&&r.biff<8)return function(e,t,r){e.l+=4;var n=e.read_shift(2),a=e.read_shift(2),s=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var i=[];return i.push((Cy[n]||Rv)(e,t,r)),{cmo:[a,n,s],ft:i}}(e,t,r);var n=py(e),a=function(e,t){for(var r=e.l+t,n=[];e.l<r;){var a=e.read_shift(2);e.l-=2;try{n.push(xy[a](e,r-e.l))}catch(s){return e.l=r,n}}return e.l!=r&&(e.l=r),n}(e,t-22,n[1]);return{cmo:n,ft:a}}},94:{},95:{f:Jb},96:{},97:{},99:{f:Jb},125:{f:Ay},128:{f:function(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(0!==t[0]&&t[0]--,0!==t[1]&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}},129:{f:function(e,t,r){var n=r&&8==r.biff||2==t?e.read_shift(2):(e.l+=t,0);return{fDialog:16&n,fBelow:64&n,fRight:128&n}}},130:{f:Zb},131:{f:Jb},132:{f:Jb},133:{f:function(e,t,r){var n=e.read_shift(4),a=3&e.read_shift(1),s=e.read_shift(1);switch(s){case 0:s="Worksheet";break;case 1:s="Macrosheet";break;case 2:s="Chartsheet";break;case 6:s="VBAModule"}var i=ey(e,0,r);return 0===i.length&&(i="Sheet1"),{pos:n,hs:a,dt:s,name:i}}},134:{},140:{f:function(e){var t,r=[0,0];return t=e.read_shift(2),r[0]=yb[t]||t,t=e.read_shift(2),r[1]=yb[t]||t,r}},141:{f:Zb},144:{},146:{f:function(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(ly(e));return r}},151:{},152:{},153:{},154:{},155:{},156:{f:Zb},157:{},158:{},160:{f:Iy},161:{f:function(e,t){var r={};return t<32||(e.l+=16,r.header=mb(e),r.footer=mb(e),e.l+=2),r}},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:function(e,t){for(var r=e.l+t-2,n=e.read_shift(2),a=e.read_shift(2),s=[];e.l<r;)s.push(uy(e));if(e.l!==r)throw new Error("MulRK read error");var i=e.read_shift(2);if(s.length!=i-a+1)throw new Error("MulRK length mismatch");return{r:n,c:a,C:i,rkrec:s}}},190:{f:function(e,t){for(var r=e.l+t-2,n=e.read_shift(2),a=e.read_shift(2),s=[];e.l<r;)s.push(e.read_shift(2));if(e.l!==r)throw new Error("MulBlank read error");var i=e.read_shift(2);if(s.length!=i-a+1)throw new Error("MulBlank length mismatch");return{r:n,c:a,C:i,ixfe:s}}},193:{f:Yb},197:{},198:{},199:{},200:{},201:{},202:{f:Jb},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:Zb},220:{},221:{f:Jb},222:{},224:{f:function(e,t,r){var n={};return n.ifnt=e.read_shift(2),n.numFmtId=e.read_shift(2),n.flags=e.read_shift(2),n.fStyle=n.flags>>2&1,n.data=function(e,t,r,n){var a={},s=e.read_shift(4),i=e.read_shift(4),o=e.read_shift(4),l=e.read_shift(2);return a.patternType=wb[o>>26],n.cellStyles?(a.alc=7&s,a.fWrap=s>>3&1,a.alcV=s>>4&7,a.fJustLast=s>>7&1,a.trot=s>>8&255,a.cIndent=s>>16&15,a.fShrinkToFit=s>>20&1,a.iReadOrder=s>>22&2,a.fAtrNum=s>>26&1,a.fAtrFnt=s>>27&1,a.fAtrAlc=s>>28&1,a.fAtrBdr=s>>29&1,a.fAtrPat=s>>30&1,a.fAtrProt=s>>31&1,a.dgLeft=15&i,a.dgRight=i>>4&15,a.dgTop=i>>8&15,a.dgBottom=i>>12&15,a.icvLeft=i>>16&127,a.icvRight=i>>23&127,a.grbitDiag=i>>30&3,a.icvTop=127&o,a.icvBottom=o>>7&127,a.icvDiag=o>>14&127,a.dgDiag=o>>21&15,a.icvFore=127&l,a.icvBack=l>>7&127,a.fsxButton=l>>14&1,a):a}(e,0,n.fStyle,r),n}},225:{f:function(e,t){return 0===t||e.read_shift(2),1200}},226:{f:Yb},227:{},229:{f:function(e,t){for(var r=[],n=e.read_shift(2);n--;)r.push(hy(e));return r}},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:function(e,t){for(var r=e.l+t,n=e.read_shift(4),a=e.read_shift(4),s=[],i=0;i!=a&&e.l<r;++i)s.push(ty(e));return s.Count=n,s.Unique=a,s}},253:{f:function(e){var t=cy(e);return t.isst=e.read_shift(4),t}},255:{f:function(e,t){var r={};return r.dsst=e.read_shift(2),e.l+=t-2,r}},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:Qb},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:Jb},353:{f:Yb},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:function(e,t,r){var n=e.l+t,a=e.read_shift(2),s=e.read_shift(2);if(r.sbcch=s,1025==s||14849==s)return[s,a];if(s<1||s>255)throw new Error("Unexpected SupBook type: "+s);for(var i=ry(e,s),o=[];n>e.l;)o.push(ny(e));return[s,a,i,o]}},431:{f:Jb},432:{},433:{},434:{},437:{},438:{f:function(e,t,r){var n=e.l,a="";try{e.l+=4;var s=(r.lastobj||{cmo:[0,0]}).cmo[1];-1==[0,5,7,11,12,14].indexOf(s)?e.l+=6:function(e){var t=e.read_shift(1);e.l++;var r=e.read_shift(2);return e.l+=2,[t,r]}(e);var i=e.read_shift(2);e.read_shift(2),Zb(e);var o=e.read_shift(2);e.l+=o;for(var l=1;l<e.lens.length-1;++l){if(e.l-n!=e.lens[l])throw new Error("TxO: bad continue record");var c=e[e.l];if((a+=ry(e,e.lens[l+1]-e.lens[l]-1)).length>=(c?i:2*i))break}if(a.length!==i&&a.length!==2*i)throw new Error("cchText: "+i+" != "+a.length);return e.l=n+t,{t:a}}catch(d){return e.l=n+t,{t:a}}}},439:{f:Jb},440:{f:function(e,t){var r=hy(e);e.l+=16;var n=function(e,t){var r=e.l+t,n=e.read_shift(4);if(2!==n)throw new Error("Unrecognized streamVersion: "+n);var a=e.read_shift(2);e.l+=2;var s,i,o,l,c,d,u="";16&a&&(s=iy(e,e.l)),128&a&&(i=iy(e,e.l)),257&~a||(o=iy(e,e.l)),1==(257&a)&&(l=sy(e,e.l)),8&a&&(u=iy(e,e.l)),32&a&&(c=e.read_shift(16)),64&a&&(d=Ub(e)),e.l=r;var h=i||o||l||"";h&&u&&(h+="#"+u),h||(h="#"+u),2&a&&"/"==h.charAt(0)&&"/"!=h.charAt(1)&&(h="file://"+h);var f={Target:h};return c&&(f.guid=c),d&&(f.time=d),s&&(f.Tooltip=s),f}(e,t-24);return[r,n]}},441:{},442:{f:ny},443:{},444:{f:Zb},445:{},446:{},448:{f:Yb},449:{f:function(e){return e.read_shift(2),e.read_shift(4)},r:2},450:{f:Yb},512:{f:wy},513:{f:Oy},515:{f:function(e,t,r){r.biffguess&&2==r.biff&&(r.biff=5);var n=cy(e),a=mb(e);return n.val=a,n}},516:{f:function(e,t,r){r.biffguess&&2==r.biff&&(r.biff=5),e.l;var n=cy(e);2==r.biff&&e.l++;var a=ny(e,e.l,r);return n.val=a,n}},517:{f:_y},519:{f:Ry},520:{f:function(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var r=e.read_shift(2);e.l+=4;var n=e.read_shift(1);return e.l+=3,7&n&&(t.level=7&n),32&n&&(t.hidden=!0),64&n&&(t.hpt=r/20),t}},523:{},545:{f:Ey},549:{f:by},566:{},574:{f:function(e,t,r){return r&&r.biff>=2&&r.biff<5?{}:{RTL:64&e.read_shift(2)}}},638:{f:function(e){var t=e.read_shift(2),r=e.read_shift(2),n=uy(e);return{r:t,c:r,ixfe:n[0],rknum:n[1]}}},659:{},1048:{},1054:{f:function(e,t,r){return[e.read_shift(2),ay(e,0,r)]}},1084:{},1212:{f:function(e,t,r){var n=fy(e);e.l++;var a=e.read_shift(1);return[w_(e,t-=8,r),a,n]}},2048:{f:function(e,t){e.read_shift(2);var r=hy(e),n=e.read_shift((t-10)/2,"dbcs-cont");return[r,n=n.replace(qp,"")]}},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:vy},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:Yb},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:function(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t},r:12},2173:{f:function(e,t){e.l,e.l+=2;var r=e.read_shift(2);e.l+=2;for(var n=e.read_shift(2),a=[];n-- >0;)a.push(Fw(e,e.l));return{ixfe:r,ext:a}},r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:Jb,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:function(e,t,r){if(!(r.biff<8)){var n=e.read_shift(2),a=e.read_shift(2);return[ry(e,n,r),ry(e,a,r)]}e.l+=t},r:12},2197:{},2198:{f:function(e,t,r){var n=e.l+t;if(124226!==e.read_shift(4))if(r.cellStyles){var a,s=e.slice(e.l);e.l=n;try{a=xx(s,{type:"array"})}catch(o){return}var i=mx(a,"theme/theme/theme1.xml",!0);if(i)return Lw(i,r)}else e.l=n},r:12},2199:{},2200:{},2201:{},2202:{f:function(e){return[0!==e.read_shift(4),0!==e.read_shift(4),e.read_shift(4)]},r:12},2203:{f:Yb},2204:{},2205:{},2206:{},2207:{},2211:{f:function(e){var t=function(e){var t=e.read_shift(2),r=e.read_shift(2);return e.l+=8,{type:t,flags:r}}(e);if(2211!=t.type)throw new Error("Invalid Future Record "+t.type);return 0!==e.read_shift(4)}},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:Zb},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:function(e,t,r){var n={area:!1};if(5!=r.biff)return e.l+=t,n;var a=e.read_shift(1);return e.l+=3,16&a&&(n.area=!0),n}},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:function(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(ly(e));return r}},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:wy},1:{},2:{f:function(e){var t=cy(e);++e.l;var r=e.read_shift(2);return t.t="n",t.val=r,t}},3:{f:function(e){var t=cy(e);++e.l;var r=mb(e);return t.t="n",t.val=r,t}},4:{f:function(e,t,r){r.biffguess&&5==r.biff&&(r.biff=2);var n=cy(e);++e.l;var a=ay(e,0,r);return n.t="str",n.val=a,n}},5:{f:_y},7:{f:function(e){var t=e.read_shift(1);return 0===t?(e.l++,""):e.read_shift(t,"sbcs-cont")}},8:{},9:{f:vy},11:{},22:{f:Zb},30:{f:yy},31:{},32:{},33:{f:Ey},36:{},37:{f:by},50:{f:function(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}},62:{},52:{},67:{},68:{f:Zb},69:{},86:{},126:{},127:{f:function(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),a={fmt:t,env:r,len:n,data:e.slice(e.l,e.l+n)};return e.l+=n,a}},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:function(e,t,r){var n=e.l+t,a=cy(e),s=e.read_shift(2),i=ry(e,s,r);return e.l=n,a.t="str",a.val=i,a}},223:{},234:{},354:{},421:{},518:{f:__},521:{f:vy},536:{f:Sy},547:{f:Ny},561:{},579:{},1030:{f:__},1033:{f:vy},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function Wk(e,t,r,n){var a=t;if(!isNaN(a)){var s=(r||[]).length||0,i=e.next(4);i.write_shift(2,a),i.write_shift(2,s),s>0&&bv(r)&&e.push(r)}}function Hk(e,t){var r=t||{},n=r.dense?[]:{},a=(e=e.replace(/<!--.*?-->/g,"")).match(/<table/i);if(!a)throw new Error("Invalid HTML: could not find <table>");var s=e.match(/<\/table/i),i=a.index,o=s&&s.index||e.length,l=lx(e.slice(i,o),/(:?<tr[^>]*>)/i,"<tr>"),c=-1,d=0,u=0,h=0,f={s:{r:1e7,c:1e7},e:{r:0,c:0}},m=[];for(i=0;i<l.length;++i){var p=l[i].trim(),g=p.slice(0,3).toLowerCase();if("<tr"!=g){if("<td"==g||"<th"==g){var x=p.split(/<\/t[dh]>/i);for(o=0;o<x.length;++o){var v=x[o].trim();if(v.match(/<t[dh]/i)){for(var b=v,y=0;"<"==b.charAt(0)&&(y=b.indexOf(">"))>-1;)b=b.slice(y+1);for(var w=0;w<m.length;++w){var _=m[w];_.s.c==d&&_.s.r<c&&c<=_.e.r&&(d=_.e.c+1,w=-1)}var k=jx(v.slice(0,v.indexOf(">")));h=k.colspan?+k.colspan:1,((u=+k.rowspan)>1||h>1)&&m.push({s:{r:c,c:d},e:{r:c+(u||1)-1,c:d+h-1}});var N=k.t||k["data-t"]||"";if(b.length)if(b=zx(b),f.s.r>c&&(f.s.r=c),f.e.r<c&&(f.e.r=c),f.s.c>d&&(f.s.c=d),f.e.c<d&&(f.e.c=d),b.length){var j={t:"s",v:b};r.raw||!b.trim().length||"s"==N||("TRUE"===b?j={t:"b",v:!0}:"FALSE"===b?j={t:"b",v:!1}:isNaN(sx(b))?isNaN(ox(b).getDate())||(j={t:"d",v:tx(b)},r.cellDates||(j={t:"n",v:Gg(j.v)}),j.z=r.dateNF||ag[14]):j={t:"n",v:sx(b)}),r.dense?(n[c]||(n[c]=[]),n[c][d]=j):n[Gv({r:c,c:d})]=j,d+=h}else d+=h;else d+=h}}}}else{if(++c,r.sheetRows&&r.sheetRows<=c){--c;break}d=0}}return n["!ref"]=Kv(f),m.length&&(n["!merges"]=m),n}function Gk(e,t,r,n){for(var a=e["!merges"]||[],s=[],i=t.s.c;i<=t.e.c;++i){for(var o=0,l=0,c=0;c<a.length;++c)if(!(a[c].s.r>r||a[c].s.c>i||a[c].e.r<r||a[c].e.c<i)){if(a[c].s.r<r||a[c].s.c<i){o=-1;break}o=a[c].e.r-a[c].s.r+1,l=a[c].e.c-a[c].s.c+1;break}if(!(o<0)){var d=Gv({r:r,c:i}),u=n.dense?(e[r]||[])[i]:e[d],h=u&&null!=u.v&&(u.h||Ix(u.w||(Jv(u),u.w)||""))||"",f={};o>1&&(f.rowspan=o),l>1&&(f.colspan=l),n.editable?h='<span contenteditable="true">'+h+"</span>":u&&(f["data-t"]=u&&u.t||"z",null!=u.v&&(f["data-v"]=u.v),null!=u.z&&(f["data-z"]=u.z),u.l&&"#"!=(u.l.Target||"#").charAt(0)&&(h='<a href="'+u.l.Target+'">'+h+"</a>")),f.id=(n.id||"sjs")+"-"+d,s.push(Kx("td",h,f))}}return"<tr>"+s.join("")+"</tr>"}function qk(e,t,r){var n=r||{},a=0,s=0;if(null!=n.origin)if("number"==typeof n.origin)a=n.origin;else{var i="string"==typeof n.origin?Hv(n.origin):n.origin;a=i.r,s=i.c}var o=t.getElementsByTagName("tr"),l=Math.min(n.sheetRows||1e7,o.length),c={s:{r:0,c:0},e:{r:a,c:s}};if(e["!ref"]){var d=qv(e["!ref"]);c.s.r=Math.min(c.s.r,d.s.r),c.s.c=Math.min(c.s.c,d.s.c),c.e.r=Math.max(c.e.r,d.e.r),c.e.c=Math.max(c.e.c,d.e.c),-1==a&&(c.e.r=a=d.e.r+1)}var u=[],h=0,f=e["!rows"]||(e["!rows"]=[]),m=0,p=0,g=0,x=0,v=0,b=0;for(e["!cols"]||(e["!cols"]=[]);m<o.length&&p<l;++m){var y=o[m];if(Xk(y)){if(n.display)continue;f[p]={hidden:!0}}var w=y.children;for(g=x=0;g<w.length;++g){var _=w[g];if(!n.display||!Xk(_)){var k=_.hasAttribute("data-v")?_.getAttribute("data-v"):_.hasAttribute("v")?_.getAttribute("v"):zx(_.innerHTML),N=_.getAttribute("data-z")||_.getAttribute("z");for(h=0;h<u.length;++h){var j=u[h];j.s.c==x+s&&j.s.r<p+a&&p+a<=j.e.r&&(x=j.e.c+1-s,h=-1)}b=+_.getAttribute("colspan")||1,((v=+_.getAttribute("rowspan")||1)>1||b>1)&&u.push({s:{r:p+a,c:x+s},e:{r:p+a+(v||1)-1,c:x+s+(b||1)-1}});var S={t:"s",v:k},T=_.getAttribute("data-t")||_.getAttribute("t")||"";null!=k&&(0==k.length?S.t=T||"z":n.raw||0==k.trim().length||"s"==T||("TRUE"===k?S={t:"b",v:!0}:"FALSE"===k?S={t:"b",v:!1}:isNaN(sx(k))?isNaN(ox(k).getDate())||(S={t:"d",v:tx(k)},n.cellDates||(S={t:"n",v:Gg(S.v)}),S.z=n.dateNF||ag[14]):S={t:"n",v:sx(k)})),void 0===S.z&&null!=N&&(S.z=N);var E="",C=_.getElementsByTagName("A");if(C&&C.length)for(var A=0;A<C.length&&(!C[A].hasAttribute("href")||"#"==(E=C[A].getAttribute("href")).charAt(0));++A);E&&"#"!=E.charAt(0)&&(S.l={Target:E}),n.dense?(e[p+a]||(e[p+a]=[]),e[p+a][x+s]=S):e[Gv({c:x+s,r:p+a})]=S,c.e.c<x+s&&(c.e.c=x+s),x+=b}}++p}return u.length&&(e["!merges"]=(e["!merges"]||[]).concat(u)),c.e.r=Math.max(c.e.r,p-1+a),e["!ref"]=Kv(c),p>=l&&(e["!fullref"]=Kv((c.e.r=o.length-m+p-1+a,c))),e}function Kk(e,t){return qk((t||{}).dense?[]:{},e,t)}function Xk(e){var t="",r=function(e){return e.ownerDocument.defaultView&&"function"==typeof e.ownerDocument.defaultView.getComputedStyle?e.ownerDocument.defaultView.getComputedStyle:"function"==typeof getComputedStyle?getComputedStyle:null}(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),"none"===t}function Yk(e){var t=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(e,t){return Array(parseInt(t,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"\t").replace(/<text:line-break\/>/g,"\n");return[Cx(t.replace(/<[^>]*>/g,""))]}var Jk={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function Zk(e,t){var r,n,a,s,i,o,l=t||{},c=Xx(e),d=[],u={name:""},h="",f=0,m={},p=[],g=l.dense?[]:{},x={value:""},v="",b=0,y=[],w=-1,_=-1,k={s:{r:1e6,c:1e7},e:{r:0,c:0}},N=0,j={},S=[],T={},E=[],C=1,A=1,O=[],I={Names:[]},R={},P=["",""],D=[],L={},M="",F=0,U=!1,B=!1,$=0;for(Yx.lastIndex=0,c=c.replace(/<!--([\s\S]*?)-->/gm,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");i=Yx.exec(c);)switch(i[3]=i[3].replace(/_.*$/,"")){case"table":case"":"/"===i[1]?(k.e.c>=k.s.c&&k.e.r>=k.s.r?g["!ref"]=Kv(k):g["!ref"]="A1:A1",l.sheetRows>0&&l.sheetRows<=k.e.r&&(g["!fullref"]=g["!ref"],k.e.r=l.sheetRows-1,g["!ref"]=Kv(k)),S.length&&(g["!merges"]=S),E.length&&(g["!rows"]=E),a.name=a[""]||a.name,"undefined"!=typeof JSON&&JSON.stringify(a),p.push(a.name),m[a.name]=g,B=!1):"/"!==i[0].charAt(i[0].length-2)&&(a=jx(i[0],!1),w=_=-1,k.s.r=k.s.c=1e7,k.e.r=k.e.c=0,g=l.dense?[]:{},S=[],E=[],B=!0);break;case"table-row-group":"/"===i[1]?--N:++N;break;case"table-row":case"":if("/"===i[1]){w+=C,C=1;break}if((s=jx(i[0],!1))[""]?w=s[""]-1:-1==w&&(w=0),(C=+s["number-rows-repeated"]||1)<10)for($=0;$<C;++$)N>0&&(E[w+$]={level:N});_=-1;break;case"covered-table-cell":"/"!==i[1]&&++_,l.sheetStubs&&(l.dense?(g[w]||(g[w]=[]),g[w][_]={t:"z"}):g[Gv({r:w,c:_})]={t:"z"}),v="",y=[];break;case"table-cell":case"":if("/"===i[0].charAt(i[0].length-2))++_,x=jx(i[0],!1),A=parseInt(x["number-columns-repeated"]||"1",10),o={t:"z",v:null},x.formula&&0!=l.cellFormula&&(o.f=O_(Cx(x.formula))),"string"==(x[""]||x["value-type"])&&(o.t="s",o.v=Cx(x["string-value"]||""),l.dense?(g[w]||(g[w]=[]),g[w][_]=o):g[Gv({r:w,c:_})]=o),_+=A-1;else if("/"!==i[1]){v="",b=0,y=[],A=1;var z=C?w+C-1:w;if(++_>k.e.c&&(k.e.c=_),_<k.s.c&&(k.s.c=_),w<k.s.r&&(k.s.r=w),z>k.e.r&&(k.e.r=z),D=[],L={},o={t:(x=jx(i[0],!1))[""]||x["value-type"],v:null},l.cellFormula)if(x.formula&&(x.formula=Cx(x.formula)),x["number-matrix-columns-spanned"]&&x["number-matrix-rows-spanned"]&&(T={s:{r:w,c:_},e:{r:w+(parseInt(x["number-matrix-rows-spanned"],10)||0)-1,c:_+(parseInt(x["number-matrix-columns-spanned"],10)||0)-1}},o.F=Kv(T),O.push([T,o.F])),x.formula)o.f=O_(x.formula);else for($=0;$<O.length;++$)w>=O[$][0].s.r&&w<=O[$][0].e.r&&_>=O[$][0].s.c&&_<=O[$][0].e.c&&(o.F=O[$][1]);switch((x["number-columns-spanned"]||x["number-rows-spanned"])&&(T={s:{r:w,c:_},e:{r:w+(parseInt(x["number-rows-spanned"],10)||0)-1,c:_+(parseInt(x["number-columns-spanned"],10)||0)-1}},S.push(T)),x["number-columns-repeated"]&&(A=parseInt(x["number-columns-repeated"],10)),o.t){case"boolean":o.t="b",o.v=Px(x["boolean-value"]);break;case"float":case"percentage":case"currency":o.t="n",o.v=parseFloat(x.value);break;case"date":o.t="d",o.v=tx(x["date-value"]),l.cellDates||(o.t="n",o.v=Gg(o.v)),o.z="m/d/yy";break;case"time":o.t="n",o.v=Jg(x["time-value"])/86400,l.cellDates&&(o.t="d",o.v=Yg(o.v)),o.z="HH:MM:SS";break;case"number":o.t="n",o.v=parseFloat(x[""]);break;default:if("string"!==o.t&&"text"!==o.t&&o.t)throw new Error("Unsupported value type "+o.t);o.t="s",null!=x["string-value"]&&(v=Cx(x["string-value"]),y=[])}}else{if(U=!1,"s"===o.t&&(o.v=v||"",y.length&&(o.R=y),U=0==b),R.Target&&(o.l=R),D.length>0&&(o.c=D,D=[]),v&&!1!==l.cellText&&(o.w=v),U&&(o.t="z",delete o.v),(!U||l.sheetStubs)&&!(l.sheetRows&&l.sheetRows<=w))for(var V=0;V<C;++V){if(A=parseInt(x["number-columns-repeated"]||"1",10),l.dense)for(g[w+V]||(g[w+V]=[]),g[w+V][_]=0==V?o:nx(o);--A>0;)g[w+V][_+A]=nx(o);else for(g[Gv({r:w+V,c:_})]=o;--A>0;)g[Gv({r:w+V,c:_+A})]=nx(o);k.e.c<=_&&(k.e.c=_)}_+=(A=parseInt(x["number-columns-repeated"]||"1",10))-1,A=0,o={},v="",y=[]}R={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if("/"===i[1]){if((r=d.pop())[0]!==i[3])throw"Bad state: "+r}else"/"!==i[0].charAt(i[0].length-2)&&d.push([i[3],!0]);break;case"annotation":if("/"===i[1]){if((r=d.pop())[0]!==i[3])throw"Bad state: "+r;L.t=v,y.length&&(L.R=y),L.a=M,D.push(L)}else"/"!==i[0].charAt(i[0].length-2)&&d.push([i[3],!1]);M="",F=0,v="",b=0,y=[];break;case"creator":"/"===i[1]?M=c.slice(F,i.index):F=i.index+i[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if("/"===i[1]){if((r=d.pop())[0]!==i[3])throw"Bad state: "+r}else"/"!==i[0].charAt(i[0].length-2)&&d.push([i[3],!1]);v="",b=0,y=[];break;case"scientific-number":case"currency-symbol":case"currency-style":case"script":case"libraries":case"automatic-styles":case"default-style":case"page-layout":case"style":case"map":case"font-face":case"paragraph-properties":case"table-properties":case"table-column-properties":case"table-row-properties":case"table-cell-properties":case"fraction":case"boolean-style":case"boolean":case"text-style":case"text-content":case"text-properties":case"embedded-text":case"body":case"":case"forms":case"table-column":case"table-header-rows":case"table-rows":case"table-column-group":case"table-header-columns":case"table-columns":case"null-date":case"graphic-properties":case"calculation-settings":case"named-expressions":case"label-range":case"label-ranges":case"named-expression":case"sort":case"sort-by":case"sort-groups":case"tab":case"line-break":case"span":case"s":case"date":case"object":case"title":case"":case"desc":case"binary-data":case"table-source":case"scenario":case"iteration":case"content-validations":case"content-validation":case"help-message":case"error-message":case"database-ranges":case"filter":case"filter-and":case"filter-or":case"filter-condition":case"list-level-style-bullet":case"list-level-style-number":case"list-level-properties":case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":case"event-listener":case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":case"config-item":case"page-number":case"page-count":case"time":case"cell-range-source":case"detective":case"operation":case"highlighted-range":case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":case"rect":case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":case"properties":case"property":case"table-protection":case"data-pilot-grand-total":case"office-document-common-attrs":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if("/"===i[1]){if(j[u.name]=h,(r=d.pop())[0]!==i[3])throw"Bad state: "+r}else"/"!==i[0].charAt(i[0].length-2)&&(h="",u=jx(i[0],!1),d.push([i[3],!0]));break;case"number":case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(d[d.length-1][0]){case"time-style":case"date-style":n=jx(i[0],!1),h+=Jk[i[3]]["long"===n.style?1:0]}break;case"text":if("/>"===i[0].slice(-2))break;if("/"===i[1])switch(d[d.length-1][0]){case"number-style":case"date-style":case"time-style":h+=c.slice(f,i.index)}else f=i.index+i[0].length;break;case"named-range":P=I_((n=jx(i[0],!1))["cell-range-address"]);var W={Name:n.name,Ref:P[0]+"!"+P[1]};B&&(W.Sheet=p.length),I.Names.push(W);break;case"p":case"":if(["master-styles"].indexOf(d[d.length-1][0])>-1)break;if("/"!==i[1]||x&&x["string-value"])jx(i[0],!1),b=i.index+i[0].length;else{var H=Yk(c.slice(b,i.index));v=(v.length>0?v+"\n":"")+H[0]}break;case"database-range":if("/"===i[1])break;try{m[(P=I_(jx(i[0])["target-range-address"]))[0]]["!autofilter"]={ref:P[1]}}catch(q){}break;case"a":if("/"!==i[1]){if(!(R=jx(i[0],!1)).href)break;R.Target=Cx(R.href),delete R.href,"#"==R.Target.charAt(0)&&R.Target.indexOf(".")>-1?(P=I_(R.Target.slice(1)),R.Target="#"+P[0]+"!"+P[1]):R.Target.match(/^\.\.[\\\/]/)&&(R.Target=R.Target.slice(3))}break;default:switch(i[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(l.WTF)throw new Error(i)}}var G={Sheets:m,SheetNames:p,Workbook:I};return l.bookSheets&&delete G.Sheets,G}function Qk(e,t){t=t||{},ux(e,"META-INF/manifest.xml")&&function(e,t){for(var r,n,a=Xx(e);r=Yx.exec(a);)switch(r[3]){case"manifest":break;case"file-entry":if("/"==(n=jx(r[0],!1)).path&&"application/vnd.oasis.opendocument.spreadsheet"!==n.type)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw r}}(fx(e,"META-INF/manifest.xml"),t);var r=mx(e,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=Zk(Ux(r),t);return ux(e,"meta.xml")&&(n.Props=Ib(fx(e,"meta.xml"))),n}function eN(e,t){return Zk(e,t)}
/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function tN(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function rN(e){return"undefined"!=typeof TextDecoder?(new TextDecoder).decode(e):Ux(Wp(e))}function nN(e){var t=e.reduce(function(e,t){return e+t.length},0),r=new Uint8Array(t),n=0;return e.forEach(function(e){r.set(e,n),n+=e.length}),r}function aN(e){return 16843009*((e=(858993459&(e-=e>>1&1431655765))+(e>>2&858993459))+(e>>4)&252645135)>>>24}function sN(e,t){var r=t?t[0]:0,n=127&e[r];e:if(e[r++]>=128){if(n|=(127&e[r])<<7,e[r++]<128)break e;if(n|=(127&e[r])<<14,e[r++]<128)break e;if(n|=(127&e[r])<<21,e[r++]<128)break e;if(n+=(127&e[r])*Math.pow(2,28),++r,e[r++]<128)break e;if(n+=(127&e[r])*Math.pow(2,35),++r,e[r++]<128)break e;if(n+=(127&e[r])*Math.pow(2,42),++r,e[r++]<128)break e}return t&&(t[0]=r),n}function iN(e){var t=0,r=127&e[t];e:if(e[t++]>=128){if(r|=(127&e[t])<<7,e[t++]<128)break e;if(r|=(127&e[t])<<14,e[t++]<128)break e;if(r|=(127&e[t])<<21,e[t++]<128)break e;r|=(127&e[t])<<28}return r}function oN(e){for(var t=[],r=[0];r[0]<e.length;){var n,a=r[0],s=sN(e,r),i=7&s,o=0;if(0==(s=Math.floor(s/8)))break;switch(i){case 0:for(var l=r[0];e[r[0]++]>=128;);n=e.slice(l,r[0]);break;case 5:o=4,n=e.slice(r[0],r[0]+o),r[0]+=o;break;case 1:o=8,n=e.slice(r[0],r[0]+o),r[0]+=o;break;case 2:o=sN(e,r),n=e.slice(r[0],r[0]+o),r[0]+=o;break;default:throw new Error("PB Type ".concat(i," for Field ").concat(s," at offset ").concat(a))}var c={data:n,type:i};null==t[s]?t[s]=[c]:t[s].push(c)}return t}function lN(e,t){return(null==e?void 0:e.map(function(e){return t(e.data)}))||[]}function cN(e,t){if(0!=e)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],n=sN(t,r),a=[];r[0]<t.length;){var s=3&t[r[0]];if(0!=s){var i=0,o=0;if(1==s?(o=4+(t[r[0]]>>2&7),i=(224&t[r[0]++])<<3,i|=t[r[0]++]):(o=1+(t[r[0]++]>>2),2==s?(i=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(i=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),a=[nN(a)],0==i)throw new Error("Invalid offset 0");if(i>a[0].length)throw new Error("Invalid offset beyond length");if(o>=i)for(a.push(a[0].slice(-i)),o-=i;o>=a[a.length-1].length;)a.push(a[a.length-1]),o-=a[a.length-1].length;a.push(a[0].slice(-i,-i+o))}else{var l=t[r[0]++]>>2;if(l<60)++l;else{var c=l-59;l=t[r[0]],c>1&&(l|=t[r[0]+1]<<8),c>2&&(l|=t[r[0]+2]<<16),c>3&&(l|=t[r[0]+3]<<24),l>>>=0,l++,r[0]+=c}a.push(t.slice(r[0],r[0]+l)),r[0]+=l}}var d=nN(a);if(d.length!=n)throw new Error("Unexpected length: ".concat(d.length," != ").concat(n));return d}function dN(e,t,r){var n,a=tN(e),s=a.getUint32(8,!0),i=12,o=-1,l=-1,c=NaN,d=NaN,u=new Date(2001,0,1);switch(1&s&&(c=function(e,t){for(var r=(127&e[t+15])<<7|e[t+14]>>1,n=1&e[t+14],a=t+13;a>=t;--a)n=256*n+e[a];return(128&e[t+15]?-n:n)*Math.pow(10,r-6176)}(e,i),i+=16),2&s&&(d=a.getFloat64(i,!0),i+=8),4&s&&(u.setTime(u.getTime()+1e3*a.getFloat64(i,!0)),i+=8),8&s&&(l=a.getUint32(i,!0),i+=4),16&s&&(o=a.getUint32(i,!0),i+=4),e[1]){case 0:break;case 2:case 10:n={t:"n",v:c};break;case 3:n={t:"s",v:t[l]};break;case 5:n={t:"d",v:u};break;case 6:n={t:"b",v:d>0};break;case 7:n={t:"n",v:d/86400};break;case 8:n={t:"e",v:0};break;case 9:if(!(o>-1))throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(31&s," : ").concat(e.slice(0,4)));n={t:"s",v:r[o]};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(31&s," : ").concat(e.slice(0,4)))}return n}function uN(e,t,r){switch(e[0]){case 0:case 1:case 2:case 3:return function(e,t,r,n){var a,s=tN(e),i=s.getUint32(4,!0),o=(n>1?12:8)+4*aN(i&(n>1?3470:398)),l=-1,c=-1,d=NaN,u=new Date(2001,0,1);switch(512&i&&(l=s.getUint32(o,!0),o+=4),o+=4*aN(i&(n>1?12288:4096)),16&i&&(c=s.getUint32(o,!0),o+=4),32&i&&(d=s.getFloat64(o,!0),o+=8),64&i&&(u.setTime(u.getTime()+1e3*s.getFloat64(o,!0)),o+=8),e[2]){case 0:break;case 2:a={t:"n",v:d};break;case 3:a={t:"s",v:t[c]};break;case 5:a={t:"d",v:u};break;case 6:a={t:"b",v:d>0};break;case 7:a={t:"n",v:d/86400};break;case 8:a={t:"e",v:0};break;case 9:if(l>-1)a={t:"s",v:r[l]};else if(c>-1)a={t:"s",v:t[c]};else{if(isNaN(d))throw new Error("Unsupported cell type ".concat(e.slice(0,4)));a={t:"n",v:d}}break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return a}(e,t,r,e[0]);case 5:return dN(e,t,r);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function hN(e){return sN(oN(e)[1][0].data)}function fN(e,t){var r=oN(t.data),n=iN(r[1][0].data),a=r[3],s=[];return(a||[]).forEach(function(t){var r=oN(t.data),a=iN(r[1][0].data)>>>0;switch(n){case 1:s[a]=rN(r[3][0].data);break;case 8:var i=oN(e[hN(r[9][0].data)][0].data),o=e[hN(i[1][0].data)][0],l=iN(o.meta[1][0].data);if(2001!=l)throw new Error("2000 unexpected reference to ".concat(l));var c=oN(o.data);s[a]=c[3].map(function(e){return rN(e.data)}).join("")}}),s}function mN(e,t){var r,n=oN(t.data),a=(null==(r=null==n?void 0:n[7])?void 0:r[0])?iN(n[7][0].data)>>>0>0?1:0:-1,s=lN(n[5],function(e){return function(e,t){var r,n,a,s,i,o,l,c,d,u,h,f,m,p,g,x,v=oN(e),b=iN(v[1][0].data)>>>0,y=iN(v[2][0].data)>>>0,w=(null==(n=null==(r=v[8])?void 0:r[0])?void 0:n.data)&&iN(v[8][0].data)>0||!1;if((null==(s=null==(a=v[7])?void 0:a[0])?void 0:s.data)&&0!=t)g=null==(o=null==(i=v[7])?void 0:i[0])?void 0:o.data,x=null==(c=null==(l=v[6])?void 0:l[0])?void 0:c.data;else{if(!(null==(u=null==(d=v[4])?void 0:d[0])?void 0:u.data)||1==t)throw"NUMBERS Tile missing ".concat(t," cell storage");g=null==(f=null==(h=v[4])?void 0:h[0])?void 0:f.data,x=null==(p=null==(m=v[3])?void 0:m[0])?void 0:p.data}for(var _=w?4:1,k=tN(g),N=[],j=0;j<g.length/2;++j){var S=k.getUint16(2*j,!0);S<65535&&N.push([j,S])}if(N.length!=y)throw"Expected ".concat(y," cells, found ").concat(N.length);var T=[];for(j=0;j<N.length-1;++j)T[N[j][0]]=x.subarray(N[j][1]*_,N[j+1][1]*_);return N.length>=1&&(T[N[N.length-1][0]]=x.subarray(N[N.length-1][1]*_)),{R:b,cells:T}}(e,a)});return{nrows:iN(n[4][0].data)>>>0,data:s.reduce(function(e,t){return e[t.R]||(e[t.R]=[]),t.cells.forEach(function(r,n){if(e[t.R][n])throw new Error("Duplicate cell r=".concat(t.R," c=").concat(n));e[t.R][n]=r}),e},[])}}function pN(e,t){var r={"!ref":"A1"},n=e[hN(oN(t.data)[2][0].data)],a=iN(n[0].meta[1][0].data);if(6001!=a)throw new Error("6000 unexpected reference to ".concat(a));return function(e,t,r){var n,a=oN(t.data),s={s:{r:0,c:0},e:{r:0,c:0}};if(s.e.r=(iN(a[6][0].data)>>>0)-1,s.e.r<0)throw new Error("Invalid row varint ".concat(a[6][0].data));if(s.e.c=(iN(a[7][0].data)>>>0)-1,s.e.c<0)throw new Error("Invalid col varint ".concat(a[7][0].data));r["!ref"]=Kv(s);var i=oN(a[4][0].data),o=fN(e,e[hN(i[4][0].data)][0]),l=(null==(n=i[17])?void 0:n[0])?fN(e,e[hN(i[17][0].data)][0]):[],c=oN(i[3][0].data),d=0;c[1].forEach(function(t){var n=oN(t.data),a=e[hN(n[2][0].data)][0],s=iN(a.meta[1][0].data);if(6002!=s)throw new Error("6001 unexpected reference to ".concat(s));var i=mN(0,a);i.data.forEach(function(e,t){e.forEach(function(e,n){var a=Gv({r:d+t,c:n}),s=uN(e,o,l);s&&(r[a]=s)})}),d+=i.nrows})}(e,n[0],r),r}function gN(e,t){var r={SheetNames:[],Sheets:{}};if(lN(oN(t.data)[1],hN).forEach(function(t){e[t].forEach(function(t){if(2==iN(t.meta[1][0].data)){var n=function(e,t){var r,n=oN(t.data),a={name:(null==(r=n[1])?void 0:r[0])?rN(n[1][0].data):"",sheets:[]};return lN(n[2],hN).forEach(function(t){e[t].forEach(function(t){6e3==iN(t.meta[1][0].data)&&a.sheets.push(pN(e,t))})}),a}(e,t);n.sheets.forEach(function(e,t){DN(r,e,0==t?n.name:n.name+"_"+t,!0)})}})}),0==r.SheetNames.length)throw new Error("Empty NUMBERS file");return r}function xN(e){var t,r,n,a,s={},i=[];if(e.FullPaths.forEach(function(e){if(e.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(e){if(e.name.match(/\.iwa$/)){var t,r;try{t=function(e){for(var t=[],r=0;r<e.length;){var n=e[r++],a=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(cN(n,e.slice(r,r+a))),r+=a}if(r!==e.length)throw new Error("data is not a valid framed stream!");return nN(t)}(e.content)}catch(n){return console.log("?? "+e.content.length+" "+(n.message||n))}try{r=function(e){for(var t,r=[],n=[0];n[0]<e.length;){var a=sN(e,n),s=oN(e.slice(n[0],n[0]+a));n[0]+=a;var i={id:iN(s[1][0].data),messages:[]};s[2].forEach(function(t){var r=oN(t.data),a=iN(r[3][0].data);i.messages.push({meta:r,data:e.slice(n[0],n[0]+a)}),n[0]+=a}),(null==(t=s[3])?void 0:t[0])&&(i.merge=iN(s[3][0].data)>>>0>0),r.push(i)}return r}(t)}catch(n){return console.log("## "+(n.message||n))}r.forEach(function(e){s[e.id]=e.messages,i.push(e.id)})}}),!i.length)throw new Error("File has no messages");var o=(null==(a=null==(n=null==(r=null==(t=null==s?void 0:s[1])?void 0:t[0])?void 0:r.meta)?void 0:n[1])?void 0:a[0].data)&&1==iN(s[1][0].meta[1][0].data)&&s[1][0];if(o||i.forEach(function(e){s[e].forEach(function(e){if(1==iN(e.meta[1][0].data)>>>0){if(o)throw new Error("Document has multiple roots");o=e}})}),!o)throw new Error("Cannot find Document root");return gN(s,o)}function vN(e){var t;(t=[["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]],function(e){for(var r=0;r!=t.length;++r){var n=t[r];void 0===e[n[0]]&&(e[n[0]]=n[1]),"n"===n[2]&&(e[n[0]]=Number(e[n[0]]))}})(e)}function bN(e,t,r,n,a,s,i,o,l,c,d,u){try{s[n]=Cb(mx(e,r,!0),t);var h,f=fx(e,t);switch(o){case"sheet":h=fk(f,t,a,l,s[n],c,d,u);break;case"chart":if(!(h=mk(f,t,a,l,s[n],c))||!h["!drawel"])break;var m=vx(h["!drawel"].Target,t),p=Eb(m),g=function(e,t){if(!e)return"??";var r=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][r].Target}(mx(e,m,!0),Cb(mx(e,p,!0),m)),x=vx(g,m),v=Eb(x);h=tk(mx(e,x,!0),0,0,Cb(mx(e,v,!0),x),0,h);break;case"macro":y=t,s[n],y.slice(-4),h={"!type":"macro"};break;case"dialog":h=function(e,t){return t.slice(-4),{"!type":"dialog"}}(0,t,0,0,s[n]);break;default:throw new Error("Unrecognized sheet type "+o)}i[n]=h;var b=[];s&&s[n]&&Vg(s[n]).forEach(function(r){var a="";if(s[n][r].Type==Tb.CMNT){a=vx(s[n][r].Target,t);var i=xk(fx(e,a,!0),a,l);if(!i||!i.length)return;Bw(h,i,!1)}s[n][r].Type==Tb.TCMNT&&(a=vx(s[n][r].Target,t),b=b.concat(function(e,t){var r=[],n=!1,a={},s=0;return e.replace(_x,function(i,o){var l=jx(i);switch(Sx(l[0])){case"<?xml":case"<ThreadedComments":case"</ThreadedComments>":case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<threadedComment":a={author:l.personId,guid:l.id,ref:l.ref,T:1};break;case"</threadedComment>":null!=a.t&&r.push(a);break;case"<text>":case"<text":s=o+i.length;break;case"</text>":a.t=e.slice(s,o).replace(/\r\n/g,"\n").replace(/\r/g,"\n");break;case"<mentions":case"<mentions>":case"<ext":n=!0;break;case"</mentions>":case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+l[0]+" in threaded comments")}return i}),r}(fx(e,a,!0),l)))}),b&&b.length&&Bw(h,b,!0,l.people||[])}catch(w){if(l.WTF)throw w}var y}function yN(e){return"/"==e.charAt(0)?e.slice(1):e}function wN(e,t){if(Fg(),vN(t=t||{}),ux(e,"META-INF/manifest.xml"))return Qk(e,t);if(ux(e,"objectdata.xml"))return Qk(e,t);if(ux(e,"Index/Document.iwa")){if("undefined"==typeof Uint8Array)throw new Error("NUMBERS file parsing requires Uint8Array support");if(void 0!==xN){if(e.FileIndex)return xN(e);var r=zg.utils.cfb_new();return px(e).forEach(function(t){gx(r,t,function(e,t){return dx(hx(e,t))}(e,t))}),xN(r)}throw new Error("Unsupported NUMBERS file")}if(!ux(e,"[Content_Types].xml")){if(ux(e,"index.xml.gz"))throw new Error("Unsupported NUMBERS 08 file");if(ux(e,"index.xml"))throw new Error("Unsupported NUMBERS 09 file");throw new Error("Unsupported ZIP file")}var n,a,s=px(e),i=function(e){var t={workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""};if(!e||!e.match)return t;var r={};if((e.match(_x)||[]).forEach(function(e){var n=jx(e);switch(n[0].replace(kx,"<")){case"<?xml":break;case"<Types":t.xmlns=n["xmlns"+(n[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[n.Extension]=n.ContentType;break;case"<Override":void 0!==t[Sb[n.ContentType]]&&t[Sb[n.ContentType]].push(n.PartName)}}),t.xmlns!==Jx)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=r,delete t.calcchains,t}(mx(e,"[Content_Types].xml")),o=!1;if(0===i.workbooks.length&&fx(e,a="xl/workbook.xml",!0)&&i.workbooks.push(a),0===i.workbooks.length){if(!fx(e,a="xl/workbook.bin",!0))throw new Error("Could not find workbook");i.workbooks.push(a),o=!0}"bin"==i.workbooks[0].slice(-3)&&(o=!0);var l={},c={};if(!t.bookSheets&&!t.bookProps){if(R_=[],i.sst)try{R_=gk(fx(e,yN(i.sst)),i.sst,t)}catch(A){if(t.WTF)throw A}t.cellStyles&&i.themes.length&&(l=function(e,t,r){return Lw(e,r)}(mx(e,i.themes[0].replace(/^\//,""),!0)||"",i.themes[0],t)),i.style&&(c=pk(fx(e,yN(i.style)),i.style,l,t))}i.links.map(function(r){try{Cb(mx(e,Eb(yN(r))),r);return bk(fx(e,yN(r)),0,r,t)}catch(A){}});var d=hk(fx(e,yN(i.workbooks[0])),i.workbooks[0],t),u={},h="";i.coreprops.length&&((h=fx(e,yN(i.coreprops[0]),!0))&&(u=Ib(h)),0!==i.extprops.length&&(h=fx(e,yN(i.extprops[0]),!0))&&function(e,t,r){var n={};t||(t={}),e=Ux(e),Rb.forEach(function(r){var a=(e.match($x(r[0]))||[])[1];switch(r[2]){case"string":a&&(t[r[1]]=Cx(a));break;case"bool":t[r[1]]="true"===a;break;case"raw":var s=e.match(new RegExp("<"+r[0]+"[^>]*>([\\s\\S]*?)</"+r[0]+">"));s&&s.length>0&&(n[r[1]]=s[1])}}),n.HeadingPairs&&n.TitlesOfParts&&Pb(n.HeadingPairs,n.TitlesOfParts,t,r)}(h,u,t));var f={};t.bookSheets&&!t.bookProps||0!==i.custprops.length&&(h=mx(e,yN(i.custprops[0]),!0))&&(f=function(e,t){var r={},n="",a=e.match(Db);if(a)for(var s=0;s!=a.length;++s){var i=a[s],o=jx(i);switch(o[0]){case"<?xml":case"<Properties":break;case"<property":n=Cx(o.name);break;case"</property>":n=null;break;default:if(0===i.indexOf("<vt:")){var l=i.split(">"),c=l[0].slice(4),d=l[1];switch(c){case"lpstr":case"bstr":case"lpwstr":case"cy":case"error":r[n]=Cx(d);break;case"bool":r[n]=Px(d);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(d,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(d);break;case"filetime":case"date":r[n]=tx(d);break;default:if("/"==c.slice(-1))break;t.WTF&&"undefined"!=typeof console&&console.warn("Unexpected",i,c,l)}}else if("</"===i.slice(0,2));else if(t.WTF)throw new Error(i)}}return r}(h,t));var m={};if((t.bookSheets||t.bookProps)&&(d.Sheets?n=d.Sheets.map(function(e){return e.name}):u.Worksheets&&u.SheetNames.length>0&&(n=u.SheetNames),t.bookProps&&(m.Props=u,m.Custprops=f),t.bookSheets&&void 0!==n&&(m.SheetNames=n),t.bookSheets?m.SheetNames:t.bookProps))return m;n={};var p={};t.bookDeps&&i.calcchain&&(p=vk(fx(e,yN(i.calcchain)),i.calcchain));var g,x,v=0,b={},y=d.Sheets;u.Worksheets=y.length,u.SheetNames=[];for(var w=0;w!=y.length;++w)u.SheetNames[w]=y[w].name;var _=o?"bin":"xml",k=i.workbooks[0].lastIndexOf("/"),N=(i.workbooks[0].slice(0,k+1)+"_rels/"+i.workbooks[0].slice(k+1)+".rels").replace(/^\//,"");ux(e,N)||(N="xl/_rels/workbook."+_+".rels");var j=Cb(mx(e,N,!0),N.replace(/_rels.*/,"s5s"));(i.metadata||[]).length>=1&&(t.xlmeta=yk(fx(e,yN(i.metadata[0])),i.metadata[0],t)),(i.people||[]).length>=1&&(t.people=function(e,t){var r=[],n=!1;return e.replace(_x,function(e){var a=jx(e);switch(Sx(a[0])){case"<?xml":case"<personList":case"</personList>":case"</person>":case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<person":r.push({name:a.displayname,id:a.id});break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+a[0]+" in threaded comments")}return e}),r}(fx(e,yN(i.people[0])),t)),j&&(j=function(e,t){if(!e)return 0;try{e=t.map(function(t){return t.id||(t.id=t.strRelID),[t.name,e["!id"][t.id].Target,(r=e["!id"][t.id].Type,Tb.WS.indexOf(r)>-1?"sheet":r==Tb.CS?"chart":r==Tb.DS?"dialog":r==Tb.MS?"macro":r&&r.length?r:"sheet")];var r})}catch(A){return null}return e&&0!==e.length?e:null}(j,d.Sheets));var S=fx(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(v=0;v!=u.Worksheets;++v){var T="sheet";if(j&&j[v]?(g="xl/"+j[v][1].replace(/[\/]?xl\//,""),ux(e,g)||(g=j[v][1]),ux(e,g)||(g=N.replace(/_rels\/.*$/,"")+j[v][1]),T=j[v][2]):g=(g="xl/worksheets/sheet"+(v+1-S)+"."+_).replace(/sheet0\./,"sheet."),x=g.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&null!=t.sheets)switch(typeof t.sheets){case"number":if(v!=t.sheets)continue e;break;case"string":if(u.SheetNames[v].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var E=!1,C=0;C!=t.sheets.length;++C)"number"==typeof t.sheets[C]&&t.sheets[C]==v&&(E=1),"string"==typeof t.sheets[C]&&t.sheets[C].toLowerCase()==u.SheetNames[v].toLowerCase()&&(E=1);if(!E)continue e}}bN(e,g,x,u.SheetNames[v],v,b,n,T,t,d,l,c)}return m={Directory:i,Workbook:d,Props:u,Custprops:f,Deps:p,Sheets:n,SheetNames:u.SheetNames,Strings:R_,Styles:c,Themes:l,SSF:nx(ag)},t&&t.bookFiles&&(e.files?(m.keys=s,m.files=e.files):(m.keys=[],m.files={},e.FullPaths.forEach(function(t,r){t=t.replace(/^Root Entry[\/]/,""),m.keys.push(t),m.files[t]=e.FileIndex[r]}))),t&&t.bookVBA&&(i.vba.length>0?m.vbaraw=fx(e,yN(i.vba[0]),!0):i.defaults&&"application/vnd.ms-office.vbaProject"===i.defaults.bin&&(m.vbaraw=fx(e,"xl/vbaProject.bin",!0))),m}function _N(e,t){var r,n,a=t||{},s="Workbook",i=zg.find(e,s);try{if(s="/!DataSpaces/Version",!(i=zg.find(e,s))||!i.content)throw new Error("ECMA-376 Encrypted file missing "+s);if(r=i.content,(n={}).id=r.read_shift(0,"lpp4"),n.R=Jy(r,4),n.U=Jy(r,4),n.W=Jy(r,4),s="/!DataSpaces/DataSpaceMap",!(i=zg.find(e,s))||!i.content)throw new Error("ECMA-376 Encrypted file missing "+s);var o=function(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(Zy(e));return t}(i.content);if(1!==o.length||1!==o[0].comps.length||0!==o[0].comps[0].t||"StrongEncryptionDataSpace"!==o[0].name||"EncryptedPackage"!==o[0].comps[0].v)throw new Error("ECMA-376 Encrypted file bad "+s);if(s="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",!(i=zg.find(e,s))||!i.content)throw new Error("ECMA-376 Encrypted file missing "+s);var l=function(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(e.read_shift(0,"lpp4"));return t}(i.content);if(1!=l.length||"StrongEncryptionTransform"!=l[0])throw new Error("ECMA-376 Encrypted file bad "+s);if(s="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",!(i=zg.find(e,s))||!i.content)throw new Error("ECMA-376 Encrypted file missing "+s);Qy(i.content)}catch(d){}if(s="/EncryptionInfo",!(i=zg.find(e,s))||!i.content)throw new Error("ECMA-376 Encrypted file missing "+s);var c=function(e){var t=Jy(e);switch(t.Minor){case 2:return[t.Minor,rw(e)];case 3:return[t.Minor,nw()];case 4:return[t.Minor,aw(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}(i.content);if(s="/EncryptedPackage",!(i=zg.find(e,s))||!i.content)throw new Error("ECMA-376 Encrypted file missing "+s);if(4==c[0]&&"undefined"!=typeof decrypt_agile)return decrypt_agile(c[1],i.content,a.password||"",a);if(2==c[0]&&"undefined"!=typeof decrypt_std76)return decrypt_std76(c[1],i.content,a.password||"",a);throw new Error("File is password-protected")}function kN(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=Fp(e.slice(0,12));break;case"binary":r=e;break;default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function NN(e,t){var r=0;e:for(;r<e.length;)switch(e.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return Ik(e.slice(r),t);default:break e}return Uy.to_workbook(e,t)}function jN(e,t,r,n){return n?(r.type="string",Uy.to_workbook(e,r)):Uy.to_workbook(t,r)}function SN(e,t){Cp();var r=t||{};if("undefined"!=typeof ArrayBuffer&&e instanceof ArrayBuffer)return SN(new Uint8Array(e),((r=nx(r)).type="array",r));"undefined"!=typeof Uint8Array&&e instanceof Uint8Array&&!r.type&&(r.type="undefined"!=typeof Deno?"buffer":"array");var n,a=e,s=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),P_={},r.dateNF&&(P_.dateNF=r.dateNF),r.type||(r.type=Up&&Buffer.isBuffer(e)?"buffer":"base64"),"file"==r.type&&(r.type=Up?"buffer":"binary",a=function(e){if("undefined"!=typeof Deno)return Deno.readFileSync(e);if("undefined"!=typeof $&&"undefined"!=typeof File&&"undefined"!=typeof Folder)try{var t=File(e);t.open("r"),t.encoding="binary";var r=t.read();return t.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+e)}(e),"undefined"==typeof Uint8Array||Up||(r.type="array")),"string"==r.type&&(s=!0,r.type="binary",r.codepage=65001,a=function(e){return e.match(/[^\x00-\x7F]/)?Bx(e):e}(e)),"array"==r.type&&"undefined"!=typeof Uint8Array&&e instanceof Uint8Array&&"undefined"!=typeof ArrayBuffer){var i=new ArrayBuffer(3),o=new Uint8Array(i);if(o.foo="bar",!o.foo)return(r=nx(r)).type="array",SN(Hp(a),r)}switch((n=kN(a,r))[0]){case 208:if(207===n[1]&&17===n[2]&&224===n[3]&&161===n[4]&&177===n[5]&&26===n[6]&&225===n[7])return function(e,t){return zg.find(e,"EncryptedPackage")?_N(e,t):$k(e,t)}(zg.read(a,r),r);break;case 9:if(n[1]<=8)return $k(a,r);break;case 60:return Ik(a,r);case 73:if(73===n[1]&&42===n[2]&&0===n[3])throw new Error("TIFF Image File is not a spreadsheet");if(68===n[1])return function(e,t){var r=t||{},n=!!r.WTF;r.WTF=!0;try{var a=Ly.to_workbook(e,r);return r.WTF=n,a}catch(s){if(r.WTF=n,!s.message.match(/SYLK bad record ID/)&&n)throw s;return Uy.to_workbook(e,t)}}(a,r);break;case 84:if(65===n[1]&&66===n[2]&&76===n[3])return My.to_workbook(a,r);break;case 80:return 75===n[1]&&n[2]<9&&n[3]<9?function(e,t){var r=e,n=t||{};return n.type||(n.type=Up&&Buffer.isBuffer(e)?"buffer":"base64"),wN(xx(r,n),n)}(a,r):jN(e,a,r,s);case 239:return 60===n[3]?Ik(a,r):jN(e,a,r,s);case 255:if(254===n[1])return function(e,t){var r=e;return"base64"==t.type&&(r=Fp(r)),r=Ip.utils.decode(1200,r.slice(2),"str"),t.type="binary",NN(r,t)}(a,r);if(0===n[1]&&2===n[2]&&0===n[3])return By.to_workbook(a,r);break;case 0:if(0===n[1]){if(n[2]>=2&&0===n[3])return By.to_workbook(a,r);if(0===n[2]&&(8===n[3]||9===n[3]))return By.to_workbook(a,r)}break;case 3:case 131:case 139:case 140:return Dy.to_workbook(a,r);case 123:if(92===n[1]&&114===n[2]&&116===n[3])return cw.to_workbook(a,r);break;case 10:case 13:case 32:return function(e,t){var r="",n=kN(e,t);switch(t.type){case"base64":r=Fp(e);break;case"binary":r=e;break;case"buffer":r=e.toString("binary");break;case"array":r=rx(e);break;default:throw new Error("Unrecognized type "+t.type)}return 239==n[0]&&187==n[1]&&191==n[2]&&(r=Ux(r)),t.type="binary",NN(r,t)}(a,r);case 137:if(80===n[1]&&78===n[2]&&71===n[3])throw new Error("PNG Image File is not a spreadsheet")}return Py.indexOf(n[0])>-1&&n[2]<=12&&n[3]<=31?Dy.to_workbook(a,r):jN(e,a,r,s)}function TN(e,t,r,n,a,s,i,o){var l=zv(r),c=o.defval,d=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),u=!0,h=1===a?[]:{};if(1!==a)if(Object.defineProperty)try{Object.defineProperty(h,"__rowNum__",{value:r,enumerable:!1})}catch(g){h.__rowNum__=r}else h.__rowNum__=r;if(!i||e[r])for(var f=t.s.c;f<=t.e.c;++f){var m=i?e[r][f]:e[n[f]+l];if(void 0!==m&&void 0!==m.t){var p=m.v;switch(m.t){case"z":if(null==p)break;continue;case"e":p=0==p?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+m.t)}if(null!=s[f]){if(null==p)if("e"==m.t&&null===p)h[s[f]]=null;else if(void 0!==c)h[s[f]]=c;else{if(!d||null!==p)continue;h[s[f]]=null}else h[s[f]]=d&&("n"!==m.t||"n"===m.t&&!1!==o.rawNumbers)?p:Jv(m,p,o);null!=p&&(u=!1)}}else{if(void 0===c)continue;null!=s[f]&&(h[s[f]]=c)}}return{row:h,isempty:u}}function EN(e,t){if(null==e||null==e["!ref"])return[];var r={t:"n",v:0},n=0,a=1,s=[],i=0,o="",l={s:{r:0,c:0},e:{r:0,c:0}},c=t||{},d=null!=c.range?c.range:e["!ref"];switch(1===c.header?n=1:"A"===c.header?n=2:Array.isArray(c.header)?n=3:null==c.header&&(n=0),typeof d){case"string":l=Xv(d);break;case"number":(l=Xv(e["!ref"])).s.r=d;break;default:l=d}n>0&&(a=0);var u=zv(l.s.r),h=[],f=[],m=0,p=0,g=Array.isArray(e),x=l.s.r,v=0,b={};g&&!e[x]&&(e[x]=[]);var y=c.skipHidden&&e["!cols"]||[],w=c.skipHidden&&e["!rows"]||[];for(v=l.s.c;v<=l.e.c;++v)if(!(y[v]||{}).hidden)switch(h[v]=Wv(v),r=g?e[x][v]:e[h[v]+u],n){case 1:s[v]=v-l.s.c;break;case 2:s[v]=h[v];break;case 3:s[v]=c.header[v-l.s.c];break;default:if(null==r&&(r={w:"__EMPTY",t:"s"}),o=i=Jv(r,null,c),p=b[i]||0){do{o=i+"_"+p++}while(b[o]);b[i]=p,b[o]=1}else b[i]=1;s[v]=o}for(x=l.s.r+a;x<=l.e.r;++x)if(!(w[x]||{}).hidden){var _=TN(e,l,x,h,n,s,g,c);(!1===_.isempty||(1===n?!1!==c.blankrows:c.blankrows))&&(f[m++]=_.row)}return f.length=m,f}var CN=/"/g;function AN(e,t,r,n,a,s,i,o){for(var l=!0,c=[],d="",u=zv(r),h=t.s.c;h<=t.e.c;++h)if(n[h]){var f=o.dense?(e[r]||[])[h]:e[n[h]+u];if(null==f)d="";else if(null!=f.v){l=!1,d=""+(o.rawNumbers&&"n"==f.t?f.v:Jv(f,null,o));for(var m=0,p=0;m!==d.length;++m)if((p=d.charCodeAt(m))===a||p===s||34===p||o.forceQuotes){d='"'+d.replace(CN,'""')+'"';break}"ID"==d&&(d='"ID"')}else null==f.f||f.F?d="":(l=!1,(d="="+f.f).indexOf(",")>=0&&(d='"'+d.replace(CN,'""')+'"'));c.push(d)}return!1===o.blankrows&&l?null:c.join(i)}function ON(e,t){var r=[],n=null==t?{}:t;if(null==e||null==e["!ref"])return"";var a=Xv(e["!ref"]),s=void 0!==n.FS?n.FS:",",i=s.charCodeAt(0),o=void 0!==n.RS?n.RS:"\n",l=o.charCodeAt(0),c=new RegExp(("|"==s?"\\|":s)+"+$"),d="",u=[];n.dense=Array.isArray(e);for(var h=n.skipHidden&&e["!cols"]||[],f=n.skipHidden&&e["!rows"]||[],m=a.s.c;m<=a.e.c;++m)(h[m]||{}).hidden||(u[m]=Wv(m));for(var p=0,g=a.s.r;g<=a.e.r;++g)(f[g]||{}).hidden||null!=(d=AN(e,a,g,u,i,l,s,n))&&(n.strip&&(d=d.replace(c,"")),(d||!1!==n.blankrows)&&r.push((p++?o:"")+d));return delete n.dense,r.join("")}function IN(e,t,r){var n,a=r||{},s=+!a.skipHeader,i=e||{},o=0,l=0;if(i&&null!=a.origin)if("number"==typeof a.origin)o=a.origin;else{var c="string"==typeof a.origin?Hv(a.origin):a.origin;o=c.r,l=c.c}var d={s:{c:0,r:0},e:{c:l,r:o+t.length-1+s}};if(i["!ref"]){var u=Xv(i["!ref"]);d.e.c=Math.max(d.e.c,u.e.c),d.e.r=Math.max(d.e.r,u.e.r),-1==o&&(o=u.e.r+1,d.e.r=o+t.length-1+s)}else-1==o&&(o=0,d.e.r=t.length-1+s);var h=a.header||[],f=0;t.forEach(function(e,t){Vg(e).forEach(function(r){-1==(f=h.indexOf(r))&&(h[f=h.length]=r);var c=e[r],d="z",u="",m=Gv({c:l+f,r:o+t+s});n=RN(i,m),!c||"object"!=typeof c||c instanceof Date?("number"==typeof c?d="n":"boolean"==typeof c?d="b":"string"==typeof c?d="s":c instanceof Date?(d="d",a.cellDates||(d="n",c=Gg(c)),u=a.dateNF||ag[14]):null===c&&a.nullError&&(d="e",c=0),n?(n.t=d,n.v=c,delete n.w,delete n.R,u&&(n.z=u)):i[m]=n={t:d,v:c},u&&(n.z=u)):i[m]=c})}),d.e.c=Math.max(d.e.c,l+h.length-1);var m=zv(o);if(s)for(f=0;f<h.length;++f)i[Wv(f+l)+m]={t:"s",v:h[f]};return i["!ref"]=Kv(d),i}function RN(e,t,r){if("string"==typeof t){if(Array.isArray(e)){var n=Hv(t);return e[n.r]||(e[n.r]=[]),e[n.r][n.c]||(e[n.r][n.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return RN(e,Gv("number"!=typeof t?t:{r:t,c:r||0}))}function PN(){return{SheetNames:[],Sheets:{}}}function DN(e,t,r,n){var a=1;if(!r)for(;a<=65535&&-1!=e.SheetNames.indexOf(r="Sheet"+a);++a,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&e.SheetNames.indexOf(r)>=0){var s=r.match(/(^.*?)(\d+)$/);a=s&&+s[2]||0;var i=s&&s[1]||r;for(++a;a<=65535&&-1!=e.SheetNames.indexOf(r=i+a);++a);}if(function(e){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");ck.forEach(function(t){if(-1!=e.indexOf(t))throw new Error("Sheet name cannot contain : \\ / ? * [ ]")})}(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function LN(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}var MN={encode_col:Wv,encode_row:zv,encode_cell:Gv,encode_range:Kv,decode_col:Vv,decode_row:$v,split_cell:function(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")},decode_cell:Hv,decode_range:qv,format_cell:Jv,sheet_add_aoa:Qv,sheet_add_json:IN,sheet_add_dom:qk,aoa_to_sheet:eb,json_to_sheet:function(e,t){return IN(null,e,t)},table_to_sheet:Kk,table_to_book:function(e,t){return Zv(Kk(e,t),t)},sheet_to_csv:ON,sheet_to_txt:function(e,t){return t||(t={}),t.FS="\t",t.RS="\n",ON(e,t)},sheet_to_json:EN,sheet_to_html:function(e,t){var r=t||{},n=null!=r.header?r.header:'<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',a=null!=r.footer?r.footer:"</body></html>",s=[n],i=qv(e["!ref"]);r.dense=Array.isArray(e),s.push(function(e,t,r){return[].join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}(0,0,r));for(var o=i.s.r;o<=i.e.r;++o)s.push(Gk(e,i,o,r));return s.push("</table>"+a),s.join("")},sheet_to_formulae:function(e){var t,r="",n="";if(null==e||null==e["!ref"])return[];var a,s=Xv(e["!ref"]),i="",o=[],l=[],c=Array.isArray(e);for(a=s.s.c;a<=s.e.c;++a)o[a]=Wv(a);for(var d=s.s.r;d<=s.e.r;++d)for(i=zv(d),a=s.s.c;a<=s.e.c;++a)if(r=o[a]+i,n="",void 0!==(t=c?(e[d]||[])[a]:e[r])){if(null!=t.F){if(r=t.F,!t.f)continue;n=t.f,-1==r.indexOf(":")&&(r=r+":"+r)}if(null!=t.f)n=t.f;else{if("z"==t.t)continue;if("n"==t.t&&null!=t.v)n=""+t.v;else if("b"==t.t)n=t.v?"TRUE":"FALSE";else if(void 0!==t.w)n="'"+t.w;else{if(void 0===t.v)continue;n="s"==t.t?"'"+t.v:""+t.v}}l[l.length]=r+"="+n}return l},sheet_to_row_object_array:EN,sheet_get_cell:RN,book_new:PN,book_append_sheet:DN,book_set_sheet_visibility:function(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var n=function(e,t){if("number"==typeof t){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}if("string"==typeof t){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}throw new Error("Cannot find sheet |"+t+"|")}(e,t);switch(e.Workbook.Sheets[n]||(e.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[n].Hidden=r},cell_set_number_format:function(e,t){return e.z=t,e},cell_set_hyperlink:LN,cell_set_internal_link:function(e,t,r){return LN(e,"#"+t,r)},cell_add_comment:function(e,t,r){e.c||(e.c=[]),e.c.push({t:t,a:r||"SheetJS"})},sheet_set_array_formula:function(e,t,r,n){for(var a="string"!=typeof t?t:Xv(t),s="string"==typeof t?t:Kv(t),i=a.s.r;i<=a.e.r;++i)for(var o=a.s.c;o<=a.e.c;++o){var l=RN(e,i,o);l.t="n",l.F=s,delete l.v,i==a.s.r&&o==a.s.c&&(l.f=r,n&&(l.D=!0))}return e},consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};function FN(e){throw new Error('Could not dynamically require "'+e+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var UN={exports:{}};
/*!

JSZip v3.10.1 - A JavaScript class for generating and reading zip files
<http://stuartk.com/jszip>

(c) 2009-2016 Stuart Knightley <stuart [at] stuartk.com>
Dual licenced under the MIT license or GPLv3. See https://raw.github.com/Stuk/jszip/main/LICENSE.markdown.

JSZip uses the library pako released under the MIT license :
https://github.com/nodeca/pako/blob/main/LICENSE
*/UN.exports=function e(t,r,n){function a(i,o){if(!r[i]){if(!t[i]){if(!o&&FN)return FN(i);if(s)return s(i,!0);var l=new Error("Cannot find module '"+i+"'");throw l.code="MODULE_NOT_FOUND",l}var c=r[i]={exports:{}};t[i][0].call(c.exports,function(e){return a(t[i][1][e]||e)},c,c.exports,e,t,r,n)}return r[i].exports}for(var s=FN,i=0;i<n.length;i++)a(n[i]);return a}({1:[function(e,t,r){var n=e("./utils"),a=e("./support"),s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";r.encode=function(e){for(var t,r,a,i,o,l,c,d=[],u=0,h=e.length,f=h,m="string"!==n.getTypeOf(e);u<e.length;)f=h-u,a=m?(t=e[u++],r=u<h?e[u++]:0,u<h?e[u++]:0):(t=e.charCodeAt(u++),r=u<h?e.charCodeAt(u++):0,u<h?e.charCodeAt(u++):0),i=t>>2,o=(3&t)<<4|r>>4,l=1<f?(15&r)<<2|a>>6:64,c=2<f?63&a:64,d.push(s.charAt(i)+s.charAt(o)+s.charAt(l)+s.charAt(c));return d.join("")},r.decode=function(e){var t,r,n,i,o,l,c=0,d=0,u="data:";if(e.substr(0,u.length)===u)throw new Error("Invalid base64 input, it looks like a data url.");var h,f=3*(e=e.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(e.charAt(e.length-1)===s.charAt(64)&&f--,e.charAt(e.length-2)===s.charAt(64)&&f--,f%1!=0)throw new Error("Invalid base64 input, bad content length.");for(h=a.uint8array?new Uint8Array(0|f):new Array(0|f);c<e.length;)t=s.indexOf(e.charAt(c++))<<2|(i=s.indexOf(e.charAt(c++)))>>4,r=(15&i)<<4|(o=s.indexOf(e.charAt(c++)))>>2,n=(3&o)<<6|(l=s.indexOf(e.charAt(c++))),h[d++]=t,64!==o&&(h[d++]=r),64!==l&&(h[d++]=n);return h}},{"./support":30,"./utils":32}],2:[function(e,t,r){var n=e("./external"),a=e("./stream/DataWorker"),s=e("./stream/Crc32Probe"),i=e("./stream/DataLengthProbe");function o(e,t,r,n,a){this.compressedSize=e,this.uncompressedSize=t,this.crc32=r,this.compression=n,this.compressedContent=a}o.prototype={getContentWorker:function(){var e=new a(n.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new i("data_length")),t=this;return e.on("end",function(){if(this.streamInfo.data_length!==t.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),e},getCompressedWorker:function(){return new a(n.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},o.createWorkerFrom=function(e,t,r){return e.pipe(new s).pipe(new i("uncompressedSize")).pipe(t.compressWorker(r)).pipe(new i("compressedSize")).withStreamInfo("compression",t)},t.exports=o},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(e,t,r){var n=e("./stream/GenericWorker");r.STORE={magic:"\0\0",compressWorker:function(){return new n("STORE compression")},uncompressWorker:function(){return new n("STORE decompression")}},r.DEFLATE=e("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(e,t,r){var n=e("./utils"),a=function(){for(var e,t=[],r=0;r<256;r++){e=r;for(var n=0;n<8;n++)e=1&e?3988292384^e>>>1:e>>>1;t[r]=e}return t}();t.exports=function(e,t){return void 0!==e&&e.length?"string"!==n.getTypeOf(e)?function(e,t,r,n){var s=a,i=n+r;e^=-1;for(var o=n;o<i;o++)e=e>>>8^s[255&(e^t[o])];return-1^e}(0|t,e,e.length,0):function(e,t,r,n){var s=a,i=n+r;e^=-1;for(var o=n;o<i;o++)e=e>>>8^s[255&(e^t.charCodeAt(o))];return-1^e}(0|t,e,e.length,0):0}},{"./utils":32}],5:[function(e,t,r){r.base64=!1,r.binary=!1,r.dir=!1,r.createFolders=!0,r.date=null,r.compression=null,r.compressionOptions=null,r.comment=null,r.unixPermissions=null,r.dosPermissions=null},{}],6:[function(e,t,r){var n=null;n="undefined"!=typeof Promise?Promise:e("lie"),t.exports={Promise:n}},{lie:37}],7:[function(e,t,r){var n="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Uint32Array,a=e("pako"),s=e("./utils"),i=e("./stream/GenericWorker"),o=n?"uint8array":"array";function l(e,t){i.call(this,"FlateWorker/"+e),this._pako=null,this._pakoAction=e,this._pakoOptions=t,this.meta={}}r.magic="\b\0",s.inherits(l,i),l.prototype.processChunk=function(e){this.meta=e.meta,null===this._pako&&this._createPako(),this._pako.push(s.transformTo(o,e.data),!1)},l.prototype.flush=function(){i.prototype.flush.call(this),null===this._pako&&this._createPako(),this._pako.push([],!0)},l.prototype.cleanUp=function(){i.prototype.cleanUp.call(this),this._pako=null},l.prototype._createPako=function(){this._pako=new a[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var e=this;this._pako.onData=function(t){e.push({data:t,meta:e.meta})}},r.compressWorker=function(e){return new l("Deflate",e)},r.uncompressWorker=function(){return new l("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(e,t,r){function n(e,t){var r,n="";for(r=0;r<t;r++)n+=String.fromCharCode(255&e),e>>>=8;return n}function a(e,t,r,a,i,d){var u,h,f=e.file,m=e.compression,p=d!==o.utf8encode,g=s.transformTo("string",d(f.name)),x=s.transformTo("string",o.utf8encode(f.name)),v=f.comment,b=s.transformTo("string",d(v)),y=s.transformTo("string",o.utf8encode(v)),w=x.length!==f.name.length,_=y.length!==v.length,k="",N="",j="",S=f.dir,T=f.date,E={crc32:0,compressedSize:0,uncompressedSize:0};t&&!r||(E.crc32=e.crc32,E.compressedSize=e.compressedSize,E.uncompressedSize=e.uncompressedSize);var C=0;t&&(C|=8),p||!w&&!_||(C|=2048);var A,O,I,R=0,P=0;S&&(R|=16),"UNIX"===i?(P=798,R|=(A=f.unixPermissions,O=S,I=A,A||(I=O?16893:33204),(65535&I)<<16)):(P=20,R|=function(e){return 63&(e||0)}(f.dosPermissions)),u=T.getUTCHours(),u<<=6,u|=T.getUTCMinutes(),u<<=5,u|=T.getUTCSeconds()/2,h=T.getUTCFullYear()-1980,h<<=4,h|=T.getUTCMonth()+1,h<<=5,h|=T.getUTCDate(),w&&(N=n(1,1)+n(l(g),4)+x,k+="up"+n(N.length,2)+N),_&&(j=n(1,1)+n(l(b),4)+y,k+="uc"+n(j.length,2)+j);var D="";return D+="\n\0",D+=n(C,2),D+=m.magic,D+=n(u,2),D+=n(h,2),D+=n(E.crc32,4),D+=n(E.compressedSize,4),D+=n(E.uncompressedSize,4),D+=n(g.length,2),D+=n(k.length,2),{fileRecord:c.LOCAL_FILE_HEADER+D+g+k,dirRecord:c.CENTRAL_FILE_HEADER+n(P,2)+D+n(b.length,2)+"\0\0\0\0"+n(R,4)+n(a,4)+g+k+b}}var s=e("../utils"),i=e("../stream/GenericWorker"),o=e("../utf8"),l=e("../crc32"),c=e("../signature");function d(e,t,r,n){i.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=t,this.zipPlatform=r,this.encodeFileName=n,this.streamFiles=e,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}s.inherits(d,i),d.prototype.push=function(e){var t=e.meta.percent||0,r=this.entriesCount,n=this._sources.length;this.accumulate?this.contentBuffer.push(e):(this.bytesWritten+=e.data.length,i.prototype.push.call(this,{data:e.data,meta:{currentFile:this.currentFile,percent:r?(t+100*(r-n-1))/r:100}}))},d.prototype.openedSource=function(e){this.currentSourceOffset=this.bytesWritten,this.currentFile=e.file.name;var t=this.streamFiles&&!e.file.dir;if(t){var r=a(e,t,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:r.fileRecord,meta:{percent:0}})}else this.accumulate=!0},d.prototype.closedSource=function(e){this.accumulate=!1;var t,r=this.streamFiles&&!e.file.dir,s=a(e,r,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(s.dirRecord),r)this.push({data:(t=e,c.DATA_DESCRIPTOR+n(t.crc32,4)+n(t.compressedSize,4)+n(t.uncompressedSize,4)),meta:{percent:100}});else for(this.push({data:s.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},d.prototype.flush=function(){for(var e=this.bytesWritten,t=0;t<this.dirRecords.length;t++)this.push({data:this.dirRecords[t],meta:{percent:100}});var r,a,i,o,l,d,u=this.bytesWritten-e,h=(r=this.dirRecords.length,a=u,i=e,o=this.zipComment,l=this.encodeFileName,d=s.transformTo("string",l(o)),c.CENTRAL_DIRECTORY_END+"\0\0\0\0"+n(r,2)+n(r,2)+n(a,4)+n(i,4)+n(d.length,2)+d);this.push({data:h,meta:{percent:100}})},d.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},d.prototype.registerPrevious=function(e){this._sources.push(e);var t=this;return e.on("data",function(e){t.processChunk(e)}),e.on("end",function(){t.closedSource(t.previous.streamInfo),t._sources.length?t.prepareNextSource():t.end()}),e.on("error",function(e){t.error(e)}),this},d.prototype.resume=function(){return!!i.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},d.prototype.error=function(e){var t=this._sources;if(!i.prototype.error.call(this,e))return!1;for(var r=0;r<t.length;r++)try{t[r].error(e)}catch(n){}return!0},d.prototype.lock=function(){i.prototype.lock.call(this);for(var e=this._sources,t=0;t<e.length;t++)e[t].lock()},t.exports=d},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(e,t,r){var n=e("../compressions"),a=e("./ZipFileWorker");r.generateWorker=function(e,t,r){var s=new a(t.streamFiles,r,t.platform,t.encodeFileName),i=0;try{e.forEach(function(e,r){i++;var a=function(e,t){var r=e||t,a=n[r];if(!a)throw new Error(r+" is not a valid compression method !");return a}(r.options.compression,t.compression),o=r.options.compressionOptions||t.compressionOptions||{},l=r.dir,c=r.date;r._compressWorker(a,o).withStreamInfo("file",{name:e,dir:l,date:c,comment:r.comment||"",unixPermissions:r.unixPermissions,dosPermissions:r.dosPermissions}).pipe(s)}),s.entriesCount=i}catch(o){s.error(o)}return s}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(e,t,r){function n(){if(!(this instanceof n))return new n;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var e=new n;for(var t in this)"function"!=typeof this[t]&&(e[t]=this[t]);return e}}(n.prototype=e("./object")).loadAsync=e("./load"),n.support=e("./support"),n.defaults=e("./defaults"),n.version="3.10.1",n.loadAsync=function(e,t){return(new n).loadAsync(e,t)},n.external=e("./external"),t.exports=n},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(e,t,r){var n=e("./utils"),a=e("./external"),s=e("./utf8"),i=e("./zipEntries"),o=e("./stream/Crc32Probe"),l=e("./nodejsUtils");function c(e){return new a.Promise(function(t,r){var n=e.decompressed.getContentWorker().pipe(new o);n.on("error",function(e){r(e)}).on("end",function(){n.streamInfo.crc32!==e.decompressed.crc32?r(new Error("Corrupted zip : CRC32 mismatch")):t()}).resume()})}t.exports=function(e,t){var r=this;return t=n.extend(t||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:s.utf8decode}),l.isNode&&l.isStream(e)?a.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):n.prepareContent("the loaded zip file",e,!0,t.optimizedBinaryString,t.base64).then(function(e){var r=new i(t);return r.load(e),r}).then(function(e){var r=[a.Promise.resolve(e)],n=e.files;if(t.checkCRC32)for(var s=0;s<n.length;s++)r.push(c(n[s]));return a.Promise.all(r)}).then(function(e){for(var a=e.shift(),s=a.files,i=0;i<s.length;i++){var o=s[i],l=o.fileNameStr,c=n.resolve(o.fileNameStr);r.file(c,o.decompressed,{binary:!0,optimizedBinaryString:!0,date:o.date,dir:o.dir,comment:o.fileCommentStr.length?o.fileCommentStr:null,unixPermissions:o.unixPermissions,dosPermissions:o.dosPermissions,createFolders:t.createFolders}),o.dir||(r.file(c).unsafeOriginalName=l)}return a.zipComment.length&&(r.comment=a.zipComment),r})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(e,t,r){var n=e("../utils"),a=e("../stream/GenericWorker");function s(e,t){a.call(this,"Nodejs stream input adapter for "+e),this._upstreamEnded=!1,this._bindStream(t)}n.inherits(s,a),s.prototype._bindStream=function(e){var t=this;(this._stream=e).pause(),e.on("data",function(e){t.push({data:e,meta:{percent:0}})}).on("error",function(e){t.isPaused?this.generatedError=e:t.error(e)}).on("end",function(){t.isPaused?t._upstreamEnded=!0:t.end()})},s.prototype.pause=function(){return!!a.prototype.pause.call(this)&&(this._stream.pause(),!0)},s.prototype.resume=function(){return!!a.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},t.exports=s},{"../stream/GenericWorker":28,"../utils":32}],13:[function(e,t,r){var n=e("readable-stream").Readable;function a(e,t,r){n.call(this,t),this._helper=e;var a=this;e.on("data",function(e,t){a.push(e)||a._helper.pause(),r&&r(t)}).on("error",function(e){a.emit("error",e)}).on("end",function(){a.push(null)})}e("../utils").inherits(a,n),a.prototype._read=function(){this._helper.resume()},t.exports=a},{"../utils":32,"readable-stream":16}],14:[function(e,t,r){t.exports={isNode:"undefined"!=typeof Buffer,newBufferFrom:function(e,t){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(e,t);if("number"==typeof e)throw new Error('The "data" argument must not be a number');return new Buffer(e,t)},allocBuffer:function(e){if(Buffer.alloc)return Buffer.alloc(e);var t=new Buffer(e);return t.fill(0),t},isBuffer:function(e){return Buffer.isBuffer(e)},isStream:function(e){return e&&"function"==typeof e.on&&"function"==typeof e.pause&&"function"==typeof e.resume}}},{}],15:[function(e,t,r){function n(e,t,r){var n,a=s.getTypeOf(t),o=s.extend(r||{},l);o.date=o.date||new Date,null!==o.compression&&(o.compression=o.compression.toUpperCase()),"string"==typeof o.unixPermissions&&(o.unixPermissions=parseInt(o.unixPermissions,8)),o.unixPermissions&&16384&o.unixPermissions&&(o.dir=!0),o.dosPermissions&&16&o.dosPermissions&&(o.dir=!0),o.dir&&(e=p(e)),o.createFolders&&(n=m(e))&&g.call(this,n,!0);var u="string"===a&&!1===o.binary&&!1===o.base64;r&&void 0!==r.binary||(o.binary=!u),(t instanceof c&&0===t.uncompressedSize||o.dir||!t||0===t.length)&&(o.base64=!1,o.binary=!0,t="",o.compression="STORE",a="string");var x=null;x=t instanceof c||t instanceof i?t:h.isNode&&h.isStream(t)?new f(e,t):s.prepareContent(e,t,o.binary,o.optimizedBinaryString,o.base64);var v=new d(e,x,o);this.files[e]=v}var a=e("./utf8"),s=e("./utils"),i=e("./stream/GenericWorker"),o=e("./stream/StreamHelper"),l=e("./defaults"),c=e("./compressedObject"),d=e("./zipObject"),u=e("./generate"),h=e("./nodejsUtils"),f=e("./nodejs/NodejsStreamInputAdapter"),m=function(e){"/"===e.slice(-1)&&(e=e.substring(0,e.length-1));var t=e.lastIndexOf("/");return 0<t?e.substring(0,t):""},p=function(e){return"/"!==e.slice(-1)&&(e+="/"),e},g=function(e,t){return t=void 0!==t?t:l.createFolders,e=p(e),this.files[e]||n.call(this,e,null,{dir:!0,createFolders:t}),this.files[e]};function x(e){return"[object RegExp]"===Object.prototype.toString.call(e)}var v={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(e){var t,r,n;for(t in this.files)n=this.files[t],(r=t.slice(this.root.length,t.length))&&t.slice(0,this.root.length)===this.root&&e(r,n)},filter:function(e){var t=[];return this.forEach(function(r,n){e(r,n)&&t.push(n)}),t},file:function(e,t,r){if(1!==arguments.length)return e=this.root+e,n.call(this,e,t,r),this;if(x(e)){var a=e;return this.filter(function(e,t){return!t.dir&&a.test(e)})}var s=this.files[this.root+e];return s&&!s.dir?s:null},folder:function(e){if(!e)return this;if(x(e))return this.filter(function(t,r){return r.dir&&e.test(t)});var t=this.root+e,r=g.call(this,t),n=this.clone();return n.root=r.name,n},remove:function(e){e=this.root+e;var t=this.files[e];if(t||("/"!==e.slice(-1)&&(e+="/"),t=this.files[e]),t&&!t.dir)delete this.files[e];else for(var r=this.filter(function(t,r){return r.name.slice(0,e.length)===e}),n=0;n<r.length;n++)delete this.files[r[n].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(e){var t,r={};try{if((r=s.extend(e||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:a.utf8encode})).type=r.type.toLowerCase(),r.compression=r.compression.toUpperCase(),"binarystring"===r.type&&(r.type="string"),!r.type)throw new Error("No output type specified.");s.checkSupport(r.type),"darwin"!==r.platform&&"freebsd"!==r.platform&&"linux"!==r.platform&&"sunos"!==r.platform||(r.platform="UNIX"),"win32"===r.platform&&(r.platform="DOS");var n=r.comment||this.comment||"";t=u.generateWorker(this,r,n)}catch(l){(t=new i("error")).error(l)}return new o(t,r.type||"string",r.mimeType)},generateAsync:function(e,t){return this.generateInternalStream(e).accumulate(t)},generateNodeStream:function(e,t){return(e=e||{}).type||(e.type="nodebuffer"),this.generateInternalStream(e).toNodejsStream(t)}};t.exports=v},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(e,t,r){t.exports=e("stream")},{stream:void 0}],17:[function(e,t,r){var n=e("./DataReader");function a(e){n.call(this,e);for(var t=0;t<this.data.length;t++)e[t]=255&e[t]}e("../utils").inherits(a,n),a.prototype.byteAt=function(e){return this.data[this.zero+e]},a.prototype.lastIndexOfSignature=function(e){for(var t=e.charCodeAt(0),r=e.charCodeAt(1),n=e.charCodeAt(2),a=e.charCodeAt(3),s=this.length-4;0<=s;--s)if(this.data[s]===t&&this.data[s+1]===r&&this.data[s+2]===n&&this.data[s+3]===a)return s-this.zero;return-1},a.prototype.readAndCheckSignature=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1),n=e.charCodeAt(2),a=e.charCodeAt(3),s=this.readData(4);return t===s[0]&&r===s[1]&&n===s[2]&&a===s[3]},a.prototype.readData=function(e){if(this.checkOffset(e),0===e)return[];var t=this.data.slice(this.zero+this.index,this.zero+this.index+e);return this.index+=e,t},t.exports=a},{"../utils":32,"./DataReader":18}],18:[function(e,t,r){var n=e("../utils");function a(e){this.data=e,this.length=e.length,this.index=0,this.zero=0}a.prototype={checkOffset:function(e){this.checkIndex(this.index+e)},checkIndex:function(e){if(this.length<this.zero+e||e<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+e+"). Corrupted zip ?")},setIndex:function(e){this.checkIndex(e),this.index=e},skip:function(e){this.setIndex(this.index+e)},byteAt:function(){},readInt:function(e){var t,r=0;for(this.checkOffset(e),t=this.index+e-1;t>=this.index;t--)r=(r<<8)+this.byteAt(t);return this.index+=e,r},readString:function(e){return n.transformTo("string",this.readData(e))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var e=this.readInt(4);return new Date(Date.UTC(1980+(e>>25&127),(e>>21&15)-1,e>>16&31,e>>11&31,e>>5&63,(31&e)<<1))}},t.exports=a},{"../utils":32}],19:[function(e,t,r){var n=e("./Uint8ArrayReader");function a(e){n.call(this,e)}e("../utils").inherits(a,n),a.prototype.readData=function(e){this.checkOffset(e);var t=this.data.slice(this.zero+this.index,this.zero+this.index+e);return this.index+=e,t},t.exports=a},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(e,t,r){var n=e("./DataReader");function a(e){n.call(this,e)}e("../utils").inherits(a,n),a.prototype.byteAt=function(e){return this.data.charCodeAt(this.zero+e)},a.prototype.lastIndexOfSignature=function(e){return this.data.lastIndexOf(e)-this.zero},a.prototype.readAndCheckSignature=function(e){return e===this.readData(4)},a.prototype.readData=function(e){this.checkOffset(e);var t=this.data.slice(this.zero+this.index,this.zero+this.index+e);return this.index+=e,t},t.exports=a},{"../utils":32,"./DataReader":18}],21:[function(e,t,r){var n=e("./ArrayReader");function a(e){n.call(this,e)}e("../utils").inherits(a,n),a.prototype.readData=function(e){if(this.checkOffset(e),0===e)return new Uint8Array(0);var t=this.data.subarray(this.zero+this.index,this.zero+this.index+e);return this.index+=e,t},t.exports=a},{"../utils":32,"./ArrayReader":17}],22:[function(e,t,r){var n=e("../utils"),a=e("../support"),s=e("./ArrayReader"),i=e("./StringReader"),o=e("./NodeBufferReader"),l=e("./Uint8ArrayReader");t.exports=function(e){var t=n.getTypeOf(e);return n.checkSupport(t),"string"!==t||a.uint8array?"nodebuffer"===t?new o(e):a.uint8array?new l(n.transformTo("uint8array",e)):new s(n.transformTo("array",e)):new i(e)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(e,t,r){r.LOCAL_FILE_HEADER="PK",r.CENTRAL_FILE_HEADER="PK",r.CENTRAL_DIRECTORY_END="PK",r.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK",r.ZIP64_CENTRAL_DIRECTORY_END="PK",r.DATA_DESCRIPTOR="PK\b"},{}],24:[function(e,t,r){var n=e("./GenericWorker"),a=e("../utils");function s(e){n.call(this,"ConvertWorker to "+e),this.destType=e}a.inherits(s,n),s.prototype.processChunk=function(e){this.push({data:a.transformTo(this.destType,e.data),meta:e.meta})},t.exports=s},{"../utils":32,"./GenericWorker":28}],25:[function(e,t,r){var n=e("./GenericWorker"),a=e("../crc32");function s(){n.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}e("../utils").inherits(s,n),s.prototype.processChunk=function(e){this.streamInfo.crc32=a(e.data,this.streamInfo.crc32||0),this.push(e)},t.exports=s},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(e,t,r){var n=e("../utils"),a=e("./GenericWorker");function s(e){a.call(this,"DataLengthProbe for "+e),this.propName=e,this.withStreamInfo(e,0)}n.inherits(s,a),s.prototype.processChunk=function(e){if(e){var t=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=t+e.data.length}a.prototype.processChunk.call(this,e)},t.exports=s},{"../utils":32,"./GenericWorker":28}],27:[function(e,t,r){var n=e("../utils"),a=e("./GenericWorker");function s(e){a.call(this,"DataWorker");var t=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,e.then(function(e){t.dataIsReady=!0,t.data=e,t.max=e&&e.length||0,t.type=n.getTypeOf(e),t.isPaused||t._tickAndRepeat()},function(e){t.error(e)})}n.inherits(s,a),s.prototype.cleanUp=function(){a.prototype.cleanUp.call(this),this.data=null},s.prototype.resume=function(){return!!a.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,n.delay(this._tickAndRepeat,[],this)),!0)},s.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(n.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},s.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var e=null,t=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":e=this.data.substring(this.index,t);break;case"uint8array":e=this.data.subarray(this.index,t);break;case"array":case"nodebuffer":e=this.data.slice(this.index,t)}return this.index=t,this.push({data:e,meta:{percent:this.max?this.index/this.max*100:0}})},t.exports=s},{"../utils":32,"./GenericWorker":28}],28:[function(e,t,r){function n(e){this.name=e||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}n.prototype={push:function(e){this.emit("data",e)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(e){this.emit("error",e)}return!0},error:function(e){return!this.isFinished&&(this.isPaused?this.generatedError=e:(this.isFinished=!0,this.emit("error",e),this.previous&&this.previous.error(e),this.cleanUp()),!0)},on:function(e,t){return this._listeners[e].push(t),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(e,t){if(this._listeners[e])for(var r=0;r<this._listeners[e].length;r++)this._listeners[e][r].call(this,t)},pipe:function(e){return e.registerPrevious(this)},registerPrevious:function(e){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=e.streamInfo,this.mergeStreamInfo(),this.previous=e;var t=this;return e.on("data",function(e){t.processChunk(e)}),e.on("end",function(){t.end()}),e.on("error",function(e){t.error(e)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var e=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),e=!0),this.previous&&this.previous.resume(),!e},flush:function(){},processChunk:function(e){this.push(e)},withStreamInfo:function(e,t){return this.extraStreamInfo[e]=t,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var e in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,e)&&(this.streamInfo[e]=this.extraStreamInfo[e])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var e="Worker "+this.name;return this.previous?this.previous+" -> "+e:e}},t.exports=n},{}],29:[function(e,t,r){var n=e("../utils"),a=e("./ConvertWorker"),s=e("./GenericWorker"),i=e("../base64"),o=e("../support"),l=e("../external"),c=null;if(o.nodestream)try{c=e("../nodejs/NodejsStreamOutputAdapter")}catch(h){}function d(e,t){return new l.Promise(function(r,a){var s=[],o=e._internalType,l=e._outputType,c=e._mimeType;e.on("data",function(e,r){s.push(e),t&&t(r)}).on("error",function(e){s=[],a(e)}).on("end",function(){try{var e=function(e,t,r){switch(e){case"blob":return n.newBlob(n.transformTo("arraybuffer",t),r);case"base64":return i.encode(t);default:return n.transformTo(e,t)}}(l,function(e,t){var r,n=0,a=null,s=0;for(r=0;r<t.length;r++)s+=t[r].length;switch(e){case"string":return t.join("");case"array":return Array.prototype.concat.apply([],t);case"uint8array":for(a=new Uint8Array(s),r=0;r<t.length;r++)a.set(t[r],n),n+=t[r].length;return a;case"nodebuffer":return Buffer.concat(t);default:throw new Error("concat : unsupported type '"+e+"'")}}(o,s),c);r(e)}catch(t){a(t)}s=[]}).resume()})}function u(e,t,r){var i=t;switch(t){case"blob":case"arraybuffer":i="uint8array";break;case"base64":i="string"}try{this._internalType=i,this._outputType=t,this._mimeType=r,n.checkSupport(i),this._worker=e.pipe(new a(i)),e.lock()}catch(o){this._worker=new s("error"),this._worker.error(o)}}u.prototype={accumulate:function(e){return d(this,e)},on:function(e,t){var r=this;return"data"===e?this._worker.on(e,function(e){t.call(r,e.data,e.meta)}):this._worker.on(e,function(){n.delay(t,arguments,r)}),this},resume:function(){return n.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(e){if(n.checkSupport("nodestream"),"nodebuffer"!==this._outputType)throw new Error(this._outputType+" is not supported by this method");return new c(this,{objectMode:"nodebuffer"!==this._outputType},e)}},t.exports=u},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(e,t,r){if(r.base64=!0,r.array=!0,r.string=!0,r.arraybuffer="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof Uint8Array,r.nodebuffer="undefined"!=typeof Buffer,r.uint8array="undefined"!=typeof Uint8Array,"undefined"==typeof ArrayBuffer)r.blob=!1;else{var n=new ArrayBuffer(0);try{r.blob=0===new Blob([n],{type:"application/zip"}).size}catch(s){try{var a=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);a.append(n),r.blob=0===a.getBlob("application/zip").size}catch(i){r.blob=!1}}}try{r.nodestream=!!e("readable-stream").Readable}catch(s){r.nodestream=!1}},{"readable-stream":16}],31:[function(e,t,r){for(var n=e("./utils"),a=e("./support"),s=e("./nodejsUtils"),i=e("./stream/GenericWorker"),o=new Array(256),l=0;l<256;l++)o[l]=252<=l?6:248<=l?5:240<=l?4:224<=l?3:192<=l?2:1;function c(){i.call(this,"utf-8 decode"),this.leftOver=null}function d(){i.call(this,"utf-8 encode")}o[254]=o[254]=1,r.utf8encode=function(e){return a.nodebuffer?s.newBufferFrom(e,"utf-8"):function(e){var t,r,n,s,i,o=e.length,l=0;for(s=0;s<o;s++)55296==(64512&(r=e.charCodeAt(s)))&&s+1<o&&56320==(64512&(n=e.charCodeAt(s+1)))&&(r=65536+(r-55296<<10)+(n-56320),s++),l+=r<128?1:r<2048?2:r<65536?3:4;for(t=a.uint8array?new Uint8Array(l):new Array(l),s=i=0;i<l;s++)55296==(64512&(r=e.charCodeAt(s)))&&s+1<o&&56320==(64512&(n=e.charCodeAt(s+1)))&&(r=65536+(r-55296<<10)+(n-56320),s++),r<128?t[i++]=r:(r<2048?t[i++]=192|r>>>6:(r<65536?t[i++]=224|r>>>12:(t[i++]=240|r>>>18,t[i++]=128|r>>>12&63),t[i++]=128|r>>>6&63),t[i++]=128|63&r);return t}(e)},r.utf8decode=function(e){return a.nodebuffer?n.transformTo("nodebuffer",e).toString("utf-8"):function(e){var t,r,a,s,i=e.length,l=new Array(2*i);for(t=r=0;t<i;)if((a=e[t++])<128)l[r++]=a;else if(4<(s=o[a]))l[r++]=65533,t+=s-1;else{for(a&=2===s?31:3===s?15:7;1<s&&t<i;)a=a<<6|63&e[t++],s--;1<s?l[r++]=65533:a<65536?l[r++]=a:(a-=65536,l[r++]=55296|a>>10&1023,l[r++]=56320|1023&a)}return l.length!==r&&(l.subarray?l=l.subarray(0,r):l.length=r),n.applyFromCharCode(l)}(e=n.transformTo(a.uint8array?"uint8array":"array",e))},n.inherits(c,i),c.prototype.processChunk=function(e){var t=n.transformTo(a.uint8array?"uint8array":"array",e.data);if(this.leftOver&&this.leftOver.length){if(a.uint8array){var s=t;(t=new Uint8Array(s.length+this.leftOver.length)).set(this.leftOver,0),t.set(s,this.leftOver.length)}else t=this.leftOver.concat(t);this.leftOver=null}var i=function(e,t){var r;for((t=t||e.length)>e.length&&(t=e.length),r=t-1;0<=r&&128==(192&e[r]);)r--;return r<0||0===r?t:r+o[e[r]]>t?r:t}(t),l=t;i!==t.length&&(a.uint8array?(l=t.subarray(0,i),this.leftOver=t.subarray(i,t.length)):(l=t.slice(0,i),this.leftOver=t.slice(i,t.length))),this.push({data:r.utf8decode(l),meta:e.meta})},c.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:r.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},r.Utf8DecodeWorker=c,n.inherits(d,i),d.prototype.processChunk=function(e){this.push({data:r.utf8encode(e.data),meta:e.meta})},r.Utf8EncodeWorker=d},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(e,t,r){var n=e("./support"),a=e("./base64"),s=e("./nodejsUtils"),i=e("./external");function o(e){return e}function l(e,t){for(var r=0;r<e.length;++r)t[r]=255&e.charCodeAt(r);return t}e("setimmediate"),r.newBlob=function(e,t){r.checkSupport("blob");try{return new Blob([e],{type:t})}catch(a){try{var n=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return n.append(e),n.getBlob(t)}catch(s){throw new Error("Bug : can't construct the Blob.")}}};var c={stringifyByChunk:function(e,t,r){var n=[],a=0,s=e.length;if(s<=r)return String.fromCharCode.apply(null,e);for(;a<s;)"array"===t||"nodebuffer"===t?n.push(String.fromCharCode.apply(null,e.slice(a,Math.min(a+r,s)))):n.push(String.fromCharCode.apply(null,e.subarray(a,Math.min(a+r,s)))),a+=r;return n.join("")},stringifyByChar:function(e){for(var t="",r=0;r<e.length;r++)t+=String.fromCharCode(e[r]);return t},applyCanBeUsed:{uint8array:function(){try{return n.uint8array&&1===String.fromCharCode.apply(null,new Uint8Array(1)).length}catch(e){return!1}}(),nodebuffer:function(){try{return n.nodebuffer&&1===String.fromCharCode.apply(null,s.allocBuffer(1)).length}catch(e){return!1}}()}};function d(e){var t=65536,n=r.getTypeOf(e),a=!0;if("uint8array"===n?a=c.applyCanBeUsed.uint8array:"nodebuffer"===n&&(a=c.applyCanBeUsed.nodebuffer),a)for(;1<t;)try{return c.stringifyByChunk(e,n,t)}catch(s){t=Math.floor(t/2)}return c.stringifyByChar(e)}function u(e,t){for(var r=0;r<e.length;r++)t[r]=e[r];return t}r.applyFromCharCode=d;var h={};h.string={string:o,array:function(e){return l(e,new Array(e.length))},arraybuffer:function(e){return h.string.uint8array(e).buffer},uint8array:function(e){return l(e,new Uint8Array(e.length))},nodebuffer:function(e){return l(e,s.allocBuffer(e.length))}},h.array={string:d,array:o,arraybuffer:function(e){return new Uint8Array(e).buffer},uint8array:function(e){return new Uint8Array(e)},nodebuffer:function(e){return s.newBufferFrom(e)}},h.arraybuffer={string:function(e){return d(new Uint8Array(e))},array:function(e){return u(new Uint8Array(e),new Array(e.byteLength))},arraybuffer:o,uint8array:function(e){return new Uint8Array(e)},nodebuffer:function(e){return s.newBufferFrom(new Uint8Array(e))}},h.uint8array={string:d,array:function(e){return u(e,new Array(e.length))},arraybuffer:function(e){return e.buffer},uint8array:o,nodebuffer:function(e){return s.newBufferFrom(e)}},h.nodebuffer={string:d,array:function(e){return u(e,new Array(e.length))},arraybuffer:function(e){return h.nodebuffer.uint8array(e).buffer},uint8array:function(e){return u(e,new Uint8Array(e.length))},nodebuffer:o},r.transformTo=function(e,t){if(t=t||"",!e)return t;r.checkSupport(e);var n=r.getTypeOf(t);return h[n][e](t)},r.resolve=function(e){for(var t=e.split("/"),r=[],n=0;n<t.length;n++){var a=t[n];"."===a||""===a&&0!==n&&n!==t.length-1||(".."===a?r.pop():r.push(a))}return r.join("/")},r.getTypeOf=function(e){return"string"==typeof e?"string":"[object Array]"===Object.prototype.toString.call(e)?"array":n.nodebuffer&&s.isBuffer(e)?"nodebuffer":n.uint8array&&e instanceof Uint8Array?"uint8array":n.arraybuffer&&e instanceof ArrayBuffer?"arraybuffer":void 0},r.checkSupport=function(e){if(!n[e.toLowerCase()])throw new Error(e+" is not supported by this platform")},r.MAX_VALUE_16BITS=65535,r.MAX_VALUE_32BITS=-1,r.pretty=function(e){var t,r,n="";for(r=0;r<(e||"").length;r++)n+="\\x"+((t=e.charCodeAt(r))<16?"0":"")+t.toString(16).toUpperCase();return n},r.delay=function(e,t,r){setImmediate(function(){e.apply(r||null,t||[])})},r.inherits=function(e,t){function r(){}r.prototype=t.prototype,e.prototype=new r},r.extend=function(){var e,t,r={};for(e=0;e<arguments.length;e++)for(t in arguments[e])Object.prototype.hasOwnProperty.call(arguments[e],t)&&void 0===r[t]&&(r[t]=arguments[e][t]);return r},r.prepareContent=function(e,t,s,o,c){return i.Promise.resolve(t).then(function(e){return n.blob&&(e instanceof Blob||-1!==["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(e)))&&"undefined"!=typeof FileReader?new i.Promise(function(t,r){var n=new FileReader;n.onload=function(e){t(e.target.result)},n.onerror=function(e){r(e.target.error)},n.readAsArrayBuffer(e)}):e}).then(function(t){var d,u=r.getTypeOf(t);return u?("arraybuffer"===u?t=r.transformTo("uint8array",t):"string"===u&&(c?t=a.decode(t):s&&!0!==o&&(t=l(d=t,n.uint8array?new Uint8Array(d.length):new Array(d.length)))),t):i.Promise.reject(new Error("Can't read the data of '"+e+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(e,t,r){var n=e("./reader/readerFor"),a=e("./utils"),s=e("./signature"),i=e("./zipEntry"),o=e("./support");function l(e){this.files=[],this.loadOptions=e}l.prototype={checkSignature:function(e){if(!this.reader.readAndCheckSignature(e)){this.reader.index-=4;var t=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+a.pretty(t)+", expected "+a.pretty(e)+")")}},isSignature:function(e,t){var r=this.reader.index;this.reader.setIndex(e);var n=this.reader.readString(4)===t;return this.reader.setIndex(r),n},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var e=this.reader.readData(this.zipCommentLength),t=o.uint8array?"uint8array":"array",r=a.transformTo(t,e);this.zipComment=this.loadOptions.decodeFileName(r)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var e,t,r,n=this.zip64EndOfCentralSize-44;0<n;)e=this.reader.readInt(2),t=this.reader.readInt(4),r=this.reader.readData(t),this.zip64ExtensibleData[e]={id:e,length:t,value:r}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var e,t;for(e=0;e<this.files.length;e++)t=this.files[e],this.reader.setIndex(t.localHeaderOffset),this.checkSignature(s.LOCAL_FILE_HEADER),t.readLocalPart(this.reader),t.handleUTF8(),t.processAttributes()},readCentralDir:function(){var e;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(s.CENTRAL_FILE_HEADER);)(e=new i({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(e);if(this.centralDirRecords!==this.files.length&&0!==this.centralDirRecords&&0===this.files.length)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var e=this.reader.lastIndexOfSignature(s.CENTRAL_DIRECTORY_END);if(e<0)throw this.isSignature(0,s.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(e);var t=e;if(this.checkSignature(s.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===a.MAX_VALUE_16BITS||this.diskWithCentralDirStart===a.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===a.MAX_VALUE_16BITS||this.centralDirRecords===a.MAX_VALUE_16BITS||this.centralDirSize===a.MAX_VALUE_32BITS||this.centralDirOffset===a.MAX_VALUE_32BITS){if(this.zip64=!0,(e=this.reader.lastIndexOfSignature(s.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(e),this.checkSignature(s.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,s.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(s.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(s.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var r=this.centralDirOffset+this.centralDirSize;this.zip64&&(r+=20,r+=12+this.zip64EndOfCentralSize);var n=t-r;if(0<n)this.isSignature(t,s.CENTRAL_FILE_HEADER)||(this.reader.zero=n);else if(n<0)throw new Error("Corrupted zip: missing "+Math.abs(n)+" bytes.")},prepareReader:function(e){this.reader=n(e)},load:function(e){this.prepareReader(e),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},t.exports=l},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(e,t,r){var n=e("./reader/readerFor"),a=e("./utils"),s=e("./compressedObject"),i=e("./crc32"),o=e("./utf8"),l=e("./compressions"),c=e("./support");function d(e,t){this.options=e,this.loadOptions=t}d.prototype={isEncrypted:function(){return!(1&~this.bitFlag)},useUTF8:function(){return!(2048&~this.bitFlag)},readLocalPart:function(e){var t,r;if(e.skip(22),this.fileNameLength=e.readInt(2),r=e.readInt(2),this.fileName=e.readData(this.fileNameLength),e.skip(r),-1===this.compressedSize||-1===this.uncompressedSize)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if(null===(t=function(e){for(var t in l)if(Object.prototype.hasOwnProperty.call(l,t)&&l[t].magic===e)return l[t];return null}(this.compressionMethod)))throw new Error("Corrupted zip : compression "+a.pretty(this.compressionMethod)+" unknown (inner file : "+a.transformTo("string",this.fileName)+")");this.decompressed=new s(this.compressedSize,this.uncompressedSize,this.crc32,t,e.readData(this.compressedSize))},readCentralPart:function(e){this.versionMadeBy=e.readInt(2),e.skip(2),this.bitFlag=e.readInt(2),this.compressionMethod=e.readString(2),this.date=e.readDate(),this.crc32=e.readInt(4),this.compressedSize=e.readInt(4),this.uncompressedSize=e.readInt(4);var t=e.readInt(2);if(this.extraFieldsLength=e.readInt(2),this.fileCommentLength=e.readInt(2),this.diskNumberStart=e.readInt(2),this.internalFileAttributes=e.readInt(2),this.externalFileAttributes=e.readInt(4),this.localHeaderOffset=e.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");e.skip(t),this.readExtraFields(e),this.parseZIP64ExtraField(e),this.fileComment=e.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var e=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),0==e&&(this.dosPermissions=63&this.externalFileAttributes),3==e&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||"/"!==this.fileNameStr.slice(-1)||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var e=n(this.extraFields[1].value);this.uncompressedSize===a.MAX_VALUE_32BITS&&(this.uncompressedSize=e.readInt(8)),this.compressedSize===a.MAX_VALUE_32BITS&&(this.compressedSize=e.readInt(8)),this.localHeaderOffset===a.MAX_VALUE_32BITS&&(this.localHeaderOffset=e.readInt(8)),this.diskNumberStart===a.MAX_VALUE_32BITS&&(this.diskNumberStart=e.readInt(4))}},readExtraFields:function(e){var t,r,n,a=e.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});e.index+4<a;)t=e.readInt(2),r=e.readInt(2),n=e.readData(r),this.extraFields[t]={id:t,length:r,value:n};e.setIndex(a)},handleUTF8:function(){var e=c.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=o.utf8decode(this.fileName),this.fileCommentStr=o.utf8decode(this.fileComment);else{var t=this.findExtraFieldUnicodePath();if(null!==t)this.fileNameStr=t;else{var r=a.transformTo(e,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(r)}var n=this.findExtraFieldUnicodeComment();if(null!==n)this.fileCommentStr=n;else{var s=a.transformTo(e,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(s)}}},findExtraFieldUnicodePath:function(){var e=this.extraFields[28789];if(e){var t=n(e.value);return 1!==t.readInt(1)||i(this.fileName)!==t.readInt(4)?null:o.utf8decode(t.readData(e.length-5))}return null},findExtraFieldUnicodeComment:function(){var e=this.extraFields[25461];if(e){var t=n(e.value);return 1!==t.readInt(1)||i(this.fileComment)!==t.readInt(4)?null:o.utf8decode(t.readData(e.length-5))}return null}},t.exports=d},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(e,t,r){function n(e,t,r){this.name=e,this.dir=r.dir,this.date=r.date,this.comment=r.comment,this.unixPermissions=r.unixPermissions,this.dosPermissions=r.dosPermissions,this._data=t,this._dataBinary=r.binary,this.options={compression:r.compression,compressionOptions:r.compressionOptions}}var a=e("./stream/StreamHelper"),s=e("./stream/DataWorker"),i=e("./utf8"),o=e("./compressedObject"),l=e("./stream/GenericWorker");n.prototype={internalStream:function(e){var t=null,r="string";try{if(!e)throw new Error("No output type specified.");var n="string"===(r=e.toLowerCase())||"text"===r;"binarystring"!==r&&"text"!==r||(r="string"),t=this._decompressWorker();var s=!this._dataBinary;s&&!n&&(t=t.pipe(new i.Utf8EncodeWorker)),!s&&n&&(t=t.pipe(new i.Utf8DecodeWorker))}catch(o){(t=new l("error")).error(o)}return new a(t,r,"")},async:function(e,t){return this.internalStream(e).accumulate(t)},nodeStream:function(e,t){return this.internalStream(e||"nodebuffer").toNodejsStream(t)},_compressWorker:function(e,t){if(this._data instanceof o&&this._data.compression.magic===e.magic)return this._data.getCompressedWorker();var r=this._decompressWorker();return this._dataBinary||(r=r.pipe(new i.Utf8EncodeWorker)),o.createWorkerFrom(r,e,t)},_decompressWorker:function(){return this._data instanceof o?this._data.getContentWorker():this._data instanceof l?this._data:new s(this._data)}};for(var c=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],d=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},u=0;u<c.length;u++)n.prototype[c[u]]=d;t.exports=n},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(e,t,n){(function(e){var r,n,a=e.MutationObserver||e.WebKitMutationObserver;if(a){var s=0,i=new a(d),o=e.document.createTextNode("");i.observe(o,{characterData:!0}),r=function(){o.data=s=++s%2}}else if(e.setImmediate||void 0===e.MessageChannel)r="document"in e&&"onreadystatechange"in e.document.createElement("script")?function(){var t=e.document.createElement("script");t.onreadystatechange=function(){d(),t.onreadystatechange=null,t.parentNode.removeChild(t),t=null},e.document.documentElement.appendChild(t)}:function(){setTimeout(d,0)};else{var l=new e.MessageChannel;l.port1.onmessage=d,r=function(){l.port2.postMessage(0)}}var c=[];function d(){var e,t;n=!0;for(var r=c.length;r;){for(t=c,c=[],e=-1;++e<r;)t[e]();r=c.length}n=!1}t.exports=function(e){1!==c.push(e)||n||r()}}).call(this,void 0!==r?r:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],37:[function(e,t,r){var n=e("immediate");function a(){}var s={},i=["REJECTED"],o=["FULFILLED"],l=["PENDING"];function c(e){if("function"!=typeof e)throw new TypeError("resolver must be a function");this.state=l,this.queue=[],this.outcome=void 0,e!==a&&f(this,e)}function d(e,t,r){this.promise=e,"function"==typeof t&&(this.onFulfilled=t,this.callFulfilled=this.otherCallFulfilled),"function"==typeof r&&(this.onRejected=r,this.callRejected=this.otherCallRejected)}function u(e,t,r){n(function(){var n;try{n=t(r)}catch(a){return s.reject(e,a)}n===e?s.reject(e,new TypeError("Cannot resolve promise with itself")):s.resolve(e,n)})}function h(e){var t=e&&e.then;if(e&&("object"==typeof e||"function"==typeof e)&&"function"==typeof t)return function(){t.apply(e,arguments)}}function f(e,t){var r=!1;function n(t){r||(r=!0,s.reject(e,t))}function a(t){r||(r=!0,s.resolve(e,t))}var i=m(function(){t(a,n)});"error"===i.status&&n(i.value)}function m(e,t){var r={};try{r.value=e(t),r.status="success"}catch(n){r.status="error",r.value=n}return r}(t.exports=c).prototype.finally=function(e){if("function"!=typeof e)return this;var t=this.constructor;return this.then(function(r){return t.resolve(e()).then(function(){return r})},function(r){return t.resolve(e()).then(function(){throw r})})},c.prototype.catch=function(e){return this.then(null,e)},c.prototype.then=function(e,t){if("function"!=typeof e&&this.state===o||"function"!=typeof t&&this.state===i)return this;var r=new this.constructor(a);return this.state!==l?u(r,this.state===o?e:t,this.outcome):this.queue.push(new d(r,e,t)),r},d.prototype.callFulfilled=function(e){s.resolve(this.promise,e)},d.prototype.otherCallFulfilled=function(e){u(this.promise,this.onFulfilled,e)},d.prototype.callRejected=function(e){s.reject(this.promise,e)},d.prototype.otherCallRejected=function(e){u(this.promise,this.onRejected,e)},s.resolve=function(e,t){var r=m(h,t);if("error"===r.status)return s.reject(e,r.value);var n=r.value;if(n)f(e,n);else{e.state=o,e.outcome=t;for(var a=-1,i=e.queue.length;++a<i;)e.queue[a].callFulfilled(t)}return e},s.reject=function(e,t){e.state=i,e.outcome=t;for(var r=-1,n=e.queue.length;++r<n;)e.queue[r].callRejected(t);return e},c.resolve=function(e){return e instanceof this?e:s.resolve(new this(a),e)},c.reject=function(e){var t=new this(a);return s.reject(t,e)},c.all=function(e){var t=this;if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(new TypeError("must be an array"));var r=e.length,n=!1;if(!r)return this.resolve([]);for(var i=new Array(r),o=0,l=-1,c=new this(a);++l<r;)d(e[l],l);return c;function d(e,a){t.resolve(e).then(function(e){i[a]=e,++o!==r||n||(n=!0,s.resolve(c,i))},function(e){n||(n=!0,s.reject(c,e))})}},c.race=function(e){var t=this;if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(new TypeError("must be an array"));var r=e.length,n=!1;if(!r)return this.resolve([]);for(var i,o=-1,l=new this(a);++o<r;)i=e[o],t.resolve(i).then(function(e){n||(n=!0,s.resolve(l,e))},function(e){n||(n=!0,s.reject(l,e))});return l}},{immediate:36}],38:[function(e,t,r){var n={};(0,e("./lib/utils/common").assign)(n,e("./lib/deflate"),e("./lib/inflate"),e("./lib/zlib/constants")),t.exports=n},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(e,t,r){var n=e("./zlib/deflate"),a=e("./utils/common"),s=e("./utils/strings"),i=e("./zlib/messages"),o=e("./zlib/zstream"),l=Object.prototype.toString,c=0,d=-1,u=0,h=8;function f(e){if(!(this instanceof f))return new f(e);this.options=a.assign({level:d,method:h,chunkSize:16384,windowBits:15,memLevel:8,strategy:u,to:""},e||{});var t=this.options;t.raw&&0<t.windowBits?t.windowBits=-t.windowBits:t.gzip&&0<t.windowBits&&t.windowBits<16&&(t.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new o,this.strm.avail_out=0;var r=n.deflateInit2(this.strm,t.level,t.method,t.windowBits,t.memLevel,t.strategy);if(r!==c)throw new Error(i[r]);if(t.header&&n.deflateSetHeader(this.strm,t.header),t.dictionary){var m;if(m="string"==typeof t.dictionary?s.string2buf(t.dictionary):"[object ArrayBuffer]"===l.call(t.dictionary)?new Uint8Array(t.dictionary):t.dictionary,(r=n.deflateSetDictionary(this.strm,m))!==c)throw new Error(i[r]);this._dict_set=!0}}function m(e,t){var r=new f(t);if(r.push(e,!0),r.err)throw r.msg||i[r.err];return r.result}f.prototype.push=function(e,t){var r,i,o=this.strm,d=this.options.chunkSize;if(this.ended)return!1;i=t===~~t?t:!0===t?4:0,"string"==typeof e?o.input=s.string2buf(e):"[object ArrayBuffer]"===l.call(e)?o.input=new Uint8Array(e):o.input=e,o.next_in=0,o.avail_in=o.input.length;do{if(0===o.avail_out&&(o.output=new a.Buf8(d),o.next_out=0,o.avail_out=d),1!==(r=n.deflate(o,i))&&r!==c)return this.onEnd(r),!(this.ended=!0);0!==o.avail_out&&(0!==o.avail_in||4!==i&&2!==i)||("string"===this.options.to?this.onData(s.buf2binstring(a.shrinkBuf(o.output,o.next_out))):this.onData(a.shrinkBuf(o.output,o.next_out)))}while((0<o.avail_in||0===o.avail_out)&&1!==r);return 4===i?(r=n.deflateEnd(this.strm),this.onEnd(r),this.ended=!0,r===c):2!==i||(this.onEnd(c),!(o.avail_out=0))},f.prototype.onData=function(e){this.chunks.push(e)},f.prototype.onEnd=function(e){e===c&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=a.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg},r.Deflate=f,r.deflate=m,r.deflateRaw=function(e,t){return(t=t||{}).raw=!0,m(e,t)},r.gzip=function(e,t){return(t=t||{}).gzip=!0,m(e,t)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(e,t,r){var n=e("./zlib/inflate"),a=e("./utils/common"),s=e("./utils/strings"),i=e("./zlib/constants"),o=e("./zlib/messages"),l=e("./zlib/zstream"),c=e("./zlib/gzheader"),d=Object.prototype.toString;function u(e){if(!(this instanceof u))return new u(e);this.options=a.assign({chunkSize:16384,windowBits:0,to:""},e||{});var t=this.options;t.raw&&0<=t.windowBits&&t.windowBits<16&&(t.windowBits=-t.windowBits,0===t.windowBits&&(t.windowBits=-15)),!(0<=t.windowBits&&t.windowBits<16)||e&&e.windowBits||(t.windowBits+=32),15<t.windowBits&&t.windowBits<48&&!(15&t.windowBits)&&(t.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new l,this.strm.avail_out=0;var r=n.inflateInit2(this.strm,t.windowBits);if(r!==i.Z_OK)throw new Error(o[r]);this.header=new c,n.inflateGetHeader(this.strm,this.header)}function h(e,t){var r=new u(t);if(r.push(e,!0),r.err)throw r.msg||o[r.err];return r.result}u.prototype.push=function(e,t){var r,o,l,c,u,h,f=this.strm,m=this.options.chunkSize,p=this.options.dictionary,g=!1;if(this.ended)return!1;o=t===~~t?t:!0===t?i.Z_FINISH:i.Z_NO_FLUSH,"string"==typeof e?f.input=s.binstring2buf(e):"[object ArrayBuffer]"===d.call(e)?f.input=new Uint8Array(e):f.input=e,f.next_in=0,f.avail_in=f.input.length;do{if(0===f.avail_out&&(f.output=new a.Buf8(m),f.next_out=0,f.avail_out=m),(r=n.inflate(f,i.Z_NO_FLUSH))===i.Z_NEED_DICT&&p&&(h="string"==typeof p?s.string2buf(p):"[object ArrayBuffer]"===d.call(p)?new Uint8Array(p):p,r=n.inflateSetDictionary(this.strm,h)),r===i.Z_BUF_ERROR&&!0===g&&(r=i.Z_OK,g=!1),r!==i.Z_STREAM_END&&r!==i.Z_OK)return this.onEnd(r),!(this.ended=!0);f.next_out&&(0!==f.avail_out&&r!==i.Z_STREAM_END&&(0!==f.avail_in||o!==i.Z_FINISH&&o!==i.Z_SYNC_FLUSH)||("string"===this.options.to?(l=s.utf8border(f.output,f.next_out),c=f.next_out-l,u=s.buf2string(f.output,l),f.next_out=c,f.avail_out=m-c,c&&a.arraySet(f.output,f.output,l,c,0),this.onData(u)):this.onData(a.shrinkBuf(f.output,f.next_out)))),0===f.avail_in&&0===f.avail_out&&(g=!0)}while((0<f.avail_in||0===f.avail_out)&&r!==i.Z_STREAM_END);return r===i.Z_STREAM_END&&(o=i.Z_FINISH),o===i.Z_FINISH?(r=n.inflateEnd(this.strm),this.onEnd(r),this.ended=!0,r===i.Z_OK):o!==i.Z_SYNC_FLUSH||(this.onEnd(i.Z_OK),!(f.avail_out=0))},u.prototype.onData=function(e){this.chunks.push(e)},u.prototype.onEnd=function(e){e===i.Z_OK&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=a.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg},r.Inflate=u,r.inflate=h,r.inflateRaw=function(e,t){return(t=t||{}).raw=!0,h(e,t)},r.ungzip=h},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(e,t,r){var n="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Int32Array;r.assign=function(e){for(var t=Array.prototype.slice.call(arguments,1);t.length;){var r=t.shift();if(r){if("object"!=typeof r)throw new TypeError(r+"must be non-object");for(var n in r)r.hasOwnProperty(n)&&(e[n]=r[n])}}return e},r.shrinkBuf=function(e,t){return e.length===t?e:e.subarray?e.subarray(0,t):(e.length=t,e)};var a={arraySet:function(e,t,r,n,a){if(t.subarray&&e.subarray)e.set(t.subarray(r,r+n),a);else for(var s=0;s<n;s++)e[a+s]=t[r+s]},flattenChunks:function(e){var t,r,n,a,s,i;for(t=n=0,r=e.length;t<r;t++)n+=e[t].length;for(i=new Uint8Array(n),t=a=0,r=e.length;t<r;t++)s=e[t],i.set(s,a),a+=s.length;return i}},s={arraySet:function(e,t,r,n,a){for(var s=0;s<n;s++)e[a+s]=t[r+s]},flattenChunks:function(e){return[].concat.apply([],e)}};r.setTyped=function(e){e?(r.Buf8=Uint8Array,r.Buf16=Uint16Array,r.Buf32=Int32Array,r.assign(r,a)):(r.Buf8=Array,r.Buf16=Array,r.Buf32=Array,r.assign(r,s))},r.setTyped(n)},{}],42:[function(e,t,r){var n=e("./common"),a=!0,s=!0;try{String.fromCharCode.apply(null,[0])}catch(c){a=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(c){s=!1}for(var i=new n.Buf8(256),o=0;o<256;o++)i[o]=252<=o?6:248<=o?5:240<=o?4:224<=o?3:192<=o?2:1;function l(e,t){if(t<65537&&(e.subarray&&s||!e.subarray&&a))return String.fromCharCode.apply(null,n.shrinkBuf(e,t));for(var r="",i=0;i<t;i++)r+=String.fromCharCode(e[i]);return r}i[254]=i[254]=1,r.string2buf=function(e){var t,r,a,s,i,o=e.length,l=0;for(s=0;s<o;s++)55296==(64512&(r=e.charCodeAt(s)))&&s+1<o&&56320==(64512&(a=e.charCodeAt(s+1)))&&(r=65536+(r-55296<<10)+(a-56320),s++),l+=r<128?1:r<2048?2:r<65536?3:4;for(t=new n.Buf8(l),s=i=0;i<l;s++)55296==(64512&(r=e.charCodeAt(s)))&&s+1<o&&56320==(64512&(a=e.charCodeAt(s+1)))&&(r=65536+(r-55296<<10)+(a-56320),s++),r<128?t[i++]=r:(r<2048?t[i++]=192|r>>>6:(r<65536?t[i++]=224|r>>>12:(t[i++]=240|r>>>18,t[i++]=128|r>>>12&63),t[i++]=128|r>>>6&63),t[i++]=128|63&r);return t},r.buf2binstring=function(e){return l(e,e.length)},r.binstring2buf=function(e){for(var t=new n.Buf8(e.length),r=0,a=t.length;r<a;r++)t[r]=e.charCodeAt(r);return t},r.buf2string=function(e,t){var r,n,a,s,o=t||e.length,c=new Array(2*o);for(r=n=0;r<o;)if((a=e[r++])<128)c[n++]=a;else if(4<(s=i[a]))c[n++]=65533,r+=s-1;else{for(a&=2===s?31:3===s?15:7;1<s&&r<o;)a=a<<6|63&e[r++],s--;1<s?c[n++]=65533:a<65536?c[n++]=a:(a-=65536,c[n++]=55296|a>>10&1023,c[n++]=56320|1023&a)}return l(c,n)},r.utf8border=function(e,t){var r;for((t=t||e.length)>e.length&&(t=e.length),r=t-1;0<=r&&128==(192&e[r]);)r--;return r<0||0===r?t:r+i[e[r]]>t?r:t}},{"./common":41}],43:[function(e,t,r){t.exports=function(e,t,r,n){for(var a=65535&e,s=e>>>16&65535,i=0;0!==r;){for(r-=i=2e3<r?2e3:r;s=s+(a=a+t[n++]|0)|0,--i;);a%=65521,s%=65521}return a|s<<16}},{}],44:[function(e,t,r){t.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(e,t,r){var n=function(){for(var e,t=[],r=0;r<256;r++){e=r;for(var n=0;n<8;n++)e=1&e?3988292384^e>>>1:e>>>1;t[r]=e}return t}();t.exports=function(e,t,r,a){var s=n,i=a+r;e^=-1;for(var o=a;o<i;o++)e=e>>>8^s[255&(e^t[o])];return-1^e}},{}],46:[function(e,t,r){var n,a=e("../utils/common"),s=e("./trees"),i=e("./adler32"),o=e("./crc32"),l=e("./messages"),c=0,d=4,u=0,h=-2,f=-1,m=4,p=2,g=8,x=9,v=286,b=30,y=19,w=2*v+1,_=15,k=3,N=258,j=N+k+1,S=42,T=113,E=1,C=2,A=3,O=4;function I(e,t){return e.msg=l[t],t}function R(e){return(e<<1)-(4<e?9:0)}function P(e){for(var t=e.length;0<=--t;)e[t]=0}function D(e){var t=e.state,r=t.pending;r>e.avail_out&&(r=e.avail_out),0!==r&&(a.arraySet(e.output,t.pending_buf,t.pending_out,r,e.next_out),e.next_out+=r,t.pending_out+=r,e.total_out+=r,e.avail_out-=r,t.pending-=r,0===t.pending&&(t.pending_out=0))}function L(e,t){s._tr_flush_block(e,0<=e.block_start?e.block_start:-1,e.strstart-e.block_start,t),e.block_start=e.strstart,D(e.strm)}function M(e,t){e.pending_buf[e.pending++]=t}function F(e,t){e.pending_buf[e.pending++]=t>>>8&255,e.pending_buf[e.pending++]=255&t}function U(e,t){var r,n,a=e.max_chain_length,s=e.strstart,i=e.prev_length,o=e.nice_match,l=e.strstart>e.w_size-j?e.strstart-(e.w_size-j):0,c=e.window,d=e.w_mask,u=e.prev,h=e.strstart+N,f=c[s+i-1],m=c[s+i];e.prev_length>=e.good_match&&(a>>=2),o>e.lookahead&&(o=e.lookahead);do{if(c[(r=t)+i]===m&&c[r+i-1]===f&&c[r]===c[s]&&c[++r]===c[s+1]){s+=2,r++;do{}while(c[++s]===c[++r]&&c[++s]===c[++r]&&c[++s]===c[++r]&&c[++s]===c[++r]&&c[++s]===c[++r]&&c[++s]===c[++r]&&c[++s]===c[++r]&&c[++s]===c[++r]&&s<h);if(n=N-(h-s),s=h-N,i<n){if(e.match_start=t,o<=(i=n))break;f=c[s+i-1],m=c[s+i]}}}while((t=u[t&d])>l&&0!=--a);return i<=e.lookahead?i:e.lookahead}function B(e){var t,r,n,s,l,c,d,u,h,f,m=e.w_size;do{if(s=e.window_size-e.lookahead-e.strstart,e.strstart>=m+(m-j)){for(a.arraySet(e.window,e.window,m,m,0),e.match_start-=m,e.strstart-=m,e.block_start-=m,t=r=e.hash_size;n=e.head[--t],e.head[t]=m<=n?n-m:0,--r;);for(t=r=m;n=e.prev[--t],e.prev[t]=m<=n?n-m:0,--r;);s+=m}if(0===e.strm.avail_in)break;if(c=e.strm,d=e.window,u=e.strstart+e.lookahead,f=void 0,(h=s)<(f=c.avail_in)&&(f=h),r=0===f?0:(c.avail_in-=f,a.arraySet(d,c.input,c.next_in,f,u),1===c.state.wrap?c.adler=i(c.adler,d,f,u):2===c.state.wrap&&(c.adler=o(c.adler,d,f,u)),c.next_in+=f,c.total_in+=f,f),e.lookahead+=r,e.lookahead+e.insert>=k)for(l=e.strstart-e.insert,e.ins_h=e.window[l],e.ins_h=(e.ins_h<<e.hash_shift^e.window[l+1])&e.hash_mask;e.insert&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[l+k-1])&e.hash_mask,e.prev[l&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=l,l++,e.insert--,!(e.lookahead+e.insert<k)););}while(e.lookahead<j&&0!==e.strm.avail_in)}function $(e,t){for(var r,n;;){if(e.lookahead<j){if(B(e),e.lookahead<j&&t===c)return E;if(0===e.lookahead)break}if(r=0,e.lookahead>=k&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+k-1])&e.hash_mask,r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!==r&&e.strstart-r<=e.w_size-j&&(e.match_length=U(e,r)),e.match_length>=k)if(n=s._tr_tally(e,e.strstart-e.match_start,e.match_length-k),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=k){for(e.match_length--;e.strstart++,e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+k-1])&e.hash_mask,r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart,0!=--e.match_length;);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+1])&e.hash_mask;else n=s._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(n&&(L(e,!1),0===e.strm.avail_out))return E}return e.insert=e.strstart<k-1?e.strstart:k-1,t===d?(L(e,!0),0===e.strm.avail_out?A:O):e.last_lit&&(L(e,!1),0===e.strm.avail_out)?E:C}function z(e,t){for(var r,n,a;;){if(e.lookahead<j){if(B(e),e.lookahead<j&&t===c)return E;if(0===e.lookahead)break}if(r=0,e.lookahead>=k&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+k-1])&e.hash_mask,r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=k-1,0!==r&&e.prev_length<e.max_lazy_match&&e.strstart-r<=e.w_size-j&&(e.match_length=U(e,r),e.match_length<=5&&(1===e.strategy||e.match_length===k&&4096<e.strstart-e.match_start)&&(e.match_length=k-1)),e.prev_length>=k&&e.match_length<=e.prev_length){for(a=e.strstart+e.lookahead-k,n=s._tr_tally(e,e.strstart-1-e.prev_match,e.prev_length-k),e.lookahead-=e.prev_length-1,e.prev_length-=2;++e.strstart<=a&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+k-1])&e.hash_mask,r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!=--e.prev_length;);if(e.match_available=0,e.match_length=k-1,e.strstart++,n&&(L(e,!1),0===e.strm.avail_out))return E}else if(e.match_available){if((n=s._tr_tally(e,0,e.window[e.strstart-1]))&&L(e,!1),e.strstart++,e.lookahead--,0===e.strm.avail_out)return E}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(n=s._tr_tally(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<k-1?e.strstart:k-1,t===d?(L(e,!0),0===e.strm.avail_out?A:O):e.last_lit&&(L(e,!1),0===e.strm.avail_out)?E:C}function V(e,t,r,n,a){this.good_length=e,this.max_lazy=t,this.nice_length=r,this.max_chain=n,this.func=a}function W(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=g,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new a.Buf16(2*w),this.dyn_dtree=new a.Buf16(2*(2*b+1)),this.bl_tree=new a.Buf16(2*(2*y+1)),P(this.dyn_ltree),P(this.dyn_dtree),P(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new a.Buf16(_+1),this.heap=new a.Buf16(2*v+1),P(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new a.Buf16(2*v+1),P(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function H(e){var t;return e&&e.state?(e.total_in=e.total_out=0,e.data_type=p,(t=e.state).pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=t.wrap?S:T,e.adler=2===t.wrap?0:1,t.last_flush=c,s._tr_init(t),u):I(e,h)}function G(e){var t,r=H(e);return r===u&&((t=e.state).window_size=2*t.w_size,P(t.head),t.max_lazy_match=n[t.level].max_lazy,t.good_match=n[t.level].good_length,t.nice_match=n[t.level].nice_length,t.max_chain_length=n[t.level].max_chain,t.strstart=0,t.block_start=0,t.lookahead=0,t.insert=0,t.match_length=t.prev_length=k-1,t.match_available=0,t.ins_h=0),r}function q(e,t,r,n,s,i){if(!e)return h;var o=1;if(t===f&&(t=6),n<0?(o=0,n=-n):15<n&&(o=2,n-=16),s<1||x<s||r!==g||n<8||15<n||t<0||9<t||i<0||m<i)return I(e,h);8===n&&(n=9);var l=new W;return(e.state=l).strm=e,l.wrap=o,l.gzhead=null,l.w_bits=n,l.w_size=1<<l.w_bits,l.w_mask=l.w_size-1,l.hash_bits=s+7,l.hash_size=1<<l.hash_bits,l.hash_mask=l.hash_size-1,l.hash_shift=~~((l.hash_bits+k-1)/k),l.window=new a.Buf8(2*l.w_size),l.head=new a.Buf16(l.hash_size),l.prev=new a.Buf16(l.w_size),l.lit_bufsize=1<<s+6,l.pending_buf_size=4*l.lit_bufsize,l.pending_buf=new a.Buf8(l.pending_buf_size),l.d_buf=1*l.lit_bufsize,l.l_buf=3*l.lit_bufsize,l.level=t,l.strategy=i,l.method=r,G(e)}n=[new V(0,0,0,0,function(e,t){var r=65535;for(r>e.pending_buf_size-5&&(r=e.pending_buf_size-5);;){if(e.lookahead<=1){if(B(e),0===e.lookahead&&t===c)return E;if(0===e.lookahead)break}e.strstart+=e.lookahead,e.lookahead=0;var n=e.block_start+r;if((0===e.strstart||e.strstart>=n)&&(e.lookahead=e.strstart-n,e.strstart=n,L(e,!1),0===e.strm.avail_out))return E;if(e.strstart-e.block_start>=e.w_size-j&&(L(e,!1),0===e.strm.avail_out))return E}return e.insert=0,t===d?(L(e,!0),0===e.strm.avail_out?A:O):(e.strstart>e.block_start&&(L(e,!1),e.strm.avail_out),E)}),new V(4,4,8,4,$),new V(4,5,16,8,$),new V(4,6,32,32,$),new V(4,4,16,16,z),new V(8,16,32,32,z),new V(8,16,128,128,z),new V(8,32,128,256,z),new V(32,128,258,1024,z),new V(32,258,258,4096,z)],r.deflateInit=function(e,t){return q(e,t,g,15,8,0)},r.deflateInit2=q,r.deflateReset=G,r.deflateResetKeep=H,r.deflateSetHeader=function(e,t){return e&&e.state?2!==e.state.wrap?h:(e.state.gzhead=t,u):h},r.deflate=function(e,t){var r,a,i,l;if(!e||!e.state||5<t||t<0)return e?I(e,h):h;if(a=e.state,!e.output||!e.input&&0!==e.avail_in||666===a.status&&t!==d)return I(e,0===e.avail_out?-5:h);if(a.strm=e,r=a.last_flush,a.last_flush=t,a.status===S)if(2===a.wrap)e.adler=0,M(a,31),M(a,139),M(a,8),a.gzhead?(M(a,(a.gzhead.text?1:0)+(a.gzhead.hcrc?2:0)+(a.gzhead.extra?4:0)+(a.gzhead.name?8:0)+(a.gzhead.comment?16:0)),M(a,255&a.gzhead.time),M(a,a.gzhead.time>>8&255),M(a,a.gzhead.time>>16&255),M(a,a.gzhead.time>>24&255),M(a,9===a.level?2:2<=a.strategy||a.level<2?4:0),M(a,255&a.gzhead.os),a.gzhead.extra&&a.gzhead.extra.length&&(M(a,255&a.gzhead.extra.length),M(a,a.gzhead.extra.length>>8&255)),a.gzhead.hcrc&&(e.adler=o(e.adler,a.pending_buf,a.pending,0)),a.gzindex=0,a.status=69):(M(a,0),M(a,0),M(a,0),M(a,0),M(a,0),M(a,9===a.level?2:2<=a.strategy||a.level<2?4:0),M(a,3),a.status=T);else{var f=g+(a.w_bits-8<<4)<<8;f|=(2<=a.strategy||a.level<2?0:a.level<6?1:6===a.level?2:3)<<6,0!==a.strstart&&(f|=32),f+=31-f%31,a.status=T,F(a,f),0!==a.strstart&&(F(a,e.adler>>>16),F(a,65535&e.adler)),e.adler=1}if(69===a.status)if(a.gzhead.extra){for(i=a.pending;a.gzindex<(65535&a.gzhead.extra.length)&&(a.pending!==a.pending_buf_size||(a.gzhead.hcrc&&a.pending>i&&(e.adler=o(e.adler,a.pending_buf,a.pending-i,i)),D(e),i=a.pending,a.pending!==a.pending_buf_size));)M(a,255&a.gzhead.extra[a.gzindex]),a.gzindex++;a.gzhead.hcrc&&a.pending>i&&(e.adler=o(e.adler,a.pending_buf,a.pending-i,i)),a.gzindex===a.gzhead.extra.length&&(a.gzindex=0,a.status=73)}else a.status=73;if(73===a.status)if(a.gzhead.name){i=a.pending;do{if(a.pending===a.pending_buf_size&&(a.gzhead.hcrc&&a.pending>i&&(e.adler=o(e.adler,a.pending_buf,a.pending-i,i)),D(e),i=a.pending,a.pending===a.pending_buf_size)){l=1;break}l=a.gzindex<a.gzhead.name.length?255&a.gzhead.name.charCodeAt(a.gzindex++):0,M(a,l)}while(0!==l);a.gzhead.hcrc&&a.pending>i&&(e.adler=o(e.adler,a.pending_buf,a.pending-i,i)),0===l&&(a.gzindex=0,a.status=91)}else a.status=91;if(91===a.status)if(a.gzhead.comment){i=a.pending;do{if(a.pending===a.pending_buf_size&&(a.gzhead.hcrc&&a.pending>i&&(e.adler=o(e.adler,a.pending_buf,a.pending-i,i)),D(e),i=a.pending,a.pending===a.pending_buf_size)){l=1;break}l=a.gzindex<a.gzhead.comment.length?255&a.gzhead.comment.charCodeAt(a.gzindex++):0,M(a,l)}while(0!==l);a.gzhead.hcrc&&a.pending>i&&(e.adler=o(e.adler,a.pending_buf,a.pending-i,i)),0===l&&(a.status=103)}else a.status=103;if(103===a.status&&(a.gzhead.hcrc?(a.pending+2>a.pending_buf_size&&D(e),a.pending+2<=a.pending_buf_size&&(M(a,255&e.adler),M(a,e.adler>>8&255),e.adler=0,a.status=T)):a.status=T),0!==a.pending){if(D(e),0===e.avail_out)return a.last_flush=-1,u}else if(0===e.avail_in&&R(t)<=R(r)&&t!==d)return I(e,-5);if(666===a.status&&0!==e.avail_in)return I(e,-5);if(0!==e.avail_in||0!==a.lookahead||t!==c&&666!==a.status){var m=2===a.strategy?function(e,t){for(var r;;){if(0===e.lookahead&&(B(e),0===e.lookahead)){if(t===c)return E;break}if(e.match_length=0,r=s._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,r&&(L(e,!1),0===e.strm.avail_out))return E}return e.insert=0,t===d?(L(e,!0),0===e.strm.avail_out?A:O):e.last_lit&&(L(e,!1),0===e.strm.avail_out)?E:C}(a,t):3===a.strategy?function(e,t){for(var r,n,a,i,o=e.window;;){if(e.lookahead<=N){if(B(e),e.lookahead<=N&&t===c)return E;if(0===e.lookahead)break}if(e.match_length=0,e.lookahead>=k&&0<e.strstart&&(n=o[a=e.strstart-1])===o[++a]&&n===o[++a]&&n===o[++a]){i=e.strstart+N;do{}while(n===o[++a]&&n===o[++a]&&n===o[++a]&&n===o[++a]&&n===o[++a]&&n===o[++a]&&n===o[++a]&&n===o[++a]&&a<i);e.match_length=N-(i-a),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=k?(r=s._tr_tally(e,1,e.match_length-k),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(r=s._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),r&&(L(e,!1),0===e.strm.avail_out))return E}return e.insert=0,t===d?(L(e,!0),0===e.strm.avail_out?A:O):e.last_lit&&(L(e,!1),0===e.strm.avail_out)?E:C}(a,t):n[a.level].func(a,t);if(m!==A&&m!==O||(a.status=666),m===E||m===A)return 0===e.avail_out&&(a.last_flush=-1),u;if(m===C&&(1===t?s._tr_align(a):5!==t&&(s._tr_stored_block(a,0,0,!1),3===t&&(P(a.head),0===a.lookahead&&(a.strstart=0,a.block_start=0,a.insert=0))),D(e),0===e.avail_out))return a.last_flush=-1,u}return t!==d?u:a.wrap<=0?1:(2===a.wrap?(M(a,255&e.adler),M(a,e.adler>>8&255),M(a,e.adler>>16&255),M(a,e.adler>>24&255),M(a,255&e.total_in),M(a,e.total_in>>8&255),M(a,e.total_in>>16&255),M(a,e.total_in>>24&255)):(F(a,e.adler>>>16),F(a,65535&e.adler)),D(e),0<a.wrap&&(a.wrap=-a.wrap),0!==a.pending?u:1)},r.deflateEnd=function(e){var t;return e&&e.state?(t=e.state.status)!==S&&69!==t&&73!==t&&91!==t&&103!==t&&t!==T&&666!==t?I(e,h):(e.state=null,t===T?I(e,-3):u):h},r.deflateSetDictionary=function(e,t){var r,n,s,o,l,c,d,f,m=t.length;if(!e||!e.state)return h;if(2===(o=(r=e.state).wrap)||1===o&&r.status!==S||r.lookahead)return h;for(1===o&&(e.adler=i(e.adler,t,m,0)),r.wrap=0,m>=r.w_size&&(0===o&&(P(r.head),r.strstart=0,r.block_start=0,r.insert=0),f=new a.Buf8(r.w_size),a.arraySet(f,t,m-r.w_size,r.w_size,0),t=f,m=r.w_size),l=e.avail_in,c=e.next_in,d=e.input,e.avail_in=m,e.next_in=0,e.input=t,B(r);r.lookahead>=k;){for(n=r.strstart,s=r.lookahead-(k-1);r.ins_h=(r.ins_h<<r.hash_shift^r.window[n+k-1])&r.hash_mask,r.prev[n&r.w_mask]=r.head[r.ins_h],r.head[r.ins_h]=n,n++,--s;);r.strstart=n,r.lookahead=k-1,B(r)}return r.strstart+=r.lookahead,r.block_start=r.strstart,r.insert=r.lookahead,r.lookahead=0,r.match_length=r.prev_length=k-1,r.match_available=0,e.next_in=c,e.input=d,e.avail_in=l,r.wrap=o,u},r.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(e,t,r){t.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(e,t,r){t.exports=function(e,t){var r,n,a,s,i,o,l,c,d,u,h,f,m,p,g,x,v,b,y,w,_,k,N,j,S;r=e.state,n=e.next_in,j=e.input,a=n+(e.avail_in-5),s=e.next_out,S=e.output,i=s-(t-e.avail_out),o=s+(e.avail_out-257),l=r.dmax,c=r.wsize,d=r.whave,u=r.wnext,h=r.window,f=r.hold,m=r.bits,p=r.lencode,g=r.distcode,x=(1<<r.lenbits)-1,v=(1<<r.distbits)-1;e:do{m<15&&(f+=j[n++]<<m,m+=8,f+=j[n++]<<m,m+=8),b=p[f&x];t:for(;;){if(f>>>=y=b>>>24,m-=y,0==(y=b>>>16&255))S[s++]=65535&b;else{if(!(16&y)){if(!(64&y)){b=p[(65535&b)+(f&(1<<y)-1)];continue t}if(32&y){r.mode=12;break e}e.msg="invalid literal/length code",r.mode=30;break e}w=65535&b,(y&=15)&&(m<y&&(f+=j[n++]<<m,m+=8),w+=f&(1<<y)-1,f>>>=y,m-=y),m<15&&(f+=j[n++]<<m,m+=8,f+=j[n++]<<m,m+=8),b=g[f&v];r:for(;;){if(f>>>=y=b>>>24,m-=y,!(16&(y=b>>>16&255))){if(!(64&y)){b=g[(65535&b)+(f&(1<<y)-1)];continue r}e.msg="invalid distance code",r.mode=30;break e}if(_=65535&b,m<(y&=15)&&(f+=j[n++]<<m,(m+=8)<y&&(f+=j[n++]<<m,m+=8)),l<(_+=f&(1<<y)-1)){e.msg="invalid distance too far back",r.mode=30;break e}if(f>>>=y,m-=y,(y=s-i)<_){if(d<(y=_-y)&&r.sane){e.msg="invalid distance too far back",r.mode=30;break e}if(N=h,(k=0)===u){if(k+=c-y,y<w){for(w-=y;S[s++]=h[k++],--y;);k=s-_,N=S}}else if(u<y){if(k+=c+u-y,(y-=u)<w){for(w-=y;S[s++]=h[k++],--y;);if(k=0,u<w){for(w-=y=u;S[s++]=h[k++],--y;);k=s-_,N=S}}}else if(k+=u-y,y<w){for(w-=y;S[s++]=h[k++],--y;);k=s-_,N=S}for(;2<w;)S[s++]=N[k++],S[s++]=N[k++],S[s++]=N[k++],w-=3;w&&(S[s++]=N[k++],1<w&&(S[s++]=N[k++]))}else{for(k=s-_;S[s++]=S[k++],S[s++]=S[k++],S[s++]=S[k++],2<(w-=3););w&&(S[s++]=S[k++],1<w&&(S[s++]=S[k++]))}break}}break}}while(n<a&&s<o);n-=w=m>>3,f&=(1<<(m-=w<<3))-1,e.next_in=n,e.next_out=s,e.avail_in=n<a?a-n+5:5-(n-a),e.avail_out=s<o?o-s+257:257-(s-o),r.hold=f,r.bits=m}},{}],49:[function(e,t,r){var n=e("../utils/common"),a=e("./adler32"),s=e("./crc32"),i=e("./inffast"),o=e("./inftrees"),l=1,c=2,d=0,u=-2,h=1,f=852,m=592;function p(e){return(e>>>24&255)+(e>>>8&65280)+((65280&e)<<8)+((255&e)<<24)}function g(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new n.Buf16(320),this.work=new n.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function x(e){var t;return e&&e.state?(t=e.state,e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=1&t.wrap),t.mode=h,t.last=0,t.havedict=0,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new n.Buf32(f),t.distcode=t.distdyn=new n.Buf32(m),t.sane=1,t.back=-1,d):u}function v(e){var t;return e&&e.state?((t=e.state).wsize=0,t.whave=0,t.wnext=0,x(e)):u}function b(e,t){var r,n;return e&&e.state?(n=e.state,t<0?(r=0,t=-t):(r=1+(t>>4),t<48&&(t&=15)),t&&(t<8||15<t)?u:(null!==n.window&&n.wbits!==t&&(n.window=null),n.wrap=r,n.wbits=t,v(e))):u}function y(e,t){var r,n;return e?(n=new g,(e.state=n).window=null,(r=b(e,t))!==d&&(e.state=null),r):u}var w,_,k=!0;function N(e){if(k){var t;for(w=new n.Buf32(512),_=new n.Buf32(32),t=0;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(o(l,e.lens,0,288,w,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;o(c,e.lens,0,32,_,0,e.work,{bits:5}),k=!1}e.lencode=w,e.lenbits=9,e.distcode=_,e.distbits=5}function j(e,t,r,a){var s,i=e.state;return null===i.window&&(i.wsize=1<<i.wbits,i.wnext=0,i.whave=0,i.window=new n.Buf8(i.wsize)),a>=i.wsize?(n.arraySet(i.window,t,r-i.wsize,i.wsize,0),i.wnext=0,i.whave=i.wsize):(a<(s=i.wsize-i.wnext)&&(s=a),n.arraySet(i.window,t,r-a,s,i.wnext),(a-=s)?(n.arraySet(i.window,t,r-a,a,0),i.wnext=a,i.whave=i.wsize):(i.wnext+=s,i.wnext===i.wsize&&(i.wnext=0),i.whave<i.wsize&&(i.whave+=s))),0}r.inflateReset=v,r.inflateReset2=b,r.inflateResetKeep=x,r.inflateInit=function(e){return y(e,15)},r.inflateInit2=y,r.inflate=function(e,t){var r,f,m,g,x,v,b,y,w,_,k,S,T,E,C,A,O,I,R,P,D,L,M,F,U=0,B=new n.Buf8(4),$=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!e||!e.state||!e.output||!e.input&&0!==e.avail_in)return u;12===(r=e.state).mode&&(r.mode=13),x=e.next_out,m=e.output,b=e.avail_out,g=e.next_in,f=e.input,v=e.avail_in,y=r.hold,w=r.bits,_=v,k=b,L=d;e:for(;;)switch(r.mode){case h:if(0===r.wrap){r.mode=13;break}for(;w<16;){if(0===v)break e;v--,y+=f[g++]<<w,w+=8}if(2&r.wrap&&35615===y){B[r.check=0]=255&y,B[1]=y>>>8&255,r.check=s(r.check,B,2,0),w=y=0,r.mode=2;break}if(r.flags=0,r.head&&(r.head.done=!1),!(1&r.wrap)||(((255&y)<<8)+(y>>8))%31){e.msg="incorrect header check",r.mode=30;break}if(8!=(15&y)){e.msg="unknown compression method",r.mode=30;break}if(w-=4,D=8+(15&(y>>>=4)),0===r.wbits)r.wbits=D;else if(D>r.wbits){e.msg="invalid window size",r.mode=30;break}r.dmax=1<<D,e.adler=r.check=1,r.mode=512&y?10:12,w=y=0;break;case 2:for(;w<16;){if(0===v)break e;v--,y+=f[g++]<<w,w+=8}if(r.flags=y,8!=(255&r.flags)){e.msg="unknown compression method",r.mode=30;break}if(57344&r.flags){e.msg="unknown header flags set",r.mode=30;break}r.head&&(r.head.text=y>>8&1),512&r.flags&&(B[0]=255&y,B[1]=y>>>8&255,r.check=s(r.check,B,2,0)),w=y=0,r.mode=3;case 3:for(;w<32;){if(0===v)break e;v--,y+=f[g++]<<w,w+=8}r.head&&(r.head.time=y),512&r.flags&&(B[0]=255&y,B[1]=y>>>8&255,B[2]=y>>>16&255,B[3]=y>>>24&255,r.check=s(r.check,B,4,0)),w=y=0,r.mode=4;case 4:for(;w<16;){if(0===v)break e;v--,y+=f[g++]<<w,w+=8}r.head&&(r.head.xflags=255&y,r.head.os=y>>8),512&r.flags&&(B[0]=255&y,B[1]=y>>>8&255,r.check=s(r.check,B,2,0)),w=y=0,r.mode=5;case 5:if(1024&r.flags){for(;w<16;){if(0===v)break e;v--,y+=f[g++]<<w,w+=8}r.length=y,r.head&&(r.head.extra_len=y),512&r.flags&&(B[0]=255&y,B[1]=y>>>8&255,r.check=s(r.check,B,2,0)),w=y=0}else r.head&&(r.head.extra=null);r.mode=6;case 6:if(1024&r.flags&&(v<(S=r.length)&&(S=v),S&&(r.head&&(D=r.head.extra_len-r.length,r.head.extra||(r.head.extra=new Array(r.head.extra_len)),n.arraySet(r.head.extra,f,g,S,D)),512&r.flags&&(r.check=s(r.check,f,S,g)),v-=S,g+=S,r.length-=S),r.length))break e;r.length=0,r.mode=7;case 7:if(2048&r.flags){if(0===v)break e;for(S=0;D=f[g+S++],r.head&&D&&r.length<65536&&(r.head.name+=String.fromCharCode(D)),D&&S<v;);if(512&r.flags&&(r.check=s(r.check,f,S,g)),v-=S,g+=S,D)break e}else r.head&&(r.head.name=null);r.length=0,r.mode=8;case 8:if(4096&r.flags){if(0===v)break e;for(S=0;D=f[g+S++],r.head&&D&&r.length<65536&&(r.head.comment+=String.fromCharCode(D)),D&&S<v;);if(512&r.flags&&(r.check=s(r.check,f,S,g)),v-=S,g+=S,D)break e}else r.head&&(r.head.comment=null);r.mode=9;case 9:if(512&r.flags){for(;w<16;){if(0===v)break e;v--,y+=f[g++]<<w,w+=8}if(y!==(65535&r.check)){e.msg="header crc mismatch",r.mode=30;break}w=y=0}r.head&&(r.head.hcrc=r.flags>>9&1,r.head.done=!0),e.adler=r.check=0,r.mode=12;break;case 10:for(;w<32;){if(0===v)break e;v--,y+=f[g++]<<w,w+=8}e.adler=r.check=p(y),w=y=0,r.mode=11;case 11:if(0===r.havedict)return e.next_out=x,e.avail_out=b,e.next_in=g,e.avail_in=v,r.hold=y,r.bits=w,2;e.adler=r.check=1,r.mode=12;case 12:if(5===t||6===t)break e;case 13:if(r.last){y>>>=7&w,w-=7&w,r.mode=27;break}for(;w<3;){if(0===v)break e;v--,y+=f[g++]<<w,w+=8}switch(r.last=1&y,w-=1,3&(y>>>=1)){case 0:r.mode=14;break;case 1:if(N(r),r.mode=20,6!==t)break;y>>>=2,w-=2;break e;case 2:r.mode=17;break;case 3:e.msg="invalid block type",r.mode=30}y>>>=2,w-=2;break;case 14:for(y>>>=7&w,w-=7&w;w<32;){if(0===v)break e;v--,y+=f[g++]<<w,w+=8}if((65535&y)!=(y>>>16^65535)){e.msg="invalid stored block lengths",r.mode=30;break}if(r.length=65535&y,w=y=0,r.mode=15,6===t)break e;case 15:r.mode=16;case 16:if(S=r.length){if(v<S&&(S=v),b<S&&(S=b),0===S)break e;n.arraySet(m,f,g,S,x),v-=S,g+=S,b-=S,x+=S,r.length-=S;break}r.mode=12;break;case 17:for(;w<14;){if(0===v)break e;v--,y+=f[g++]<<w,w+=8}if(r.nlen=257+(31&y),y>>>=5,w-=5,r.ndist=1+(31&y),y>>>=5,w-=5,r.ncode=4+(15&y),y>>>=4,w-=4,286<r.nlen||30<r.ndist){e.msg="too many length or distance symbols",r.mode=30;break}r.have=0,r.mode=18;case 18:for(;r.have<r.ncode;){for(;w<3;){if(0===v)break e;v--,y+=f[g++]<<w,w+=8}r.lens[$[r.have++]]=7&y,y>>>=3,w-=3}for(;r.have<19;)r.lens[$[r.have++]]=0;if(r.lencode=r.lendyn,r.lenbits=7,M={bits:r.lenbits},L=o(0,r.lens,0,19,r.lencode,0,r.work,M),r.lenbits=M.bits,L){e.msg="invalid code lengths set",r.mode=30;break}r.have=0,r.mode=19;case 19:for(;r.have<r.nlen+r.ndist;){for(;A=(U=r.lencode[y&(1<<r.lenbits)-1])>>>16&255,O=65535&U,!((C=U>>>24)<=w);){if(0===v)break e;v--,y+=f[g++]<<w,w+=8}if(O<16)y>>>=C,w-=C,r.lens[r.have++]=O;else{if(16===O){for(F=C+2;w<F;){if(0===v)break e;v--,y+=f[g++]<<w,w+=8}if(y>>>=C,w-=C,0===r.have){e.msg="invalid bit length repeat",r.mode=30;break}D=r.lens[r.have-1],S=3+(3&y),y>>>=2,w-=2}else if(17===O){for(F=C+3;w<F;){if(0===v)break e;v--,y+=f[g++]<<w,w+=8}w-=C,D=0,S=3+(7&(y>>>=C)),y>>>=3,w-=3}else{for(F=C+7;w<F;){if(0===v)break e;v--,y+=f[g++]<<w,w+=8}w-=C,D=0,S=11+(127&(y>>>=C)),y>>>=7,w-=7}if(r.have+S>r.nlen+r.ndist){e.msg="invalid bit length repeat",r.mode=30;break}for(;S--;)r.lens[r.have++]=D}}if(30===r.mode)break;if(0===r.lens[256]){e.msg="invalid code -- missing end-of-block",r.mode=30;break}if(r.lenbits=9,M={bits:r.lenbits},L=o(l,r.lens,0,r.nlen,r.lencode,0,r.work,M),r.lenbits=M.bits,L){e.msg="invalid literal/lengths set",r.mode=30;break}if(r.distbits=6,r.distcode=r.distdyn,M={bits:r.distbits},L=o(c,r.lens,r.nlen,r.ndist,r.distcode,0,r.work,M),r.distbits=M.bits,L){e.msg="invalid distances set",r.mode=30;break}if(r.mode=20,6===t)break e;case 20:r.mode=21;case 21:if(6<=v&&258<=b){e.next_out=x,e.avail_out=b,e.next_in=g,e.avail_in=v,r.hold=y,r.bits=w,i(e,k),x=e.next_out,m=e.output,b=e.avail_out,g=e.next_in,f=e.input,v=e.avail_in,y=r.hold,w=r.bits,12===r.mode&&(r.back=-1);break}for(r.back=0;A=(U=r.lencode[y&(1<<r.lenbits)-1])>>>16&255,O=65535&U,!((C=U>>>24)<=w);){if(0===v)break e;v--,y+=f[g++]<<w,w+=8}if(A&&!(240&A)){for(I=C,R=A,P=O;A=(U=r.lencode[P+((y&(1<<I+R)-1)>>I)])>>>16&255,O=65535&U,!(I+(C=U>>>24)<=w);){if(0===v)break e;v--,y+=f[g++]<<w,w+=8}y>>>=I,w-=I,r.back+=I}if(y>>>=C,w-=C,r.back+=C,r.length=O,0===A){r.mode=26;break}if(32&A){r.back=-1,r.mode=12;break}if(64&A){e.msg="invalid literal/length code",r.mode=30;break}r.extra=15&A,r.mode=22;case 22:if(r.extra){for(F=r.extra;w<F;){if(0===v)break e;v--,y+=f[g++]<<w,w+=8}r.length+=y&(1<<r.extra)-1,y>>>=r.extra,w-=r.extra,r.back+=r.extra}r.was=r.length,r.mode=23;case 23:for(;A=(U=r.distcode[y&(1<<r.distbits)-1])>>>16&255,O=65535&U,!((C=U>>>24)<=w);){if(0===v)break e;v--,y+=f[g++]<<w,w+=8}if(!(240&A)){for(I=C,R=A,P=O;A=(U=r.distcode[P+((y&(1<<I+R)-1)>>I)])>>>16&255,O=65535&U,!(I+(C=U>>>24)<=w);){if(0===v)break e;v--,y+=f[g++]<<w,w+=8}y>>>=I,w-=I,r.back+=I}if(y>>>=C,w-=C,r.back+=C,64&A){e.msg="invalid distance code",r.mode=30;break}r.offset=O,r.extra=15&A,r.mode=24;case 24:if(r.extra){for(F=r.extra;w<F;){if(0===v)break e;v--,y+=f[g++]<<w,w+=8}r.offset+=y&(1<<r.extra)-1,y>>>=r.extra,w-=r.extra,r.back+=r.extra}if(r.offset>r.dmax){e.msg="invalid distance too far back",r.mode=30;break}r.mode=25;case 25:if(0===b)break e;if(S=k-b,r.offset>S){if((S=r.offset-S)>r.whave&&r.sane){e.msg="invalid distance too far back",r.mode=30;break}T=S>r.wnext?(S-=r.wnext,r.wsize-S):r.wnext-S,S>r.length&&(S=r.length),E=r.window}else E=m,T=x-r.offset,S=r.length;for(b<S&&(S=b),b-=S,r.length-=S;m[x++]=E[T++],--S;);0===r.length&&(r.mode=21);break;case 26:if(0===b)break e;m[x++]=r.length,b--,r.mode=21;break;case 27:if(r.wrap){for(;w<32;){if(0===v)break e;v--,y|=f[g++]<<w,w+=8}if(k-=b,e.total_out+=k,r.total+=k,k&&(e.adler=r.check=r.flags?s(r.check,m,k,x-k):a(r.check,m,k,x-k)),k=b,(r.flags?y:p(y))!==r.check){e.msg="incorrect data check",r.mode=30;break}w=y=0}r.mode=28;case 28:if(r.wrap&&r.flags){for(;w<32;){if(0===v)break e;v--,y+=f[g++]<<w,w+=8}if(y!==(4294967295&r.total)){e.msg="incorrect length check",r.mode=30;break}w=y=0}r.mode=29;case 29:L=1;break e;case 30:L=-3;break e;case 31:return-4;default:return u}return e.next_out=x,e.avail_out=b,e.next_in=g,e.avail_in=v,r.hold=y,r.bits=w,(r.wsize||k!==e.avail_out&&r.mode<30&&(r.mode<27||4!==t))&&j(e,e.output,e.next_out,k-e.avail_out)?(r.mode=31,-4):(_-=e.avail_in,k-=e.avail_out,e.total_in+=_,e.total_out+=k,r.total+=k,r.wrap&&k&&(e.adler=r.check=r.flags?s(r.check,m,k,e.next_out-k):a(r.check,m,k,e.next_out-k)),e.data_type=r.bits+(r.last?64:0)+(12===r.mode?128:0)+(20===r.mode||15===r.mode?256:0),(0==_&&0===k||4===t)&&L===d&&(L=-5),L)},r.inflateEnd=function(e){if(!e||!e.state)return u;var t=e.state;return t.window&&(t.window=null),e.state=null,d},r.inflateGetHeader=function(e,t){var r;return e&&e.state&&2&(r=e.state).wrap?((r.head=t).done=!1,d):u},r.inflateSetDictionary=function(e,t){var r,n=t.length;return e&&e.state?0!==(r=e.state).wrap&&11!==r.mode?u:11===r.mode&&a(1,t,n,0)!==r.check?-3:j(e,t,n,n)?(r.mode=31,-4):(r.havedict=1,d):u},r.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(e,t,r){var n=e("../utils/common"),a=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],s=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],i=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],o=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];t.exports=function(e,t,r,l,c,d,u,h){var f,m,p,g,x,v,b,y,w,_=h.bits,k=0,N=0,j=0,S=0,T=0,E=0,C=0,A=0,O=0,I=0,R=null,P=0,D=new n.Buf16(16),L=new n.Buf16(16),M=null,F=0;for(k=0;k<=15;k++)D[k]=0;for(N=0;N<l;N++)D[t[r+N]]++;for(T=_,S=15;1<=S&&0===D[S];S--);if(S<T&&(T=S),0===S)return c[d++]=20971520,c[d++]=20971520,h.bits=1,0;for(j=1;j<S&&0===D[j];j++);for(T<j&&(T=j),k=A=1;k<=15;k++)if(A<<=1,(A-=D[k])<0)return-1;if(0<A&&(0===e||1!==S))return-1;for(L[1]=0,k=1;k<15;k++)L[k+1]=L[k]+D[k];for(N=0;N<l;N++)0!==t[r+N]&&(u[L[t[r+N]]++]=N);if(v=0===e?(R=M=u,19):1===e?(R=a,P-=257,M=s,F-=257,256):(R=i,M=o,-1),k=j,x=d,C=N=I=0,p=-1,g=(O=1<<(E=T))-1,1===e&&852<O||2===e&&592<O)return 1;for(;;){for(b=k-C,w=u[N]<v?(y=0,u[N]):u[N]>v?(y=M[F+u[N]],R[P+u[N]]):(y=96,0),f=1<<k-C,j=m=1<<E;c[x+(I>>C)+(m-=f)]=b<<24|y<<16|w,0!==m;);for(f=1<<k-1;I&f;)f>>=1;if(0!==f?(I&=f-1,I+=f):I=0,N++,0==--D[k]){if(k===S)break;k=t[r+u[N]]}if(T<k&&(I&g)!==p){for(0===C&&(C=T),x+=j,A=1<<(E=k-C);E+C<S&&!((A-=D[E+C])<=0);)E++,A<<=1;if(O+=1<<E,1===e&&852<O||2===e&&592<O)return 1;c[p=I&g]=T<<24|E<<16|x-d}}return 0!==I&&(c[x+I]=k-C<<24|64<<16),h.bits=T,0}},{"../utils/common":41}],51:[function(e,t,r){t.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(e,t,r){var n=e("../utils/common"),a=0,s=1;function i(e){for(var t=e.length;0<=--t;)e[t]=0}var o=0,l=29,c=256,d=c+1+l,u=30,h=19,f=2*d+1,m=15,p=16,g=7,x=256,v=16,b=17,y=18,w=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],_=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],k=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],N=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],j=new Array(2*(d+2));i(j);var S=new Array(2*u);i(S);var T=new Array(512);i(T);var E=new Array(256);i(E);var C=new Array(l);i(C);var A,O,I,R=new Array(u);function P(e,t,r,n,a){this.static_tree=e,this.extra_bits=t,this.extra_base=r,this.elems=n,this.max_length=a,this.has_stree=e&&e.length}function D(e,t){this.dyn_tree=e,this.max_code=0,this.stat_desc=t}function L(e){return e<256?T[e]:T[256+(e>>>7)]}function M(e,t){e.pending_buf[e.pending++]=255&t,e.pending_buf[e.pending++]=t>>>8&255}function F(e,t,r){e.bi_valid>p-r?(e.bi_buf|=t<<e.bi_valid&65535,M(e,e.bi_buf),e.bi_buf=t>>p-e.bi_valid,e.bi_valid+=r-p):(e.bi_buf|=t<<e.bi_valid&65535,e.bi_valid+=r)}function U(e,t,r){F(e,r[2*t],r[2*t+1])}function B(e,t){for(var r=0;r|=1&e,e>>>=1,r<<=1,0<--t;);return r>>>1}function $(e,t,r){var n,a,s=new Array(m+1),i=0;for(n=1;n<=m;n++)s[n]=i=i+r[n-1]<<1;for(a=0;a<=t;a++){var o=e[2*a+1];0!==o&&(e[2*a]=B(s[o]++,o))}}function z(e){var t;for(t=0;t<d;t++)e.dyn_ltree[2*t]=0;for(t=0;t<u;t++)e.dyn_dtree[2*t]=0;for(t=0;t<h;t++)e.bl_tree[2*t]=0;e.dyn_ltree[2*x]=1,e.opt_len=e.static_len=0,e.last_lit=e.matches=0}function V(e){8<e.bi_valid?M(e,e.bi_buf):0<e.bi_valid&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0}function W(e,t,r,n){var a=2*t,s=2*r;return e[a]<e[s]||e[a]===e[s]&&n[t]<=n[r]}function H(e,t,r){for(var n=e.heap[r],a=r<<1;a<=e.heap_len&&(a<e.heap_len&&W(t,e.heap[a+1],e.heap[a],e.depth)&&a++,!W(t,n,e.heap[a],e.depth));)e.heap[r]=e.heap[a],r=a,a<<=1;e.heap[r]=n}function G(e,t,r){var n,a,s,i,o=0;if(0!==e.last_lit)for(;n=e.pending_buf[e.d_buf+2*o]<<8|e.pending_buf[e.d_buf+2*o+1],a=e.pending_buf[e.l_buf+o],o++,0===n?U(e,a,t):(U(e,(s=E[a])+c+1,t),0!==(i=w[s])&&F(e,a-=C[s],i),U(e,s=L(--n),r),0!==(i=_[s])&&F(e,n-=R[s],i)),o<e.last_lit;);U(e,x,t)}function q(e,t){var r,n,a,s=t.dyn_tree,i=t.stat_desc.static_tree,o=t.stat_desc.has_stree,l=t.stat_desc.elems,c=-1;for(e.heap_len=0,e.heap_max=f,r=0;r<l;r++)0!==s[2*r]?(e.heap[++e.heap_len]=c=r,e.depth[r]=0):s[2*r+1]=0;for(;e.heap_len<2;)s[2*(a=e.heap[++e.heap_len]=c<2?++c:0)]=1,e.depth[a]=0,e.opt_len--,o&&(e.static_len-=i[2*a+1]);for(t.max_code=c,r=e.heap_len>>1;1<=r;r--)H(e,s,r);for(a=l;r=e.heap[1],e.heap[1]=e.heap[e.heap_len--],H(e,s,1),n=e.heap[1],e.heap[--e.heap_max]=r,e.heap[--e.heap_max]=n,s[2*a]=s[2*r]+s[2*n],e.depth[a]=(e.depth[r]>=e.depth[n]?e.depth[r]:e.depth[n])+1,s[2*r+1]=s[2*n+1]=a,e.heap[1]=a++,H(e,s,1),2<=e.heap_len;);e.heap[--e.heap_max]=e.heap[1],function(e,t){var r,n,a,s,i,o,l=t.dyn_tree,c=t.max_code,d=t.stat_desc.static_tree,u=t.stat_desc.has_stree,h=t.stat_desc.extra_bits,p=t.stat_desc.extra_base,g=t.stat_desc.max_length,x=0;for(s=0;s<=m;s++)e.bl_count[s]=0;for(l[2*e.heap[e.heap_max]+1]=0,r=e.heap_max+1;r<f;r++)g<(s=l[2*l[2*(n=e.heap[r])+1]+1]+1)&&(s=g,x++),l[2*n+1]=s,c<n||(e.bl_count[s]++,i=0,p<=n&&(i=h[n-p]),o=l[2*n],e.opt_len+=o*(s+i),u&&(e.static_len+=o*(d[2*n+1]+i)));if(0!==x){do{for(s=g-1;0===e.bl_count[s];)s--;e.bl_count[s]--,e.bl_count[s+1]+=2,e.bl_count[g]--,x-=2}while(0<x);for(s=g;0!==s;s--)for(n=e.bl_count[s];0!==n;)c<(a=e.heap[--r])||(l[2*a+1]!==s&&(e.opt_len+=(s-l[2*a+1])*l[2*a],l[2*a+1]=s),n--)}}(e,t),$(s,c,e.bl_count)}function K(e,t,r){var n,a,s=-1,i=t[1],o=0,l=7,c=4;for(0===i&&(l=138,c=3),t[2*(r+1)+1]=65535,n=0;n<=r;n++)a=i,i=t[2*(n+1)+1],++o<l&&a===i||(o<c?e.bl_tree[2*a]+=o:0!==a?(a!==s&&e.bl_tree[2*a]++,e.bl_tree[2*v]++):o<=10?e.bl_tree[2*b]++:e.bl_tree[2*y]++,s=a,c=(o=0)===i?(l=138,3):a===i?(l=6,3):(l=7,4))}function X(e,t,r){var n,a,s=-1,i=t[1],o=0,l=7,c=4;for(0===i&&(l=138,c=3),n=0;n<=r;n++)if(a=i,i=t[2*(n+1)+1],!(++o<l&&a===i)){if(o<c)for(;U(e,a,e.bl_tree),0!=--o;);else 0!==a?(a!==s&&(U(e,a,e.bl_tree),o--),U(e,v,e.bl_tree),F(e,o-3,2)):o<=10?(U(e,b,e.bl_tree),F(e,o-3,3)):(U(e,y,e.bl_tree),F(e,o-11,7));s=a,c=(o=0)===i?(l=138,3):a===i?(l=6,3):(l=7,4)}}i(R);var Y=!1;function J(e,t,r,a){var s,i,l;F(e,(o<<1)+(a?1:0),3),i=t,l=r,V(s=e),M(s,l),M(s,~l),n.arraySet(s.pending_buf,s.window,i,l,s.pending),s.pending+=l}r._tr_init=function(e){Y||(function(){var e,t,r,n,a,s=new Array(m+1);for(n=r=0;n<l-1;n++)for(C[n]=r,e=0;e<1<<w[n];e++)E[r++]=n;for(E[r-1]=n,n=a=0;n<16;n++)for(R[n]=a,e=0;e<1<<_[n];e++)T[a++]=n;for(a>>=7;n<u;n++)for(R[n]=a<<7,e=0;e<1<<_[n]-7;e++)T[256+a++]=n;for(t=0;t<=m;t++)s[t]=0;for(e=0;e<=143;)j[2*e+1]=8,e++,s[8]++;for(;e<=255;)j[2*e+1]=9,e++,s[9]++;for(;e<=279;)j[2*e+1]=7,e++,s[7]++;for(;e<=287;)j[2*e+1]=8,e++,s[8]++;for($(j,d+1,s),e=0;e<u;e++)S[2*e+1]=5,S[2*e]=B(e,5);A=new P(j,w,c+1,d,m),O=new P(S,_,0,u,m),I=new P(new Array(0),k,0,h,g)}(),Y=!0),e.l_desc=new D(e.dyn_ltree,A),e.d_desc=new D(e.dyn_dtree,O),e.bl_desc=new D(e.bl_tree,I),e.bi_buf=0,e.bi_valid=0,z(e)},r._tr_stored_block=J,r._tr_flush_block=function(e,t,r,n){var i,o,l=0;0<e.level?(2===e.strm.data_type&&(e.strm.data_type=function(e){var t,r=4093624447;for(t=0;t<=31;t++,r>>>=1)if(1&r&&0!==e.dyn_ltree[2*t])return a;if(0!==e.dyn_ltree[18]||0!==e.dyn_ltree[20]||0!==e.dyn_ltree[26])return s;for(t=32;t<c;t++)if(0!==e.dyn_ltree[2*t])return s;return a}(e)),q(e,e.l_desc),q(e,e.d_desc),l=function(e){var t;for(K(e,e.dyn_ltree,e.l_desc.max_code),K(e,e.dyn_dtree,e.d_desc.max_code),q(e,e.bl_desc),t=h-1;3<=t&&0===e.bl_tree[2*N[t]+1];t--);return e.opt_len+=3*(t+1)+5+5+4,t}(e),i=e.opt_len+3+7>>>3,(o=e.static_len+3+7>>>3)<=i&&(i=o)):i=o=r+5,r+4<=i&&-1!==t?J(e,t,r,n):4===e.strategy||o===i?(F(e,2+(n?1:0),3),G(e,j,S)):(F(e,4+(n?1:0),3),function(e,t,r,n){var a;for(F(e,t-257,5),F(e,r-1,5),F(e,n-4,4),a=0;a<n;a++)F(e,e.bl_tree[2*N[a]+1],3);X(e,e.dyn_ltree,t-1),X(e,e.dyn_dtree,r-1)}(e,e.l_desc.max_code+1,e.d_desc.max_code+1,l+1),G(e,e.dyn_ltree,e.dyn_dtree)),z(e),n&&V(e)},r._tr_tally=function(e,t,r){return e.pending_buf[e.d_buf+2*e.last_lit]=t>>>8&255,e.pending_buf[e.d_buf+2*e.last_lit+1]=255&t,e.pending_buf[e.l_buf+e.last_lit]=255&r,e.last_lit++,0===t?e.dyn_ltree[2*r]++:(e.matches++,t--,e.dyn_ltree[2*(E[r]+c+1)]++,e.dyn_dtree[2*L(t)]++),e.last_lit===e.lit_bufsize-1},r._tr_align=function(e){var t;F(e,2,3),U(e,x,j),16===(t=e).bi_valid?(M(t,t.bi_buf),t.bi_buf=0,t.bi_valid=0):8<=t.bi_valid&&(t.pending_buf[t.pending++]=255&t.bi_buf,t.bi_buf>>=8,t.bi_valid-=8)}},{"../utils/common":41}],53:[function(e,t,r){t.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(e,t,n){(function(e){!function(e,t){if(!e.setImmediate){var r,n,a,s,i=1,o={},l=!1,c=e.document,d=Object.getPrototypeOf&&Object.getPrototypeOf(e);d=d&&d.setTimeout?d:e,r="[object process]"==={}.toString.call(e.process)?function(e){process.nextTick(function(){h(e)})}:function(){if(e.postMessage&&!e.importScripts){var t=!0,r=e.onmessage;return e.onmessage=function(){t=!1},e.postMessage("","*"),e.onmessage=r,t}}()?(s="setImmediate$"+Math.random()+"$",e.addEventListener?e.addEventListener("message",f,!1):e.attachEvent("onmessage",f),function(t){e.postMessage(s+t,"*")}):e.MessageChannel?((a=new MessageChannel).port1.onmessage=function(e){h(e.data)},function(e){a.port2.postMessage(e)}):c&&"onreadystatechange"in c.createElement("script")?(n=c.documentElement,function(e){var t=c.createElement("script");t.onreadystatechange=function(){h(e),t.onreadystatechange=null,n.removeChild(t),t=null},n.appendChild(t)}):function(e){setTimeout(h,0,e)},d.setImmediate=function(e){"function"!=typeof e&&(e=new Function(""+e));for(var t=new Array(arguments.length-1),n=0;n<t.length;n++)t[n]=arguments[n+1];var a={callback:e,args:t};return o[i]=a,r(i),i++},d.clearImmediate=u}function u(e){delete o[e]}function h(e){if(l)setTimeout(h,0,e);else{var r=o[e];if(r){l=!0;try{!function(e){var r=e.callback,n=e.args;switch(n.length){case 0:r();break;case 1:r(n[0]);break;case 2:r(n[0],n[1]);break;case 3:r(n[0],n[1],n[2]);break;default:r.apply(t,n)}}(r)}finally{u(e),l=!1}}}}function f(t){t.source===e&&"string"==typeof t.data&&0===t.data.indexOf(s)&&h(+t.data.slice(s.length))}}("undefined"==typeof self?void 0===e?this:e:self)}).call(this,void 0!==r?r:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}]},{},[10])(10);const BN=n(UN.exports);var $N,zN={exports:{}};$N=zN,function(){function e(e,t){return void 0===t?t={autoBom:!1}:"object"!=typeof t&&(console.warn("Deprecated: Expected third argument to be a object"),t={autoBom:!t}),t.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(e.type)?new Blob(["\ufeff",e],{type:e.type}):e}function t(e,t,r){var n=new XMLHttpRequest;n.open("GET",e),n.responseType="blob",n.onload=function(){o(n.response,t,r)},n.onerror=function(){console.error("could not download file")},n.send()}function n(e){var t=new XMLHttpRequest;t.open("HEAD",e,!1);try{t.send()}catch(r){}return 200<=t.status&&299>=t.status}function a(e){try{e.dispatchEvent(new MouseEvent("click"))}catch(r){var t=document.createEvent("MouseEvents");t.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),e.dispatchEvent(t)}}var s="object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:"object"==typeof r&&r.global===r?r:void 0,i=s.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),o=s.saveAs||("object"!=typeof window||window!==s?function(){}:"download"in HTMLAnchorElement.prototype&&!i?function(e,r,i){var o=s.URL||s.webkitURL,l=document.createElement("a");r=r||e.name||"download",l.download=r,l.rel="noopener","string"==typeof e?(l.href=e,l.origin===location.origin?a(l):n(l.href)?t(e,r,i):a(l,l.target="_blank")):(l.href=o.createObjectURL(e),setTimeout(function(){o.revokeObjectURL(l.href)},4e4),setTimeout(function(){a(l)},0))}:"msSaveOrOpenBlob"in navigator?function(r,s,i){if(s=s||r.name||"download","string"!=typeof r)navigator.msSaveOrOpenBlob(e(r,i),s);else if(n(r))t(r,s,i);else{var o=document.createElement("a");o.href=r,o.target="_blank",setTimeout(function(){a(o)})}}:function(e,r,n,a){if((a=a||open("","_blank"))&&(a.document.title=a.document.body.innerText="downloading..."),"string"==typeof e)return t(e,r,n);var o="application/octet-stream"===e.type,l=/constructor/i.test(s.HTMLElement)||s.safari,c=/CriOS\/[\d]+/.test(navigator.userAgent);if((c||o&&l||i)&&"undefined"!=typeof FileReader){var d=new FileReader;d.onloadend=function(){var e=d.result;e=c?e:e.replace(/^data:[^;]*;/,"data:attachment/file;"),a?a.location.href=e:location=e,a=null},d.readAsDataURL(e)}else{var u=s.URL||s.webkitURL,h=u.createObjectURL(e);a?a.location=h:location.href=h,a=null,setTimeout(function(){u.revokeObjectURL(h)},4e4)}});s.saveAs=o.saveAs=o,$N.exports=o}();var VN=zN.exports;const WN=()=>{const[e,t]=W.useState(null),[r,n]=W.useState([]),[a,s]=W.useState(!1),[i,o]=W.useState(0),[l,c]=W.useState([]),[d,u]=W.useState({pricePosition:"bottom-right",priceColor:"#ff0909",fontSize:186.9,logoPosition:"none",fontFamily:"Barlow Condensed",fontWeight:"800",fontStyle:"italic",strokeColor:"#fee660",strokeWidth:6,useGradient:!1,gradientColor:"#fee660"}),[h,f]=W.useState(null),[m,p]=W.useState(null),[g,x]=W.useState(!1),[v,b]=W.useState(!1),[y,w]=W.useState(!1),[_,k]=W.useState(null),[N,j]=W.useState(null),[S,T]=W.useState(!1),[E,C]=W.useState(!1),A=W.useRef(null),O=W.useRef(null),I=e=>{c(t=>[...t,`${(new Date).toLocaleTimeString()}: ${e}`])},R=e=>{const t=new FileReader;t.onload=e=>{try{const t=SN(new Uint8Array(e.target.result),{type:"array"}),r=t.SheetNames[0],a=t.Sheets[r],s=MN.sheet_to_json(a);I(`Excel${s.length}`);const i=[];for(let e=0;e<s.length;e++){const t=s[e];let r=t["spu"]||"",n=t["*"]||"";const a=t["*"]||"";!n&&e+1<s.length&&(n=s[e+1]["*"]||"",I(`SPU ${r} : ${n}`)),r=String(r).trim(),n=String(n).trim(),n&&!isNaN(parseFloat(n))&&(n=Math.floor(parseFloat(n)).toString());const o=a.split(",").map(e=>e.trim()).filter(e=>e),l=o[0]||"";r&&n&&l&&i.push({id:i.length+1,spu:r,price:n,imageUrls:o,firstImageUrl:l,filename:`${n}-${r}.png`,status:"pending"})}n(i),I(`${i.length}`)}catch(t){console.error("Excel:",t),I(`Excel: ${t.message}`),alert("Excel")}},t.readAsArrayBuffer(e)};return Q.jsxs("div",{className:"max-w-7xl mx-auto",children:[Q.jsx("div",{className:"bg-white p-6 rounded-lg shadow-md mb-6",children:Q.jsxs("div",{className:"flex items-center space-x-3",children:[Q.jsx("div",{className:"bg-indigo-500 p-2 rounded-lg",children:Q.jsx("svg",{className:"w-6 h-6 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:Q.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M9 19l3 3m0 0l3-3m-3 3V10"})})}),Q.jsxs("div",{children:[Q.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:""}),Q.jsx("p",{className:"text-gray-600",children:"Excel"})]}),Q.jsx("div",{className:"ml-auto",children:Q.jsx("button",{onClick:()=>C(!E),className:"bg-purple-500 hover:bg-purple-600 text-white font-bold py-2 px-4 rounded-lg transition-colors",children:" "})})]})}),E&&Q.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6 mb-6",children:[Q.jsxs("div",{className:"flex items-center justify-between mb-4",children:[Q.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:" "}),Q.jsx("button",{onClick:()=>C(!1),className:"text-gray-400 hover:text-gray-600",children:Q.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:Q.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),Q.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[Q.jsxs("div",{className:"space-y-4",children:[Q.jsx("h4",{className:"font-medium text-gray-700",children:" "}),Q.jsxs("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-6 text-center",children:[Q.jsx("input",{type:"file",accept:"image/*",onChange:e=>{const t=e.target.files[0];if(t){if(!t.type.startsWith("image/"))return void I(" ");if(t.size>10485760)return void I(" 10MB");const e=new FileReader;e.onload=e=>{const r=new Image;r.onload=()=>{800===r.width&&800===r.height?(k(t),j(e.target.result),I(" ")):I("  800x800 ")},r.src=e.target.result},e.readAsDataURL(t)}},className:"hidden",id:"template-upload"}),Q.jsxs("label",{htmlFor:"template-upload",className:"cursor-pointer flex flex-col items-center space-y-2",children:[Q.jsx("svg",{className:"w-12 h-12 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:Q.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})}),Q.jsx("span",{className:"text-sm text-gray-600",children:" 800x800 PNG "}),Q.jsx("span",{className:"text-xs text-gray-400",children:" PNGJPG  10MB"})]})]}),N&&Q.jsxs("div",{className:"space-y-3",children:[Q.jsxs("div",{className:"flex items-center space-x-2",children:[Q.jsx("input",{type:"checkbox",id:"use-template",checked:S,onChange:e=>T(e.target.checked),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),Q.jsx("label",{htmlFor:"use-template",className:"text-sm text-gray-700",children:""})]}),Q.jsx("button",{onClick:()=>{k(null),j(null),T(!1),I(" ")},className:"bg-red-500 hover:bg-red-600 text-white font-bold py-2 px-4 rounded-lg transition-colors text-sm",children:" "})]})]}),Q.jsxs("div",{className:"space-y-4",children:[Q.jsx("h4",{className:"font-medium text-gray-700",children:" "}),Q.jsx("div",{className:"border rounded-lg p-4 bg-gray-50",children:N?Q.jsxs("div",{className:"space-y-3",children:[Q.jsx("img",{src:N,alt:"",className:"w-full max-w-xs mx-auto rounded-lg shadow-md"}),Q.jsxs("div",{className:"text-center text-sm text-gray-600",children:[Q.jsxs("p",{children:["  ",S?"()":"()"]}),Q.jsx("p",{className:"text-xs text-gray-500",children:"800x800 "})]})]}):Q.jsxs("div",{className:"text-center text-gray-400 py-8",children:[Q.jsx("svg",{className:"w-16 h-16 mx-auto mb-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:Q.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v14a2 2 0 002 2z"})}),Q.jsx("p",{children:""}),Q.jsx("p",{className:"text-xs",children:" 800x800  PNG "})]})})]})]})]}),Q.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[Q.jsx("div",{className:"lg:col-span-1",children:Q.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6 space-y-6",children:[Q.jsxs("div",{children:[Q.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:""}),Q.jsxs("div",{className:"mb-4",children:[Q.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Excel"}),Q.jsx("input",{ref:O,type:"file",accept:".xlsx",onChange:e=>{const r=e.target.files[0];r&&(r.name.toLowerCase().endsWith(".xlsx")?(t(r),c([]),n([]),I("..."),R(r)):alert("Excel(.xlsx)"))},className:"hidden"}),Q.jsx("button",{onClick:()=>{var e;return null==(e=O.current)?void 0:e.click()},disabled:a,className:"w-full bg-indigo-500 hover:bg-indigo-600 disabled:bg-gray-400 text-white font-bold py-3 px-4 rounded-lg transition-colors",children:"Excel"}),e&&Q.jsxs("p",{className:"text-sm text-gray-600 mt-2",children:[": ",e.name]})]}),r.length>0&&Q.jsxs("div",{className:"border-t pt-4 space-y-4",children:[Q.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-3",children:""}),Q.jsxs("div",{className:"bg-gradient-to-r from-red-500 to-yellow-500 text-white p-3 rounded-lg",children:[Q.jsx("p",{className:"text-sm font-bold",children:" "}),Q.jsx("p",{className:"text-xs opacity-90",children:"Barlow Condensed ExtraBold Italic"}),Q.jsx("p",{className:"text-xs opacity-90",children:"#ff0909   186.9px   6px "})]}),Q.jsxs("div",{children:[Q.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""}),Q.jsxs("select",{value:d.pricePosition,onChange:e=>u(t=>({...t,pricePosition:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[Q.jsx("option",{value:"none",children:""}),Q.jsx("option",{value:"top-left",children:""}),Q.jsx("option",{value:"top-right",children:""}),Q.jsx("option",{value:"bottom-left",children:""}),Q.jsx("option",{value:"bottom-right",children:""})]})]}),Q.jsxs("div",{children:[Q.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""}),Q.jsxs("div",{className:"flex items-center space-x-3",children:[Q.jsx("input",{type:"range",min:"24",max:"200",step:"0.1",value:d.fontSize,onChange:e=>u(t=>({...t,fontSize:parseFloat(e.target.value)})),className:"flex-1"}),Q.jsx("input",{type:"number",min:"24",max:"200",step:"0.1",value:d.fontSize,onChange:e=>u(t=>({...t,fontSize:parseFloat(e.target.value)})),className:"w-20 px-2 py-1 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"}),Q.jsx("span",{className:"text-sm text-gray-500",children:"px"})]})]}),Q.jsxs("div",{children:[Q.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[Q.jsx("input",{type:"checkbox",id:"use-gradient",checked:d.useGradient,onChange:e=>u(t=>({...t,useGradient:e.target.checked})),className:"rounded border-gray-300"}),Q.jsx("label",{htmlFor:"use-gradient",className:"text-sm font-medium text-gray-700",children:""})]}),Q.jsxs("div",{className:"grid grid-cols-1 gap-3",children:[Q.jsxs("div",{children:[Q.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:""}),Q.jsxs("div",{className:"flex items-center space-x-2",children:[Q.jsx("input",{type:"color",value:d.priceColor,onChange:e=>u(t=>({...t,priceColor:e.target.value})),className:"w-8 h-8 border border-gray-300 rounded cursor-pointer"}),Q.jsx("input",{type:"text",value:d.priceColor,onChange:e=>u(t=>({...t,priceColor:e.target.value})),className:"flex-1 px-2 py-1 text-xs border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]}),d.useGradient&&Q.jsxs("div",{children:[Q.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:""}),Q.jsxs("div",{className:"flex items-center space-x-2",children:[Q.jsx("input",{type:"color",value:d.gradientColor,onChange:e=>u(t=>({...t,gradientColor:e.target.value})),className:"w-8 h-8 border border-gray-300 rounded cursor-pointer"}),Q.jsx("input",{type:"text",value:d.gradientColor,onChange:e=>u(t=>({...t,gradientColor:e.target.value})),className:"flex-1 px-2 py-1 text-xs border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]})]})]}),Q.jsxs("div",{children:[Q.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""}),Q.jsxs("div",{className:"space-y-2",children:[Q.jsxs("div",{children:[Q.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:""}),Q.jsxs("div",{className:"flex items-center space-x-2",children:[Q.jsx("input",{type:"range",min:"0",max:"20",value:d.strokeWidth,onChange:e=>u(t=>({...t,strokeWidth:parseInt(e.target.value)})),className:"flex-1"}),Q.jsxs("span",{className:"text-xs text-gray-500 w-8",children:[d.strokeWidth,"px"]})]})]}),Q.jsxs("div",{children:[Q.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:""}),Q.jsx("input",{type:"color",value:d.strokeColor,onChange:e=>u(t=>({...t,strokeColor:e.target.value})),className:"w-full h-8 border border-gray-300 rounded cursor-pointer"})]})]})]})]})]}),r.length>0&&Q.jsxs("div",{className:"space-y-3",children:[Q.jsx("button",{onClick:async()=>{if(0===r.length)return void alert("Excel");b(!0),I("...");const e=new BN;let t=0;for(let a=0;a<r.length;a++){const s=r[a];try{I(`: ${s.spu}`);const r=await new Promise((e,t)=>{const r=new Image,n=setTimeout(()=>{t(new Error(""))},1e4);r.onload=()=>{clearTimeout(n);try{const t=document.createElement("canvas"),n=t.getContext("2d");t.width=800,t.height=800,n.fillStyle="#FFFFFF",n.fillRect(0,0,800,800);const a=Math.min(800/r.width,800/r.height),i=r.width*a,o=r.height*a,l=(800-i)/2,c=(800-o)/2;if(n.drawImage(r,l,c,i,o),S&&N){const e=new Image;e.src=N,n.drawImage(e,0,0,800,800)}if(d.pricePosition&&"none"!==d.pricePosition){const e=`MX$${s.price}`,t=d.fontSize,r=d.fontWeight||"bold",a=d.fontStyle||"normal",i=d.fontFamily||"Arial";n.font=`${a} ${r} ${t}px ${i}`;const o=n.measureText(e).width,l=15;let c,u;switch(d.pricePosition){case"top-left":c=l,u=l+t;break;case"top-right":c=800-o-l,u=l+t;break;case"bottom-left":c=l,u=800-l;break;case"bottom-right":c=800-o-l,u=800-l}if(d.strokeWidth>0&&(n.strokeStyle=d.strokeColor||"#FFFFFF",n.lineWidth=d.strokeWidth,n.lineJoin="round",n.miterLimit=2,n.strokeText(e,c,u)),d.useGradient&&d.gradientColor){const e=n.createLinearGradient(c,u-t,c,u);e.addColorStop(0,d.priceColor),e.addColorStop(1,d.gradientColor),n.fillStyle=e}else n.fillStyle=d.priceColor;n.fillText(e,c,u)}t.toBlob(e,"image/png",.9)}catch(a){t(a)}},r.onerror=()=>{clearTimeout(n),t(new Error(""))},r.crossOrigin="anonymous",r.src=s.firstImageUrl}),n=`${s.price}-${s.spu}.png`;e.file(n,r),t++,I(` : ${n}`)}catch(n){I(` : ${s.spu} - ${n.message}`)}await new Promise(e=>setTimeout(e,200))}if(t>0){const r=await e.generateAsync({type:"blob"}),n=(new Date).toISOString().slice(0,19).replace(/:/g,"-");VN.saveAs(r,`product-images-${n}.zip`),I(`  ${t} `)}b(!1)},disabled:v,className:"w-full bg-green-500 hover:bg-green-600 disabled:bg-gray-400 text-white font-bold py-3 px-4 rounded-lg transition-colors",children:v?"...":""}),Q.jsx("button",{onClick:()=>{t(null),n([]),s(!1),o(0),c([]),f(null),p(null),O.current&&(O.current.value=""),A.current&&(A.current.value=""),I("")},className:"w-full bg-gray-500 hover:bg-gray-600 text-white font-bold py-2 px-4 rounded-lg transition-colors",children:""})]})]})}),Q.jsxs("div",{className:"lg:col-span-2",children:[Q.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[Q.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:""}),Q.jsx("div",{className:"bg-gray-50 rounded-lg p-4 h-96 overflow-y-auto",children:0===l.length?Q.jsx("p",{className:"text-gray-500 text-sm",children:"..."}):Q.jsx("div",{className:"space-y-1",children:l.map((e,t)=>Q.jsx("div",{className:"text-sm font-mono text-gray-700",children:e},t))})})]}),r.length>0&&Q.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6 mt-6",children:[Q.jsxs("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:[" (",r.length,")"]}),Q.jsx("div",{className:"max-h-64 overflow-y-auto",children:Q.jsxs("div",{className:"space-y-2",children:[r.slice(0,10).map((e,t)=>Q.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[Q.jsxs("div",{className:"flex-1",children:[Q.jsx("p",{className:"font-medium text-gray-800",children:e.spu}),Q.jsxs("p",{className:"text-sm text-gray-600",children:["MX$",e.price]})]}),Q.jsx("div",{className:"w-12 h-12 bg-gray-200 rounded-lg overflow-hidden",children:Q.jsx("img",{src:e.firstImageUrl,alt:e.spu,className:"w-full h-full object-cover",onError:e=>{e.target.style.display="none"}})})]},t)),r.length>10&&Q.jsxs("div",{className:"text-center py-2 text-gray-500 text-sm",children:[" ",r.length-10," ..."]})]})})]})]})]})]})},HN={async getAllRequests(){try{const{data:e,error:t}=await sp.from("app_e87b41cfe355428b8146f8bae8184e10_account_reset").select("*").order("created_at",{ascending:!1});if(t)throw console.error("Supabase error fetching reset requests:",t),new Error(`: ${t.message}`);return e||[]}catch(e){throw console.error("Error in getAllRequests:",e),e}},async getPendingRequests(){try{const{data:e,error:t}=await sp.from("app_e87b41cfe355428b8146f8bae8184e10_account_reset").select("*").eq("status","pending").order("created_at",{ascending:!1});if(t)throw t;return e||[]}catch(e){throw console.error(":",e),e}},async createRequest(e){try{console.log("Creating reset request:",e);let t=null;if(e.screenshot){const r=e.screenshot.name.split(".").pop().toLowerCase(),n=Date.now(),a=`${n}_${{"":"qing","":"qiao","":"bai","":"ding","":"mei"}[e.advertiser]||e.advertiser}_balance.${r}`;console.log("Uploading file:",a);const{data:s,error:i}=await sp.storage.from("account-reset-screenshots").upload(a,e.screenshot,{cacheControl:"3600",upsert:!1});if(i)throw console.error("Screenshot upload error:",i),new Error(`: ${i.message}`);console.log("Upload successful:",s);const{data:o}=sp.storage.from("account-reset-screenshots").getPublicUrl(a);t=o.publicUrl}const{data:r,error:n}=await sp.from("app_e87b41cfe355428b8146f8bae8184e10_account_reset").insert([{advertiser:e.advertiser,account_name:e.accountName,account_id:e.accountId,balance:parseFloat(e.balance),screenshot_url:t,status:"pending",created_at:(new Date).toISOString()}]).select();if(n)throw console.error("Supabase error creating reset request:",n),new Error(`: ${n.message}`);return console.log("Reset request created successfully:",r[0]),r[0]}catch(t){throw console.error("Error in createRequest:",t),t}},async updateRequest(e,t){try{console.log("Updating reset request:",e,"with updates:",t);const{data:r,error:n}=await sp.from("app_e87b41cfe355428b8146f8bae8184e10_account_reset").update({...t,updated_at:(new Date).toISOString()}).eq("id",e).select();if(n)throw console.error("Supabase error updating reset request:",n),new Error(`: ${n.message}`);if(console.log("Update result:",r),!r||0===r.length)throw console.warn("No records were updated"),new Error("");return console.log(":",e),r[0]}catch(r){throw console.error("Error in updateRequest:",r),r}},async processRequest(e,t,r=""){try{const n={status:t,processed_at:(new Date).toISOString(),processed_by:"Admin",admin_notes:r};return console.log("Processing reset request:",e,"with action:",t),await this.updateRequest(e,n)}catch(n){throw console.error("Error in processRequest:",n),n}},async searchRequests(e,t=null){try{let r=sp.from("app_e87b41cfe355428b8146f8bae8184e10_account_reset").select("*").order("created_at",{ascending:!1});e&&(r=r.ilike("advertiser",`%${e}%`)),t&&"all"!==t&&(r=r.eq("status",t));const{data:n,error:a}=await r;if(a)throw a;return n||[]}catch(r){throw console.error(":",r),r}},async getRequestsByDateRange(e,t,r=null){try{let n=sp.from("app_e87b41cfe355428b8146f8bae8184e10_account_reset").select("*").gte("created_at",e).lte("created_at",t).order("created_at",{ascending:!1});r&&"all"!==r&&(n=n.eq("status",r));const{data:a,error:s}=await n;if(s)throw s;return a||[]}catch(n){throw console.error(":",n),n}},async deleteRequest(e){try{console.log("Deleting reset request with ID:",e);const{data:t,error:r}=await sp.from("app_e87b41cfe355428b8146f8bae8184e10_account_reset").delete().eq("id",e).select();if(r)throw console.error("Supabase error deleting reset request:",r),new Error(`: ${r.message}`);if(console.log("Delete result:",t),!t||0===t.length)throw console.warn("No records were deleted"),new Error("");return console.log(":",e),!0}catch(t){throw console.error("Error in deleteRequest:",t),t}},async approveRequest(e,t=""){try{return await this.processRequest(e,"approved",t)}catch(r){throw console.error("Error approving reset request:",r),r}},async rejectRequest(e,t=""){try{return await this.processRequest(e,"rejected",t)}catch(r){throw console.error("Error rejecting reset request:",r),r}},async getAllAccounts(){try{const{data:e,error:t}=await sp.from("app_e87b41cfe355428b8146f8bae8184e10_ad_accounts").select("*").order("created_at",{ascending:!1});if(t)throw console.error("Supabase error fetching accounts:",t),new Error(`: ${t.message}`);return e||[]}catch(e){throw console.error("Error in getAllAccounts:",e),e}},async createAccount(e){try{const{data:t,error:r}=await sp.from("app_e87b41cfe355428b8146f8bae8184e10_ad_accounts").insert([{account_name:e.accountName,account_id:e.accountId,advertiser:e.advertiser}]).select();if(r)throw console.error("Supabase error creating account:",r),new Error(`: ${r.message}`);return t[0]}catch(t){throw console.error("Error in createAccount:",t),t}},async deleteAccount(e){try{const{error:t}=await sp.from("app_e87b41cfe355428b8146f8bae8184e10_ad_accounts").delete().eq("id",e);if(t)throw console.error("Supabase error deleting account:",t),new Error(`: ${t.message}`);return!0}catch(t){throw console.error("Error in deleteAccount:",t),t}}},GN=()=>{const[e,t]=W.useState([]),[r,n]=W.useState(!0),[a,s]=W.useState(null),[i,o]=W.useState({show:!1,message:"",type:"success"}),[l,c]=W.useState(!1),[d,u]=W.useState(""),[h,f]=W.useState(!1),[m,p]=W.useState(!1),[g,x]=W.useState(1),[v,b]=W.useState(!1),[y,w]=W.useState(null),[_,k]=W.useState({advertiser:"",accountName:"",accountId:"",balance:"",screenshot:null,screenshotPreview:null});W.useEffect(()=>{N()},[]);const N=async()=>{try{n(!0),s(null);const e=await HN.getAllRequests();t(e||[])}catch(e){console.error("Failed to load requests:",e),s(": "+e.message),t([])}finally{n(!1)}},j=(e,t="success")=>{o({show:!0,message:e,type:t}),setTimeout(()=>{o({show:!1,message:"",type:"success"})},3e3)},S=()=>{"19990403"===d?(c(!0),f(!1),u(""),j("","success")):j("","error")},T=(e,t)=>{w({url:e,info:t}),b(!0)};return r?Q.jsxs("div",{className:"flex justify-center items-center h-64",children:[Q.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500"}),Q.jsx("span",{className:"ml-3 text-gray-600",children:"..."})]}):Q.jsxs("div",{className:"p-6",children:[i.show&&Q.jsx("div",{className:"fixed top-6 right-6 z-50 p-4 rounded-lg shadow-lg transform transition-all duration-300 "+("success"===i.type?"bg-green-50 border border-green-200 text-green-800":"bg-red-50 border border-red-200 text-red-800"),children:Q.jsxs("div",{className:"flex items-center",children:[Q.jsx("div",{className:"p-1 rounded-full mr-3",children:Q.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 20 20",children:Q.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})})}),Q.jsx("span",{className:"font-medium",children:i.message})]})}),Q.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6 mb-6",children:Q.jsxs("div",{className:"flex items-center justify-between",children:[Q.jsxs("div",{className:"flex items-center space-x-4",children:[Q.jsx("div",{className:"flex items-center justify-center w-12 h-12 bg-blue-600 rounded-lg",children:Q.jsx("svg",{className:"w-6 h-6 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:Q.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})}),Q.jsxs("div",{children:[Q.jsx("h2",{className:"text-2xl font-medium text-gray-900",children:""}),Q.jsx("p",{className:"text-gray-600",children:"4 + "})]})]}),Q.jsxs("div",{className:"flex space-x-3",children:[Q.jsxs("button",{onClick:()=>{p(!0),x(1),k({advertiser:"",accountName:"",accountId:"",balance:"",screenshot:null,screenshotPreview:null})},className:"inline-flex items-center px-4 py-2 bg-blue-600 text-white text-sm font-medium rounded-lg hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-colors duration-200",children:[Q.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:Q.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),""]}),l?Q.jsxs("div",{className:"flex items-center bg-green-50 text-green-700 px-4 py-2 rounded-lg border border-green-200",children:[Q.jsx("svg",{className:"w-4 h-4 mr-2",fill:"currentColor",viewBox:"0 0 20 20",children:Q.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}),Q.jsx("span",{className:"text-sm font-medium",children:""}),Q.jsx("button",{onClick:()=>c(!1),className:"ml-3 text-sm text-green-600 hover:text-green-800 transition-colors font-medium",children:""})]}):Q.jsxs("button",{onClick:()=>f(!0),className:"inline-flex items-center px-4 py-2 bg-gray-600 text-white text-sm font-medium rounded-lg hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:ring-offset-2 transition-colors duration-200",children:[Q.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:Q.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})}),""]})]})]})}),a&&Q.jsx("div",{className:"mb-6 p-4 bg-red-50 border border-red-200 text-red-800 rounded-lg",children:Q.jsxs("div",{className:"flex items-center space-x-3",children:[Q.jsx("div",{className:"p-2 bg-red-100 rounded-full",children:Q.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:Q.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})})}),Q.jsx("span",{className:"font-medium",children:a})]})}),h&&Q.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:Q.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-xl max-w-md w-full mx-4",children:[Q.jsxs("div",{className:"flex items-center justify-between mb-6",children:[Q.jsxs("div",{className:"flex items-center space-x-3",children:[Q.jsx("div",{className:"flex items-center justify-center w-10 h-10 bg-blue-600 rounded-lg",children:Q.jsx("svg",{className:"w-5 h-5 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:Q.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})})}),Q.jsx("h3",{className:"text-lg font-medium text-gray-900",children:""})]}),Q.jsx("button",{onClick:()=>{f(!1),u("")},className:"text-gray-400 hover:text-gray-600 p-2 hover:bg-gray-100 rounded-lg transition-colors",children:Q.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:Q.jsx("path",{fillRule:"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z",clipRule:"evenodd"})})})]}),Q.jsxs("div",{className:"space-y-4",children:[Q.jsxs("div",{children:[Q.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""}),Q.jsx("input",{type:"password",value:d,onChange:e=>u(e.target.value),onKeyPress:e=>"Enter"===e.key&&S(),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:""})]}),Q.jsxs("div",{className:"flex space-x-3",children:[Q.jsx("button",{onClick:S,className:"flex-1 bg-blue-600 hover:bg-blue-700 text-white font-medium py-2 px-4 rounded-lg transition-colors",children:""}),Q.jsx("button",{onClick:()=>{f(!1),u("")},className:"flex-1 bg-gray-500 hover:bg-gray-600 text-white font-medium py-2 px-4 rounded-lg transition-colors",children:""})]})]})]})}),Q.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200",children:[Q.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:Q.jsxs("div",{className:"flex items-center space-x-3",children:[Q.jsx("div",{className:"flex items-center justify-center w-8 h-8 bg-blue-600 rounded-lg",children:Q.jsx("svg",{className:"w-5 h-5 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:Q.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5H7a2 2 0 00-2 2v10a2 2 0 002 2h8a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"})})}),Q.jsx("h3",{className:"text-lg font-medium text-gray-900",children:""})]})}),Q.jsx("div",{className:"overflow-x-auto",children:Q.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[Q.jsx("thead",{className:"bg-gray-50",children:Q.jsxs("tr",{children:[Q.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""}),Q.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""}),Q.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""}),Q.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""}),Q.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""}),Q.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""}),l&&Q.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:""})]})}),Q.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:0===e.length?Q.jsx("tr",{children:Q.jsx("td",{colSpan:l?7:6,className:"px-6 py-12 text-center",children:Q.jsxs("div",{className:"flex flex-col items-center space-y-4",children:[Q.jsx("div",{className:"p-6 bg-gray-100 rounded-lg",children:Q.jsx("svg",{className:"w-12 h-12 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:Q.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M9 5H7a2 2 0 00-2 2v10a2 2 0 002 2h8a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"})})}),Q.jsxs("div",{children:[Q.jsx("p",{className:"text-lg font-medium text-gray-900",children:""}),Q.jsx("p",{className:"text-sm text-gray-500 mt-1",children:'""4'})]})]})})}):e.map(e=>Q.jsxs("tr",{className:"hover:bg-gray-50 transition-colors duration-200",children:[Q.jsx("td",{className:"px-6 py-4",children:Q.jsxs("div",{className:"flex items-center space-x-3",children:[Q.jsx("div",{className:"w-10 h-10 bg-blue-600 rounded-full flex items-center justify-center text-white font-bold text-sm",children:e.advertiser}),Q.jsxs("div",{children:[Q.jsxs("div",{className:"text-sm font-medium text-gray-900",children:[": ",e.advertiser]}),Q.jsxs("div",{className:"text-sm text-gray-500",children:["ID: #",e.id]})]})]})}),Q.jsx("td",{className:"px-6 py-4",children:Q.jsxs("div",{className:"space-y-1",children:[Q.jsxs("div",{className:"text-sm font-medium text-gray-900",children:[": ",e.account_name||"N/A"]}),Q.jsxs("div",{className:"text-sm text-gray-500",children:["ID: ",e.account_id||"N/A"]})]})}),Q.jsx("td",{className:"px-6 py-4",children:Q.jsxs("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800",children:["$",parseFloat(e.balance||0).toFixed(2)]})}),Q.jsx("td",{className:"px-6 py-4",children:e.screenshot_url?Q.jsxs("div",{className:"flex items-center space-x-2",children:[Q.jsx("img",{src:e.screenshot_url,alt:"",className:"w-12 h-12 object-cover rounded-lg border border-gray-200 cursor-pointer hover:opacity-75 transition-opacity",onClick:()=>T(e.screenshot_url,e),title:""}),Q.jsx("button",{onClick:()=>T(e.screenshot_url,e),className:"text-blue-600 hover:text-blue-800 text-xs",children:""})]}):Q.jsx("span",{className:"text-gray-400 text-sm",children:""})}),Q.jsx("td",{className:"px-6 py-4",children:Q.jsx("span",{className:"inline-flex px-2 py-1 text-xs font-semibold rounded-full "+("pending"===e.status?"bg-yellow-100 text-yellow-800":"approved"===e.status?"bg-green-100 text-green-800":"rejected"===e.status?"bg-red-100 text-red-800":"bg-gray-100 text-gray-800"),children:"pending"===e.status?" ":"approved"===e.status?" ":"rejected"===e.status?" ":" "})}),Q.jsx("td",{className:"px-6 py-4 text-sm text-gray-500",children:e.created_at?new Date(e.created_at).toLocaleString("zh-CN"):"N/A"}),l&&Q.jsxs("td",{className:"px-6 py-4 text-sm space-x-2",children:["pending"===e.status&&Q.jsxs(Q.Fragment,{children:[Q.jsx("button",{onClick:()=>(async e=>{if(window.confirm(""))try{await HN.processRequest(e,"approved",""),j("","success"),await N()}catch(t){console.error("Failed to approve request:",t),j(": "+t.message,"error")}})(e.id),className:"inline-flex items-center px-2.5 py-1.5 border border-transparent text-xs font-medium rounded text-white bg-green-600 hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500",children:""}),Q.jsx("button",{onClick:()=>(async e=>{const t=prompt("");if(null!==t)try{await HN.processRequest(e,"rejected",t||""),j("","success"),await N()}catch(r){console.error("Failed to reject request:",r),j(": "+r.message,"error")}})(e.id),className:"inline-flex items-center px-2.5 py-1.5 border border-transparent text-xs font-medium rounded text-white bg-red-600 hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500",children:""})]}),Q.jsx("button",{onClick:()=>(async e=>{if(window.confirm(""))try{await HN.deleteRequest(e),j("","success"),await N()}catch(t){console.error("Failed to delete request:",t),j(": "+t.message,"error")}})(e.id),className:"inline-flex items-center px-2.5 py-1.5 border border-transparent text-xs font-medium rounded text-white bg-gray-600 hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500",children:""})]})]},e.id))})]})})]}),v&&y&&Q.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50",children:Q.jsxs("div",{className:"bg-white rounded-lg p-4 max-w-4xl max-h-[90vh] overflow-auto",children:[Q.jsxs("div",{className:"flex items-center justify-between mb-4",children:[Q.jsxs("div",{children:[Q.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:""}),Q.jsxs("p",{className:"text-sm text-gray-600",children:[": ",y.info.advertiser," | : ",y.info.account_name||"N/A"," | : $",parseFloat(y.info.balance||0).toFixed(2)]})]}),Q.jsx("button",{onClick:()=>{b(!1),w(null)},className:"text-gray-400 hover:text-gray-600 text-2xl",children:""})]}),Q.jsxs("div",{className:"text-center",children:[Q.jsx("img",{src:y.url,alt:"",className:"max-w-full max-h-[70vh] object-contain rounded-lg"}),Q.jsxs("div",{className:"mt-4 flex justify-center space-x-3",children:[Q.jsx("button",{onClick:()=>window.open(y.url,"_blank"),className:"bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-lg transition-colors",children:""}),Q.jsx("a",{href:y.url,download:`balance_screenshot_${y.info.advertiser}_${new Date(y.info.created_at).toLocaleDateString()}.jpg`,className:"bg-green-500 hover:bg-green-600 text-white px-4 py-2 rounded-lg transition-colors inline-block",children:""}),Q.jsx("button",{onClick:()=>{b(!1),w(null)},className:"bg-gray-500 hover:bg-gray-600 text-white px-4 py-2 rounded-lg transition-colors",children:""})]})]})]})})]})},qN=e=>{const t=(e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,r)=>r?r.toUpperCase():t.toLowerCase()))(e);return t.charAt(0).toUpperCase()+t.slice(1)},KN=(...e)=>e.filter((e,t,r)=>Boolean(e)&&""!==e.trim()&&r.indexOf(e)===t).join(" ").trim(),XN=e=>{for(const t in e)if(t.startsWith("aria-")||"role"===t||"title"===t)return!0};
/**
 * @license lucide-react v0.536.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
var YN={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};
/**
 * @license lucide-react v0.536.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const JN=W.forwardRef(({color:e="currentColor",size:t=24,strokeWidth:r=2,absoluteStrokeWidth:n,className:a="",children:s,iconNode:i,...o},l)=>W.createElement("svg",{ref:l,...YN,width:t,height:t,stroke:e,strokeWidth:n?24*Number(r)/Number(t):r,className:KN("lucide",a),...!s&&!XN(o)&&{"aria-hidden":"true"},...o},[...i.map(([e,t])=>W.createElement(e,t)),...Array.isArray(s)?s:[s]])),ZN=(e,t)=>{const r=W.forwardRef(({className:r,...n},a)=>{return W.createElement(JN,{ref:a,iconNode:t,className:KN(`lucide-${s=qN(e),s.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()}`,`lucide-${e}`,r),...n});var s});return r.displayName=qN(e),r},QN=ZN("calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]),ej=ZN("chevron-down",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]),tj=ZN("circle-alert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]),rj=ZN("clock",[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]),nj=ZN("copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]),aj=ZN("credit-card",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]),sj=ZN("dollar-sign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]),ij=ZN("funnel",[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]]),oj=ZN("history",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]]),lj=ZN("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]),cj=ZN("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]),dj=ZN("refresh-cw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]),uj=ZN("trash-2",[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]]),hj=ZN("trending-down",[["path",{d:"M16 17h6v-6",key:"t6n2it"}],["path",{d:"m22 17-8.5-8.5-5 5L2 7",key:"x473p"}]]),fj=ZN("trending-up",[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]]),mj=ZN("users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]]),pj=ZN("x",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),gj=({isOpen:e,onClose:t,onSuccess:r,staffId:n,staffName:a})=>{const[s,i]=W.useState({accountName:"",adAccountId:"",status:"Active"}),[o,l]=W.useState(!1),[c,d]=W.useState("");if(!e)return null;const u=(e,t)=>{i(r=>({...r,[e]:t})),d("")};return Q.jsx("div",{className:"fixed inset-0 bg-black/20 backdrop-blur-sm flex items-center justify-center z-50 p-4",onClick:e=>{e.target===e.currentTarget&&t()},children:Q.jsxs("div",{className:"backdrop-blur-xl bg-white/95 border border-white/30 rounded-2xl p-6 lg:p-8 w-full max-w-md mx-auto shadow-2xl shadow-indigo-100/50 transform transition-all max-h-screen overflow-y-auto",children:[Q.jsxs("div",{className:"flex justify-between items-center mb-8",children:[Q.jsxs("div",{className:"flex items-center space-x-3",children:[Q.jsx("div",{className:"w-3 h-3 bg-gradient-to-r from-indigo-500 to-purple-500 rounded-full"}),Q.jsx("h3",{className:"text-2xl font-bold text-gray-800 bg-gradient-to-r from-indigo-600 to-purple-600 bg-clip-text text-transparent",children:""})]}),Q.jsx("button",{onClick:t,className:"text-gray-500 hover:text-gray-700 transition-colors p-2 rounded-lg hover:bg-gray-100/50",children:Q.jsx(pj,{size:24})})]}),Q.jsx("div",{className:"bg-gradient-to-r from-indigo-50 to-purple-50 border border-indigo-100 rounded-xl p-5 mb-6",children:Q.jsxs("div",{className:"flex items-center space-x-4",children:[Q.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-indigo-500 to-purple-600 rounded-full flex items-center justify-center shadow-lg",children:Q.jsx("span",{className:"text-white font-bold text-lg",children:a.charAt(0)})}),Q.jsxs("div",{children:[Q.jsx("p",{className:"text-gray-800 font-bold text-lg",children:a}),Q.jsx("p",{className:"text-indigo-600 text-sm font-medium",children:""})]})]})}),Q.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),s.accountName.trim())if(s.adAccountId.trim())if(/^\d+$/.test(s.adAccountId.trim()))try{l(!0),d("");const{data:e,error:o}=await up.from("app_e87b41cfe355428b8146f8bae8184e10_account_management_ads").select("id, account_name, personnel_id").eq("ad_account_id",s.adAccountId.trim()).single();if(o&&"PGRST116"!==o.code)throw o;if(e){let t="";if(e.personnel_id)try{const{data:r}=await up.from("app_e87b41cfe355428b8146f8bae8184e10_personnel").select("name").eq("id",e.personnel_id).single();r&&(t=r.name)}catch(a){console.log(":",a)}return void d(`ID "${t}"  "${e.account_name}" IDID`)}let c=!1;try{const{data:e,error:t}=await up.from("app_5c098b55fc88465db9b331c43b51ef43_advertising_accounts").select("id, account_name, account_id").eq("account_id",s.adAccountId.trim()).single();e&&!t&&(console.log(`: ${e.account_name}`),c=!0)}catch(a){console.log(":",a)}const{error:u}=await up.from("app_e87b41cfe355428b8146f8bae8184e10_account_management_ads").insert({personnel_id:n,account_name:s.accountName.trim(),ad_account_id:s.adAccountId.trim(),status:s.status});if(u)throw u;i({accountName:"",adAccountId:"",status:"Active"}),r&&r(),t()}catch(a){console.error(":",a),d(": "+(a.message||""))}finally{l(!1)}else d("ID");else d("ID");else d("")},className:"space-y-6",children:[Q.jsxs("div",{children:[Q.jsx("label",{className:"block text-sm font-bold text-gray-700 mb-3",children:""}),Q.jsx("input",{type:"text",value:s.accountName,onChange:e=>u("accountName",e.target.value),placeholder:"Facebook-",className:"w-full bg-white/70 text-gray-800 rounded-xl px-4 py-3 focus:ring-2 focus:ring-indigo-500 focus:outline-none border border-gray-200 hover:border-indigo-300 transition-all backdrop-blur-sm",required:!0})]}),Q.jsxs("div",{children:[Q.jsx("label",{className:"block text-sm font-bold text-gray-700 mb-3",children:"ID"}),Q.jsx("input",{type:"text",value:s.adAccountId,onChange:e=>{const t=e.target.value.replace(/\D/g,"");u("adAccountId",t)},placeholder:"ID",className:"w-full bg-white/70 text-gray-800 rounded-xl px-4 py-3 focus:ring-2 focus:ring-indigo-500 focus:outline-none border border-gray-200 hover:border-indigo-300 transition-all font-mono backdrop-blur-sm",required:!0})]}),Q.jsxs("div",{children:[Q.jsx("label",{className:"block text-sm font-bold text-gray-700 mb-3",children:""}),Q.jsxs("select",{value:s.status,onChange:e=>u("status",e.target.value),className:"w-full bg-white/70 text-gray-800 rounded-xl px-4 py-3 focus:ring-2 focus:ring-indigo-500 focus:outline-none border border-gray-200 hover:border-indigo-300 transition-all backdrop-blur-sm",children:[Q.jsx("option",{value:"Active",children:""}),Q.jsx("option",{value:"Inactive",children:""}),Q.jsx("option",{value:"Suspended",children:""}),Q.jsx("option",{value:"Pending",children:""})]})]}),c&&Q.jsx("div",{className:"bg-red-50 border-l-4 border-red-400 rounded-xl p-4 backdrop-blur-sm",children:Q.jsxs("div",{className:"flex items-start",children:[Q.jsx("div",{className:"flex-shrink-0",children:Q.jsx("svg",{className:"h-5 w-5 text-red-400",viewBox:"0 0 20 20",fill:"currentColor",children:Q.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})})}),Q.jsxs("div",{className:"ml-3",children:[Q.jsx("h3",{className:"text-sm font-medium text-red-800",children:"ID"}),Q.jsx("div",{className:"mt-1 text-sm text-red-700",children:c}),Q.jsx("div",{className:"mt-2",children:Q.jsxs("div",{className:"text-xs text-red-600",children:[Q.jsx("strong",{children:""}),Q.jsxs("ul",{className:"list-disc list-inside mt-1 space-y-1",children:[Q.jsx("li",{children:"ID"}),Q.jsx("li",{children:""}),Q.jsx("li",{children:"ID"})]})]})})]})]})}),Q.jsxs("div",{className:"flex gap-4 pt-4",children:[Q.jsx("button",{type:"button",onClick:t,className:"flex-1 bg-white/80 hover:bg-white/95 text-gray-700 py-3 px-6 rounded-xl font-semibold transition-all border border-gray-200 hover:border-gray-300 backdrop-blur-sm",disabled:o,children:""}),Q.jsx("button",{type:"submit",disabled:o,className:"flex-1 bg-gradient-to-r from-emerald-500 to-teal-500 hover:from-emerald-600 hover:to-teal-600 text-white py-3 px-6 rounded-xl font-semibold transition-all disabled:opacity-50 disabled:cursor-not-allowed shadow-lg hover:shadow-xl transform hover:scale-105",children:o?Q.jsxs("div",{className:"flex items-center justify-center",children:[Q.jsx(lj,{className:"animate-spin mr-2",size:18}),"..."]}):Q.jsxs("div",{className:"flex items-center justify-center",children:[Q.jsx(cj,{className:"mr-2",size:18}),""]})})]})]}),s.accountName&&s.adAccountId&&Q.jsxs("div",{className:"mt-6 bg-gradient-to-r from-emerald-50 to-teal-50 border border-emerald-200 rounded-xl p-4 backdrop-blur-sm",children:[Q.jsxs("p",{className:"text-emerald-700 font-bold mb-3 flex items-center",children:[Q.jsx("div",{className:"w-2 h-2 bg-emerald-500 rounded-full mr-2"}),""]}),Q.jsxs("div",{className:"text-gray-700 space-y-2",children:[Q.jsxs("p",{children:[Q.jsx("span",{className:"font-medium text-gray-600",children:""}),Q.jsx("span",{className:"font-semibold",children:s.accountName})]}),Q.jsxs("p",{children:[Q.jsx("span",{className:"font-medium text-gray-600",children:"ID"}),Q.jsx("span",{className:"font-mono bg-white/70 px-2 py-1 rounded",children:s.adAccountId})]}),Q.jsxs("p",{children:[Q.jsx("span",{className:"font-medium text-gray-600",children:""}),Q.jsx("span",{className:"px-3 py-1 rounded-full text-sm font-medium ml-2 "+("Active"===s.status?"bg-emerald-100 text-emerald-700":"Inactive"===s.status?"bg-gray-100 text-gray-700":"Suspended"===s.status?"bg-red-100 text-red-700":"bg-yellow-100 text-yellow-700"),children:"Active"===s.status?"":"Inactive"===s.status?"":"Suspended"===s.status?"":""})]})]})]})]})})},xj=({isOpen:e,onClose:t,onSuccess:r,account:n})=>{const[a,s]=W.useState(""),[i,o]=W.useState(!1),[l,c]=W.useState(""),d="app_e87b41cfe355428b8146f8bae8184e10_";if(!e||!n)return null;const u=n.account_name||n.name||"",h=n.ad_account_id||n.account_id||n.id||"N/A";return Q.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",onClick:e=>{e.target===e.currentTarget&&t()},children:Q.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl p-4 lg:p-6 w-full max-w-md mx-auto shadow-lg transform transition-all max-h-screen overflow-y-auto",children:[Q.jsxs("div",{className:"flex justify-between items-center mb-8",children:[Q.jsxs("div",{className:"flex items-center space-x-3",children:[Q.jsx("div",{className:"w-3 h-3 bg-gradient-to-r from-blue-500 to-indigo-500 rounded-full"}),Q.jsx("h3",{className:"text-2xl font-bold text-gray-800 bg-gradient-to-r from-blue-600 to-indigo-600 bg-clip-text text-transparent",children:""})]}),Q.jsx("button",{onClick:t,className:"text-gray-500 hover:text-gray-700 transition-colors p-2 rounded-lg hover:bg-gray-100/50",children:Q.jsx(pj,{size:24})})]}),Q.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6",children:Q.jsxs("div",{className:"space-y-3",children:[Q.jsxs("div",{className:"flex justify-between items-center",children:[Q.jsx("span",{className:"text-gray-600 font-medium",children:""}),Q.jsx("span",{className:"text-gray-800 font-bold",children:u})]}),Q.jsxs("div",{className:"flex justify-between items-center",children:[Q.jsx("span",{className:"text-gray-600 font-medium",children:"ID"}),Q.jsx("span",{className:"text-gray-800 font-mono bg-white/70 px-2 py-1 rounded text-sm",children:h})]}),n.personnel_name&&Q.jsxs("div",{className:"flex justify-between items-center",children:[Q.jsx("span",{className:"text-gray-600 font-medium",children:""}),Q.jsx("span",{className:"text-gray-800 font-medium",children:n.personnel_name})]})]})}),Q.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),!a||isNaN(a)||parseFloat(a)<=0)c("");else try{o(!0),c(""),console.log("===  ==="),console.log("account:",JSON.stringify(n,null,2));const e=n.account_name||n.name||`Account_${n.id}`||"Unknown Account",i=n.ad_account_id||n.account_id||n.id||"N/A",l=n.personnel_id||null,u=n.personnel_name||n.operator_name||"",h=(new Date).toISOString().split("T")[0],{data:f,error:m}=await up.from(`${d}recharge_operations`).select("id").eq("account_id",n.id).gte("created_at",h);m&&console.warn(":",m);const p=((null==f?void 0:f.length)||0)+1;let g;g=1===p?` $${parseFloat(a).toFixed(2)} - ${e} (${u})`:2===p?` $${parseFloat(a).toFixed(2)} - ${e} (${u})`:3===p?` $${parseFloat(a).toFixed(2)} - ${e} (${u})`:`${p} $${parseFloat(a).toFixed(2)} - ${e} (${u})`;const x={account_id:n.id,personnel_id:l,account_name:e,ad_account_id:i,amount:parseFloat(a),operator_name:u,description:g};console.log(":",JSON.stringify(x,null,2));const{data:v,error:b}=await up.from(`${d}recharge_operations`).insert(x).select();if(b)throw console.error(":",b),b;console.log(":",v),s(""),t(),setTimeout(()=>{r&&r()},100)}catch(i){console.error("===  ==="),console.error(":",i),console.error(":",i.code),console.error(":",i.message);let e="";i.message&&(e="23502"===i.code?"":i.message.includes("personnel_id")?"":i.message.includes("account_name")?"":i.message.includes("duplicate")?"":i.message.includes("network")||i.message.includes("connection")?"":`: ${i.message}`),c(e)}finally{o(!1)}},className:"space-y-6",children:[Q.jsxs("div",{children:[Q.jsx("label",{className:"block text-sm font-bold text-gray-700 mb-3",children:" ()"}),Q.jsxs("div",{className:"relative",children:[Q.jsx("span",{className:"absolute left-4 top-1/2 transform -translate-y-1/2 text-blue-600 font-bold",children:Q.jsx(sj,{size:18})}),Q.jsx("input",{type:"number",step:"0.01",min:"0",value:a,onChange:e=>{s(e.target.value),c("")},placeholder:"0.00",className:"w-full bg-white text-gray-800 rounded-lg pl-12 pr-4 py-3 focus:ring-2 focus:ring-blue-500 focus:outline-none border border-gray-300 hover:border-blue-400 transition-colors font-mono text-lg",required:!0})]})]}),l&&Q.jsx("div",{className:"bg-red-50 border-l-4 border-red-400 rounded-xl p-4",children:Q.jsxs("div",{className:"flex items-start",children:[Q.jsx("div",{className:"flex-shrink-0",children:Q.jsx("svg",{className:"h-5 w-5 text-red-400",viewBox:"0 0 20 20",fill:"currentColor",children:Q.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})})}),Q.jsxs("div",{className:"ml-3",children:[Q.jsx("h3",{className:"text-sm font-medium text-red-800",children:""}),Q.jsx("div",{className:"mt-1 text-sm text-red-700",children:l}),l.includes("")&&Q.jsx("div",{className:"mt-2",children:Q.jsxs("div",{className:"text-xs text-red-600",children:[Q.jsx("strong",{children:""}),Q.jsxs("ul",{className:"list-disc list-inside mt-1 space-y-1",children:[Q.jsxs("li",{children:[": ",u]}),Q.jsxs("li",{children:["ID: ",h]}),Q.jsxs("li",{children:["ID: ",n.personnel_id||""]}),Q.jsxs("li",{children:[": ",n.personnel_name||""]})]})]})})]})]})}),Q.jsxs("div",{className:"flex gap-4 pt-4",children:[Q.jsx("button",{type:"button",onClick:t,className:"flex-1 bg-white hover:bg-gray-50 text-gray-700 py-3 px-6 rounded-lg font-semibold transition-colors border border-gray-300 hover:border-gray-400",disabled:i,children:""}),Q.jsx("button",{type:"submit",disabled:i,className:"flex-1 bg-blue-600 hover:bg-blue-700 text-white py-3 px-6 rounded-lg font-semibold transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:i?Q.jsxs("div",{className:"flex items-center justify-center",children:[Q.jsx(lj,{className:"animate-spin mr-2",size:18}),"..."]}):Q.jsxs("div",{className:"flex items-center justify-center",children:[Q.jsx(sj,{className:"mr-2",size:18}),""]})})]})]}),a&&!isNaN(a)&&parseFloat(a)>0&&Q.jsxs("div",{className:"mt-6 bg-blue-50 border border-blue-200 rounded-lg p-4",children:[Q.jsxs("p",{className:"text-blue-700 font-bold mb-3 flex items-center",children:[Q.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full mr-2"}),""]}),Q.jsxs("p",{className:"text-gray-700 font-mono bg-white px-3 py-2 rounded text-sm",children:["",u,"  Ad account ID: ",h,"  $",parseFloat(a).toFixed(2)]})]})]})})},vj=({refreshTrigger:e,dateFilter:t,customStartDate:r,customEndDate:n})=>{const[a,s]=W.useState([]),[i,o]=W.useState(!0),[l,c]=W.useState(null),[d,u]=W.useState(new Date),h="app_e87b41cfe355428b8146f8bae8184e10_",f=W.useCallback(e=>{if(!e)return"";const t={"":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""};for(const[r,n]of Object.entries(t))if(e.includes(r))return n;return""},[]);W.useEffect(()=>{const e=setInterval(()=>{u(new Date)},1e3);return()=>clearInterval(e)},[]);const m=W.useCallback(async()=>{try{o(!0),c(null),console.log("...",{dateFilter:t,customStartDate:r,customEndDate:n});let e=up.from(`${h}recharge_operations`).select("*"),a=up.from(`${h}reset_operations`).select("*");if("today"===t){const t=new Date,r=new Date(t.getFullYear(),t.getMonth(),t.getDate()),n=new Date(t.getFullYear(),t.getMonth(),t.getDate()+1),s=r.toISOString(),i=n.toISOString();e=e.gte("created_at",s).lt("created_at",i),a=a.gte("created_at",s).lt("created_at",i)}else if("custom"===t&&r&&n){const t=new Date(r+"T00:00:00"),s=new Date(n+"T23:59:59"),i=t.toISOString(),o=s.toISOString();e=e.gte("created_at",i).lte("created_at",o),a=a.gte("created_at",i).lte("created_at",o)}const[i,l]=await Promise.all([e.order("created_at",{ascending:!1}).limit(50),a.order("created_at",{ascending:!1}).limit(50)]),{data:d,error:u}=i,{data:f,error:m}=l;if(u&&"PGRST116"!==u.code)throw console.error(":",u),u;if(m&&"PGRST116"!==m.code)throw console.error(":",m),m;const p=[...(d||[]).map(e=>({...e,type:"recharge"})),...(f||[]).map(e=>({...e,type:"reset"}))].sort((e,t)=>new Date(t.created_at)-new Date(e.created_at));console.log(":",p.length),s(p.slice(0,100))}catch(e){console.error(":",e),c(": "+e.message)}finally{o(!1)}},[h,t,r,n]);W.useEffect(()=>{m()},[m,e]),W.useEffect(()=>{if("all"!==t)return;let e=null,r=null;try{e=up.channel("recharge_operations_realtime").on("postgres_changes",{event:"INSERT",schema:"public",table:`${h}recharge_operations`},e=>{console.log(":",e);const t={...e.new,type:"recharge"};s(e=>[t,...e.slice(0,99)])}).subscribe(),r=up.channel("reset_operations_realtime").on("postgres_changes",{event:"INSERT",schema:"public",table:`${h}reset_operations`},e=>{console.log(":",e);const t={...e.new,type:"reset"};s(e=>[t,...e.slice(0,99)])}).subscribe()}catch(n){console.error(":",n)}return()=>{e&&e.unsubscribe(),r&&r.unsubscribe()}},[h,t]);const p=W.useCallback(e=>{try{return new Date(e).toLocaleString("zh-CN",{month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"})}catch(t){return""}},[]),g=W.useCallback(e=>{try{return new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:2}).format(e)}catch(t){return`$${e}`}},[]),x=W.useMemo(()=>{if(!a||0===a.length)return{recharge:{count:0,total:0},reset:{count:0,total:0}};const e=a.filter(e=>"recharge"===e.type),t=a.filter(e=>"reset"===e.type);return{recharge:{count:e.length,total:e.reduce((e,t)=>e+Number(t.amount||0),0)},reset:{count:t.length,total:t.reduce((e,t)=>e+Number(t.balance||0),0)}}},[a]),v=W.useCallback(async e=>{try{let t="";if(t="recharge"===e.type?`${e.account_name||""}\nAd account ID: ${e.ad_account_id||"N/A"}\n ${g(e.amount||0)}`:`${e.account_name||""}\nAd account ID: ${e.ad_account_id||"N/A"}\n ${g(e.balance||0)}`,navigator.clipboard&&window.isSecureContext)await navigator.clipboard.writeText(t);else{const e=document.createElement("textarea");e.value=t,e.style.position="fixed",e.style.left="-999999px",document.body.appendChild(e),e.focus(),e.select(),document.execCommand("copy"),e.remove()}console.log(":",t)}catch(t){console.error(":",t)}},[g]),b=W.useCallback(async()=>{if(a&&0!==a.length)try{const e=a.map(e=>"recharge"===e.type?`${e.account_name||""}\nAd account ID: ${e.ad_account_id||"N/A"}\n ${g(e.amount||0)}`:`${e.account_name||""}\nAd account ID: ${e.ad_account_id||"N/A"}\n ${g(e.balance||0)}`).join("\n\n");if(navigator.clipboard&&window.isSecureContext)await navigator.clipboard.writeText(e);else{const t=document.createElement("textarea");t.value=e,t.style.position="fixed",t.style.left="-999999px",document.body.appendChild(t),t.focus(),t.select(),document.execCommand("copy"),t.remove()}alert(`${a.length}`)}catch(e){console.error(":",e),alert(": "+e.message)}else alert("")},[a,g]);return l?Q.jsx("div",{className:"bg-white rounded-lg shadow h-full p-6",children:Q.jsxs("div",{className:"text-center py-12",children:[Q.jsx("div",{className:"text-red-500 text-3xl mb-4",children:""}),Q.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-3",children:""}),Q.jsx("p",{className:"text-gray-600 mb-6",children:l}),Q.jsx("button",{onClick:m,className:"bg-blue-500 hover:bg-blue-600 text-white px-6 py-3 rounded-lg transition-colors",children:""})]})}):Q.jsxs("div",{className:"bg-white rounded-lg shadow h-full flex flex-col",children:[Q.jsxs("div",{className:"p-6 border-b border-gray-200",children:[Q.jsxs("div",{className:"flex items-center justify-between mb-6",children:[Q.jsxs("div",{className:"flex items-center space-x-3",children:[Q.jsxs("h3",{className:"text-2xl font-bold text-gray-900 flex items-center",children:[Q.jsx("span",{className:"w-3 h-3 bg-green-500 rounded-full mr-3 animate-pulse"}),""]}),Q.jsxs("div",{className:"flex items-center space-x-2",children:["today"===t&&Q.jsx("span",{className:"bg-blue-100 text-blue-700 px-3 py-1 rounded-full text-sm font-medium",children:" "}),"custom"===t&&Q.jsxs("span",{className:"bg-purple-100 text-purple-700 px-3 py-1 rounded-full text-sm font-medium",children:[" ",r,"  ",n]}),"all"===t&&Q.jsx("span",{className:"bg-gray-100 text-gray-700 px-3 py-1 rounded-full text-sm font-medium",children:" "})]})]}),Q.jsxs("div",{className:"flex items-center space-x-4",children:[Q.jsx("div",{className:"text-sm text-gray-500",children:d.toLocaleTimeString("zh-CN")}),Q.jsxs("button",{onClick:b,disabled:!a||0===a.length,className:"bg-green-500 hover:bg-green-600 text-white px-4 py-2 rounded-lg transition-colors text-sm flex items-center space-x-2 disabled:opacity-50 disabled:cursor-not-allowed",children:[Q.jsx(nj,{size:16}),Q.jsx("span",{children:""})]})]})]}),Q.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-4",children:[Q.jsx("div",{className:"bg-gradient-to-r from-blue-50 to-blue-100 border border-blue-200 rounded-xl p-4",children:Q.jsxs("div",{className:"flex items-center justify-between",children:[Q.jsxs("div",{children:[Q.jsx("div",{className:"text-blue-600 text-sm font-medium",children:""}),Q.jsx("div",{className:"text-blue-900 text-2xl font-bold",children:x.recharge.count})]}),Q.jsx("div",{className:"text-blue-500",children:Q.jsx(fj,{size:24})})]})}),Q.jsx("div",{className:"bg-gradient-to-r from-green-50 to-green-100 border border-green-200 rounded-xl p-4",children:Q.jsxs("div",{className:"flex items-center justify-between",children:[Q.jsxs("div",{children:[Q.jsx("div",{className:"text-green-600 text-sm font-medium",children:""}),Q.jsx("div",{className:"text-green-900 text-2xl font-bold",children:g(x.recharge.total)})]}),Q.jsx("div",{className:"text-green-500",children:""})]})}),Q.jsx("div",{className:"bg-gradient-to-r from-red-50 to-red-100 border border-red-200 rounded-xl p-4",children:Q.jsxs("div",{className:"flex items-center justify-between",children:[Q.jsxs("div",{children:[Q.jsx("div",{className:"text-red-600 text-sm font-medium",children:""}),Q.jsx("div",{className:"text-red-900 text-2xl font-bold",children:x.reset.count})]}),Q.jsx("div",{className:"text-red-500",children:Q.jsx(hj,{size:24})})]})}),Q.jsx("div",{className:"bg-gradient-to-r from-orange-50 to-orange-100 border border-orange-200 rounded-xl p-4",children:Q.jsxs("div",{className:"flex items-center justify-between",children:[Q.jsxs("div",{children:[Q.jsx("div",{className:"text-orange-600 text-sm font-medium",children:""}),Q.jsx("div",{className:"text-orange-900 text-2xl font-bold",children:g(x.reset.total)})]}),Q.jsx("div",{className:"text-orange-500",children:""})]})})]})]}),Q.jsx("div",{className:"flex-1 p-4 sm:p-6 overflow-y-auto",children:Q.jsx("div",{className:"w-full",children:i?Q.jsxs("div",{className:"text-center py-12",children:[Q.jsx("div",{className:"w-8 h-8 border-2 border-gray-300 border-t-blue-500 rounded-full animate-spin mx-auto mb-4"}),Q.jsx("p",{className:"text-gray-500 text-lg",children:"..."})]}):0===a.length?Q.jsxs("div",{className:"text-center py-16",children:[Q.jsx("div",{className:"text-gray-400 text-4xl mb-4",children:""}),Q.jsx("p",{className:"text-gray-500 text-xl mb-2",children:""}),Q.jsx("p",{className:"text-gray-400 text-sm",children:""})]}):Q.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-4",children:a.map((e,t)=>{const r=e.operator_name||"",n=f(r);return Q.jsxs("div",{className:`border rounded-xl p-5 transition-all duration-300 cursor-pointer hover:shadow-lg transform hover:-translate-y-1 ${"recharge"===e.type?"border-blue-200 bg-gradient-to-br from-blue-50 to-blue-100 hover:from-blue-100 hover:to-blue-200":"border-red-200 bg-gradient-to-br from-red-50 to-red-100 hover:from-red-100 hover:to-red-200"} ${0===t?"ring-2 ring-yellow-300 shadow-lg":""}`,onClick:()=>v(e),children:[Q.jsxs("div",{className:"flex items-start justify-between mb-4",children:[Q.jsxs("div",{className:"flex items-center space-x-3",children:[Q.jsx("div",{className:"w-3 h-3 rounded-full animate-pulse "+("recharge"===e.type?"bg-blue-500":"bg-red-500")}),Q.jsxs("div",{className:"flex items-center space-x-2",children:[Q.jsx("span",{className:"text-2xl",children:n}),Q.jsxs("div",{children:[Q.jsx("div",{className:"text-gray-900 font-bold text-base",children:r}),Q.jsx("div",{className:"text-sm font-medium "+("recharge"===e.type?"text-blue-600":"text-red-600"),children:"recharge"===e.type?"":""})]})]})]}),Q.jsxs("div",{className:"text-right",children:[Q.jsx("div",{className:"text-gray-400 text-sm",children:p(e.created_at)}),0===t&&Q.jsx("div",{className:"text-yellow-600 text-xs font-medium mt-1",children:" "})]})]}),Q.jsxs("div",{className:"space-y-3",children:[Q.jsxs("div",{className:"bg-white/70 rounded-lg p-3",children:[Q.jsx("div",{className:"text-gray-800 font-bold text-lg truncate",children:e.account_name||""}),Q.jsxs("div",{className:"text-gray-600 text-sm font-mono truncate mt-1",children:["ID: ",e.ad_account_id||"N/A"]})]}),"recharge"===e.type&&e.amount&&Q.jsxs("div",{className:"flex items-center justify-between bg-green-100 rounded-lg p-3",children:[Q.jsx("span",{className:"text-green-700 font-medium",children:":"}),Q.jsx("span",{className:"text-green-800 font-bold text-xl",children:g(e.amount)})]}),"reset"===e.type&&e.balance&&Q.jsxs("div",{className:"flex items-center justify-between bg-orange-100 rounded-lg p-3",children:[Q.jsx("span",{className:"text-orange-700 font-medium",children:":"}),Q.jsx("span",{className:"text-orange-800 font-bold text-xl",children:g(e.balance)})]}),e.description&&Q.jsx("div",{className:"bg-gray-100 rounded-lg p-3",children:Q.jsxs("div",{className:"text-gray-600 text-sm",children:[" : ",e.description]})}),Q.jsx("div",{className:"text-center pt-2 border-t border-white/50",children:Q.jsxs("div",{className:"text-xs text-gray-500 flex items-center justify-center space-x-1",children:[Q.jsx(nj,{size:12}),Q.jsx("span",{children:""})]})})]})]},`${e.type}-${e.id}`)})})})})]})},bj=()=>{const[e,t]=W.useState([]),[r,n]=W.useState(null),[a,s]=W.useState([]),[i,o]=W.useState(!0),[l,c]=W.useState(null),[d,u]=W.useState(""),[h,f]=W.useState(!1),[m,p]=W.useState(!1),[g,x]=W.useState(null),[v,b]=W.useState(!1),[y,w]=W.useState([]),[_,k]=W.useState(!1),[N,j]=W.useState("today"),[S,T]=W.useState(""),[E,C]=W.useState(""),[A,O]=W.useState(!1),[I,R]=W.useState(null),[P,D]=W.useState(0),L="app_e87b41cfe355428b8146f8bae8184e10_",M=W.useCallback(async()=>{try{o(!0),c(null),u("..."),console.log("");const{data:e,error:r}=await up.from(`${L}personnel`).select("*").order("name",{ascending:!0});if(r)throw console.error("Supabase:",r),r;console.log(":",e),t(e||[]),u(`${e?e.length:0}`)}catch(e){console.error(":",e),c(": "+e.message),u("")}finally{o(!1)}},[L]),F=W.useCallback(async e=>{if(e&&e.id)try{u(`${e.name}...`),console.log(" - ID:",e.id);const{data:t,error:r}=await up.from(`${L}account_management_ads`).select("*").eq("personnel_id",e.id).order("created_at",{ascending:!1});if(r)throw console.error(":",r),r;console.log(":",t);const n=(t||[]).map(t=>({...t,personnel_name:e.name}));s(n),u(`${e.name}: ${n.length}`)}catch(t){console.error(":",t),s([]),u(`${e.name}`)}else s([])},[L]);W.useEffect(()=>{M();const e=(new Date).toISOString().split("T")[0];T(e),C(e)},[M]);const U=W.useCallback(e=>{(null==I?void 0:I.id)===e.id?(R(null),n(null),s([]),u("")):(R(e),n(e),F(e))},[I,F]),B=W.useCallback(()=>{f(!1),r&&F(r),D(e=>e+1),u("")},[r,F]),$=W.useCallback(()=>{p(!1),r&&F(r),D(e=>e+1),u("")},[r,F]),z=W.useCallback(async e=>{if(!e||!e.id)return;const t=` "${e.account_name}" `;if(confirm(t))try{u("...");const{error:t}=await up.from(`${L}account_management_ads`).delete().eq("id",e.id);if(t)throw t;r&&F(r),u("")}catch(n){console.error(":",n),u(""),alert(": "+n.message)}},[r,F,L]),V=W.useCallback(async e=>{try{const t=`${e.account_name}\nAd account ID: ${e.ad_account_id||e.id}`;if(navigator.clipboard&&window.isSecureContext)await navigator.clipboard.writeText(t);else{const e=document.createElement("textarea");e.value=t,e.style.position="fixed",e.style.left="-999999px",document.body.appendChild(e),e.focus(),e.select(),document.execCommand("copy"),e.remove()}u(`: ${e.account_name}`)}catch(t){console.error(":",t),u("")}},[]),H=W.useCallback(async()=>{if(a&&0!==a.length)try{const e=a.map(e=>`${e.account_name}\nAd account ID: ${e.ad_account_id||e.id}`).join("\n\n");if(navigator.clipboard&&window.isSecureContext)await navigator.clipboard.writeText(e);else{const t=document.createElement("textarea");t.value=e,t.style.position="fixed",t.style.left="-999999px",document.body.appendChild(t),t.focus(),t.select(),document.execCommand("copy"),t.remove()}u(`${a.length}`),alert(`${a.length}`)}catch(e){console.error(":",e),u(""),alert(": "+e.message)}else alert("")},[a]),G=W.useCallback(async e=>{if(e&&e.id)try{x(e),b(!0),k(!0),u("...");let t=up.from(`${L}recharge_operations`).select("*").eq("account_id",e.id);if("today"===N){const e=new Date,r=new Date(e.getFullYear(),e.getMonth(),e.getDate()),n=new Date(e.getFullYear(),e.getMonth(),e.getDate()+1);t=t.gte("created_at",r.toISOString()).lt("created_at",n.toISOString())}else if("custom"===N&&S&&E){const e=new Date(S+"T00:00:00"),r=new Date(E+"T23:59:59");t=t.gte("created_at",e.toISOString()).lte("created_at",r.toISOString())}const{data:r,error:n}=await t.order("created_at",{ascending:!1});if(n)throw console.error(":",n),n;w(r||[]),u(`${r?r.length:0}`)}catch(t){console.error(":",t),w([]),u("")}finally{k(!1)}},[L,N,S,E]),q=W.useCallback(async e=>{if(e&&confirm(""))try{u("...");const{error:t}=await up.from(`${L}recharge_operations`).delete().eq("id",e);if(t)throw t;g&&G(g),u(""),alert("")}catch(t){console.error(":",t),u(""),alert(": "+t.message)}},[g,G,L]),K=W.useCallback(async(e,t)=>{try{const r=`${(null==t?void 0:t.account_name)||""}\nAd account ID: ${(null==t?void 0:t.ad_account_id)||(null==t?void 0:t.id)||"N/A"}\n $${Number(e.amount).toFixed(2)}`;if(navigator.clipboard&&window.isSecureContext)await navigator.clipboard.writeText(r);else{const e=document.createElement("textarea");e.value=r,e.style.position="fixed",e.style.left="-999999px",document.body.appendChild(e),e.focus(),e.select(),document.execCommand("copy"),e.remove()}u(`: $${Number(e.amount).toFixed(2)}`)}catch(r){console.error(":",r),u("")}},[]),X=W.useCallback(e=>{if(!e)return"";const t={"":"","":"","":"","":"","":"","":"","":"","":""};for(const[r,n]of Object.entries(t))if(e.includes(r))return n;return""},[]),Y=W.useCallback(e=>{if(j(e),"today"===e){const e=(new Date).toISOString().split("T")[0];T(e),C(e)}O(!1),u(`${"today"===e?"":"all"===e?"":""}`)},[]);return l&&!i?Q.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center p-4",children:Q.jsxs("div",{className:"text-center p-6 bg-white rounded-lg shadow-lg max-w-md w-full",children:[Q.jsx(tj,{className:"mx-auto mb-4 text-red-500",size:48}),Q.jsx("h3",{className:"text-lg font-bold text-gray-800 mb-2",children:""}),Q.jsx("p",{className:"text-gray-600 mb-4 text-sm",children:l}),Q.jsx("button",{onClick:M,className:"bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded text-sm",children:""})]})}):i?Q.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center p-4",children:Q.jsxs("div",{className:"text-center",children:[Q.jsx(dj,{className:"mx-auto mb-4 animate-spin text-blue-500",size:48}),Q.jsx("h3",{className:"text-lg font-bold text-gray-800 mb-2",children:"..."}),Q.jsx("p",{className:"text-gray-600 text-sm",children:d})]})}):Q.jsxs("div",{className:"min-h-screen bg-gray-50",children:[Q.jsxs("div",{className:"flex flex-col lg:flex-row min-h-screen",children:[Q.jsxs("div",{className:"w-full lg:w-80 xl:w-96 bg-white shadow-lg border-r border-gray-200 flex flex-col lg:h-screen",children:[Q.jsxs("div",{className:"p-3 sm:p-4 border-b border-gray-100 flex-shrink-0",children:[Q.jsxs("div",{className:"flex items-center space-x-2 mb-3",children:[Q.jsx(mj,{className:"text-blue-500",size:20}),Q.jsx("h2",{className:"text-lg font-bold text-gray-900",children:""}),Q.jsxs("span",{className:"text-xs bg-blue-100 text-blue-600 px-2 py-1 rounded-full",children:[e.length,""]})]}),Q.jsxs("div",{className:"text-xs text-gray-500 bg-gray-50 px-2 py-1 rounded mb-3 break-words",children:[": ",d]}),Q.jsxs("div",{className:"mb-3",children:[Q.jsxs("div",{className:"flex flex-wrap gap-2 mb-2",children:[Q.jsxs("button",{onClick:()=>Y("today"),className:"flex items-center space-x-1 px-3 py-2 rounded text-sm font-medium transition-colors "+("today"===N?"bg-blue-500 text-white":"bg-gray-100 hover:bg-gray-200 text-gray-700"),children:[Q.jsx(rj,{size:14}),Q.jsx("span",{children:""})]}),Q.jsxs("button",{onClick:()=>Y("all"),className:"flex items-center space-x-1 px-3 py-2 rounded text-sm font-medium transition-colors "+("all"===N?"bg-blue-500 text-white":"bg-gray-100 hover:bg-gray-200 text-gray-700"),children:[Q.jsx(QN,{size:14}),Q.jsx("span",{children:""})]}),Q.jsxs("button",{onClick:()=>{j("custom"),O(!A)},className:"flex items-center space-x-1 px-3 py-2 rounded text-sm font-medium transition-colors "+("custom"===N?"bg-purple-500 text-white":"bg-gray-100 hover:bg-gray-200 text-gray-700"),children:[Q.jsx(ij,{size:14}),Q.jsx("span",{children:""}),Q.jsx(ej,{size:12,className:"transition-transform "+(A?"rotate-180":"")})]})]}),A&&"custom"===N&&Q.jsxs("div",{className:"bg-gray-50 p-3 rounded border space-y-3",children:[Q.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[Q.jsxs("div",{children:[Q.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:""}),Q.jsx("input",{type:"date",value:S,onChange:e=>T(e.target.value),className:"w-full px-2 py-2 border border-gray-300 rounded text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),Q.jsxs("div",{children:[Q.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:""}),Q.jsx("input",{type:"date",value:E,onChange:e=>C(e.target.value),className:"w-full px-2 py-2 border border-gray-300 rounded text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]})]}),Q.jsx("button",{onClick:()=>O(!1),className:"w-full bg-gray-100 hover:bg-gray-200 text-gray-700 px-3 py-2 rounded text-sm transition-colors",children:""})]})]}),r&&Q.jsxs("div",{className:"space-y-2",children:[Q.jsxs("button",{onClick:()=>f(!0),className:"w-full bg-blue-500 hover:bg-blue-600 text-white px-3 py-2.5 rounded-lg text-sm font-medium flex items-center justify-center space-x-2 transition-colors",children:[Q.jsx(cj,{size:16}),Q.jsx("span",{children:""})]}),Q.jsxs("button",{onClick:H,disabled:!a||0===a.length,className:"w-full bg-green-500 hover:bg-green-600 text-white px-3 py-2.5 rounded-lg text-sm font-medium flex items-center justify-center space-x-2 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:[Q.jsx(nj,{size:16}),Q.jsx("span",{children:""})]})]})]}),Q.jsx("div",{className:"flex-1 overflow-y-auto p-3",children:0===e.length?Q.jsx("div",{className:"text-center py-8 text-gray-500",children:""}):Q.jsx("div",{className:"space-y-3",children:e.map(e=>Q.jsxs("div",{className:"border border-gray-200 rounded-lg overflow-hidden",children:[Q.jsx("button",{onClick:()=>U(e),className:"w-full text-left p-3 sm:p-4 transition-all "+((null==I?void 0:I.id)===e.id?"bg-blue-50 border-blue-200":"hover:bg-gray-50"),children:Q.jsxs("div",{className:"flex items-center justify-between",children:[Q.jsxs("div",{className:"flex items-center space-x-3",children:[Q.jsx("span",{className:"text-xl",children:X(e.name)}),Q.jsxs("div",{className:"flex flex-col",children:[Q.jsx("span",{className:"font-medium text-gray-900 text-sm sm:text-base",children:e.name}),(null==I?void 0:I.id)===e.id&&Q.jsxs("span",{className:"text-xs text-gray-500",children:[a.length,""]})]})]}),Q.jsx(ej,{size:16,className:"text-gray-400 transition-transform "+((null==I?void 0:I.id)===e.id?"rotate-180":"")})]})}),(null==I?void 0:I.id)===e.id&&Q.jsx("div",{className:"border-t border-gray-100 bg-gray-50",children:0===a.length?Q.jsx("div",{className:"p-4 text-center text-gray-500 text-sm",children:""}):Q.jsx("div",{className:"p-3 space-y-3",children:a.map(e=>Q.jsx("div",{className:"bg-white p-3 rounded border border-gray-200",children:Q.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between space-y-2 sm:space-y-0",children:[Q.jsxs("div",{className:"flex-1 min-w-0",children:[Q.jsx("div",{className:"font-medium text-gray-900 text-sm truncate",children:e.account_name}),Q.jsxs("div",{className:"text-xs text-gray-500 break-all",children:["ID: ",e.ad_account_id||e.id]})]}),Q.jsxs("div",{className:"flex items-center justify-end space-x-1 flex-shrink-0",children:[Q.jsx("button",{onClick:()=>V(e),className:"p-2 text-gray-500 hover:bg-gray-100 rounded transition-colors",title:"",children:Q.jsx(nj,{size:14})}),Q.jsx("button",{onClick:()=>{x(e),p(!0)},className:"p-2 text-blue-500 hover:bg-blue-50 rounded transition-colors",title:"",children:Q.jsx(aj,{size:14})}),Q.jsx("button",{onClick:()=>G(e),className:"p-2 text-green-500 hover:bg-green-50 rounded transition-colors",title:"",children:Q.jsx(oj,{size:14})}),Q.jsx("button",{onClick:()=>z(e),className:"p-2 text-red-500 hover:bg-red-50 rounded transition-colors",title:"",children:Q.jsx(uj,{size:14})})]})]})},e.id))})})]},e.id))})})]}),Q.jsx("div",{className:"flex-1 lg:min-h-0 h-auto lg:h-screen overflow-y-auto",children:Q.jsx("div",{className:"p-2 sm:p-4 h-full",children:Q.jsx(vj,{refreshTrigger:P,dateFilter:N,customStartDate:S,customEndDate:E})})})]}),h&&Q.jsx(gj,{isOpen:h,onClose:()=>f(!1),onSuccess:B,staffId:null==r?void 0:r.id,staffName:null==r?void 0:r.name}),m&&g&&Q.jsx(xj,{isOpen:m,onClose:()=>p(!1),onSuccess:$,account:g}),v&&Q.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-2 sm:p-4",children:Q.jsxs("div",{className:"bg-white rounded-lg w-full max-w-4xl max-h-[90vh] flex flex-col",children:[Q.jsxs("div",{className:"flex justify-between items-center p-4 sm:p-6 border-b border-gray-200 flex-shrink-0",children:[Q.jsxs("div",{className:"min-w-0 flex-1 pr-4",children:[Q.jsxs("h3",{className:"text-lg sm:text-xl font-bold text-gray-800 truncate",children:[" - ",null==g?void 0:g.account_name]}),Q.jsxs("div",{className:"text-xs sm:text-sm text-gray-500 mt-1",children:[": ","all"===N?"":"today"===N?"":`${S}  ${E}`]})]}),Q.jsx("button",{onClick:()=>b(!1),className:"text-gray-500 hover:text-gray-700 text-xl font-bold px-2 py-1 hover:bg-gray-100 rounded flex-shrink-0",children:""})]}),Q.jsx("div",{className:"flex-1 overflow-y-auto p-4 sm:p-6",children:_?Q.jsxs("div",{className:"text-center py-8",children:[Q.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500 mx-auto"}),Q.jsx("p",{className:"text-gray-500 mt-3 text-sm",children:"..."})]}):0===y.length?Q.jsxs("div",{className:"text-center py-12",children:[Q.jsx("div",{className:"text-gray-400 text-4xl mb-4",children:""}),Q.jsx("p",{className:"text-gray-500 text-lg",children:""}),Q.jsx("p",{className:"text-gray-400 text-sm mt-2",children:""})]}):Q.jsx("div",{className:"space-y-3",children:y.map(e=>Q.jsx("div",{className:"border rounded-lg p-3 sm:p-4 bg-gray-50 hover:bg-gray-100 transition-colors",children:Q.jsxs("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-start space-y-2 sm:space-y-0",children:[Q.jsxs("div",{className:"flex-1 min-w-0",children:[Q.jsxs("div",{className:"flex flex-wrap items-center gap-2 sm:gap-3 mb-2",children:[Q.jsxs("div",{className:"text-lg font-bold text-green-600",children:["$",Number(e.amount).toFixed(2)]}),Q.jsxs("div",{className:"text-xs sm:text-sm text-gray-600",children:[": ",e.operator_name]})]}),Q.jsxs("div",{className:"text-xs sm:text-sm text-gray-500 break-words",children:[": ",new Date(e.created_at).toLocaleString("zh-CN")]}),e.description&&Q.jsxs("div",{className:"text-xs sm:text-sm text-gray-500 mt-1 break-words",children:[": ",e.description]})]}),Q.jsxs("div",{className:"flex items-center space-x-2 flex-shrink-0",children:[Q.jsxs("button",{onClick:()=>K(e,g),className:"bg-blue-500 hover:bg-blue-600 text-white px-3 py-2 rounded-lg text-xs font-medium flex items-center space-x-1 transition-colors",title:"",children:[Q.jsx(nj,{size:14}),Q.jsx("span",{className:"hidden sm:inline",children:""})]}),Q.jsxs("button",{onClick:()=>q(e.id),className:"bg-red-500 hover:bg-red-600 text-white px-3 py-2 rounded-lg text-xs font-medium flex items-center space-x-1 transition-colors",title:"",children:[Q.jsx(uj,{size:14}),Q.jsx("span",{className:"hidden sm:inline",children:""})]})]})]})},e.id))})})]})})]})};
/**
 * @license lucide-react v0.536.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yj=new class{constructor(){this.cache=new Map,this.cacheExpiry=new Map,this.defaultTTL=3e5}set(e,t,r=this.defaultTTL){this.cache.set(e,t),this.cacheExpiry.set(e,Date.now()+r)}get(e){const t=this.cacheExpiry.get(e);return t&&Date.now()>t?(this.cache.delete(e),this.cacheExpiry.delete(e),null):this.cache.get(e)}clear(){this.cache.clear(),this.cacheExpiry.clear()}},wj={TARGET_EMPLOYEES:["","",""],EXCHANGE_RATE:20,async getStableAdData(e){const t=`ad_data_${e}`;let r=yj.get(t);if(r)return console.log(":",e),r;try{console.log(":",e);const r=await fp.getAll(),n=r.filter(t=>{const r=t.date===e,n=this.TARGET_EMPLOYEES.some(e=>{const r=(t.staff||"").trim();return r===e||r.includes(e)||e.includes(r)});return console.log(`: =${t.date} =${t.staff} =${r} =${n}`),r&&n});console.log(`${e} : ${r.length}, : ${n.length}`);const a=n.map(e=>{const t=parseFloat(e.credit_card_amount||0)/this.EXCHANGE_RATE,r=parseFloat(e.ad_spend||0),n=r>0?t/r:0;return{advertiser:(e.staff||"").trim(),date:e.date,spend_amount:r,credit_card_amount:t,credit_card_orders:parseInt(e.credit_card_orders||0),roi:Math.round(1e4*n)/1e4,created_at:e.created_at,updated_at:e.updated_at}});return yj.set(t,a,12e4),console.log(` ${e} :`,a),a}catch(n){throw console.error(":",n),new Error(` ${e} : ${n.message}`)}},calculateCommissionStable(e){console.log(":",e);const t={};this.TARGET_EMPLOYEES.forEach(e=>{t[e]={advertiser:e,totalSpend:0,totalRevenue:0,totalOrders:0,records:[]}}),e.forEach(e=>{const r=e.advertiser;t[r]&&(t[r].totalSpend+=parseFloat(e.spend_amount||0),t[r].totalRevenue+=parseFloat(e.credit_card_amount||0),t[r].totalOrders+=parseInt(e.credit_card_orders||0),t[r].records.push(e))});const r=this.TARGET_EMPLOYEES.map(r=>{const n=t[r],a=n.totalSpend>0?n.totalRevenue/n.totalSpend:0;let s=0,i="no_data",o="";n.totalOrders>0&&(a>=1?(s=7,i="high_performance",o=""):a>=.8?(s=5,i="qualified",o=""):(s=0,i="no_commission",o=""));const l=n.totalOrders*s;return{advertiser:r,date:e.length>0?e[0].date:null,order_count:n.totalOrders,roi:Math.round(1e4*a)/1e4,commission_per_order:s,total_commission:Math.round(100*l)/100,commission_status:i,status_text:o,_debug:{totalSpend:Math.round(100*n.totalSpend)/100,totalRevenue:Math.round(100*n.totalRevenue)/100,recordCount:n.records.length}}});return console.log(":",r),r},async getStableDailyCommission(e){const t=`daily_commission_${e}`;let r=yj.get(t);if(r)return console.log(":",e),r;try{const r=await this.getStableAdData(e),n=this.calculateCommissionStable(r);return yj.set(t,n,12e4),n}catch(n){return console.error(":",n),this.TARGET_EMPLOYEES.map(t=>({advertiser:t,date:e,order_count:0,roi:0,commission_per_order:0,total_commission:0,commission_status:"error",status_text:"",_debug:{error:n.message}}))}},async getStableMonthlyCommission(e="2025-08"){const t=`monthly_commission_${e}`;let r=yj.get(t);if(r)return console.log(":",e),r;try{console.log(":",e);const[r,a]=e.split("-").map(Number),s=await this.getAvailableDatesForMonth(e);if(0===s.length)return console.log(""),this.TARGET_EMPLOYEES.map(t=>({advertiser:t,totalCommission:0,totalOrders:0,workingDays:0,avgROI:0,monthString:e}));const i=[];for(const e of s)try{const t=await this.getStableDailyCommission(e);i.push(...t)}catch(n){console.warn(` ${e} :`,n.message)}const o=this.TARGET_EMPLOYEES.map(t=>{const r=i.filter(e=>e.advertiser===t&&"error"!==e.commission_status),n=r.reduce((e,t)=>e+(t.total_commission||0),0),a=r.reduce((e,t)=>e+(t.order_count||0),0),s=r.filter(e=>e.order_count>0||e.total_commission>0).length,o=r.length>0?r.reduce((e,t)=>e+(t.roi||0),0)/r.length:0;return{advertiser:t,totalCommission:Math.round(100*n)/100,totalOrders:a,workingDays:s,avgROI:Math.round(1e4*o)/1e4,monthString:e,recordCount:r.length}});return yj.set(t,o,6e5),console.log(":",o),o}catch(n){return console.error(":",n),this.TARGET_EMPLOYEES.map(t=>({advertiser:t,totalCommission:0,totalOrders:0,workingDays:0,avgROI:0,monthString:e,error:n.message}))}},async getAvailableDatesForMonth(e="2025-08"){const t=`available_dates_${e}`;let r=yj.get(t);if(r)return console.log(` ${e}:`,r),r;try{console.log(` ${e} ...`);const[r,n]=e.split("-").map(Number),a=`${r}-${n.toString().padStart(2,"0")}-01`,s=new Date(r,n,0).getDate(),i=`${r}-${n.toString().padStart(2,"0")}-${s.toString().padStart(2,"0")}`;console.log(`: ${a}  ${i}`);const o=await fp.getAll();console.log(`: ${o.length}`);const l=o.filter(e=>{const t=e.date>=a&&e.date<=i,r=this.TARGET_EMPLOYEES.some(t=>{const r=(e.staff||"").trim();return r===t||r.includes(t)||t.includes(r)});return t&&r});console.log(`${e} : ${l.length}`);const c=[...new Set(l.map(e=>e.date))].filter(e=>e&&e.length>=10).sort((e,t)=>new Date(t)-new Date(e));return console.log(`${e} :`,c),console.log(`: ${c.length}`),yj.set(t,c,18e4),c}catch(n){return console.error(":",n),[]}},async getDataRangeInfo(e="2025-08"){try{const t=await this.getAvailableDatesForMonth(e);return 0===t.length?{startDate:null,endDate:null,totalDays:0,monthString:e}:{startDate:t[t.length-1],endDate:t[0],totalDays:t.length,monthString:e,availableDates:t}}catch(t){return console.error(":",t),{startDate:null,endDate:null,totalDays:0,monthString:e,error:t.message}}},clearCache(){console.log(""),yj.clear()},async forceRefresh(e=null,t=null){if(console.log(":",{date:e,monthString:t}),e&&(yj.cache.delete(`ad_data_${e}`),yj.cache.delete(`daily_commission_${e}`),yj.cacheExpiry.delete(`ad_data_${e}`),yj.cacheExpiry.delete(`daily_commission_${e}`)),t){yj.cache.delete(`monthly_commission_${t}`),yj.cache.delete(`available_dates_${t}`),yj.cacheExpiry.delete(`monthly_commission_${t}`),yj.cacheExpiry.delete(`available_dates_${t}`);for(let e=1;e<=31;e++){const r=`${t}-${e.toString().padStart(2,"0")}`;yj.cache.delete(`ad_data_${r}`),yj.cache.delete(`daily_commission_${r}`),yj.cacheExpiry.delete(`ad_data_${r}`),yj.cacheExpiry.delete(`daily_commission_${r}`)}}e||t||this.clearCache(),console.log("")}},_j={async getStableRankings(e="2025-08"){const t=`stable_leaderboard_${e}`;let r=yj.get(t);if(r)return console.log(":",e),r;try{console.log(":",e);const r=await wj.getStableMonthlyCommission(e);if(0===r.length)return console.log(""),wj.TARGET_EMPLOYEES.map((t,r)=>({advertiser:t,totalCommission:0,totalOrders:0,workingDays:0,avgROI:0,rank:r+1,rankInfo:this.getRankInfo(r+1),monthString:e}));const n=[...r].sort((e,t)=>{const r=(t.totalCommission||0)-(e.totalCommission||0);if(Math.abs(r)>=.01)return r;const n=(t.totalOrders||0)-(e.totalOrders||0);if(0!==n)return n;const a=(t.avgROI||0)-(e.avgROI||0);if(Math.abs(a)>=1e-4)return a;const s=(t.workingDays||0)-(e.workingDays||0);return 0!==s?s:(e.advertiser||"").localeCompare(t.advertiser||"","zh-CN")}),a=n.map((e,t)=>({...e,rank:t+1,rankInfo:this.getRankInfo(t+1)})),s=a.map(e=>e.advertiser),i=wj.TARGET_EMPLOYEES.filter(e=>!s.includes(e));return i.length>0&&(console.log(":",i),i.forEach(t=>{a.push({advertiser:t,totalCommission:0,totalOrders:0,workingDays:0,avgROI:0,rank:a.length+1,rankInfo:this.getRankInfo(a.length+1),monthString:e})})),yj.set(t,a,48e4),console.log(":",a),a}catch(n){return console.error(":",n),wj.TARGET_EMPLOYEES.map((t,r)=>({advertiser:t,totalCommission:0,totalOrders:0,workingDays:0,avgROI:0,rank:r+1,rankInfo:this.getRankInfo(r+1),monthString:e,error:n.message}))}},getRankInfo:e=>({1:{title:"",privilege:"",emoji:"",gradient:"from-yellow-400 via-yellow-500 to-yellow-600",textGradient:"from-yellow-600 to-orange-600",bgGradient:"from-yellow-50 to-orange-50",borderColor:"border-yellow-300",shadowColor:"shadow-yellow-200",glowColor:"shadow-yellow-400/30"},2:{title:"",privilege:"",emoji:"",gradient:"from-gray-300 via-gray-400 to-gray-500",textGradient:"from-gray-600 to-slate-600",bgGradient:"from-gray-50 to-slate-50",borderColor:"border-gray-300",shadowColor:"shadow-gray-200",glowColor:"shadow-gray-400/30"},3:{title:"",privilege:"",emoji:"",gradient:"from-orange-400 via-amber-500 to-orange-600",textGradient:"from-orange-600 to-amber-600",bgGradient:"from-orange-50 to-amber-50",borderColor:"border-orange-300",shadowColor:"shadow-orange-200",glowColor:"shadow-orange-400/30"}}[e]||{title:"",privilege:"",emoji:"",gradient:"from-blue-400 via-blue-500 to-blue-600",textGradient:"from-blue-600 to-indigo-600",bgGradient:"from-blue-50 to-indigo-50",borderColor:"border-blue-300",shadowColor:"shadow-blue-200",glowColor:"shadow-blue-400/30"}),clearLeaderboardCache(e=null){if(console.log(":",e),e){const t=`stable_leaderboard_${e}`;yj.cache.delete(t),yj.cacheExpiry.delete(t)}else for(const t of yj.cache.keys())t.startsWith("stable_leaderboard_")&&(yj.cache.delete(t),yj.cacheExpiry.delete(t))},async forceRefreshLeaderboard(e){return console.log(":",e),this.clearLeaderboardCache(e),wj.forceRefresh(null,e),await this.getStableRankings(e)}},kj=function(e,t){let r;return function(...n){clearTimeout(r),r=setTimeout(()=>{clearTimeout(r),e(...n)},t)}}(async e=>{try{await e()}catch(t){console.error(":",t)}},1e3),Nj=()=>{const[e,t]=W.useState(!1),[r,n]=W.useState(null),[a,s]=W.useState("2025-08"),[i,o]=W.useState([]),[l,c]=W.useState(null),[d,u]=W.useState([]),[h,f]=W.useState({key:"date",direction:"desc"}),[m,p]=W.useState({employee:"all",dateRange:"all"}),[g,x]=W.useState(null),v=W.useMemo(()=>[{value:"2025-07",label:"20257"},{value:"2025-08",label:"20258"}],[]),b=W.useMemo(()=>["","",""],[]),y=W.useCallback(e=>"number"!=typeof e||isNaN(e)?0:Math.floor(100*e)/100,[]),w=W.useCallback(async()=>{t(!0),n(null);try{console.log(" :",a);const e=await wj.getAvailableDatesForMonth(a);u(e),console.log(`  ${e.length} :`,e);const t=e.map(e=>wj.getStableDailyCommission(e)),r=await Promise.all(t),n=[];r.forEach((t,r)=>{const a=e[r];t.forEach((e,t)=>{e&&e.advertiser&&n.push({id:`${a}-${e.advertiser}`,date:a,employee:e.advertiser,commission:e.total_commission||0,roi:y(e.roi||0),orders:e.order_count||0,commissionPerOrder:e.commission_per_order||0,status:e.commission_status||"no_data",statusText:e.status_text||""})})}),o(n);const s=_(n);c(s),x((new Date).toISOString()),console.log(` : ${n.length} `),console.log(" :",s)}catch(e){console.error(" :",e),n(`: ${e.message}`)}finally{t(!1)}},[a]),_=W.useCallback(e=>{if(!e||0===e.length)return{totalCommission:0,totalOrders:0,avgROI:0,totalRecords:0,uniqueDates:0,employeeStats:b.map(e=>({employee:e,totalCommission:0,totalOrders:0,avgROI:0,workingDays:0}))};const t=e.reduce((e,t)=>e+t.commission,0),r=e.reduce((e,t)=>e+t.orders,0),n=e.length>0?y(e.reduce((e,t)=>e+t.roi,0)/e.length):0,a=[...new Set(e.map(e=>e.date))].length,s=b.map(t=>{const r=e.filter(e=>e.employee===t),n=r.reduce((e,t)=>e+t.commission,0),a=r.reduce((e,t)=>e+t.orders,0),s=r.length>0?y(r.reduce((e,t)=>e+t.roi,0)/r.length):0,i=r.filter(e=>e.orders>0||e.commission>0).length;return{employee:t,totalCommission:n,totalOrders:a,avgROI:s,workingDays:i}});return{totalCommission:t,totalOrders:r,avgROI:n,totalRecords:e.length,uniqueDates:a,employeeStats:s}},[b]),k=W.useMemo(()=>{if(!i||0===i.length)return[];let e=[...i];if("all"!==m.employee&&(e=e.filter(e=>e.employee===m.employee)),"all"!==m.dateRange){const t=(new Date).toISOString().split("T")[0],r=new Date(Date.now()-6048e5).toISOString().split("T")[0];"recent7"===m.dateRange&&(e=e.filter(e=>e.date>=r&&e.date<=t))}return e.sort((e,t)=>{const r=e[h.key],n=t[h.key];return"number"==typeof r&&"number"==typeof n?"asc"===h.direction?r-n:n-r:"string"==typeof r&&"string"==typeof n?"asc"===h.direction?r.localeCompare(n,"zh-CN"):n.localeCompare(r,"zh-CN"):0})},[i,h,m]),N=W.useCallback(e=>{f(t=>({key:e,direction:t.key===e&&"desc"===t.direction?"asc":"desc"}))},[]),j=W.useCallback((e,t)=>{p(r=>({...r,[e]:t}))},[]),S=W.useCallback(async()=>{console.log(" "),wj.forceRefresh(null,a),await w()},[a,w]),T=W.useCallback(e=>{e!==a&&(s(e),o([]),c(null),u([]))},[a]),E=W.useCallback((e,t,r)=>e>=1?{icon:"",color:"text-green-600",trend:"up"}:e>=.8?{icon:"",color:"text-yellow-600",trend:"stable"}:e>0?{icon:"",color:"text-red-600",trend:"down"}:{icon:"",color:"text-gray-400",trend:"none"},[]),C=W.useCallback((e,t)=>"high_performance"===e||t>=1?{bgColor:"bg-green-50",textColor:"text-green-800",badgeColor:"bg-green-100 text-green-800",borderColor:"border-green-200"}:"qualified"===e||t>=.8&&t<1?{bgColor:"bg-yellow-50",textColor:"text-yellow-800",badgeColor:"bg-yellow-100 text-yellow-800",borderColor:"border-yellow-200"}:"no_commission"===e&&t>0?{bgColor:"bg-red-50",textColor:"text-red-800",badgeColor:"bg-red-100 text-red-800",borderColor:"border-red-200"}:{bgColor:"bg-gray-50",textColor:"text-gray-600",badgeColor:"bg-gray-100 text-gray-600",borderColor:"border-gray-200"},[]),A=W.useCallback((e="csv")=>{if(!k||0===k.length)return void alert("");const t=[["","","","ROI","","",""].join(","),...k.map(e=>[e.date,e.employee,e.commission.toFixed(2),e.roi.toFixed(2),e.orders,e.commissionPerOrder,e.statusText].join(","))].join("\n"),r=new Blob([t],{type:"text/csv;charset=utf-8;"}),n=document.createElement("a");n.href=URL.createObjectURL(r),n.download=`_${a}_${(new Date).toISOString().split("T")[0]}.csv`,n.click()},[k,a]);return W.useEffect(()=>{w()},[w]),!e||i&&0!==i.length?Q.jsxs("div",{className:"min-h-screen bg-gray-50",children:[Q.jsx("div",{className:"bg-white shadow-sm border-b border-gray-200",children:Q.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:Q.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-4",children:[Q.jsxs("div",{className:"flex-1",children:[Q.jsxs("h1",{className:"text-3xl font-bold text-gray-900 flex items-center gap-3",children:[Q.jsx("span",{className:"text-4xl",children:""}),""]}),Q.jsx("p",{className:"mt-2 text-gray-600",children:""})]}),Q.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[Q.jsx("select",{value:a,onChange:e=>T(e.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg bg-white text-gray-900 focus:ring-2 focus:ring-blue-500 focus:border-transparent font-medium",children:v.map(e=>Q.jsx("option",{value:e.value,children:e.label},e.value))}),Q.jsx("button",{onClick:S,disabled:e,className:"bg-blue-600 hover:bg-blue-700 text-white px-6 py-2 rounded-lg transition-colors duration-200 font-medium flex items-center gap-2 disabled:opacity-50",children:e?Q.jsxs(Q.Fragment,{children:[Q.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-2 border-white border-t-transparent"}),""]}):Q.jsx(Q.Fragment,{children:" "})}),Q.jsx("button",{onClick:()=>A("csv"),className:"bg-green-600 hover:bg-green-700 text-white px-6 py-2 rounded-lg transition-colors duration-200 font-medium flex items-center gap-2",children:" "})]})]})})}),Q.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8 space-y-8",children:[r&&Q.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:Q.jsxs("div",{className:"flex items-center space-x-2 text-red-700",children:[Q.jsx("span",{className:"text-xl",children:""}),Q.jsxs("span",{className:"font-medium",children:[": ",r]})]})}),l&&Q.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[Q.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:Q.jsxs("div",{className:"flex items-center justify-between",children:[Q.jsxs("div",{children:[Q.jsx("p",{className:"text-sm font-medium text-gray-600",children:""}),Q.jsxs("p",{className:"text-3xl font-bold text-green-600",children:["",l.totalCommission.toFixed(0)]})]}),Q.jsx("div",{className:"text-green-600 bg-green-100 p-3 rounded-lg",children:""})]})}),Q.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:Q.jsxs("div",{className:"flex items-center justify-between",children:[Q.jsxs("div",{children:[Q.jsx("p",{className:"text-sm font-medium text-gray-600",children:""}),Q.jsx("p",{className:"text-3xl font-bold text-blue-600",children:l.totalOrders})]}),Q.jsx("div",{className:"text-blue-600 bg-blue-100 p-3 rounded-lg",children:""})]})}),Q.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:Q.jsxs("div",{className:"flex items-center justify-between",children:[Q.jsxs("div",{children:[Q.jsx("p",{className:"text-sm font-medium text-gray-600",children:"ROI"}),Q.jsx("p",{className:"text-3xl font-bold text-purple-600",children:l.avgROI.toFixed(2)})]}),Q.jsx("div",{className:"text-purple-600 bg-purple-100 p-3 rounded-lg",children:""})]})}),Q.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:Q.jsxs("div",{className:"flex items-center justify-between",children:[Q.jsxs("div",{children:[Q.jsx("p",{className:"text-sm font-medium text-gray-600",children:""}),Q.jsx("p",{className:"text-3xl font-bold text-orange-600",children:l.uniqueDates})]}),Q.jsx("div",{className:"text-orange-600 bg-orange-100 p-3 rounded-lg",children:""})]})})]}),Q.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:Q.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 items-start sm:items-center justify-between",children:[Q.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[Q.jsxs("div",{className:"flex items-center gap-2",children:[Q.jsx("label",{className:"text-sm font-medium text-gray-700",children:":"}),Q.jsxs("select",{value:m.employee,onChange:e=>j("employee",e.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg bg-white text-sm focus:ring-2 focus:ring-blue-500",children:[Q.jsx("option",{value:"all",children:""}),b.map(e=>Q.jsx("option",{value:e,children:e},e))]})]}),Q.jsxs("div",{className:"flex items-center gap-2",children:[Q.jsx("label",{className:"text-sm font-medium text-gray-700",children:":"}),Q.jsxs("select",{value:m.dateRange,onChange:e=>j("dateRange",e.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg bg-white text-sm focus:ring-2 focus:ring-blue-500",children:[Q.jsx("option",{value:"all",children:""}),Q.jsx("option",{value:"recent7",children:"7"})]})]})]}),Q.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-600",children:[Q.jsxs("span",{children:[" ",k.length," "]}),g&&Q.jsxs("span",{children:[" ",new Date(g).toLocaleString("zh-CN")]})]})]})}),Q.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden",children:Q.jsx("div",{className:"overflow-x-auto",children:Q.jsxs("table",{className:"w-full",children:[Q.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:Q.jsx("tr",{children:[{key:"date",label:"",sortable:!0},{key:"employee",label:"",sortable:!0},{key:"commission",label:"",sortable:!0},{key:"roi",label:"ROI",sortable:!0},{key:"orders",label:"",sortable:!0},{key:"status",label:"",sortable:!1}].map((e,t)=>Q.jsx("th",{className:"px-6 py-4 text-left text-sm font-semibold text-gray-900 "+(e.sortable?"cursor-pointer hover:bg-gray-100":""),onClick:()=>e.sortable&&N(e.key),children:Q.jsxs("div",{className:"flex items-center gap-2",children:[e.label,e.sortable&&h.key===e.key&&Q.jsx("span",{className:"text-blue-600",children:"asc"===h.direction?"":""})]})},e.key))})}),Q.jsx("tbody",{className:"divide-y divide-gray-200",children:0===k.length?Q.jsx("tr",{children:Q.jsx("td",{colSpan:"6",className:"px-6 py-12 text-center",children:Q.jsxs("div",{className:"text-gray-500",children:[Q.jsx("div",{className:"text-4xl mb-4",children:""}),Q.jsx("p",{className:"text-lg",children:""})]})})}):k.map((e,t)=>{const r=C(e.status,e.roi),n=E(e.roi,e.employee,e.date);return Q.jsxs("tr",{className:`${t%2==0?"bg-white":"bg-gray-50"} ${r.bgColor} hover:bg-blue-50 transition-colors duration-150`,children:[Q.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:e.date}),Q.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-semibold text-gray-900",children:Q.jsxs("div",{className:"flex items-center gap-2",children:[Q.jsx("span",{className:"w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center text-blue-600 font-bold text-xs",children:e.employee}),e.employee]})}),Q.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-bold",children:Q.jsxs("span",{className:e.commission>0?"text-green-600":"text-gray-400",children:["",e.commission.toFixed(0)]})}),Q.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:Q.jsxs("div",{className:"flex items-center gap-2",children:[Q.jsx("span",{className:r.textColor,children:e.roi.toFixed(2)}),Q.jsx("span",{className:`${n.color} font-bold`,children:n.icon})]})}),Q.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-semibold text-gray-900",children:e.orders}),Q.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:Q.jsx("span",{className:`inline-flex items-center px-3 py-1 rounded-full text-xs font-medium ${r.badgeColor}`,children:e.statusText})})]},e.id)})}),l&&k.length>0&&Q.jsx("tfoot",{className:"bg-blue-50 border-t-2 border-blue-200",children:Q.jsxs("tr",{children:[Q.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-bold text-blue-900",children:""}),Q.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-blue-700",children:[b.length," "]}),Q.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-bold text-blue-900",children:["",l.totalCommission.toFixed(0)]}),Q.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-bold text-blue-900",children:l.avgROI.toFixed(2)}),Q.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-bold text-blue-900",children:l.totalOrders}),Q.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-blue-700",children:[l.uniqueDates," "]})]})})]})})}),l&&l.employeeStats&&Q.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[Q.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-4 flex items-center gap-2",children:" "}),Q.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:l.employeeStats.map(e=>Q.jsxs("div",{className:"bg-gradient-to-br from-gray-50 to-white border border-gray-200 rounded-lg p-4",children:[Q.jsxs("div",{className:"flex items-center justify-between mb-3",children:[Q.jsx("h4",{className:"text-lg font-bold text-gray-800",children:e.employee}),Q.jsx("span",{className:"w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center text-blue-600 font-bold",children:e.employee})]}),Q.jsxs("div",{className:"space-y-2 text-sm",children:[Q.jsxs("div",{className:"flex justify-between",children:[Q.jsx("span",{className:"text-gray-600",children:":"}),Q.jsxs("span",{className:"font-bold text-green-600",children:["",e.totalCommission.toFixed(0)]})]}),Q.jsxs("div",{className:"flex justify-between",children:[Q.jsx("span",{className:"text-gray-600",children:":"}),Q.jsx("span",{className:"font-semibold",children:e.totalOrders})]}),Q.jsxs("div",{className:"flex justify-between",children:[Q.jsx("span",{className:"text-gray-600",children:"ROI:"}),Q.jsx("span",{className:"font-semibold",children:e.avgROI.toFixed(2)})]}),Q.jsxs("div",{className:"flex justify-between",children:[Q.jsx("span",{className:"text-gray-600",children:":"}),Q.jsxs("span",{className:"font-semibold",children:[e.workingDays,""]})]})]})]},e.employee))})]})]})]}):Q.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:Q.jsxs("div",{className:"text-center",children:[Q.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-4 border-blue-600 border-t-transparent mx-auto mb-6"}),Q.jsx("h3",{className:"text-xl font-semibold text-gray-800 mb-2",children:""}),Q.jsx("p",{className:"text-gray-600",children:"Loading professional data table..."})]})})},jj=()=>{const[e,t]=W.useState(!1),[r,n]=W.useState(null),[a,s]=W.useState("2025-08"),[i,o]=W.useState([]),[l,c]=W.useState(null),[d,u]=W.useState([]),[h,f]=W.useState(null),m=W.useMemo(()=>[{value:"2025-07",label:"20257"},{value:"2025-08",label:"20258"}],[]),p=W.useMemo(()=>["","",""],[]),g=W.useMemo(()=>({"":{avatar:"",name:"",theme:"blue",gradient:"from-blue-400 to-blue-600",bgColor:"bg-blue-50",borderColor:"border-blue-200",textColor:"text-blue-900",cardBg:"bg-gradient-to-br from-blue-50 to-blue-100"},"":{avatar:"",name:"",theme:"purple",gradient:"from-purple-400 to-purple-600",bgColor:"bg-purple-50",borderColor:"border-purple-200",textColor:"text-purple-900",cardBg:"bg-gradient-to-br from-purple-50 to-purple-100"},"":{avatar:"",name:"",theme:"pink",gradient:"from-pink-400 to-pink-600",bgColor:"bg-pink-50",borderColor:"border-pink-200",textColor:"text-pink-900",cardBg:"bg-gradient-to-br from-pink-50 to-pink-100"}}),[]),x=W.useCallback(e=>"number"!=typeof e||isNaN(e)?0:Math.floor(100*e)/100,[]),v=W.useCallback(async()=>{t(!0),n(null);try{console.log(" :",a);const e=await wj.getAvailableDatesForMonth(a);u(e),console.log(`  ${e.length} :`,e);const t=e.map(e=>wj.getStableDailyCommission(e)),r=await Promise.all(t),n=[];r.forEach((t,r)=>{const a=e[r];t.forEach((e,t)=>{e&&e.advertiser&&n.push({id:`${a}-${e.advertiser}`,date:a,employee:e.advertiser,commission:e.total_commission||0,roi:x(e.roi||0),orders:e.order_count||0,commissionPerOrder:e.commission_per_order||0,status:e.commission_status||"no_data",statusText:e.status_text||""})})}),n.sort((e,t)=>e.employee!==t.employee?p.indexOf(e.employee)-p.indexOf(t.employee):new Date(t.date)-new Date(e.date)),o(n);const s=b(n);c(s),f((new Date).toISOString()),console.log(` : ${n.length} `),console.log(" :",s)}catch(e){console.error(" :",e),n(`: ${e.message}`)}finally{t(!1)}},[a,x,p]),b=W.useCallback(e=>{if(!e||0===e.length)return{totalCommission:0,totalOrders:0,avgROI:0,totalRecords:0,uniqueDates:0,employeeStats:p.map(e=>({employee:e,totalCommission:0,totalOrders:0,avgROI:0,workingDays:0,dailyRecords:[]}))};const t=e.reduce((e,t)=>e+t.commission,0),r=e.reduce((e,t)=>e+t.orders,0),n=e.length>0?x(e.reduce((e,t)=>e+t.roi,0)/e.length):0,a=[...new Set(e.map(e=>e.date))].length,s=p.map(t=>{const r=e.filter(e=>e.employee===t),n=r.reduce((e,t)=>e+t.commission,0),a=r.reduce((e,t)=>e+t.orders,0),s=r.length>0?x(r.reduce((e,t)=>e+t.roi,0)/r.length):0,i=r.filter(e=>e.orders>0||e.commission>0).length;return{employee:t,totalCommission:n,totalOrders:a,avgROI:s,workingDays:i,dailyRecords:r}});return{totalCommission:t,totalOrders:r,avgROI:n,totalRecords:e.length,uniqueDates:a,employeeStats:s}},[p,x]),y=W.useCallback(async()=>{console.log(" "),wj.forceRefresh(null,a),await v()},[a,v]),w=W.useCallback(e=>{e!==a&&(s(e),o([]),c(null),u([]))},[a]),_=W.useCallback(e=>e>=1?{icon:"",color:"text-red-500",trend:"",bgColor:"bg-red-100"}:e>=.8?{icon:"",color:"text-yellow-500",trend:"",bgColor:"bg-yellow-100"}:e>0?{icon:"",color:"text-blue-500",trend:"",bgColor:"bg-blue-100"}:{icon:"",color:"text-gray-400",trend:"",bgColor:"bg-gray-100"},[]),k=W.useCallback((e,t)=>"high_performance"===e||t>=1?{bgColor:"bg-gradient-to-r from-green-100 to-green-200",textColor:"text-green-800",borderColor:"border-green-300"}:"qualified"===e||t>=.8&&t<1?{bgColor:"bg-gradient-to-r from-yellow-100 to-yellow-200",textColor:"text-yellow-800",borderColor:"border-yellow-300"}:"no_commission"===e&&t>0?{bgColor:"bg-gradient-to-r from-blue-100 to-blue-200",textColor:"text-blue-800",borderColor:"border-blue-300"}:{bgColor:"bg-gradient-to-r from-gray-100 to-gray-200",textColor:"text-gray-600",borderColor:"border-gray-300"},[]),N=W.useCallback((e="csv")=>{if(!i||0===i.length)return void alert("");const t=[["","","","ROI","","",""].join(","),...i.map(e=>[e.date,e.employee,e.commission.toFixed(2),e.roi.toFixed(2),e.orders,e.commissionPerOrder,e.statusText].join(","))].join("\n"),r=new Blob([t],{type:"text/csv;charset=utf-8;"}),n=document.createElement("a");n.href=URL.createObjectURL(r),n.download=`__${a}_${(new Date).toISOString().split("T")[0]}.csv`,n.click()},[i,a]),j=W.useCallback(e=>{const t=new Date(e);return`${t.getMonth()+1}/${t.getDate()} ${["","","","","","",""][t.getDay()]}`},[]);return W.useEffect(()=>{v()},[v]),!e||i&&0!==i.length?Q.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 to-gray-100",children:[Q.jsx("div",{className:"bg-white shadow-lg border-b border-gray-200",children:Q.jsx("div",{className:"max-w-full mx-auto px-4 sm:px-6 lg:px-8 py-8",children:Q.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-6",children:[Q.jsx("div",{className:"flex-1",children:Q.jsxs("h1",{className:"text-4xl font-bold text-gray-900 flex items-center gap-4",children:[Q.jsx("span",{className:"text-5xl",children:""}),Q.jsxs("div",{children:[" - ",Q.jsx("div",{className:"text-lg text-gray-600 font-normal mt-1",children:""})]})]})}),Q.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[Q.jsx("select",{value:a,onChange:e=>w(e.target.value),className:"px-6 py-3 border border-gray-300 rounded-xl bg-white text-gray-900 focus:ring-2 focus:ring-blue-500 focus:border-transparent font-medium text-lg shadow-sm",children:m.map(e=>Q.jsx("option",{value:e.value,children:e.label},e.value))}),Q.jsx("button",{onClick:y,disabled:e,className:"bg-gradient-to-r from-blue-600 to-blue-700 hover:from-blue-700 hover:to-blue-800 text-white px-8 py-3 rounded-xl transition-all duration-200 font-medium flex items-center gap-3 disabled:opacity-50 shadow-lg hover:shadow-xl transform hover:-translate-y-0.5",children:e?Q.jsxs(Q.Fragment,{children:[Q.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-2 border-white border-t-transparent"}),"..."]}):Q.jsxs(Q.Fragment,{children:[Q.jsx("span",{className:"text-xl",children:""}),""]})}),Q.jsxs("button",{onClick:()=>N("csv"),className:"bg-gradient-to-r from-green-600 to-green-700 hover:from-green-700 hover:to-green-800 text-white px-8 py-3 rounded-xl transition-all duration-200 font-medium flex items-center gap-3 shadow-lg hover:shadow-xl transform hover:-translate-y-0.5",children:[Q.jsx("span",{className:"text-xl",children:""}),""]})]})]})})}),Q.jsxs("div",{className:"max-w-full mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[r&&Q.jsx("div",{className:"mb-8 bg-red-50 border border-red-200 rounded-xl p-6",children:Q.jsxs("div",{className:"flex items-center space-x-3 text-red-700",children:[Q.jsx("span",{className:"text-2xl",children:""}),Q.jsxs("span",{className:"font-semibold text-lg",children:[": ",r]})]})}),l&&Q.jsxs("div",{className:"mb-8 bg-white rounded-2xl shadow-xl border border-gray-200 p-8",children:[Q.jsxs("h2",{className:"text-2xl font-bold text-gray-900 mb-6 flex items-center gap-3",children:[Q.jsx("span",{className:"text-3xl",children:""}),""]}),Q.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[Q.jsx("div",{className:"bg-gradient-to-br from-green-400 to-green-600 rounded-xl p-6 text-white",children:Q.jsxs("div",{className:"flex items-center justify-between",children:[Q.jsxs("div",{children:[Q.jsx("p",{className:"text-green-100 text-sm font-medium",children:""}),Q.jsxs("p",{className:"text-3xl font-bold",children:["",l.totalCommission.toFixed(0)]})]}),Q.jsx("div",{className:"text-4xl opacity-80",children:""})]})}),Q.jsx("div",{className:"bg-gradient-to-br from-blue-400 to-blue-600 rounded-xl p-6 text-white",children:Q.jsxs("div",{className:"flex items-center justify-between",children:[Q.jsxs("div",{children:[Q.jsx("p",{className:"text-blue-100 text-sm font-medium",children:""}),Q.jsx("p",{className:"text-3xl font-bold",children:l.totalOrders})]}),Q.jsx("div",{className:"text-4xl opacity-80",children:""})]})}),Q.jsx("div",{className:"bg-gradient-to-br from-purple-400 to-purple-600 rounded-xl p-6 text-white",children:Q.jsxs("div",{className:"flex items-center justify-between",children:[Q.jsxs("div",{children:[Q.jsx("p",{className:"text-purple-100 text-sm font-medium",children:"ROI"}),Q.jsx("p",{className:"text-3xl font-bold",children:l.avgROI.toFixed(2)})]}),Q.jsx("div",{className:"text-4xl opacity-80",children:""})]})}),Q.jsx("div",{className:"bg-gradient-to-br from-orange-400 to-orange-600 rounded-xl p-6 text-white",children:Q.jsxs("div",{className:"flex items-center justify-between",children:[Q.jsxs("div",{children:[Q.jsx("p",{className:"text-orange-100 text-sm font-medium",children:""}),Q.jsx("p",{className:"text-3xl font-bold",children:l.uniqueDates})]}),Q.jsx("div",{className:"text-4xl opacity-80",children:""})]})})]})]}),l&&l.employeeStats&&Q.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:l.employeeStats.map(e=>{const t=g[e.employee];return t?Q.jsxs("div",{className:"bg-white rounded-2xl shadow-xl border border-gray-200 overflow-hidden",children:[Q.jsxs("div",{className:`bg-gradient-to-r ${t.gradient} p-8 text-white text-center`,children:[Q.jsxs("div",{className:"mb-4",children:[Q.jsx("div",{className:"w-20 h-20 mx-auto bg-white bg-opacity-20 rounded-full flex items-center justify-center mb-4",children:Q.jsx("span",{className:"text-4xl",children:t.avatar})}),Q.jsx("h2",{className:"text-3xl font-bold mb-2",children:t.name}),Q.jsx("p",{className:"text-white text-opacity-90",children:""})]}),Q.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[Q.jsxs("div",{className:"bg-white bg-opacity-20 rounded-xl p-4",children:[Q.jsxs("div",{className:"text-2xl font-bold",children:["",e.totalCommission.toFixed(0)]}),Q.jsx("div",{className:"text-sm text-white text-opacity-80",children:""})]}),Q.jsxs("div",{className:"bg-white bg-opacity-20 rounded-xl p-4",children:[Q.jsx("div",{className:"text-2xl font-bold",children:e.totalOrders}),Q.jsx("div",{className:"text-sm text-white text-opacity-80",children:""})]}),Q.jsxs("div",{className:"bg-white bg-opacity-20 rounded-xl p-4",children:[Q.jsx("div",{className:"text-2xl font-bold",children:e.avgROI.toFixed(2)}),Q.jsx("div",{className:"text-sm text-white text-opacity-80",children:"ROI"})]}),Q.jsxs("div",{className:"bg-white bg-opacity-20 rounded-xl p-4",children:[Q.jsx("div",{className:"text-2xl font-bold",children:e.workingDays}),Q.jsx("div",{className:"text-sm text-white text-opacity-80",children:""})]})]})]}),Q.jsxs("div",{className:"p-6",children:[Q.jsxs("h3",{className:"text-lg font-bold text-gray-800 mb-4 flex items-center gap-2",children:[Q.jsx("span",{className:"text-xl",children:""}),""]}),Q.jsx("div",{className:"space-y-3 max-h-96 overflow-y-auto",children:0===e.dailyRecords.length?Q.jsxs("div",{className:"text-center py-8 text-gray-500",children:[Q.jsx("div",{className:"text-4xl mb-2",children:""}),Q.jsx("p",{children:""})]}):e.dailyRecords.map(e=>{const t=k(e.status,e.roi),r=_(e.roi);return Q.jsxs("div",{className:`${t.bgColor} ${t.borderColor} border rounded-xl p-4 hover:shadow-md transition-all duration-200 transform hover:-translate-y-1`,children:[Q.jsxs("div",{className:"flex items-center justify-between mb-3",children:[Q.jsx("div",{className:"text-lg font-bold text-gray-800",children:j(e.date)}),Q.jsxs("div",{className:`${r.bgColor} px-3 py-1 rounded-full flex items-center gap-2`,children:[Q.jsx("span",{children:r.icon}),Q.jsx("span",{className:`text-xs font-medium ${r.color}`,children:r.trend})]})]}),Q.jsxs("div",{className:"grid grid-cols-3 gap-3 text-center",children:[Q.jsxs("div",{children:[Q.jsxs("div",{className:"text-lg font-bold "+(e.commission>0?"text-green-600":"text-gray-400"),children:["",e.commission.toFixed(0)]}),Q.jsx("div",{className:"text-xs text-gray-600",children:""})]}),Q.jsxs("div",{children:[Q.jsx("div",{className:`text-lg font-bold ${t.textColor}`,children:e.roi.toFixed(2)}),Q.jsx("div",{className:"text-xs text-gray-600",children:"ROI"})]}),Q.jsxs("div",{children:[Q.jsx("div",{className:"text-lg font-bold text-gray-800",children:e.orders}),Q.jsx("div",{className:"text-xs text-gray-600",children:""})]})]}),e.commission>0&&Q.jsx("div",{className:"mt-3 pt-3 border-t border-gray-200",children:Q.jsxs("div",{className:"text-xs text-gray-600 text-center",children:[": ",e.commissionPerOrder.toFixed(2)]})})]},e.id)})})]})]},e.employee):null})}),h&&Q.jsx("div",{className:"mt-8 text-center",children:Q.jsxs("p",{className:"text-gray-500 text-sm",children:[": ",new Date(h).toLocaleString("zh-CN")]})})]})]}):Q.jsx("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 to-gray-100 flex items-center justify-center",children:Q.jsxs("div",{className:"text-center",children:[Q.jsxs("div",{className:"relative",children:[Q.jsx("div",{className:"animate-spin rounded-full h-20 w-20 border-4 border-blue-600 border-t-transparent mx-auto mb-6"}),Q.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:Q.jsx("span",{className:"text-2xl",children:""})})]}),Q.jsx("h3",{className:"text-2xl font-bold text-gray-800 mb-2",children:""}),Q.jsx("p",{className:"text-gray-600",children:"Loading three-column commission layout..."})]})})},Sj=()=>{var e,t;const[r,n]=W.useState(!1),[a,s]=W.useState(null),[i,o]=W.useState("2025-08"),[l,c]=W.useState([]),[d,u]=W.useState(null),[h,f]=W.useState(!1),m=W.useMemo(()=>[{value:"2025-07",label:"20257"},{value:"2025-08",label:"20258"}],[]),p=W.useCallback(async e=>{try{n(!0),s(null),console.log(":",e);const t=await _j.getStableRankings(e);c(t),u((new Date).toISOString()),console.log(":",t)}catch(t){console.error(":",t),s(`: ${t.message}`),c([])}finally{n(!1)}},[]),g=W.useCallback(()=>{f(!0),kj(async()=>{try{console.log("");const e=await _j.forceRefreshLeaderboard(i);c(e),u((new Date).toISOString()),s(null),console.log("")}catch(e){console.error(":",e),s(`: ${e.message}`)}finally{f(!1)}})},[i]),x=W.useCallback(e=>{e!==i&&(o(e),c([]),s(null))},[i]),v=W.useCallback(e=>({1:{gradient:"from-yellow-400 via-yellow-500 to-yellow-600",bgGradient:"from-yellow-50 to-orange-50",textColor:"text-yellow-800",borderColor:"border-yellow-300",glowColor:"shadow-yellow-400/50"},2:{gradient:"from-gray-300 via-gray-400 to-gray-500",bgGradient:"from-gray-50 to-slate-50",textColor:"text-gray-800",borderColor:"border-gray-300",glowColor:"shadow-gray-400/50"},3:{gradient:"from-orange-400 via-amber-500 to-orange-600",bgGradient:"from-orange-50 to-amber-50",textColor:"text-orange-800",borderColor:"border-orange-300",glowColor:"shadow-orange-400/50"}}[e]||{gradient:"from-blue-400 via-blue-500 to-blue-600",bgGradient:"from-blue-50 to-indigo-50",textColor:"text-blue-800",borderColor:"border-blue-300",glowColor:"shadow-blue-400/50"}),[]),b=W.useMemo(()=>0===l.length?{totalCommission:0,totalOrders:0,maxWorkingDays:0,avgROI:0}:{totalCommission:l.reduce((e,t)=>e+(t.totalCommission||0),0),totalOrders:l.reduce((e,t)=>e+(t.totalOrders||0),0),maxWorkingDays:Math.max(...l.map(e=>e.workingDays||0)),avgROI:l.reduce((e,t)=>e+(t.avgROI||0),0)/l.length},[l]);return W.useEffect(()=>{p(i)},[i,p]),r&&0===l.length?Q.jsx("div",{className:"min-h-screen bg-gradient-to-br from-purple-50 via-blue-50 to-indigo-100 flex items-center justify-center",children:Q.jsxs("div",{className:"text-center",children:[Q.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-4 border-purple-500 border-t-transparent mx-auto mb-4"}),Q.jsx("h3",{className:"text-lg font-semibold text-purple-800 mb-2",children:""}),Q.jsx("p",{className:"text-purple-600",children:"..."})]})}):Q.jsx("div",{className:"min-h-screen bg-gradient-to-br from-purple-50 via-blue-50 to-indigo-100 p-4 lg:p-6",children:Q.jsxs("div",{className:"max-w-6xl mx-auto space-y-6",children:[Q.jsxs("div",{className:"text-center mb-8",children:[Q.jsx("div",{className:"inline-flex items-center justify-center p-3 bg-gradient-to-r from-purple-600 to-blue-600 rounded-full mb-4",children:Q.jsx("span",{className:"text-4xl",children:""})}),Q.jsx("h1",{className:"text-4xl lg:text-5xl font-bold bg-gradient-to-r from-purple-600 via-blue-600 to-indigo-600 bg-clip-text text-transparent mb-2",children:" "}),Q.jsx("p",{className:"text-gray-600 text-lg",children:""})]}),Q.jsx("div",{className:"bg-white/90 backdrop-blur-sm rounded-2xl p-6 shadow-xl border border-white/30",children:Q.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-center gap-4",children:[Q.jsxs("div",{className:"flex items-center gap-4",children:[Q.jsx("select",{value:i,onChange:e=>x(e.target.value),className:"px-4 py-2 bg-white border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-purple-500 transition-all duration-200 text-sm",children:m.map(e=>Q.jsx("option",{value:e.value,children:e.label},e.value))}),Q.jsx("button",{onClick:g,disabled:r||h,className:"bg-gradient-to-r from-purple-500 to-blue-500 hover:from-purple-600 hover:to-blue-600 text-white px-4 py-2 rounded-xl transition-all duration-200 transform hover:scale-105 disabled:opacity-50 disabled:transform-none flex items-center gap-2 text-sm",children:r||h?Q.jsxs(Q.Fragment,{children:[Q.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-2 border-white border-t-transparent"}),""]}):Q.jsx(Q.Fragment,{children:" "})})]}),Q.jsxs("div",{className:"text-sm text-gray-600 text-center sm:text-right",children:[d&&Q.jsxs("div",{children:[" ",new Date(d).toLocaleString("zh-CN")]}),Q.jsx("div",{className:"text-xs text-gray-500 mt-1",children:""})]})]})}),a&&Q.jsx("div",{className:"bg-red-50 border border-red-200 rounded-2xl p-6",children:Q.jsxs("div",{className:"flex items-center space-x-3 text-red-700",children:[Q.jsx("span",{className:"text-2xl",children:""}),Q.jsxs("div",{children:[Q.jsx("h3",{className:"font-semibold",children:""}),Q.jsx("p",{className:"text-sm mt-1",children:a})]})]})}),0===l.length?Q.jsxs("div",{className:"bg-white/90 backdrop-blur-sm rounded-2xl p-12 shadow-xl border border-white/30 text-center",children:[Q.jsx("div",{className:"text-6xl mb-4",children:""}),Q.jsx("h3",{className:"text-2xl font-bold text-gray-700 mb-2",children:""}),Q.jsx("p",{className:"text-gray-500",children:""}),Q.jsx("button",{onClick:g,className:"mt-4 bg-gradient-to-r from-blue-500 to-purple-500 text-white px-6 py-2 rounded-xl hover:from-blue-600 hover:to-purple-600 transition-all duration-200",children:""})]}):Q.jsxs("div",{className:"space-y-6",children:[l.slice(0,3).length>0&&Q.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6 mb-8",children:l.slice(0,3).map((e,t)=>{const r=v(e.rank),{rankInfo:n}=e;return Q.jsxs("div",{className:"group relative transform transition-all duration-500 hover:scale-105",children:[Q.jsx("div",{className:`absolute inset-0 bg-gradient-to-r ${r.gradient} opacity-20 blur-xl rounded-3xl group-hover:opacity-30 transition-opacity duration-300`}),Q.jsxs("div",{className:`relative bg-gradient-to-br ${r.bgGradient} border-2 ${r.borderColor} rounded-3xl p-6 shadow-2xl ${r.glowColor} hover:shadow-3xl transition-all duration-300`,children:[Q.jsx("div",{className:"absolute -top-4 left-1/2 transform -translate-x-1/2",children:Q.jsxs("div",{className:`bg-gradient-to-r ${r.gradient} text-white px-4 py-2 rounded-full shadow-lg flex items-center gap-2`,children:[Q.jsx("span",{className:"text-2xl",children:n.emoji}),Q.jsxs("span",{className:"font-bold",children:["",e.rank,""]})]})}),Q.jsxs("div",{className:"text-center mt-6",children:[Q.jsx("div",{className:"text-6xl mb-4",children:n.emoji}),Q.jsx("h3",{className:`text-2xl font-bold ${r.textColor} mb-2`,children:e.advertiser}),Q.jsx("div",{className:`bg-gradient-to-r ${r.gradient} text-white px-4 py-2 rounded-full text-sm font-medium mb-4 inline-block`,children:n.title}),Q.jsxs("div",{className:"space-y-3",children:[Q.jsxs("div",{className:"bg-white/60 rounded-xl p-4",children:[Q.jsxs("div",{className:"text-3xl font-bold text-gray-800",children:["",(e.totalCommission||0).toFixed(0)]}),Q.jsx("div",{className:"text-sm text-gray-600",children:""})]}),Q.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[Q.jsxs("div",{className:"bg-white/40 rounded-lg p-3 text-center",children:[Q.jsx("div",{className:"text-xl font-bold text-gray-800",children:e.totalOrders||0}),Q.jsx("div",{className:"text-xs text-gray-600",children:""})]}),Q.jsxs("div",{className:"bg-white/40 rounded-lg p-3 text-center",children:[Q.jsx("div",{className:"text-xl font-bold text-gray-800",children:(e.avgROI||0).toFixed(2)}),Q.jsx("div",{className:"text-xs text-gray-600",children:"ROI"})]})]}),Q.jsxs("div",{className:"bg-white/40 rounded-lg p-3 text-center",children:[Q.jsxs("div",{className:"text-lg font-bold text-gray-800",children:[e.workingDays||0,""]}),Q.jsx("div",{className:"text-xs text-gray-600",children:""})]})]}),Q.jsxs("div",{className:"mt-4 p-3 bg-white/50 rounded-xl",children:[Q.jsx("div",{className:"text-sm font-medium text-gray-700",children:" "}),Q.jsx("div",{className:"text-sm text-gray-600 mt-1",children:n.privilege})]})]})]})]},e.advertiser)})}),Q.jsxs("div",{className:"bg-white/90 backdrop-blur-sm rounded-2xl shadow-xl border border-white/30 overflow-hidden",children:[Q.jsx("div",{className:"bg-gradient-to-r from-purple-600 to-blue-600 text-white p-6",children:Q.jsxs("h2",{className:"text-2xl font-bold flex items-center gap-3",children:[" ",Q.jsxs("span",{className:"text-lg font-normal opacity-80",children:["(",null==(e=m.find(e=>e.value===i))?void 0:e.label,")"]})]})}),Q.jsx("div",{className:"p-6",children:Q.jsx("div",{className:"overflow-x-auto",children:Q.jsxs("table",{className:"w-full",children:[Q.jsx("thead",{children:Q.jsxs("tr",{className:"border-b border-gray-200",children:[Q.jsx("th",{className:"text-left py-3 px-4 font-semibold text-gray-700",children:""}),Q.jsx("th",{className:"text-left py-3 px-4 font-semibold text-gray-700",children:""}),Q.jsx("th",{className:"text-left py-3 px-4 font-semibold text-gray-700",children:""}),Q.jsx("th",{className:"text-right py-3 px-4 font-semibold text-gray-700",children:""}),Q.jsx("th",{className:"text-right py-3 px-4 font-semibold text-gray-700",children:""}),Q.jsx("th",{className:"text-right py-3 px-4 font-semibold text-gray-700",children:""}),Q.jsx("th",{className:"text-right py-3 px-4 font-semibold text-gray-700",children:"ROI"})]})}),Q.jsx("tbody",{children:l.map(e=>{const t=v(e.rank),{rankInfo:r}=e;return Q.jsxs("tr",{className:`border-b border-gray-100 hover:bg-gradient-to-r hover:${t.bgGradient} transition-all duration-300`,children:[Q.jsx("td",{className:"py-4 px-4",children:Q.jsxs("div",{className:"flex items-center gap-2",children:[Q.jsx("span",{className:"text-2xl",children:r.emoji}),Q.jsxs("span",{className:`font-bold text-lg ${t.textColor}`,children:["#",e.rank]})]})}),Q.jsx("td",{className:"py-4 px-4",children:Q.jsx("div",{className:"font-semibold text-gray-800 text-lg",children:e.advertiser})}),Q.jsx("td",{className:"py-4 px-4",children:Q.jsx("span",{className:`bg-gradient-to-r ${t.gradient} text-white px-3 py-1 rounded-full text-sm font-medium`,children:r.title})}),Q.jsx("td",{className:"py-4 px-4 text-right",children:Q.jsxs("div",{className:"font-bold text-lg text-gray-800",children:["",(e.totalCommission||0).toFixed(0)]})}),Q.jsx("td",{className:"py-4 px-4 text-right",children:Q.jsx("div",{className:"font-semibold text-gray-700",children:e.totalOrders||0})}),Q.jsx("td",{className:"py-4 px-4 text-right",children:Q.jsxs("div",{className:"font-semibold text-gray-700",children:[e.workingDays||0,""]})}),Q.jsx("td",{className:"py-4 px-4 text-right",children:Q.jsx("div",{className:"font-semibold text-gray-700",children:(e.avgROI||0).toFixed(3)})})]},e.advertiser)})})]})})})]}),Q.jsxs("div",{className:"bg-white/90 backdrop-blur-sm rounded-2xl p-6 shadow-xl border border-white/30",children:[Q.jsxs("h3",{className:"text-xl font-bold text-gray-800 mb-6 flex items-center gap-2",children:[" ",Q.jsxs("span",{className:"text-sm font-normal text-gray-500",children:["(",null==(t=m.find(e=>e.value===i))?void 0:t.label,")"]})]}),Q.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-4",children:[Q.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-blue-100 rounded-xl p-4 text-center border border-blue-200",children:[Q.jsxs("div",{className:"text-2xl font-bold text-blue-600",children:["",b.totalCommission.toFixed(0)]}),Q.jsx("div",{className:"text-sm text-blue-700 mt-1",children:""})]}),Q.jsxs("div",{className:"bg-gradient-to-br from-green-50 to-green-100 rounded-xl p-4 text-center border border-green-200",children:[Q.jsx("div",{className:"text-2xl font-bold text-green-600",children:b.totalOrders}),Q.jsx("div",{className:"text-sm text-green-700 mt-1",children:""})]}),Q.jsxs("div",{className:"bg-gradient-to-br from-purple-50 to-purple-100 rounded-xl p-4 text-center border border-purple-200",children:[Q.jsx("div",{className:"text-2xl font-bold text-purple-600",children:b.maxWorkingDays}),Q.jsx("div",{className:"text-sm text-purple-700 mt-1",children:""})]}),Q.jsxs("div",{className:"bg-gradient-to-br from-orange-50 to-orange-100 rounded-xl p-4 text-center border border-orange-200",children:[Q.jsx("div",{className:"text-2xl font-bold text-orange-600",children:(b.avgROI||0).toFixed(2)}),Q.jsx("div",{className:"text-sm text-orange-700 mt-1",children:"ROI"})]})]})]})]})]})})},Tj=({isDark:e=!1})=>{var t,r,n;const[a,s]=W.useState(null),[i,o]=W.useState(!0),[l,c]=W.useState(null),[d,u]=W.useState({advertiser:"",amount:"",type:"revenue",date:(new Date).toISOString().split("T")[0]});W.useEffect(()=>{h()},[]);const h=async()=>{try{o(!0);const e=await mp.getDashboardData();s(e)}catch(e){c(e.message)}finally{o(!1)}};return i?Q.jsx("div",{className:"min-h-screen flex items-center justify-center "+(e?"bg-gray-900":"bg-gray-50"),children:Q.jsxs("div",{className:"text-center",children:[Q.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-600 mx-auto"}),Q.jsx("p",{className:"mt-4 "+(e?"text-gray-300":"text-gray-600"),children:"..."})]})}):l?Q.jsx("div",{className:"min-h-screen flex items-center justify-center "+(e?"bg-gray-900":"bg-gray-50"),children:Q.jsxs("div",{className:"text-center",children:[Q.jsx("div",{className:"text-red-500 text-6xl mb-4",children:""}),Q.jsx("h2",{className:"text-xl font-semibold mb-2 "+(e?"text-white":"text-gray-900"),children:""}),Q.jsx("p",{className:""+(e?"text-gray-400":"text-gray-600"),children:l}),Q.jsx("button",{onClick:h,className:"mt-4 px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 transition-colors",children:""})]})}):Q.jsx("div",{className:"min-h-screen transition-colors duration-300 "+(e?"bg-gray-900":"bg-gray-50"),children:Q.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[Q.jsxs("div",{className:"mb-8",children:[Q.jsx("h1",{className:"text-3xl font-bold "+(e?"text-white":"text-gray-900"),children:" "}),Q.jsx("p",{className:"mt-2 "+(e?"text-gray-400":"text-gray-600"),children:""})]}),Q.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[Q.jsx("div",{className:"rounded-2xl shadow-xl transition-all duration-300 "+(e?"bg-gray-800/50 backdrop-blur-sm border border-gray-700":"bg-white/70 backdrop-blur-sm border border-gray-200"),children:Q.jsxs("div",{className:"p-6",children:[Q.jsx("h2",{className:"text-xl font-semibold mb-6 "+(e?"text-white":"text-gray-900"),children:" "}),Q.jsxs("form",{onSubmit:async e=>{e.preventDefault();try{const e={id:Date.now(),advertiser:d.advertiser,amount:parseInt(d.amount),type:d.type,timestamp:new Date(d.date).toISOString()},t={...a,recentTransactions:[e,...a.recentTransactions.slice(0,4)]};"revenue"===d.type?t.totalRevenue+=e.amount:t.totalCost+=Math.abs(e.amount),await mp.updateDashboardData(t),s(t),u({advertiser:"",amount:"",type:"revenue",date:(new Date).toISOString().split("T")[0]})}catch(t){c(t.message)}},className:"space-y-6",children:[Q.jsxs("div",{children:[Q.jsx("label",{className:"block text-sm font-medium mb-2 "+(e?"text-gray-300":"text-gray-700"),children:""}),Q.jsx("input",{type:"text",value:d.advertiser,onChange:e=>u({...d,advertiser:e.target.value}),className:"w-full px-4 py-3 rounded-xl border transition-all duration-200 focus:ring-2 focus:ring-indigo-500 focus:border-transparent "+(e?"bg-gray-700 border-gray-600 text-white placeholder-gray-400":"bg-white border-gray-300 text-gray-900 placeholder-gray-500"),placeholder:"",required:!0})]}),Q.jsxs("div",{children:[Q.jsx("label",{className:"block text-sm font-medium mb-2 "+(e?"text-gray-300":"text-gray-700"),children:" (MX$)"}),Q.jsx("input",{type:"number",value:d.amount,onChange:e=>u({...d,amount:e.target.value}),className:"w-full px-4 py-3 rounded-xl border transition-all duration-200 focus:ring-2 focus:ring-indigo-500 focus:border-transparent "+(e?"bg-gray-700 border-gray-600 text-white placeholder-gray-400":"bg-white border-gray-300 text-gray-900 placeholder-gray-500"),placeholder:"",required:!0})]}),Q.jsxs("div",{children:[Q.jsx("label",{className:"block text-sm font-medium mb-2 "+(e?"text-gray-300":"text-gray-700"),children:""}),Q.jsxs("select",{value:d.type,onChange:e=>u({...d,type:e.target.value}),className:"w-full px-4 py-3 rounded-xl border transition-all duration-200 focus:ring-2 focus:ring-indigo-500 focus:border-transparent "+(e?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300 text-gray-900"),children:[Q.jsx("option",{value:"revenue",children:" "}),Q.jsx("option",{value:"cost",children:" "})]})]}),Q.jsxs("div",{children:[Q.jsx("label",{className:"block text-sm font-medium mb-2 "+(e?"text-gray-300":"text-gray-700"),children:""}),Q.jsx("input",{type:"date",value:d.date,onChange:e=>u({...d,date:e.target.value}),className:"w-full px-4 py-3 rounded-xl border transition-all duration-200 focus:ring-2 focus:ring-indigo-500 focus:border-transparent "+(e?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300 text-gray-900"),required:!0})]}),Q.jsx("button",{type:"submit",className:"w-full bg-gradient-to-r from-indigo-600 to-purple-600 text-white py-3 px-4 rounded-xl font-medium hover:from-indigo-700 hover:to-purple-700 transform hover:scale-105 transition-all duration-200 shadow-lg hover:shadow-xl",children:" "})]})]})}),Q.jsx("div",{className:"rounded-2xl shadow-xl transition-all duration-300 "+(e?"bg-gray-800/50 backdrop-blur-sm border border-gray-700":"bg-white/70 backdrop-blur-sm border border-gray-200"),children:Q.jsxs("div",{className:"p-6",children:[Q.jsx("h2",{className:"text-xl font-semibold mb-6 "+(e?"text-white":"text-gray-900"),children:" "}),Q.jsx("div",{className:"space-y-4",children:null==(t=null==a?void 0:a.recentTransactions)?void 0:t.map((t,r)=>{var n;return Q.jsx("div",{className:"p-4 rounded-xl transition-all duration-200 hover:scale-102 "+(e?"bg-gray-700/50 hover:bg-gray-700/70":"bg-gray-50 hover:bg-gray-100"),children:Q.jsxs("div",{className:"flex items-center justify-between",children:[Q.jsxs("div",{className:"flex items-center space-x-3",children:[Q.jsx("div",{className:"w-10 h-10 rounded-full flex items-center justify-center font-bold text-white "+("revenue"===t.type?"bg-green-500":"bg-red-500"),children:(null==(n=t.advertiser)?void 0:n.charAt(0))||"?"}),Q.jsxs("div",{children:[Q.jsx("div",{className:"font-medium "+(e?"text-white":"text-gray-900"),children:t.advertiser}),Q.jsx("div",{className:"text-sm "+(e?"text-gray-400":"text-gray-600"),children:new Date(t.timestamp).toLocaleDateString("zh-CN")})]})]}),Q.jsxs("div",{className:"font-bold "+("revenue"===t.type?"text-green-500":"text-red-500"),children:["revenue"===t.type?"+":"-","MX$",Math.abs(t.amount).toLocaleString()]})]})},t.id||r)})})]})})]}),Q.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mt-8",children:[Q.jsx("div",{className:"rounded-2xl p-6 shadow-xl transition-all duration-300 "+(e?"bg-gradient-to-br from-green-800/30 to-green-900/30 border border-green-700/50":"bg-gradient-to-br from-green-50 to-green-100 border border-green-200"),children:Q.jsxs("div",{className:"flex items-center justify-between",children:[Q.jsxs("div",{children:[Q.jsx("p",{className:"text-sm font-medium "+(e?"text-green-300":"text-green-700"),children:""}),Q.jsxs("p",{className:"text-2xl font-bold "+(e?"text-white":"text-gray-900"),children:["MX$",(null==(r=null==a?void 0:a.totalRevenue)?void 0:r.toLocaleString())||"0"]})]}),Q.jsx("div",{className:"text-3xl",children:""})]})}),Q.jsx("div",{className:"rounded-2xl p-6 shadow-xl transition-all duration-300 "+(e?"bg-gradient-to-br from-red-800/30 to-red-900/30 border border-red-700/50":"bg-gradient-to-br from-red-50 to-red-100 border border-red-200"),children:Q.jsxs("div",{className:"flex items-center justify-between",children:[Q.jsxs("div",{children:[Q.jsx("p",{className:"text-sm font-medium "+(e?"text-red-300":"text-red-700"),children:""}),Q.jsxs("p",{className:"text-2xl font-bold "+(e?"text-white":"text-gray-900"),children:["MX$",(null==(n=null==a?void 0:a.totalCost)?void 0:n.toLocaleString())||"0"]})]}),Q.jsx("div",{className:"text-3xl",children:""})]})}),Q.jsx("div",{className:"rounded-2xl p-6 shadow-xl transition-all duration-300 "+(e?"bg-gradient-to-br from-blue-800/30 to-blue-900/30 border border-blue-700/50":"bg-gradient-to-br from-blue-50 to-blue-100 border border-blue-200"),children:Q.jsxs("div",{className:"flex items-center justify-between",children:[Q.jsxs("div",{children:[Q.jsx("p",{className:"text-sm font-medium "+(e?"text-blue-300":"text-blue-700"),children:""}),Q.jsxs("p",{className:"text-2xl font-bold "+(e?"text-white":"text-gray-900"),children:["MX$",(((null==a?void 0:a.totalRevenue)||0)-((null==a?void 0:a.totalCost)||0)).toLocaleString()]})]}),Q.jsx("div",{className:"text-3xl",children:""})]})})]})]})})},Ej=()=>{const[e,t]=W.useState((new Date).toISOString().split("T")[0]),[r,n]=W.useState(""),[a,s]=W.useState(!1),[i,o]=W.useState(null),[l,c]=W.useState({adSpend:"",creditCardOrders:"",paymentInfoCount:"",orderCount:""}),[d,u]=W.useState([]),[h,f]=W.useState(!1);W.useEffect(()=>{m()},[]);const m=async()=>{try{const e=(await fp.getAll()).map(e=>({id:e.id,date:e.date,staff:e.staff,adSpend:e.ad_spend,creditCardOrders:e.credit_card_amount,paymentInfoCount:e.payment_info_count,orderCount:e.credit_card_orders,timestamp:e.created_at}));u(e)}catch(e){console.error(":",e),alert("")}},p=(e,t)=>{c(r=>({...r,[e]:t}))},g=d.filter(t=>(!e||t.date===e)&&(!r||t.staff===r)),x=g.reduce((e,t)=>({adSpend:e.adSpend+t.adSpend,creditCardOrders:e.creditCardOrders+t.creditCardOrders,paymentInfoCount:e.paymentInfoCount+t.paymentInfoCount,orderCount:e.orderCount+t.orderCount}),{adSpend:0,creditCardOrders:0,paymentInfoCount:0,orderCount:0});return Q.jsx("div",{className:"max-w-7xl mx-auto p-6",children:Q.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-8",children:[Q.jsxs("div",{className:"text-center mb-8",children:[Q.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-gradient-to-br from-blue-500 to-indigo-500 rounded-2xl mb-4",children:Q.jsx("svg",{className:"w-8 h-8 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:Q.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})})}),Q.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:""}),Q.jsx("p",{className:"text-gray-600",children:""})]}),Q.jsxs("div",{className:"bg-gray-50 rounded-2xl p-6 mb-8",children:[Q.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-6",children:""}),Q.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6 mb-6",children:[Q.jsxs("div",{children:[Q.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""}),Q.jsx("input",{type:"date",value:e,onChange:e=>t(e.target.value),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),Q.jsxs("div",{children:[Q.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""}),Q.jsxs("select",{value:r,onChange:e=>n(e.target.value),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[Q.jsx("option",{value:"",children:""}),["","","","",""].map(e=>Q.jsx("option",{value:e,children:e},e))]})]}),Q.jsx("div",{className:"flex items-end",children:Q.jsx("button",{onClick:()=>{e&&r?(s(!0),c({adSpend:"",creditCardOrders:"",paymentInfoCount:"",orderCount:""})):alert("")},disabled:!e||!r,className:"w-full bg-gradient-to-r from-blue-500 to-blue-600 text-white px-6 py-3 rounded-lg hover:from-blue-600 hover:to-blue-700 transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed font-semibold",children:""})})]})]}),a&&Q.jsxs("div",{className:"bg-blue-50 rounded-2xl p-6 mb-8",children:[Q.jsxs("h3",{className:"text-xl font-semibold text-gray-900 mb-6",children:[i?"":""," - ",e," - ",r]}),Q.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6",children:[Q.jsxs("div",{children:[Q.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:" ()"}),Q.jsxs("div",{className:"relative",children:[Q.jsx("span",{className:"absolute left-3 top-3 text-gray-500 font-semibold",children:"$"}),Q.jsx("input",{type:"number",step:"0.01",placeholder:"0.00",value:l.adSpend,onChange:e=>p("adSpend",e.target.value),className:"w-full p-3 pl-8 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]})]}),Q.jsxs("div",{children:[Q.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:" (MX$)"}),Q.jsx("input",{type:"number",step:"0.01",placeholder:"",value:l.creditCardOrders,onChange:e=>p("creditCardOrders",e.target.value),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),Q.jsxs("div",{children:[Q.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""}),Q.jsx("input",{type:"number",placeholder:"",value:l.paymentInfoCount,onChange:e=>p("paymentInfoCount",e.target.value),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),Q.jsxs("div",{children:[Q.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:""}),Q.jsx("input",{type:"number",placeholder:"",value:l.orderCount,onChange:e=>p("orderCount",e.target.value),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]})]}),Q.jsxs("div",{className:"flex gap-4",children:[Q.jsx("button",{onClick:async()=>{if(l.adSpend&&l.creditCardOrders&&l.paymentInfoCount&&l.orderCount){f(!0);try{const t={date:e,staff:r,adSpend:parseFloat(l.adSpend),creditCardOrders:parseFloat(l.creditCardOrders),paymentInfoCount:parseInt(l.paymentInfoCount),orderCount:parseInt(l.orderCount)};i&&(t.id=i.id),await fp.upsert(t),await m(),c({adSpend:"",creditCardOrders:"",paymentInfoCount:"",orderCount:""}),s(!1),o(null);alert(i?"":"")}catch(t){console.error(":",t),alert("")}finally{f(!1)}}else alert("")},disabled:h,className:"bg-green-600 text-white px-6 py-3 rounded-lg hover:bg-green-700 transition-colors disabled:opacity-50 font-semibold",children:h?i?"...":"...":i?"":""}),Q.jsx("button",{onClick:()=>{o(null),s(!1),c({adSpend:"",creditCardOrders:"",paymentInfoCount:"",orderCount:""})},className:"bg-gray-500 text-white px-6 py-3 rounded-lg hover:bg-gray-600 transition-colors font-semibold",children:""})]})]}),g.length>0&&Q.jsxs("div",{className:"bg-gray-50 rounded-2xl p-6 mb-8",children:[Q.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-6",children:""}),Q.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[Q.jsxs("div",{className:"bg-white rounded-xl p-4 text-center",children:[Q.jsxs("div",{className:"text-2xl font-bold text-red-600",children:["$",x.adSpend.toFixed(2)]}),Q.jsx("div",{className:"text-sm text-gray-600",children:" ()"})]}),Q.jsxs("div",{className:"bg-white rounded-xl p-4 text-center",children:[Q.jsxs("div",{className:"text-2xl font-bold text-green-600",children:["MX$",x.creditCardOrders.toFixed(2)]}),Q.jsx("div",{className:"text-sm text-gray-600",children:""})]}),Q.jsxs("div",{className:"bg-white rounded-xl p-4 text-center",children:[Q.jsx("div",{className:"text-2xl font-bold text-blue-600",children:x.paymentInfoCount}),Q.jsx("div",{className:"text-sm text-gray-600",children:""})]}),Q.jsxs("div",{className:"bg-white rounded-xl p-4 text-center",children:[Q.jsx("div",{className:"text-2xl font-bold text-purple-600",children:x.orderCount}),Q.jsx("div",{className:"text-sm text-gray-600",children:""})]})]})]}),Q.jsxs("div",{className:"mt-8",children:[Q.jsx("div",{className:"flex items-center justify-between mb-6",children:Q.jsxs("h3",{className:"text-xl font-semibold text-gray-900",children:[" (",g.length,")"]})}),g.length>0?Q.jsx("div",{className:"overflow-x-auto",children:Q.jsxs("table",{className:"w-full bg-white rounded-lg overflow-hidden shadow-sm",children:[Q.jsx("thead",{className:"bg-gray-50",children:Q.jsxs("tr",{children:[Q.jsx("th",{className:"px-6 py-4 text-left text-sm font-medium text-gray-500 uppercase tracking-wider",children:""}),Q.jsx("th",{className:"px-6 py-4 text-left text-sm font-medium text-gray-500 uppercase tracking-wider",children:""}),Q.jsx("th",{className:"px-6 py-4 text-left text-sm font-medium text-gray-500 uppercase tracking-wider",children:" ($)"}),Q.jsx("th",{className:"px-6 py-4 text-left text-sm font-medium text-gray-500 uppercase tracking-wider",children:" (MX$)"}),Q.jsx("th",{className:"px-6 py-4 text-left text-sm font-medium text-gray-500 uppercase tracking-wider",children:""}),Q.jsx("th",{className:"px-6 py-4 text-left text-sm font-medium text-gray-500 uppercase tracking-wider",children:""}),Q.jsx("th",{className:"px-6 py-4 text-left text-sm font-medium text-gray-500 uppercase tracking-wider",children:""})]})}),Q.jsx("tbody",{className:"divide-y divide-gray-200",children:g.map(e=>Q.jsxs("tr",{className:"hover:bg-gray-50",children:[Q.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:e.date}),Q.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:e.staff}),Q.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-red-600 font-semibold",children:["$",e.adSpend.toFixed(2)]}),Q.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-green-600 font-semibold",children:e.creditCardOrders.toFixed(2)}),Q.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-blue-600 font-semibold",children:e.paymentInfoCount}),Q.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-purple-600 font-semibold",children:e.orderCount}),Q.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:Q.jsxs("div",{className:"flex gap-3",children:[Q.jsx("button",{onClick:()=>(e=>{o(e),t(e.date),n(e.staff),c({adSpend:e.adSpend.toString(),creditCardOrders:e.creditCardOrders.toString(),paymentInfoCount:e.paymentInfoCount.toString(),orderCount:e.orderCount.toString()}),s(!0)})(e),className:"text-blue-600 hover:text-blue-800 font-medium",children:""}),Q.jsx("button",{onClick:()=>(async e=>{if(confirm(""))try{await fp.delete(e),await m(),alert("")}catch(t){console.error(":",t),alert("")}})(e.id),className:"text-red-600 hover:text-red-800 font-medium",children:""})]})})]},e.id))})]})}):Q.jsxs("div",{className:"text-center py-12 bg-gray-50 rounded-lg",children:[Q.jsx("svg",{className:"mx-auto h-12 w-12 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:Q.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})}),Q.jsx("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:""}),Q.jsx("p",{className:"mt-1 text-sm text-gray-500",children:""})]})]})]})})},Cj=W.createContext({});function Aj(e){const t=W.useRef(null);return null===t.current&&(t.current=e()),t.current}const Oj="undefined"!=typeof window,Ij=Oj?W.useLayoutEffect:W.useEffect,Rj=W.createContext(null);function Pj(e,t){-1===e.indexOf(t)&&e.push(t)}function Dj(e,t){const r=e.indexOf(t);r>-1&&e.splice(r,1)}const Lj=(e,t,r)=>r>t?t:r<e?e:r;const Mj={},Fj=e=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(e);function Uj(e){return"object"==typeof e&&null!==e}const Bj=e=>/^0[^.\s]+$/u.test(e);function $j(e){let t;return()=>(void 0===t&&(t=e()),t)}const zj=e=>e,Vj=(e,t)=>r=>t(e(r)),Wj=(...e)=>e.reduce(Vj),Hj=(e,t,r)=>{const n=t-e;return 0===n?1:(r-e)/n};class Gj{constructor(){this.subscriptions=[]}add(e){return Pj(this.subscriptions,e),()=>Dj(this.subscriptions,e)}notify(e,t,r){const n=this.subscriptions.length;if(n)if(1===n)this.subscriptions[0](e,t,r);else for(let a=0;a<n;a++){const n=this.subscriptions[a];n&&n(e,t,r)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}const qj=e=>1e3*e,Kj=e=>e/1e3;function Xj(e,t){return t?e*(1e3/t):0}const Yj=(e,t,r)=>(((1-3*r+3*t)*e+(3*r-6*t))*e+3*t)*e;function Jj(e,t,r,n){if(e===t&&r===n)return zj;const a=t=>function(e,t,r,n,a){let s,i,o=0;do{i=t+(r-t)/2,s=Yj(i,n,a)-e,s>0?r=i:t=i}while(Math.abs(s)>1e-7&&++o<12);return i}(t,0,1,e,r);return e=>0===e||1===e?e:Yj(a(e),t,n)}const Zj=e=>t=>t<=.5?e(2*t)/2:(2-e(2*(1-t)))/2,Qj=e=>t=>1-e(1-t),eS=Jj(.33,1.53,.69,.99),tS=Qj(eS),rS=Zj(tS),nS=e=>(e*=2)<1?.5*tS(e):.5*(2-Math.pow(2,-10*(e-1))),aS=e=>1-Math.sin(Math.acos(e)),sS=Qj(aS),iS=Zj(aS),oS=Jj(.42,0,1,1),lS=Jj(0,0,.58,1),cS=Jj(.42,0,.58,1),dS=e=>Array.isArray(e)&&"number"==typeof e[0],uS={linear:zj,easeIn:oS,easeInOut:cS,easeOut:lS,circIn:aS,circInOut:iS,circOut:sS,backIn:tS,backInOut:rS,backOut:eS,anticipate:nS},hS=e=>{if(dS(e)){e.length;const[t,r,n,a]=e;return Jj(t,r,n,a)}return"string"==typeof e?uS[e]:e},fS=["setup","read","resolveKeyframes","preUpdate","update","preRender","render","postRender"];function mS(e,t){let r=!1,n=!0;const a={delta:0,timestamp:0,isProcessing:!1},s=()=>r=!0,i=fS.reduce((e,t)=>(e[t]=function(e){let t=new Set,r=new Set,n=!1,a=!1;const s=new WeakSet;let i={delta:0,timestamp:0,isProcessing:!1};function o(t){s.has(t)&&(l.schedule(t),e()),t(i)}const l={schedule:(e,a=!1,i=!1)=>{const o=i&&n?t:r;return a&&s.add(e),o.has(e)||o.add(e),e},cancel:e=>{r.delete(e),s.delete(e)},process:e=>{i=e,n?a=!0:(n=!0,[t,r]=[r,t],t.forEach(o),t.clear(),n=!1,a&&(a=!1,l.process(e)))}};return l}(s),e),{}),{setup:o,read:l,resolveKeyframes:c,preUpdate:d,update:u,preRender:h,render:f,postRender:m}=i,p=()=>{const s=Mj.useManualTiming?a.timestamp:performance.now();r=!1,Mj.useManualTiming||(a.delta=n?1e3/60:Math.max(Math.min(s-a.timestamp,40),1)),a.timestamp=s,a.isProcessing=!0,o.process(a),l.process(a),c.process(a),d.process(a),u.process(a),h.process(a),f.process(a),m.process(a),a.isProcessing=!1,r&&t&&(n=!1,e(p))};return{schedule:fS.reduce((t,s)=>{const o=i[s];return t[s]=(t,s=!1,i=!1)=>(r||(r=!0,n=!0,a.isProcessing||e(p)),o.schedule(t,s,i)),t},{}),cancel:e=>{for(let t=0;t<fS.length;t++)i[fS[t]].cancel(e)},state:a,steps:i}}const{schedule:pS,cancel:gS,state:xS,steps:vS}=mS("undefined"!=typeof requestAnimationFrame?requestAnimationFrame:zj,!0);let bS;function yS(){bS=void 0}const wS={now:()=>(void 0===bS&&wS.set(xS.isProcessing||Mj.useManualTiming?xS.timestamp:performance.now()),bS),set:e=>{bS=e,queueMicrotask(yS)}},_S=e=>t=>"string"==typeof t&&t.startsWith(e),kS=_S("--"),NS=_S("var(--"),jS=e=>!!NS(e)&&SS.test(e.split("/*")[0].trim()),SS=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,TS={test:e=>"number"==typeof e,parse:parseFloat,transform:e=>e},ES={...TS,transform:e=>Lj(0,1,e)},CS={...TS,default:1},AS=e=>Math.round(1e5*e)/1e5,OS=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;const IS=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,RS=(e,t)=>r=>Boolean("string"==typeof r&&IS.test(r)&&r.startsWith(e)||t&&!function(e){return null==e}(r)&&Object.prototype.hasOwnProperty.call(r,t)),PS=(e,t,r)=>n=>{if("string"!=typeof n)return n;const[a,s,i,o]=n.match(OS);return{[e]:parseFloat(a),[t]:parseFloat(s),[r]:parseFloat(i),alpha:void 0!==o?parseFloat(o):1}},DS={...TS,transform:e=>Math.round((e=>Lj(0,255,e))(e))},LS={test:RS("rgb","red"),parse:PS("red","green","blue"),transform:({red:e,green:t,blue:r,alpha:n=1})=>"rgba("+DS.transform(e)+", "+DS.transform(t)+", "+DS.transform(r)+", "+AS(ES.transform(n))+")"};const MS={test:RS("#"),parse:function(e){let t="",r="",n="",a="";return e.length>5?(t=e.substring(1,3),r=e.substring(3,5),n=e.substring(5,7),a=e.substring(7,9)):(t=e.substring(1,2),r=e.substring(2,3),n=e.substring(3,4),a=e.substring(4,5),t+=t,r+=r,n+=n,a+=a),{red:parseInt(t,16),green:parseInt(r,16),blue:parseInt(n,16),alpha:a?parseInt(a,16)/255:1}},transform:LS.transform},FS=e=>({test:t=>"string"==typeof t&&t.endsWith(e)&&1===t.split(" ").length,parse:parseFloat,transform:t=>`${t}${e}`}),US=FS("deg"),BS=FS("%"),$S=FS("px"),zS=FS("vh"),VS=FS("vw"),WS=(()=>({...BS,parse:e=>BS.parse(e)/100,transform:e=>BS.transform(100*e)}))(),HS={test:RS("hsl","hue"),parse:PS("hue","saturation","lightness"),transform:({hue:e,saturation:t,lightness:r,alpha:n=1})=>"hsla("+Math.round(e)+", "+BS.transform(AS(t))+", "+BS.transform(AS(r))+", "+AS(ES.transform(n))+")"},GS={test:e=>LS.test(e)||MS.test(e)||HS.test(e),parse:e=>LS.test(e)?LS.parse(e):HS.test(e)?HS.parse(e):MS.parse(e),transform:e=>"string"==typeof e?e:e.hasOwnProperty("red")?LS.transform(e):HS.transform(e),getAnimatableNone:e=>{const t=GS.parse(e);return t.alpha=0,GS.transform(t)}},qS=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;const KS="number",XS="color",YS=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function JS(e){const t=e.toString(),r=[],n={color:[],number:[],var:[]},a=[];let s=0;const i=t.replace(YS,e=>(GS.test(e)?(n.color.push(s),a.push(XS),r.push(GS.parse(e))):e.startsWith("var(")?(n.var.push(s),a.push("var"),r.push(e)):(n.number.push(s),a.push(KS),r.push(parseFloat(e))),++s,"${}")).split("${}");return{values:r,split:i,indexes:n,types:a}}function ZS(e){return JS(e).values}function QS(e){const{split:t,types:r}=JS(e),n=t.length;return e=>{let a="";for(let s=0;s<n;s++)if(a+=t[s],void 0!==e[s]){const t=r[s];a+=t===KS?AS(e[s]):t===XS?GS.transform(e[s]):e[s]}return a}}const eT=e=>"number"==typeof e?0:GS.test(e)?GS.getAnimatableNone(e):e;const tT={test:function(e){var t,r;return isNaN(e)&&"string"==typeof e&&((null==(t=e.match(OS))?void 0:t.length)||0)+((null==(r=e.match(qS))?void 0:r.length)||0)>0},parse:ZS,createTransformer:QS,getAnimatableNone:function(e){const t=ZS(e);return QS(e)(t.map(eT))}};function rT(e,t,r){return r<0&&(r+=1),r>1&&(r-=1),r<1/6?e+6*(t-e)*r:r<.5?t:r<2/3?e+(t-e)*(2/3-r)*6:e}function nT(e,t){return r=>r>0?t:e}const aT=(e,t,r)=>e+(t-e)*r,sT=(e,t,r)=>{const n=e*e,a=r*(t*t-n)+n;return a<0?0:Math.sqrt(a)},iT=[MS,LS,HS];function oT(e){const t=(r=e,iT.find(e=>e.test(r)));var r;if(!Boolean(t))return!1;let n=t.parse(e);return t===HS&&(n=function({hue:e,saturation:t,lightness:r,alpha:n}){e/=360,r/=100;let a=0,s=0,i=0;if(t/=100){const n=r<.5?r*(1+t):r+t-r*t,o=2*r-n;a=rT(o,n,e+1/3),s=rT(o,n,e),i=rT(o,n,e-1/3)}else a=s=i=r;return{red:Math.round(255*a),green:Math.round(255*s),blue:Math.round(255*i),alpha:n}}(n)),n}const lT=(e,t)=>{const r=oT(e),n=oT(t);if(!r||!n)return nT(e,t);const a={...r};return e=>(a.red=sT(r.red,n.red,e),a.green=sT(r.green,n.green,e),a.blue=sT(r.blue,n.blue,e),a.alpha=aT(r.alpha,n.alpha,e),LS.transform(a))},cT=new Set(["none","hidden"]);function dT(e,t){return r=>aT(e,t,r)}function uT(e){return"number"==typeof e?dT:"string"==typeof e?jS(e)?nT:GS.test(e)?lT:mT:Array.isArray(e)?hT:"object"==typeof e?GS.test(e)?lT:fT:nT}function hT(e,t){const r=[...e],n=r.length,a=e.map((e,r)=>uT(e)(e,t[r]));return e=>{for(let t=0;t<n;t++)r[t]=a[t](e);return r}}function fT(e,t){const r={...e,...t},n={};for(const a in r)void 0!==e[a]&&void 0!==t[a]&&(n[a]=uT(e[a])(e[a],t[a]));return e=>{for(const t in n)r[t]=n[t](e);return r}}const mT=(e,t)=>{const r=tT.createTransformer(t),n=JS(e),a=JS(t);return n.indexes.var.length===a.indexes.var.length&&n.indexes.color.length===a.indexes.color.length&&n.indexes.number.length>=a.indexes.number.length?cT.has(e)&&!a.values.length||cT.has(t)&&!n.values.length?function(e,t){return cT.has(e)?r=>r<=0?e:t:r=>r>=1?t:e}(e,t):Wj(hT(function(e,t){const r=[],n={color:0,var:0,number:0};for(let a=0;a<t.values.length;a++){const s=t.types[a],i=e.indexes[s][n[s]],o=e.values[i]??0;r[a]=o,n[s]++}return r}(n,a),a.values),r):nT(e,t)};function pT(e,t,r){if("number"==typeof e&&"number"==typeof t&&"number"==typeof r)return aT(e,t,r);return uT(e)(e,t)}const gT=e=>{const t=({timestamp:t})=>e(t);return{start:(e=!0)=>pS.update(t,e),stop:()=>gS(t),now:()=>xS.isProcessing?xS.timestamp:wS.now()}},xT=(e,t,r=10)=>{let n="";const a=Math.max(Math.round(t/r),2);for(let s=0;s<a;s++)n+=Math.round(1e4*e(s/(a-1)))/1e4+", ";return`linear(${n.substring(0,n.length-2)})`},vT=2e4;function bT(e){let t=0;let r=e.next(t);for(;!r.done&&t<vT;)t+=50,r=e.next(t);return t>=vT?1/0:t}function yT(e,t,r){const n=Math.max(t-5,0);return Xj(r-e(n),t-n)}const wT=100,_T=10,kT=1,NT=0,jT=800,ST=.3,TT=.3,ET={granular:.01,default:2},CT={granular:.005,default:.5},AT=.01,OT=10,IT=.05,RT=1,PT=.001;function DT({duration:e=jT,bounce:t=ST,velocity:r=NT,mass:n=kT}){let a,s,i=1-t;i=Lj(IT,RT,i),e=Lj(AT,OT,Kj(e)),i<1?(a=t=>{const n=t*i,a=n*e,s=n-r,o=MT(t,i),l=Math.exp(-a);return PT-s/o*l},s=t=>{const n=t*i*e,s=n*r+r,o=Math.pow(i,2)*Math.pow(t,2)*e,l=Math.exp(-n),c=MT(Math.pow(t,2),i);return(-a(t)+PT>0?-1:1)*((s-o)*l)/c}):(a=t=>Math.exp(-t*e)*((t-r)*e+1)-.001,s=t=>Math.exp(-t*e)*(e*e*(r-t)));const o=function(e,t,r){let n=r;for(let a=1;a<LT;a++)n-=e(n)/t(n);return n}(a,s,5/e);if(e=qj(e),isNaN(o))return{stiffness:wT,damping:_T,duration:e};{const t=Math.pow(o,2)*n;return{stiffness:t,damping:2*i*Math.sqrt(n*t),duration:e}}}const LT=12;function MT(e,t){return e*Math.sqrt(1-t*t)}const FT=["duration","bounce"],UT=["stiffness","damping","mass"];function BT(e,t){return t.some(t=>void 0!==e[t])}function $T(e=TT,t=ST){const r="object"!=typeof e?{visualDuration:e,keyframes:[0,1],bounce:t}:e;let{restSpeed:n,restDelta:a}=r;const s=r.keyframes[0],i=r.keyframes[r.keyframes.length-1],o={done:!1,value:s},{stiffness:l,damping:c,mass:d,duration:u,velocity:h,isResolvedFromDuration:f}=function(e){let t={velocity:NT,stiffness:wT,damping:_T,mass:kT,isResolvedFromDuration:!1,...e};if(!BT(e,UT)&&BT(e,FT))if(e.visualDuration){const r=e.visualDuration,n=2*Math.PI/(1.2*r),a=n*n,s=2*Lj(.05,1,1-(e.bounce||0))*Math.sqrt(a);t={...t,mass:kT,stiffness:a,damping:s}}else{const r=DT(e);t={...t,...r,mass:kT},t.isResolvedFromDuration=!0}return t}({...r,velocity:-Kj(r.velocity||0)}),m=h||0,p=c/(2*Math.sqrt(l*d)),g=i-s,x=Kj(Math.sqrt(l/d)),v=Math.abs(g)<5;let b;if(n||(n=v?ET.granular:ET.default),a||(a=v?CT.granular:CT.default),p<1){const e=MT(x,p);b=t=>{const r=Math.exp(-p*x*t);return i-r*((m+p*x*g)/e*Math.sin(e*t)+g*Math.cos(e*t))}}else if(1===p)b=e=>i-Math.exp(-x*e)*(g+(m+x*g)*e);else{const e=x*Math.sqrt(p*p-1);b=t=>{const r=Math.exp(-p*x*t),n=Math.min(e*t,300);return i-r*((m+p*x*g)*Math.sinh(n)+e*g*Math.cosh(n))/e}}const y={calculatedDuration:f&&u||null,next:e=>{const t=b(e);if(f)o.done=e>=u;else{let r=0===e?m:0;p<1&&(r=0===e?qj(m):yT(b,e,t));const s=Math.abs(r)<=n,l=Math.abs(i-t)<=a;o.done=s&&l}return o.value=o.done?i:t,o},toString:()=>{const e=Math.min(bT(y),vT),t=xT(t=>y.next(e*t).value,e,30);return e+"ms "+t},toTransition:()=>{}};return y}function zT({keyframes:e,velocity:t=0,power:r=.8,timeConstant:n=325,bounceDamping:a=10,bounceStiffness:s=500,modifyTarget:i,min:o,max:l,restDelta:c=.5,restSpeed:d}){const u=e[0],h={done:!1,value:u},f=e=>void 0===o?l:void 0===l||Math.abs(o-e)<Math.abs(l-e)?o:l;let m=r*t;const p=u+m,g=void 0===i?p:i(p);g!==p&&(m=g-u);const x=e=>-m*Math.exp(-e/n),v=e=>g+x(e),b=e=>{const t=x(e),r=v(e);h.done=Math.abs(t)<=c,h.value=h.done?g:r};let y,w;const _=e=>{var t;(t=h.value,void 0!==o&&t<o||void 0!==l&&t>l)&&(y=e,w=$T({keyframes:[h.value,f(h.value)],velocity:yT(v,e,h.value),damping:a,stiffness:s,restDelta:c,restSpeed:d}))};return _(0),{calculatedDuration:null,next:e=>{let t=!1;return w||void 0!==y||(t=!0,b(e),_(e)),void 0!==y&&e>=y?w.next(e-y):(!t&&b(e),h)}}}function VT(e,t,{clamp:r=!0,ease:n,mixer:a}={}){const s=e.length;if(t.length,1===s)return()=>t[0];if(2===s&&t[0]===t[1])return()=>t[1];const i=e[0]===e[1];e[0]>e[s-1]&&(e=[...e].reverse(),t=[...t].reverse());const o=function(e,t,r){const n=[],a=r||Mj.mix||pT,s=e.length-1;for(let i=0;i<s;i++){let r=a(e[i],e[i+1]);if(t){const e=Array.isArray(t)?t[i]||zj:t;r=Wj(e,r)}n.push(r)}return n}(t,n,a),l=o.length,c=r=>{if(i&&r<e[0])return t[0];let n=0;if(l>1)for(;n<e.length-2&&!(r<e[n+1]);n++);const a=Hj(e[n],e[n+1],r);return o[n](a)};return r?t=>c(Lj(e[0],e[s-1],t)):c}function WT(e){const t=[0];return function(e,t){const r=e[e.length-1];for(let n=1;n<=t;n++){const a=Hj(0,t,n);e.push(aT(r,1,a))}}(t,e.length-1),t}function HT({duration:e=300,keyframes:t,times:r,ease:n="easeInOut"}){const a=(e=>Array.isArray(e)&&"number"!=typeof e[0])(n)?n.map(hS):hS(n),s={done:!1,value:t[0]},i=function(e,t){return e.map(e=>e*t)}(r&&r.length===t.length?r:WT(t),e),o=VT(i,t,{ease:Array.isArray(a)?a:(l=t,c=a,l.map(()=>c||cS).splice(0,l.length-1))});var l,c;return{calculatedDuration:e,next:t=>(s.value=o(t),s.done=t>=e,s)}}$T.applyToOptions=e=>{const t=function(e,t=100,r){const n=r({...e,keyframes:[0,t]}),a=Math.min(bT(n),vT);return{type:"keyframes",ease:e=>n.next(a*e).value/t,duration:Kj(a)}}(e,100,$T);return e.ease=t.ease,e.duration=qj(t.duration),e.type="keyframes",e};const GT=e=>null!==e;function qT(e,{repeat:t,repeatType:r="loop"},n,a=1){const s=e.filter(GT),i=a<0||t&&"loop"!==r&&t%2==1?0:s.length-1;return i&&void 0!==n?n:s[i]}const KT={decay:zT,inertia:zT,tween:HT,keyframes:HT,spring:$T};function XT(e){"string"==typeof e.type&&(e.type=KT[e.type])}class YT{constructor(){this.updateFinished()}get finished(){return this._finished}updateFinished(){this._finished=new Promise(e=>{this.resolve=e})}notifyFinished(){this.resolve()}then(e,t){return this.finished.then(e,t)}}const JT=e=>e/100;class ZT extends YT{constructor(e){super(),this.state="idle",this.startTime=null,this.isStopped=!1,this.currentTime=0,this.holdTime=null,this.playbackSpeed=1,this.stop=()=>{var e,t;const{motionValue:r}=this.options;r&&r.updatedAt!==wS.now()&&this.tick(wS.now()),this.isStopped=!0,"idle"!==this.state&&(this.teardown(),null==(t=(e=this.options).onStop)||t.call(e))},this.options=e,this.initAnimation(),this.play(),!1===e.autoplay&&this.pause()}initAnimation(){const{options:e}=this;XT(e);const{type:t=HT,repeat:r=0,repeatDelay:n=0,repeatType:a,velocity:s=0}=e;let{keyframes:i}=e;const o=t||HT;o!==HT&&"number"!=typeof i[0]&&(this.mixKeyframes=Wj(JT,pT(i[0],i[1])),i=[0,100]);const l=o({...e,keyframes:i});"mirror"===a&&(this.mirroredGenerator=o({...e,keyframes:[...i].reverse(),velocity:-s})),null===l.calculatedDuration&&(l.calculatedDuration=bT(l));const{calculatedDuration:c}=l;this.calculatedDuration=c,this.resolvedDuration=c+n,this.totalDuration=this.resolvedDuration*(r+1)-n,this.generator=l}updateTime(e){const t=Math.round(e-this.startTime)*this.playbackSpeed;null!==this.holdTime?this.currentTime=this.holdTime:this.currentTime=t}tick(e,t=!1){const{generator:r,totalDuration:n,mixKeyframes:a,mirroredGenerator:s,resolvedDuration:i,calculatedDuration:o}=this;if(null===this.startTime)return r.next(0);const{delay:l=0,keyframes:c,repeat:d,repeatType:u,repeatDelay:h,type:f,onUpdate:m,finalKeyframe:p}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,e):this.speed<0&&(this.startTime=Math.min(e-n/this.speed,this.startTime)),t?this.currentTime=e:this.updateTime(e);const g=this.currentTime-l*(this.playbackSpeed>=0?1:-1),x=this.playbackSpeed>=0?g<0:g>n;this.currentTime=Math.max(g,0),"finished"===this.state&&null===this.holdTime&&(this.currentTime=n);let v=this.currentTime,b=r;if(d){const e=Math.min(this.currentTime,n)/i;let t=Math.floor(e),r=e%1;!r&&e>=1&&(r=1),1===r&&t--,t=Math.min(t,d+1);Boolean(t%2)&&("reverse"===u?(r=1-r,h&&(r-=h/i)):"mirror"===u&&(b=s)),v=Lj(0,1,r)*i}const y=x?{done:!1,value:c[0]}:b.next(v);a&&(y.value=a(y.value));let{done:w}=y;x||null===o||(w=this.playbackSpeed>=0?this.currentTime>=n:this.currentTime<=0);const _=null===this.holdTime&&("finished"===this.state||"running"===this.state&&w);return _&&f!==zT&&(y.value=qT(c,this.options,p,this.speed)),m&&m(y.value),_&&this.finish(),y}then(e,t){return this.finished.then(e,t)}get duration(){return Kj(this.calculatedDuration)}get time(){return Kj(this.currentTime)}set time(e){var t;e=qj(e),this.currentTime=e,null===this.startTime||null!==this.holdTime||0===this.playbackSpeed?this.holdTime=e:this.driver&&(this.startTime=this.driver.now()-e/this.playbackSpeed),null==(t=this.driver)||t.start(!1)}get speed(){return this.playbackSpeed}set speed(e){this.updateTime(wS.now());const t=this.playbackSpeed!==e;this.playbackSpeed=e,t&&(this.time=Kj(this.currentTime))}play(){var e,t;if(this.isStopped)return;const{driver:r=gT,startTime:n}=this.options;this.driver||(this.driver=r(e=>this.tick(e))),null==(t=(e=this.options).onPlay)||t.call(e);const a=this.driver.now();"finished"===this.state?(this.updateFinished(),this.startTime=a):null!==this.holdTime?this.startTime=a-this.holdTime:this.startTime||(this.startTime=n??a),"finished"===this.state&&this.speed<0&&(this.startTime+=this.calculatedDuration),this.holdTime=null,this.state="running",this.driver.start()}pause(){this.state="paused",this.updateTime(wS.now()),this.holdTime=this.currentTime}complete(){"running"!==this.state&&this.play(),this.state="finished",this.holdTime=null}finish(){var e,t;this.notifyFinished(),this.teardown(),this.state="finished",null==(t=(e=this.options).onComplete)||t.call(e)}cancel(){var e,t;this.holdTime=null,this.startTime=0,this.tick(0),this.teardown(),null==(t=(e=this.options).onCancel)||t.call(e)}teardown(){this.state="idle",this.stopDriver(),this.startTime=this.holdTime=null}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(e){return this.startTime=0,this.tick(e,!0)}attachTimeline(e){var t;return this.options.allowFlatten&&(this.options.type="keyframes",this.options.ease="linear",this.initAnimation()),null==(t=this.driver)||t.stop(),e.observe(this)}}const QT=e=>180*e/Math.PI,eE=e=>{const t=QT(Math.atan2(e[1],e[0]));return rE(t)},tE={x:4,y:5,translateX:4,translateY:5,scaleX:0,scaleY:3,scale:e=>(Math.abs(e[0])+Math.abs(e[3]))/2,rotate:eE,rotateZ:eE,skewX:e=>QT(Math.atan(e[1])),skewY:e=>QT(Math.atan(e[2])),skew:e=>(Math.abs(e[1])+Math.abs(e[2]))/2},rE=e=>((e%=360)<0&&(e+=360),e),nE=e=>Math.sqrt(e[0]*e[0]+e[1]*e[1]),aE=e=>Math.sqrt(e[4]*e[4]+e[5]*e[5]),sE={x:12,y:13,z:14,translateX:12,translateY:13,translateZ:14,scaleX:nE,scaleY:aE,scale:e=>(nE(e)+aE(e))/2,rotateX:e=>rE(QT(Math.atan2(e[6],e[5]))),rotateY:e=>rE(QT(Math.atan2(-e[2],e[0]))),rotateZ:eE,rotate:eE,skewX:e=>QT(Math.atan(e[4])),skewY:e=>QT(Math.atan(e[1])),skew:e=>(Math.abs(e[1])+Math.abs(e[4]))/2};function iE(e){return e.includes("scale")?1:0}function oE(e,t){if(!e||"none"===e)return iE(t);const r=e.match(/^matrix3d\(([-\d.e\s,]+)\)$/u);let n,a;if(r)n=sE,a=r;else{const t=e.match(/^matrix\(([-\d.e\s,]+)\)$/u);n=tE,a=t}if(!a)return iE(t);const s=n[t],i=a[1].split(",").map(lE);return"function"==typeof s?s(i):i[s]}function lE(e){return parseFloat(e.trim())}const cE=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],dE=(()=>new Set(cE))(),uE=e=>e===TS||e===$S,hE=new Set(["x","y","z"]),fE=cE.filter(e=>!hE.has(e));const mE={width:({x:e},{paddingLeft:t="0",paddingRight:r="0"})=>e.max-e.min-parseFloat(t)-parseFloat(r),height:({y:e},{paddingTop:t="0",paddingBottom:r="0"})=>e.max-e.min-parseFloat(t)-parseFloat(r),top:(e,{top:t})=>parseFloat(t),left:(e,{left:t})=>parseFloat(t),bottom:({y:e},{top:t})=>parseFloat(t)+(e.max-e.min),right:({x:e},{left:t})=>parseFloat(t)+(e.max-e.min),x:(e,{transform:t})=>oE(t,"x"),y:(e,{transform:t})=>oE(t,"y")};mE.translateX=mE.x,mE.translateY=mE.y;const pE=new Set;let gE=!1,xE=!1,vE=!1;function bE(){if(xE){const e=Array.from(pE).filter(e=>e.needsMeasurement),t=new Set(e.map(e=>e.element)),r=new Map;t.forEach(e=>{const t=function(e){const t=[];return fE.forEach(r=>{const n=e.getValue(r);void 0!==n&&(t.push([r,n.get()]),n.set(r.startsWith("scale")?1:0))}),t}(e);t.length&&(r.set(e,t),e.render())}),e.forEach(e=>e.measureInitialState()),t.forEach(e=>{e.render();const t=r.get(e);t&&t.forEach(([t,r])=>{var n;null==(n=e.getValue(t))||n.set(r)})}),e.forEach(e=>e.measureEndState()),e.forEach(e=>{void 0!==e.suspendedScrollY&&window.scrollTo(0,e.suspendedScrollY)})}xE=!1,gE=!1,pE.forEach(e=>e.complete(vE)),pE.clear()}function yE(){pE.forEach(e=>{e.readKeyframes(),e.needsMeasurement&&(xE=!0)})}class wE{constructor(e,t,r,n,a,s=!1){this.state="pending",this.isAsync=!1,this.needsMeasurement=!1,this.unresolvedKeyframes=[...e],this.onComplete=t,this.name=r,this.motionValue=n,this.element=a,this.isAsync=s}scheduleResolve(){this.state="scheduled",this.isAsync?(pE.add(this),gE||(gE=!0,pS.read(yE),pS.resolveKeyframes(bE))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:e,name:t,element:r,motionValue:n}=this;if(null===e[0]){const a=null==n?void 0:n.get(),s=e[e.length-1];if(void 0!==a)e[0]=a;else if(r&&t){const n=r.readValue(t,s);null!=n&&(e[0]=n)}void 0===e[0]&&(e[0]=s),n&&void 0===a&&n.set(e[0])}!function(e){for(let t=1;t<e.length;t++)e[t]??(e[t]=e[t-1])}(e)}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(e=!1){this.state="complete",this.onComplete(this.unresolvedKeyframes,this.finalKeyframe,e),pE.delete(this)}cancel(){"scheduled"===this.state&&(pE.delete(this),this.state="pending")}resume(){"pending"===this.state&&this.scheduleResolve()}}const _E=$j(()=>void 0!==window.ScrollTimeline),kE={};function NE(e,t){const r=$j(e);return()=>kE[t]??r()}const jE=NE(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch(e){return!1}return!0},"linearEasing"),SE=([e,t,r,n])=>`cubic-bezier(${e}, ${t}, ${r}, ${n})`,TE={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:SE([0,.65,.55,1]),circOut:SE([.55,0,1,.45]),backIn:SE([.31,.01,.66,-.59]),backOut:SE([.33,1.53,.69,.99])};function EE(e,t){return e?"function"==typeof e?jE()?xT(e,t):"ease-out":dS(e)?SE(e):Array.isArray(e)?e.map(e=>EE(e,t)||TE.easeOut):TE[e]:void 0}function CE(e,t,r,{delay:n=0,duration:a=300,repeat:s=0,repeatType:i="loop",ease:o="easeOut",times:l}={},c=void 0){const d={[t]:r};l&&(d.offset=l);const u=EE(o,a);Array.isArray(u)&&(d.easing=u);const h={delay:n,duration:a,easing:Array.isArray(u)?"linear":u,fill:"both",iterations:s+1,direction:"reverse"===i?"alternate":"normal"};c&&(h.pseudoElement=c);return e.animate(d,h)}function AE(e){return"function"==typeof e&&"applyToOptions"in e}class OE extends YT{constructor(e){if(super(),this.finishedTime=null,this.isStopped=!1,!e)return;const{element:t,name:r,keyframes:n,pseudoElement:a,allowFlatten:s=!1,finalKeyframe:i,onComplete:o}=e;this.isPseudoElement=Boolean(a),this.allowFlatten=s,this.options=e,e.type;const l=function({type:e,...t}){return AE(e)&&jE()?e.applyToOptions(t):(t.duration??(t.duration=300),t.ease??(t.ease="easeOut"),t)}(e);this.animation=CE(t,r,n,l,a),!1===l.autoplay&&this.animation.pause(),this.animation.onfinish=()=>{if(this.finishedTime=this.time,!a){const e=qT(n,this.options,i,this.speed);this.updateMotionValue?this.updateMotionValue(e):function(e,t,r){(e=>e.startsWith("--"))(t)?e.style.setProperty(t,r):e.style[t]=r}(t,r,e),this.animation.cancel()}null==o||o(),this.notifyFinished()}}play(){this.isStopped||(this.animation.play(),"finished"===this.state&&this.updateFinished())}pause(){this.animation.pause()}complete(){var e,t;null==(t=(e=this.animation).finish)||t.call(e)}cancel(){try{this.animation.cancel()}catch(e){}}stop(){if(this.isStopped)return;this.isStopped=!0;const{state:e}=this;"idle"!==e&&"finished"!==e&&(this.updateMotionValue?this.updateMotionValue():this.commitStyles(),this.isPseudoElement||this.cancel())}commitStyles(){var e,t;this.isPseudoElement||null==(t=(e=this.animation).commitStyles)||t.call(e)}get duration(){var e,t;const r=(null==(t=null==(e=this.animation.effect)?void 0:e.getComputedTiming)?void 0:t.call(e).duration)||0;return Kj(Number(r))}get time(){return Kj(Number(this.animation.currentTime)||0)}set time(e){this.finishedTime=null,this.animation.currentTime=qj(e)}get speed(){return this.animation.playbackRate}set speed(e){e<0&&(this.finishedTime=null),this.animation.playbackRate=e}get state(){return null!==this.finishedTime?"finished":this.animation.playState}get startTime(){return Number(this.animation.startTime)}set startTime(e){this.animation.startTime=e}attachTimeline({timeline:e,observe:t}){var r;return this.allowFlatten&&(null==(r=this.animation.effect)||r.updateTiming({easing:"linear"})),this.animation.onfinish=null,e&&_E()?(this.animation.timeline=e,zj):t(this)}}const IE={anticipate:nS,backInOut:rS,circInOut:iS};function RE(e){"string"==typeof e.ease&&e.ease in IE&&(e.ease=IE[e.ease])}class PE extends OE{constructor(e){RE(e),XT(e),super(e),e.startTime&&(this.startTime=e.startTime),this.options=e}updateMotionValue(e){const{motionValue:t,onUpdate:r,onComplete:n,element:a,...s}=this.options;if(!t)return;if(void 0!==e)return void t.set(e);const i=new ZT({...s,autoplay:!1}),o=qj(this.finishedTime??this.time);t.setWithVelocity(i.sample(o-10).value,i.sample(o).value,10),i.stop()}}const DE=(e,t)=>"zIndex"!==t&&(!("number"!=typeof e&&!Array.isArray(e))||!("string"!=typeof e||!tT.test(e)&&"0"!==e||e.startsWith("url(")));function LE(e){e.duration=0,e.type}const ME=new Set(["opacity","clipPath","filter","transform"]),FE=$j(()=>Object.hasOwnProperty.call(Element.prototype,"animate"));class UE extends YT{constructor({autoplay:e=!0,delay:t=0,type:r="keyframes",repeat:n=0,repeatDelay:a=0,repeatType:s="loop",keyframes:i,name:o,motionValue:l,element:c,...d}){var u;super(),this.stop=()=>{var e,t;this._animation&&(this._animation.stop(),null==(e=this.stopTimeline)||e.call(this)),null==(t=this.keyframeResolver)||t.cancel()},this.createdAt=wS.now();const h={autoplay:e,delay:t,type:r,repeat:n,repeatDelay:a,repeatType:s,name:o,motionValue:l,element:c,...d},f=(null==c?void 0:c.KeyframeResolver)||wE;this.keyframeResolver=new f(i,(e,t,r)=>this.onKeyframesResolved(e,t,h,!r),o,l,c),null==(u=this.keyframeResolver)||u.scheduleResolve()}onKeyframesResolved(e,t,r,n){this.keyframeResolver=void 0;const{name:a,type:s,velocity:i,delay:o,isHandoff:l,onUpdate:c}=r;this.resolvedAt=wS.now(),function(e,t,r,n){const a=e[0];if(null===a)return!1;if("display"===t||"visibility"===t)return!0;const s=e[e.length-1],i=DE(a,t),o=DE(s,t);return!(!i||!o)&&(function(e){const t=e[0];if(1===e.length)return!0;for(let r=0;r<e.length;r++)if(e[r]!==t)return!0}(e)||("spring"===r||AE(r))&&n)}(e,a,s,i)||(!Mj.instantAnimations&&o||null==c||c(qT(e,r,t)),e[0]=e[e.length-1],LE(r),r.repeat=0);const d={startTime:n?this.resolvedAt&&this.resolvedAt-this.createdAt>40?this.resolvedAt:this.createdAt:void 0,finalKeyframe:t,...r,keyframes:e},u=!l&&function(e){var t;const{motionValue:r,name:n,repeatDelay:a,repeatType:s,damping:i,type:o}=e;if(!((null==(t=null==r?void 0:r.owner)?void 0:t.current)instanceof HTMLElement))return!1;const{onUpdate:l,transformTemplate:c}=r.owner.getProps();return FE()&&n&&ME.has(n)&&("transform"!==n||!c)&&!l&&!a&&"mirror"!==s&&0!==i&&"inertia"!==o}(d)?new PE({...d,element:d.motionValue.owner.current}):new ZT(d);u.finished.then(()=>this.notifyFinished()).catch(zj),this.pendingTimeline&&(this.stopTimeline=u.attachTimeline(this.pendingTimeline),this.pendingTimeline=void 0),this._animation=u}get finished(){return this._animation?this.animation.finished:this._finished}then(e,t){return this.finished.finally(e).then(()=>{})}get animation(){var e;return this._animation||(null==(e=this.keyframeResolver)||e.resume(),vE=!0,yE(),bE(),vE=!1),this._animation}get duration(){return this.animation.duration}get time(){return this.animation.time}set time(e){this.animation.time=e}get speed(){return this.animation.speed}get state(){return this.animation.state}set speed(e){this.animation.speed=e}get startTime(){return this.animation.startTime}attachTimeline(e){return this._animation?this.stopTimeline=this.animation.attachTimeline(e):this.pendingTimeline=e,()=>this.stop()}play(){this.animation.play()}pause(){this.animation.pause()}complete(){this.animation.complete()}cancel(){var e;this._animation&&this.animation.cancel(),null==(e=this.keyframeResolver)||e.cancel()}}const BE=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function $E(e,t,r=1){const[n,a]=function(e){const t=BE.exec(e);if(!t)return[,];const[,r,n,a]=t;return[`--${r??n}`,a]}(e);if(!n)return;const s=window.getComputedStyle(t).getPropertyValue(n);if(s){const e=s.trim();return Fj(e)?parseFloat(e):e}return jS(a)?$E(a,t,r+1):a}function zE(e,t){return(null==e?void 0:e[t])??(null==e?void 0:e.default)??e}const VE=new Set(["width","height","top","left","right","bottom",...cE]),WE=e=>t=>t.test(e),HE=[TS,$S,BS,US,VS,zS,{test:e=>"auto"===e,parse:e=>e}],GE=e=>HE.find(WE(e));function qE(e){return"number"==typeof e?0===e:null===e||("none"===e||"0"===e||Bj(e))}const KE=new Set(["brightness","contrast","saturate","opacity"]);function XE(e){const[t,r]=e.slice(0,-1).split("(");if("drop-shadow"===t)return e;const[n]=r.match(OS)||[];if(!n)return e;const a=r.replace(n,"");let s=KE.has(t)?1:0;return n!==r&&(s*=100),t+"("+s+a+")"}const YE=/\b([a-z-]*)\(.*?\)/gu,JE={...tT,getAnimatableNone:e=>{const t=e.match(YE);return t?t.map(XE).join(" "):e}},ZE={...TS,transform:Math.round},QE={borderWidth:$S,borderTopWidth:$S,borderRightWidth:$S,borderBottomWidth:$S,borderLeftWidth:$S,borderRadius:$S,radius:$S,borderTopLeftRadius:$S,borderTopRightRadius:$S,borderBottomRightRadius:$S,borderBottomLeftRadius:$S,width:$S,maxWidth:$S,height:$S,maxHeight:$S,top:$S,right:$S,bottom:$S,left:$S,padding:$S,paddingTop:$S,paddingRight:$S,paddingBottom:$S,paddingLeft:$S,margin:$S,marginTop:$S,marginRight:$S,marginBottom:$S,marginLeft:$S,backgroundPositionX:$S,backgroundPositionY:$S,...{rotate:US,rotateX:US,rotateY:US,rotateZ:US,scale:CS,scaleX:CS,scaleY:CS,scaleZ:CS,skew:US,skewX:US,skewY:US,distance:$S,translateX:$S,translateY:$S,translateZ:$S,x:$S,y:$S,z:$S,perspective:$S,transformPerspective:$S,opacity:ES,originX:WS,originY:WS,originZ:$S},zIndex:ZE,fillOpacity:ES,strokeOpacity:ES,numOctaves:ZE},eC={...QE,color:GS,backgroundColor:GS,outlineColor:GS,fill:GS,stroke:GS,borderColor:GS,borderTopColor:GS,borderRightColor:GS,borderBottomColor:GS,borderLeftColor:GS,filter:JE,WebkitFilter:JE},tC=e=>eC[e];function rC(e,t){let r=tC(e);return r!==JE&&(r=tT),r.getAnimatableNone?r.getAnimatableNone(t):void 0}const nC=new Set(["auto","none","0"]);class aC extends wE{constructor(e,t,r,n,a){super(e,t,r,n,a,!0)}readKeyframes(){const{unresolvedKeyframes:e,element:t,name:r}=this;if(!t||!t.current)return;super.readKeyframes();for(let o=0;o<e.length;o++){let r=e[o];if("string"==typeof r&&(r=r.trim(),jS(r))){const n=$E(r,t.current);void 0!==n&&(e[o]=n),o===e.length-1&&(this.finalKeyframe=r)}}if(this.resolveNoneKeyframes(),!VE.has(r)||2!==e.length)return;const[n,a]=e,s=GE(n),i=GE(a);if(s!==i)if(uE(s)&&uE(i))for(let o=0;o<e.length;o++){const t=e[o];"string"==typeof t&&(e[o]=parseFloat(t))}else mE[r]&&(this.needsMeasurement=!0)}resolveNoneKeyframes(){const{unresolvedKeyframes:e,name:t}=this,r=[];for(let n=0;n<e.length;n++)(null===e[n]||qE(e[n]))&&r.push(n);r.length&&function(e,t,r){let n,a=0;for(;a<e.length&&!n;){const t=e[a];"string"==typeof t&&!nC.has(t)&&JS(t).values.length&&(n=e[a]),a++}if(n&&r)for(const s of t)e[s]=rC(r,n)}(e,r,t)}measureInitialState(){const{element:e,unresolvedKeyframes:t,name:r}=this;if(!e||!e.current)return;"height"===r&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=mE[r](e.measureViewportBox(),window.getComputedStyle(e.current)),t[0]=this.measuredOrigin;const n=t[t.length-1];void 0!==n&&e.getValue(r,n).jump(n,!1)}measureEndState(){var e;const{element:t,name:r,unresolvedKeyframes:n}=this;if(!t||!t.current)return;const a=t.getValue(r);a&&a.jump(this.measuredOrigin,!1);const s=n.length-1,i=n[s];n[s]=mE[r](t.measureViewportBox(),window.getComputedStyle(t.current)),null!==i&&void 0===this.finalKeyframe&&(this.finalKeyframe=i),(null==(e=this.removedTransforms)?void 0:e.length)&&this.removedTransforms.forEach(([e,r])=>{t.getValue(e).set(r)}),this.resolveNoneKeyframes()}}const sC=(e,t)=>t&&"number"==typeof e?t.transform(e):e;function iC(e){return Uj(e)&&"offsetHeight"in e}class oC{constructor(e,t={}){this.canTrackVelocity=null,this.events={},this.updateAndNotify=e=>{var t;const r=wS.now();if(this.updatedAt!==r&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(e),this.current!==this.prev&&(null==(t=this.events.change)||t.notify(this.current),this.dependents))for(const n of this.dependents)n.dirty()},this.hasAnimated=!1,this.setCurrent(e),this.owner=t.owner}setCurrent(e){var t;this.current=e,this.updatedAt=wS.now(),null===this.canTrackVelocity&&void 0!==e&&(this.canTrackVelocity=(t=this.current,!isNaN(parseFloat(t))))}setPrevFrameValue(e=this.current){this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt}onChange(e){return this.on("change",e)}on(e,t){this.events[e]||(this.events[e]=new Gj);const r=this.events[e].add(t);return"change"===e?()=>{r(),pS.read(()=>{this.events.change.getSize()||this.stop()})}:r}clearListeners(){for(const e in this.events)this.events[e].clear()}attach(e,t){this.passiveEffect=e,this.stopPassiveEffect=t}set(e){this.passiveEffect?this.passiveEffect(e,this.updateAndNotify):this.updateAndNotify(e)}setWithVelocity(e,t,r){this.set(t),this.prev=void 0,this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt-r}jump(e,t=!0){this.updateAndNotify(e),this.prev=e,this.prevUpdatedAt=this.prevFrameValue=void 0,t&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}dirty(){var e;null==(e=this.events.change)||e.notify(this.current)}addDependent(e){this.dependents||(this.dependents=new Set),this.dependents.add(e)}removeDependent(e){this.dependents&&this.dependents.delete(e)}get(){return this.current}getPrevious(){return this.prev}getVelocity(){const e=wS.now();if(!this.canTrackVelocity||void 0===this.prevFrameValue||e-this.updatedAt>30)return 0;const t=Math.min(this.updatedAt-this.prevUpdatedAt,30);return Xj(parseFloat(this.current)-parseFloat(this.prevFrameValue),t)}start(e){return this.stop(),new Promise(t=>{this.hasAnimated=!0,this.animation=e(t),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){var e,t;null==(e=this.dependents)||e.clear(),null==(t=this.events.destroy)||t.notify(),this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function lC(e,t){return new oC(e,t)}const{schedule:cC}=mS(queueMicrotask,!1),dC={x:!1,y:!1};function uC(){return dC.x||dC.y}function hC(e,t){const r=function(e,t,r){if(e instanceof EventTarget)return[e];if("string"==typeof e){let t=document;const n=(null==r?void 0:r[e])??t.querySelectorAll(e);return n?Array.from(n):[]}return Array.from(e)}(e),n=new AbortController;return[r,{passive:!0,...t,signal:n.signal},()=>n.abort()]}function fC(e){return!("touch"===e.pointerType||uC())}const mC=(e,t)=>!!t&&(e===t||mC(e,t.parentElement)),pC=e=>"mouse"===e.pointerType?"number"!=typeof e.button||e.button<=0:!1!==e.isPrimary,gC=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);const xC=new WeakSet;function vC(e){return t=>{"Enter"===t.key&&e(t)}}function bC(e,t){e.dispatchEvent(new PointerEvent("pointer"+t,{isPrimary:!0,bubbles:!0}))}function yC(e){return pC(e)&&!uC()}function wC(e,t,r={}){const[n,a,s]=hC(e,r),i=e=>{const n=e.currentTarget;if(!yC(e))return;xC.add(n);const s=t(n,e),i=(e,t)=>{window.removeEventListener("pointerup",o),window.removeEventListener("pointercancel",l),xC.has(n)&&xC.delete(n),yC(e)&&"function"==typeof s&&s(e,{success:t})},o=e=>{i(e,n===window||n===document||r.useGlobalTarget||mC(n,e.target))},l=e=>{i(e,!1)};window.addEventListener("pointerup",o,a),window.addEventListener("pointercancel",l,a)};return n.forEach(e=>{var t;(r.useGlobalTarget?window:e).addEventListener("pointerdown",i,a),iC(e)&&(e.addEventListener("focus",e=>((e,t)=>{const r=e.currentTarget;if(!r)return;const n=vC(()=>{if(xC.has(r))return;bC(r,"down");const e=vC(()=>{bC(r,"up")});r.addEventListener("keyup",e,t),r.addEventListener("blur",()=>bC(r,"cancel"),t)});r.addEventListener("keydown",n,t),r.addEventListener("blur",()=>r.removeEventListener("keydown",n),t)})(e,a)),t=e,gC.has(t.tagName)||-1!==t.tabIndex||e.hasAttribute("tabindex")||(e.tabIndex=0))}),s}function _C(e){return Uj(e)&&"ownerSVGElement"in e}const kC=e=>Boolean(e&&e.getVelocity),NC=[...HE,GS,tT],jC=W.createContext({transformPagePoint:e=>e,isStatic:!1,reducedMotion:"never"});class SC extends W.Component{getSnapshotBeforeUpdate(e){const t=this.props.childRef.current;if(t&&e.isPresent&&!this.props.isPresent){const e=t.offsetParent,r=iC(e)&&e.offsetWidth||0,n=this.props.sizeRef.current;n.height=t.offsetHeight||0,n.width=t.offsetWidth||0,n.top=t.offsetTop,n.left=t.offsetLeft,n.right=r-n.width-n.left}return null}componentDidUpdate(){}render(){return this.props.children}}function TC({children:e,isPresent:t,anchorX:r,root:n}){const a=W.useId(),s=W.useRef(null),i=W.useRef({width:0,height:0,top:0,left:0,right:0}),{nonce:o}=W.useContext(jC);return W.useInsertionEffect(()=>{const{width:e,height:l,top:c,left:d,right:u}=i.current;if(t||!s.current||!e||!l)return;const h="left"===r?`left: ${d}`:`right: ${u}`;s.current.dataset.motionPopId=a;const f=document.createElement("style");o&&(f.nonce=o);const m=n??document.head;return m.appendChild(f),f.sheet&&f.sheet.insertRule(`\n          [data-motion-pop-id="${a}"] {\n            position: absolute !important;\n            width: ${e}px !important;\n            height: ${l}px !important;\n            ${h}px !important;\n            top: ${c}px !important;\n          }\n        `),()=>{m.contains(f)&&m.removeChild(f)}},[t]),Q.jsx(SC,{isPresent:t,childRef:s,sizeRef:i,children:W.cloneElement(e,{ref:s})})}const EC=({children:e,initial:t,isPresent:r,onExitComplete:n,custom:a,presenceAffectsLayout:s,mode:i,anchorX:o,root:l})=>{const c=Aj(CC),d=W.useId();let u=!0,h=W.useMemo(()=>(u=!1,{id:d,initial:t,isPresent:r,custom:a,onExitComplete:e=>{c.set(e,!0);for(const t of c.values())if(!t)return;n&&n()},register:e=>(c.set(e,!1),()=>c.delete(e))}),[r,c,n]);return s&&u&&(h={...h}),W.useMemo(()=>{c.forEach((e,t)=>c.set(t,!1))},[r]),W.useEffect(()=>{!r&&!c.size&&n&&n()},[r]),"popLayout"===i&&(e=Q.jsx(TC,{isPresent:r,anchorX:o,root:l,children:e})),Q.jsx(Rj.Provider,{value:h,children:e})};function CC(){return new Map}function AC(e=!0){const t=W.useContext(Rj);if(null===t)return[!0,null];const{isPresent:r,onExitComplete:n,register:a}=t,s=W.useId();W.useEffect(()=>{if(e)return a(s)},[e]);const i=W.useCallback(()=>e&&n&&n(s),[s,n,e]);return!r&&n?[!1,i]:[!0]}const OC=e=>e.key||"";function IC(e){const t=[];return W.Children.forEach(e,e=>{W.isValidElement(e)&&t.push(e)}),t}const RC=({children:e,custom:t,initial:r=!0,onExitComplete:n,presenceAffectsLayout:a=!0,mode:s="sync",propagate:i=!1,anchorX:o="left",root:l})=>{const[c,d]=AC(i),u=W.useMemo(()=>IC(e),[e]),h=i&&!c?[]:u.map(OC),f=W.useRef(!0),m=W.useRef(u),p=Aj(()=>new Map),[g,x]=W.useState(u),[v,b]=W.useState(u);Ij(()=>{f.current=!1,m.current=u;for(let e=0;e<v.length;e++){const t=OC(v[e]);h.includes(t)?p.delete(t):!0!==p.get(t)&&p.set(t,!1)}},[v,h.length,h.join("-")]);const y=[];if(u!==g){let e=[...u];for(let t=0;t<v.length;t++){const r=v[t],n=OC(r);h.includes(n)||(e.splice(t,0,r),y.push(r))}return"wait"===s&&y.length&&(e=y),b(IC(e)),x(u),null}const{forceRender:w}=W.useContext(Cj);return Q.jsx(Q.Fragment,{children:v.map(e=>{const g=OC(e),x=!(i&&!c)&&(u===v||h.includes(g));return Q.jsx(EC,{isPresent:x,initial:!(f.current&&!r)&&void 0,custom:t,presenceAffectsLayout:a,mode:s,root:l,onExitComplete:x?void 0:()=>{if(!p.has(g))return;p.set(g,!0);let e=!0;p.forEach(t=>{t||(e=!1)}),e&&(null==w||w(),b(m.current),i&&(null==d||d()),n&&n())},anchorX:o,children:e},g)})})},PC=W.createContext({strict:!1}),DC={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},LC={};for(const $ in DC)LC[$]={isEnabled:e=>DC[$].some(t=>!!e[t])};const MC=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function FC(e){return e.startsWith("while")||e.startsWith("drag")&&"draggable"!==e||e.startsWith("layout")||e.startsWith("onTap")||e.startsWith("onPan")||e.startsWith("onLayout")||MC.has(e)}let UC=e=>!FC(e);try{"function"==typeof(BC=require("@emotion/is-prop-valid").default)&&(UC=e=>e.startsWith("on")?!FC(e):BC(e))}catch{}var BC;const $C=W.createContext({});function zC(e){return null!==e&&"object"==typeof e&&"function"==typeof e.start}function VC(e){return"string"==typeof e||Array.isArray(e)}const WC=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],HC=["initial",...WC];function GC(e){return zC(e.animate)||HC.some(t=>VC(e[t]))}function qC(e){return Boolean(GC(e)||e.variants)}function KC(e){const{initial:t,animate:r}=function(e,t){if(GC(e)){const{initial:t,animate:r}=e;return{initial:!1===t||VC(t)?t:void 0,animate:VC(r)?r:void 0}}return!1!==e.inherit?t:{}}(e,W.useContext($C));return W.useMemo(()=>({initial:t,animate:r}),[XC(t),XC(r)])}function XC(e){return Array.isArray(e)?e.join(" "):e}const YC={};function JC(e,{layout:t,layoutId:r}){return dE.has(e)||e.startsWith("origin")||(t||void 0!==r)&&(!!YC[e]||"opacity"===e)}const ZC={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},QC=cE.length;function eA(e,t,r){const{style:n,vars:a,transformOrigin:s}=e;let i=!1,o=!1;for(const l in t){const e=t[l];if(dE.has(l))i=!0;else if(kS(l))a[l]=e;else{const t=sC(e,QE[l]);l.startsWith("origin")?(o=!0,s[l]=t):n[l]=t}}if(t.transform||(i||r?n.transform=function(e,t,r){let n="",a=!0;for(let s=0;s<QC;s++){const i=cE[s],o=e[i];if(void 0===o)continue;let l=!0;if(l="number"==typeof o?o===(i.startsWith("scale")?1:0):0===parseFloat(o),!l||r){const e=sC(o,QE[i]);l||(a=!1,n+=`${ZC[i]||i}(${e}) `),r&&(t[i]=e)}}return n=n.trim(),r?n=r(t,a?"":n):a&&(n="none"),n}(t,e.transform,r):n.transform&&(n.transform="none")),o){const{originX:e="50%",originY:t="50%",originZ:r=0}=s;n.transformOrigin=`${e} ${t} ${r}`}}const tA=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function rA(e,t,r){for(const n in t)kC(t[n])||JC(n,r)||(e[n]=t[n])}function nA(e,t){const r={};return rA(r,e.style||{},e),Object.assign(r,function({transformTemplate:e},t){return W.useMemo(()=>{const r={style:{},transform:{},transformOrigin:{},vars:{}};return eA(r,t,e),Object.assign({},r.vars,r.style)},[t])}(e,t)),r}function aA(e,t){const r={},n=nA(e,t);return e.drag&&!1!==e.dragListener&&(r.draggable=!1,n.userSelect=n.WebkitUserSelect=n.WebkitTouchCallout="none",n.touchAction=!0===e.drag?"none":"pan-"+("x"===e.drag?"y":"x")),void 0===e.tabIndex&&(e.onTap||e.onTapStart||e.whileTap)&&(r.tabIndex=0),r.style=n,r}const sA={offset:"stroke-dashoffset",array:"stroke-dasharray"},iA={offset:"strokeDashoffset",array:"strokeDasharray"};function oA(e,{attrX:t,attrY:r,attrScale:n,pathLength:a,pathSpacing:s=1,pathOffset:i=0,...o},l,c,d){if(eA(e,o,c),l)return void(e.style.viewBox&&(e.attrs.viewBox=e.style.viewBox));e.attrs=e.style,e.style={};const{attrs:u,style:h}=e;u.transform&&(h.transform=u.transform,delete u.transform),(h.transform||u.transformOrigin)&&(h.transformOrigin=u.transformOrigin??"50% 50%",delete u.transformOrigin),h.transform&&(h.transformBox=(null==d?void 0:d.transformBox)??"fill-box",delete u.transformBox),void 0!==t&&(u.x=t),void 0!==r&&(u.y=r),void 0!==n&&(u.scale=n),void 0!==a&&function(e,t,r=1,n=0,a=!0){e.pathLength=1;const s=a?sA:iA;e[s.offset]=$S.transform(-n);const i=$S.transform(t),o=$S.transform(r);e[s.array]=`${i} ${o}`}(u,a,s,i,!1)}const lA=()=>({style:{},transform:{},transformOrigin:{},vars:{},attrs:{}}),cA=e=>"string"==typeof e&&"svg"===e.toLowerCase();function dA(e,t,r,n){const a=W.useMemo(()=>{const r={style:{},transform:{},transformOrigin:{},vars:{},attrs:{}};return oA(r,t,cA(n),e.transformTemplate,e.style),{...r.attrs,style:{...r.style}}},[t]);if(e.style){const t={};rA(t,e.style,e),a.style={...t,...a.style}}return a}const uA=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function hA(e){return"string"==typeof e&&!e.includes("-")&&!!(uA.indexOf(e)>-1||/[A-Z]/u.test(e))}function fA(e,t,r,{latestValues:n},a,s=!1){const i=(hA(e)?dA:aA)(t,n,a,e),o=function(e,t,r){const n={};for(const a in e)"values"===a&&"object"==typeof e.values||(UC(a)||!0===r&&FC(a)||!t&&!FC(a)||e.draggable&&a.startsWith("onDrag"))&&(n[a]=e[a]);return n}(t,"string"==typeof e,s),l=e!==W.Fragment?{...o,...i,ref:r}:{},{children:c}=t,d=W.useMemo(()=>kC(c)?c.get():c,[c]);return W.createElement(e,{...l,children:d})}function mA(e){const t=[{},{}];return null==e||e.values.forEach((e,r)=>{t[0][r]=e.get(),t[1][r]=e.getVelocity()}),t}function pA(e,t,r,n){if("function"==typeof t){const[a,s]=mA(n);t=t(void 0!==r?r:e.custom,a,s)}if("string"==typeof t&&(t=e.variants&&e.variants[t]),"function"==typeof t){const[a,s]=mA(n);t=t(void 0!==r?r:e.custom,a,s)}return t}function gA(e){return kC(e)?e.get():e}function xA(e,t,r,n){const a={},s=n(e,{});for(const h in s)a[h]=gA(s[h]);let{initial:i,animate:o}=e;const l=GC(e),c=qC(e);t&&c&&!l&&!1!==e.inherit&&(void 0===i&&(i=t.initial),void 0===o&&(o=t.animate));let d=!!r&&!1===r.initial;d=d||!1===i;const u=d?o:i;if(u&&"boolean"!=typeof u&&!zC(u)){const t=Array.isArray(u)?u:[u];for(let r=0;r<t.length;r++){const n=pA(e,t[r]);if(n){const{transitionEnd:e,transition:t,...r}=n;for(const n in r){let e=r[n];if(Array.isArray(e)){e=e[d?e.length-1:0]}null!==e&&(a[n]=e)}for(const n in e)a[n]=e[n]}}}return a}const vA=e=>(t,r)=>{const n=W.useContext($C),a=W.useContext(Rj),s=()=>function({scrapeMotionValuesFromProps:e,createRenderState:t},r,n,a){return{latestValues:xA(r,n,a,e),renderState:t()}}(e,t,n,a);return r?s():Aj(s)};function bA(e,t,r){var n;const{style:a}=e,s={};for(const i in a)(kC(a[i])||t.style&&kC(t.style[i])||JC(i,e)||void 0!==(null==(n=null==r?void 0:r.getValue(i))?void 0:n.liveStyle))&&(s[i]=a[i]);return s}const yA=vA({scrapeMotionValuesFromProps:bA,createRenderState:tA});function wA(e,t,r){const n=bA(e,t,r);for(const a in e)if(kC(e[a])||kC(t[a])){n[-1!==cE.indexOf(a)?"attr"+a.charAt(0).toUpperCase()+a.substring(1):a]=e[a]}return n}const _A=vA({scrapeMotionValuesFromProps:wA,createRenderState:lA}),kA=Symbol.for("motionComponentSymbol");function NA(e){return e&&"object"==typeof e&&Object.prototype.hasOwnProperty.call(e,"current")}function jA(e,t,r){return W.useCallback(n=>{n&&e.onMount&&e.onMount(n),t&&(n?t.mount(n):t.unmount()),r&&("function"==typeof r?r(n):NA(r)&&(r.current=n))},[t])}const SA=e=>e.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),TA="data-"+SA("framerAppearId"),EA=W.createContext({});function CA(e,t,r,n,a){var s,i;const{visualElement:o}=W.useContext($C),l=W.useContext(PC),c=W.useContext(Rj),d=W.useContext(jC).reducedMotion,u=W.useRef(null);n=n||l.renderer,!u.current&&n&&(u.current=n(e,{visualState:t,parent:o,props:r,presenceContext:c,blockInitialAnimation:!!c&&!1===c.initial,reducedMotionConfig:d}));const h=u.current,f=W.useContext(EA);!h||h.projection||!a||"html"!==h.type&&"svg"!==h.type||function(e,t,r,n){const{layoutId:a,layout:s,drag:i,dragConstraints:o,layoutScroll:l,layoutRoot:c,layoutCrossfade:d}=t;e.projection=new r(e.latestValues,t["data-framer-portal-id"]?void 0:AA(e.parent)),e.projection.setOptions({layoutId:a,layout:s,alwaysMeasureLayout:Boolean(i)||o&&NA(o),visualElement:e,animationType:"string"==typeof s?s:"both",initialPromotionConfig:n,crossfade:d,layoutScroll:l,layoutRoot:c})}(u.current,r,a,f);const m=W.useRef(!1);W.useInsertionEffect(()=>{h&&m.current&&h.update(r,c)});const p=r[TA],g=W.useRef(Boolean(p)&&!(null==(s=window.MotionHandoffIsComplete)?void 0:s.call(window,p))&&(null==(i=window.MotionHasOptimisedAnimation)?void 0:i.call(window,p)));return Ij(()=>{h&&(m.current=!0,window.MotionIsMounted=!0,h.updateFeatures(),h.scheduleRenderMicrotask(),g.current&&h.animationState&&h.animationState.animateChanges())}),W.useEffect(()=>{h&&(!g.current&&h.animationState&&h.animationState.animateChanges(),g.current&&(queueMicrotask(()=>{var e;null==(e=window.MotionHandoffMarkAsComplete)||e.call(window,p)}),g.current=!1),h.enteringChildren=void 0)}),h}function AA(e){if(e)return!1!==e.options.allowProjection?e.projection:AA(e.parent)}function OA(e,{forwardMotionProps:t=!1}={},r,n){r&&function(e){for(const t in e)LC[t]={...LC[t],...e[t]}}(r);const a=hA(e)?_A:yA;function s(r,s){let i;const o={...W.useContext(jC),...r,layoutId:IA(r)},{isStatic:l}=o,c=KC(r),d=a(r,l);if(!l&&Oj){W.useContext(PC).strict;const t=function(e){const{drag:t,layout:r}=LC;if(!t&&!r)return{};const n={...t,...r};return{MeasureLayout:(null==t?void 0:t.isEnabled(e))||(null==r?void 0:r.isEnabled(e))?n.MeasureLayout:void 0,ProjectionNode:n.ProjectionNode}}(o);i=t.MeasureLayout,c.visualElement=CA(e,d,o,n,t.ProjectionNode)}return Q.jsxs($C.Provider,{value:c,children:[i&&c.visualElement?Q.jsx(i,{visualElement:c.visualElement,...o}):null,fA(e,r,jA(d,c.visualElement,s),d,l,t)]})}s.displayName=`motion.${"string"==typeof e?e:`create(${e.displayName??e.name??""})`}`;const i=W.forwardRef(s);return i[kA]=e,i}function IA({layoutId:e}){const t=W.useContext(Cj).id;return t&&void 0!==e?t+"-"+e:e}function RA(e,t){if("undefined"==typeof Proxy)return OA;const r=new Map,n=(r,n)=>OA(r,n,e,t);return new Proxy((e,t)=>n(e,t),{get:(a,s)=>"create"===s?n:(r.has(s)||r.set(s,OA(s,void 0,e,t)),r.get(s))})}function PA({top:e,left:t,right:r,bottom:n}){return{x:{min:t,max:r},y:{min:e,max:n}}}function DA(e){return void 0===e||1===e}function LA({scale:e,scaleX:t,scaleY:r}){return!DA(e)||!DA(t)||!DA(r)}function MA(e){return LA(e)||FA(e)||e.z||e.rotate||e.rotateX||e.rotateY||e.skewX||e.skewY}function FA(e){return UA(e.x)||UA(e.y)}function UA(e){return e&&"0%"!==e}function BA(e,t,r){return r+t*(e-r)}function $A(e,t,r,n,a){return void 0!==a&&(e=BA(e,a,n)),BA(e,r,n)+t}function zA(e,t=0,r=1,n,a){e.min=$A(e.min,t,r,n,a),e.max=$A(e.max,t,r,n,a)}function VA(e,{x:t,y:r}){zA(e.x,t.translate,t.scale,t.originPoint),zA(e.y,r.translate,r.scale,r.originPoint)}const WA=.999999999999,HA=1.0000000000001;function GA(e,t){e.min=e.min+t,e.max=e.max+t}function qA(e,t,r,n,a=.5){zA(e,t,r,aT(e.min,e.max,a),n)}function KA(e,t){qA(e.x,t.x,t.scaleX,t.scale,t.originX),qA(e.y,t.y,t.scaleY,t.scale,t.originY)}function XA(e,t){return PA(function(e,t){if(!t)return e;const r=t({x:e.left,y:e.top}),n=t({x:e.right,y:e.bottom});return{top:r.y,left:r.x,bottom:n.y,right:n.x}}(e.getBoundingClientRect(),t))}const YA=()=>({x:{min:0,max:0},y:{min:0,max:0}}),JA={current:null},ZA={current:!1};const QA=new WeakMap;const eO=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class tO{scrapeMotionValuesFromProps(e,t,r){return{}}constructor({parent:e,props:t,presenceContext:r,reducedMotionConfig:n,blockInitialAnimation:a,visualState:s},i={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=wE,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const e=wS.now();this.renderScheduledAt<e&&(this.renderScheduledAt=e,pS.render(this.render,!1,!0))};const{latestValues:o,renderState:l}=s;this.latestValues=o,this.baseTarget={...o},this.initialValues=t.initial?{...o}:{},this.renderState=l,this.parent=e,this.props=t,this.presenceContext=r,this.depth=e?e.depth+1:0,this.reducedMotionConfig=n,this.options=i,this.blockInitialAnimation=Boolean(a),this.isControllingVariants=GC(t),this.isVariantNode=qC(t),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=Boolean(e&&e.current);const{willChange:c,...d}=this.scrapeMotionValuesFromProps(t,{},this);for(const u in d){const e=d[u];void 0!==o[u]&&kC(e)&&e.set(o[u])}}mount(e){var t;this.current=e,QA.set(e,this),this.projection&&!this.projection.instance&&this.projection.mount(e),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((e,t)=>this.bindToMotionValue(t,e)),ZA.current||function(){if(ZA.current=!0,Oj)if(window.matchMedia){const e=window.matchMedia("(prefers-reduced-motion)"),t=()=>JA.current=e.matches;e.addEventListener("change",t),t()}else JA.current=!1}(),this.shouldReduceMotion="never"!==this.reducedMotionConfig&&("always"===this.reducedMotionConfig||JA.current),null==(t=this.parent)||t.addChild(this),this.update(this.props,this.presenceContext)}unmount(){var e;this.projection&&this.projection.unmount(),gS(this.notifyUpdate),gS(this.render),this.valueSubscriptions.forEach(e=>e()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),null==(e=this.parent)||e.removeChild(this);for(const t in this.events)this.events[t].clear();for(const t in this.features){const e=this.features[t];e&&(e.unmount(),e.isMounted=!1)}this.current=null}addChild(e){this.children.add(e),this.enteringChildren??(this.enteringChildren=new Set),this.enteringChildren.add(e)}removeChild(e){this.children.delete(e),this.enteringChildren&&this.enteringChildren.delete(e)}bindToMotionValue(e,t){this.valueSubscriptions.has(e)&&this.valueSubscriptions.get(e)();const r=dE.has(e);r&&this.onBindTransform&&this.onBindTransform();const n=t.on("change",t=>{this.latestValues[e]=t,this.props.onUpdate&&pS.preRender(this.notifyUpdate),r&&this.projection&&(this.projection.isTransformDirty=!0),this.scheduleRender()});let a;window.MotionCheckAppearSync&&(a=window.MotionCheckAppearSync(this,e,t)),this.valueSubscriptions.set(e,()=>{n(),a&&a(),t.owner&&t.stop()})}sortNodePosition(e){return this.current&&this.sortInstanceNodePosition&&this.type===e.type?this.sortInstanceNodePosition(this.current,e.current):0}updateFeatures(){let e="animation";for(e in LC){const t=LC[e];if(!t)continue;const{isEnabled:r,Feature:n}=t;if(!this.features[e]&&n&&r(this.props)&&(this.features[e]=new n(this)),this.features[e]){const t=this.features[e];t.isMounted?t.update():(t.mount(),t.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):{x:{min:0,max:0},y:{min:0,max:0}}}getStaticValue(e){return this.latestValues[e]}setStaticValue(e,t){this.latestValues[e]=t}update(e,t){(e.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=e,this.prevPresenceContext=this.presenceContext,this.presenceContext=t;for(let r=0;r<eO.length;r++){const t=eO[r];this.propEventSubscriptions[t]&&(this.propEventSubscriptions[t](),delete this.propEventSubscriptions[t]);const n=e["on"+t];n&&(this.propEventSubscriptions[t]=this.on(t,n))}this.prevMotionValues=function(e,t,r){for(const n in t){const a=t[n],s=r[n];if(kC(a))e.addValue(n,a);else if(kC(s))e.addValue(n,lC(a,{owner:e}));else if(s!==a)if(e.hasValue(n)){const t=e.getValue(n);!0===t.liveStyle?t.jump(a):t.hasAnimated||t.set(a)}else{const t=e.getStaticValue(n);e.addValue(n,lC(void 0!==t?t:a,{owner:e}))}}for(const n in r)void 0===t[n]&&e.removeValue(n);return t}(this,this.scrapeMotionValuesFromProps(e,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(e){return this.props.variants?this.props.variants[e]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(e){const t=this.getClosestVariantNode();if(t)return t.variantChildren&&t.variantChildren.add(e),()=>t.variantChildren.delete(e)}addValue(e,t){const r=this.values.get(e);t!==r&&(r&&this.removeValue(e),this.bindToMotionValue(e,t),this.values.set(e,t),this.latestValues[e]=t.get())}removeValue(e){this.values.delete(e);const t=this.valueSubscriptions.get(e);t&&(t(),this.valueSubscriptions.delete(e)),delete this.latestValues[e],this.removeValueFromRenderState(e,this.renderState)}hasValue(e){return this.values.has(e)}getValue(e,t){if(this.props.values&&this.props.values[e])return this.props.values[e];let r=this.values.get(e);return void 0===r&&void 0!==t&&(r=lC(null===t?void 0:t,{owner:this}),this.addValue(e,r)),r}readValue(e,t){let r=void 0===this.latestValues[e]&&this.current?this.getBaseTargetFromProps(this.props,e)??this.readValueFromInstance(this.current,e,this.options):this.latestValues[e];var n;return null!=r&&("string"==typeof r&&(Fj(r)||Bj(r))?r=parseFloat(r):(n=r,!NC.find(WE(n))&&tT.test(t)&&(r=rC(e,t))),this.setBaseTarget(e,kC(r)?r.get():r)),kC(r)?r.get():r}setBaseTarget(e,t){this.baseTarget[e]=t}getBaseTarget(e){var t;const{initial:r}=this.props;let n;if("string"==typeof r||"object"==typeof r){const a=pA(this.props,r,null==(t=this.presenceContext)?void 0:t.custom);a&&(n=a[e])}if(r&&void 0!==n)return n;const a=this.getBaseTargetFromProps(this.props,e);return void 0===a||kC(a)?void 0!==this.initialValues[e]&&void 0===n?void 0:this.baseTarget[e]:a}on(e,t){return this.events[e]||(this.events[e]=new Gj),this.events[e].add(t)}notify(e,...t){this.events[e]&&this.events[e].notify(...t)}scheduleRenderMicrotask(){cC.render(this.render)}}class rO extends tO{constructor(){super(...arguments),this.KeyframeResolver=aC}sortInstanceNodePosition(e,t){return 2&e.compareDocumentPosition(t)?1:-1}getBaseTargetFromProps(e,t){return e.style?e.style[t]:void 0}removeValueFromRenderState(e,{vars:t,style:r}){delete t[e],delete r[e]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:e}=this.props;kC(e)&&(this.childSubscription=e.on("change",e=>{this.current&&(this.current.textContent=`${e}`)}))}}function nO(e,{style:t,vars:r},n,a){const s=e.style;let i;for(i in t)s[i]=t[i];for(i in null==a||a.applyProjectionStyles(s,n),r)s.setProperty(i,r[i])}class aO extends rO{constructor(){super(...arguments),this.type="html",this.renderInstance=nO}readValueFromInstance(e,t){var r,n;if(dE.has(t))return(null==(r=this.projection)?void 0:r.isProjecting)?iE(t):((e,t)=>{const{transform:r="none"}=getComputedStyle(e);return oE(r,t)})(e,t);{const r=(n=e,window.getComputedStyle(n)),a=(kS(t)?r.getPropertyValue(t):r[t])||0;return"string"==typeof a?a.trim():a}}measureInstanceViewportBox(e,{transformPagePoint:t}){return XA(e,t)}build(e,t,r){eA(e,t,r.transformTemplate)}scrapeMotionValuesFromProps(e,t,r){return bA(e,t,r)}}const sO=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);class iO extends rO{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=YA}getBaseTargetFromProps(e,t){return e[t]}readValueFromInstance(e,t){if(dE.has(t)){const e=tC(t);return e&&e.default||0}return t=sO.has(t)?t:SA(t),e.getAttribute(t)}scrapeMotionValuesFromProps(e,t,r){return wA(e,t,r)}build(e,t,r){oA(e,t,this.isSVGTag,r.transformTemplate,r.style)}renderInstance(e,t,r,n){!function(e,t,r,n){nO(e,t,void 0,n);for(const a in t.attrs)e.setAttribute(sO.has(a)?a:SA(a),t.attrs[a])}(e,t,0,n)}mount(e){this.isSVGTag=cA(e.tagName),super.mount(e)}}const oO=(e,t)=>hA(e)?new iO(t):new aO(t,{allowProjection:e!==W.Fragment});function lO(e,t,r){const n=e.getProps();return pA(n,t,void 0!==r?r:n.custom,e)}const cO=e=>Array.isArray(e);function dO(e,t,r){e.hasValue(t)?e.getValue(t).set(r):e.addValue(t,lC(r))}function uO(e){return cO(e)?e[e.length-1]||0:e}function hO(e,t){const r=e.getValue("willChange");if(n=r,Boolean(kC(n)&&n.add))return r.add(t);if(!r&&Mj.WillChange){const r=new Mj.WillChange("auto");e.addValue("willChange",r),r.add(t)}var n}function fO(e){return e.props[TA]}const mO=e=>null!==e;const pO={type:"spring",stiffness:500,damping:25,restSpeed:10},gO={type:"keyframes",duration:.8},xO={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},vO=(e,{keyframes:t})=>t.length>2?gO:dE.has(e)?e.startsWith("scale")?{type:"spring",stiffness:550,damping:0===t[1]?2*Math.sqrt(550):30,restSpeed:10}:pO:xO;const bO=(e,t,r,n={},a,s)=>i=>{const o=zE(n,e)||{},l=o.delay||n.delay||0;let{elapsed:c=0}=n;c-=qj(l);const d={keyframes:Array.isArray(r)?r:[null,r],ease:"easeOut",velocity:t.getVelocity(),...o,delay:-c,onUpdate:e=>{t.set(e),o.onUpdate&&o.onUpdate(e)},onComplete:()=>{i(),o.onComplete&&o.onComplete()},name:e,motionValue:t,element:s?void 0:a};(function({when:e,delay:t,delayChildren:r,staggerChildren:n,staggerDirection:a,repeat:s,repeatType:i,repeatDelay:o,from:l,elapsed:c,...d}){return!!Object.keys(d).length})(o)||Object.assign(d,vO(e,d)),d.duration&&(d.duration=qj(d.duration)),d.repeatDelay&&(d.repeatDelay=qj(d.repeatDelay)),void 0!==d.from&&(d.keyframes[0]=d.from);let u=!1;if((!1===d.type||0===d.duration&&!d.repeatDelay)&&(LE(d),0===d.delay&&(u=!0)),(Mj.instantAnimations||Mj.skipAnimations)&&(u=!0,LE(d),d.delay=0),d.allowFlatten=!o.type&&!o.ease,u&&!s&&void 0!==t.get()){const e=function(e,{repeat:t,repeatType:r="loop"}){const n=e.filter(mO);return n[t&&"loop"!==r&&t%2==1?0:n.length-1]}(d.keyframes,o);if(void 0!==e)return void pS.update(()=>{d.onUpdate(e),d.onComplete()})}return o.isSync?new ZT(d):new UE(d)};function yO({protectedKeys:e,needsAnimating:t},r){const n=e.hasOwnProperty(r)&&!0!==t[r];return t[r]=!1,n}function wO(e,t,{delay:r=0,transitionOverride:n,type:a}={}){let{transition:s=e.getDefaultTransition(),transitionEnd:i,...o}=t;n&&(s=n);const l=[],c=a&&e.animationState&&e.animationState.getState()[a];for(const d in o){const t=e.getValue(d,e.latestValues[d]??null),n=o[d];if(void 0===n||c&&yO(c,d))continue;const a={delay:r,...zE(s||{},d)},i=t.get();if(void 0!==i&&!t.isAnimating&&!Array.isArray(n)&&n===i&&!a.velocity)continue;let u=!1;if(window.MotionHandoffAnimation){const t=fO(e);if(t){const e=window.MotionHandoffAnimation(t,d,pS);null!==e&&(a.startTime=e,u=!0)}}hO(e,d),t.start(bO(d,t,n,e.shouldReduceMotion&&VE.has(d)?{type:!1}:a,e,u));const h=t.animation;h&&l.push(h)}return i&&Promise.all(l).then(()=>{pS.update(()=>{i&&function(e,t){const r=lO(e,t);let{transitionEnd:n={},transition:a={},...s}=r||{};s={...s,...n};for(const i in s)dO(e,i,uO(s[i]))}(e,i)})}),l}function _O(e,t,r,n=0,a=1){const s=Array.from(e).sort((e,t)=>e.sortNodePosition(t)).indexOf(t),i=e.size,o=(i-1)*n;return"function"==typeof r?r(s,i):1===a?s*n:o-s*n}function kO(e,t,r={}){var n;const a=lO(e,t,"exit"===r.type?null==(n=e.presenceContext)?void 0:n.custom:void 0);let{transition:s=e.getDefaultTransition()||{}}=a||{};r.transitionOverride&&(s=r.transitionOverride);const i=a?()=>Promise.all(wO(e,a,r)):()=>Promise.resolve(),o=e.variantChildren&&e.variantChildren.size?(n=0)=>{const{delayChildren:a=0,staggerChildren:i,staggerDirection:o}=s;return function(e,t,r=0,n=0,a=0,s=1,i){const o=[];for(const l of e.variantChildren)l.notify("AnimationStart",t),o.push(kO(l,t,{...i,delay:r+("function"==typeof n?0:n)+_O(e.variantChildren,l,n,a,s)}).then(()=>l.notify("AnimationComplete",t)));return Promise.all(o)}(e,t,n,a,i,o,r)}:()=>Promise.resolve(),{when:l}=s;if(l){const[e,t]="beforeChildren"===l?[i,o]:[o,i];return e().then(()=>t())}return Promise.all([i(),o(r.delay)])}function NO(e,t){if(!Array.isArray(t))return!1;const r=t.length;if(r!==e.length)return!1;for(let n=0;n<r;n++)if(t[n]!==e[n])return!1;return!0}const jO=HC.length;function SO(e){if(!e)return;if(!e.isControllingVariants){const t=e.parent&&SO(e.parent)||{};return void 0!==e.props.initial&&(t.initial=e.props.initial),t}const t={};for(let r=0;r<jO;r++){const n=HC[r],a=e.props[n];(VC(a)||!1===a)&&(t[n]=a)}return t}const TO=[...WC].reverse(),EO=WC.length;function CO(e){return t=>Promise.all(t.map(({animation:t,options:r})=>function(e,t,r={}){let n;if(e.notify("AnimationStart",t),Array.isArray(t)){const a=t.map(t=>kO(e,t,r));n=Promise.all(a)}else if("string"==typeof t)n=kO(e,t,r);else{const a="function"==typeof t?lO(e,t,r.custom):t;n=Promise.all(wO(e,a,r))}return n.then(()=>{e.notify("AnimationComplete",t)})}(e,t,r)))}function AO(e){let t=CO(e),r=RO(),n=!0;const a=t=>(r,n)=>{var a;const s=lO(e,n,"exit"===t?null==(a=e.presenceContext)?void 0:a.custom:void 0);if(s){const{transition:e,transitionEnd:t,...n}=s;r={...r,...n,...t}}return r};function s(s){const{props:i}=e,o=SO(e.parent)||{},l=[],c=new Set;let d={},u=1/0;for(let t=0;t<EO;t++){const h=TO[t],f=r[h],m=void 0!==i[h]?i[h]:o[h],p=VC(m),g=h===s?f.isActive:null;!1===g&&(u=t);let x=m===o[h]&&m!==i[h]&&p;if(x&&n&&e.manuallyAnimateOnMount&&(x=!1),f.protectedKeys={...d},!f.isActive&&null===g||!m&&!f.prevProp||zC(m)||"boolean"==typeof m)continue;const v=OO(f.prevProp,m);let b=v||h===s&&f.isActive&&!x&&p||t>u&&p,y=!1;const w=Array.isArray(m)?m:[m];let _=w.reduce(a(h),{});!1===g&&(_={});const{prevResolvedValues:k={}}=f,N={...k,..._},j=t=>{b=!0,c.has(t)&&(y=!0,c.delete(t)),f.needsAnimating[t]=!0;const r=e.getValue(t);r&&(r.liveStyle=!1)};for(const e in N){const t=_[e],r=k[e];if(d.hasOwnProperty(e))continue;let n=!1;n=cO(t)&&cO(r)?!NO(t,r):t!==r,n?null!=t?j(e):c.add(e):void 0!==t&&c.has(e)?j(e):f.protectedKeys[e]=!0}f.prevProp=m,f.prevResolvedValues=_,f.isActive&&(d={...d,..._}),n&&e.blockInitialAnimation&&(b=!1);const S=x&&v;b&&(!S||y)&&l.push(...w.map(t=>{const r={type:h};if("string"==typeof t&&n&&!S&&e.manuallyAnimateOnMount&&e.parent){const{parent:n}=e,a=lO(n,t);if(n.enteringChildren&&a){const{delayChildren:t}=a.transition||{};r.delay=_O(n.enteringChildren,e,t)}}return{animation:t,options:r}}))}if(c.size){const t={};if("boolean"!=typeof i.initial){const r=lO(e,Array.isArray(i.initial)?i.initial[0]:i.initial);r&&r.transition&&(t.transition=r.transition)}c.forEach(r=>{const n=e.getBaseTarget(r),a=e.getValue(r);a&&(a.liveStyle=!0),t[r]=n??null}),l.push({animation:t})}let h=Boolean(l.length);return!n||!1!==i.initial&&i.initial!==i.animate||e.manuallyAnimateOnMount||(h=!1),n=!1,h?t(l):Promise.resolve()}return{animateChanges:s,setActive:function(t,n){var a;if(r[t].isActive===n)return Promise.resolve();null==(a=e.variantChildren)||a.forEach(e=>{var r;return null==(r=e.animationState)?void 0:r.setActive(t,n)}),r[t].isActive=n;const i=s(t);for(const e in r)r[e].protectedKeys={};return i},setAnimateFunction:function(r){t=r(e)},getState:()=>r,reset:()=>{r=RO(),n=!0}}}function OO(e,t){return"string"==typeof t?t!==e:!!Array.isArray(t)&&!NO(t,e)}function IO(e=!1){return{isActive:e,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function RO(){return{animate:IO(!0),whileInView:IO(),whileHover:IO(),whileTap:IO(),whileDrag:IO(),whileFocus:IO(),exit:IO()}}class PO{constructor(e){this.isMounted=!1,this.node=e}update(){}}let DO=0;const LO={animation:{Feature:class extends PO{constructor(e){super(e),e.animationState||(e.animationState=AO(e))}updateAnimationControlsSubscription(){const{animate:e}=this.node.getProps();zC(e)&&(this.unmountControls=e.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:e}=this.node.getProps(),{animate:t}=this.node.prevProps||{};e!==t&&this.updateAnimationControlsSubscription()}unmount(){var e;this.node.animationState.reset(),null==(e=this.unmountControls)||e.call(this)}}},exit:{Feature:class extends PO{constructor(){super(...arguments),this.id=DO++}update(){if(!this.node.presenceContext)return;const{isPresent:e,onExitComplete:t}=this.node.presenceContext,{isPresent:r}=this.node.prevPresenceContext||{};if(!this.node.animationState||e===r)return;const n=this.node.animationState.setActive("exit",!e);t&&!e&&n.then(()=>{t(this.id)})}mount(){const{register:e,onExitComplete:t}=this.node.presenceContext||{};t&&t(this.id),e&&(this.unmount=e(this.id))}unmount(){}}}};function MO(e,t,r,n={passive:!0}){return e.addEventListener(t,r,n),()=>e.removeEventListener(t,r)}function FO(e){return{point:{x:e.pageX,y:e.pageY}}}function UO(e,t,r,n){return MO(e,t,(e=>t=>pC(t)&&e(t,FO(t)))(r),n)}function BO(e){return e.max-e.min}function $O(e,t,r,n=.5){e.origin=n,e.originPoint=aT(t.min,t.max,e.origin),e.scale=BO(r)/BO(t),e.translate=aT(r.min,r.max,e.origin)-e.originPoint,(e.scale>=.9999&&e.scale<=1.0001||isNaN(e.scale))&&(e.scale=1),(e.translate>=-.01&&e.translate<=.01||isNaN(e.translate))&&(e.translate=0)}function zO(e,t,r,n){$O(e.x,t.x,r.x,n?n.originX:void 0),$O(e.y,t.y,r.y,n?n.originY:void 0)}function VO(e,t,r){e.min=r.min+t.min,e.max=e.min+BO(t)}function WO(e,t,r){e.min=t.min-r.min,e.max=e.min+BO(t)}function HO(e,t,r){WO(e.x,t.x,r.x),WO(e.y,t.y,r.y)}function GO(e){return[e("x"),e("y")]}const qO=({current:e})=>e?e.ownerDocument.defaultView:null,KO=(e,t)=>Math.abs(e-t);class XO{constructor(e,t,{transformPagePoint:r,contextWindow:n=window,dragSnapToOrigin:a=!1,distanceThreshold:s=3}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!this.lastMoveEvent||!this.lastMoveEventInfo)return;const e=ZO(this.lastMoveEventInfo,this.history),t=null!==this.startEvent,r=function(e,t){const r=KO(e.x,t.x),n=KO(e.y,t.y);return Math.sqrt(r**2+n**2)}(e.offset,{x:0,y:0})>=this.distanceThreshold;if(!t&&!r)return;const{point:n}=e,{timestamp:a}=xS;this.history.push({...n,timestamp:a});const{onStart:s,onMove:i}=this.handlers;t||(s&&s(this.lastMoveEvent,e),this.startEvent=this.lastMoveEvent),i&&i(this.lastMoveEvent,e)},this.handlePointerMove=(e,t)=>{this.lastMoveEvent=e,this.lastMoveEventInfo=YO(t,this.transformPagePoint),pS.update(this.updatePoint,!0)},this.handlePointerUp=(e,t)=>{this.end();const{onEnd:r,onSessionEnd:n,resumeAnimation:a}=this.handlers;if(this.dragSnapToOrigin&&a&&a(),!this.lastMoveEvent||!this.lastMoveEventInfo)return;const s=ZO("pointercancel"===e.type?this.lastMoveEventInfo:YO(t,this.transformPagePoint),this.history);this.startEvent&&r&&r(e,s),n&&n(e,s)},!pC(e))return;this.dragSnapToOrigin=a,this.handlers=t,this.transformPagePoint=r,this.distanceThreshold=s,this.contextWindow=n||window;const i=YO(FO(e),this.transformPagePoint),{point:o}=i,{timestamp:l}=xS;this.history=[{...o,timestamp:l}];const{onSessionStart:c}=t;c&&c(e,ZO(i,this.history)),this.removeListeners=Wj(UO(this.contextWindow,"pointermove",this.handlePointerMove),UO(this.contextWindow,"pointerup",this.handlePointerUp),UO(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(e){this.handlers=e}end(){this.removeListeners&&this.removeListeners(),gS(this.updatePoint)}}function YO(e,t){return t?{point:t(e.point)}:e}function JO(e,t){return{x:e.x-t.x,y:e.y-t.y}}function ZO({point:e},t){return{point:e,delta:JO(e,eI(t)),offset:JO(e,QO(t)),velocity:tI(t,.1)}}function QO(e){return e[0]}function eI(e){return e[e.length-1]}function tI(e,t){if(e.length<2)return{x:0,y:0};let r=e.length-1,n=null;const a=eI(e);for(;r>=0&&(n=e[r],!(a.timestamp-n.timestamp>qj(t)));)r--;if(!n)return{x:0,y:0};const s=Kj(a.timestamp-n.timestamp);if(0===s)return{x:0,y:0};const i={x:(a.x-n.x)/s,y:(a.y-n.y)/s};return i.x===1/0&&(i.x=0),i.y===1/0&&(i.y=0),i}function rI(e,t,r){return{min:void 0!==t?e.min+t:void 0,max:void 0!==r?e.max+r-(e.max-e.min):void 0}}function nI(e,t){let r=t.min-e.min,n=t.max-e.max;return t.max-t.min<e.max-e.min&&([r,n]=[n,r]),{min:r,max:n}}const aI=.35;function sI(e,t,r){return{min:iI(e,t),max:iI(e,r)}}function iI(e,t){return"number"==typeof e?e:e[t]||0}const oI=new WeakMap;class lI{constructor(e){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic={x:{min:0,max:0},y:{min:0,max:0}},this.latestPointerEvent=null,this.latestPanInfo=null,this.visualElement=e}start(e,{snapToCursor:t=!1,distanceThreshold:r}={}){const{presenceContext:n}=this.visualElement;if(n&&!1===n.isPresent)return;const{dragSnapToOrigin:a}=this.getProps();this.panSession=new XO(e,{onSessionStart:e=>{const{dragSnapToOrigin:r}=this.getProps();r?this.pauseAnimation():this.stopAnimation(),t&&this.snapToCursor(FO(e).point)},onStart:(e,t)=>{const{drag:r,dragPropagation:n,onDragStart:a}=this.getProps();if(r&&!n&&(this.openDragLock&&this.openDragLock(),this.openDragLock="x"===(s=r)||"y"===s?dC[s]?null:(dC[s]=!0,()=>{dC[s]=!1}):dC.x||dC.y?null:(dC.x=dC.y=!0,()=>{dC.x=dC.y=!1}),!this.openDragLock))return;var s;this.latestPointerEvent=e,this.latestPanInfo=t,this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),GO(e=>{let t=this.getAxisMotionValue(e).get()||0;if(BS.test(t)){const{projection:r}=this.visualElement;if(r&&r.layout){const n=r.layout.layoutBox[e];if(n){t=BO(n)*(parseFloat(t)/100)}}}this.originPoint[e]=t}),a&&pS.postRender(()=>a(e,t)),hO(this.visualElement,"transform");const{animationState:i}=this.visualElement;i&&i.setActive("whileDrag",!0)},onMove:(e,t)=>{this.latestPointerEvent=e,this.latestPanInfo=t;const{dragPropagation:r,dragDirectionLock:n,onDirectionLock:a,onDrag:s}=this.getProps();if(!r&&!this.openDragLock)return;const{offset:i}=t;if(n&&null===this.currentDirection)return this.currentDirection=function(e,t=10){let r=null;Math.abs(e.y)>t?r="y":Math.abs(e.x)>t&&(r="x");return r}(i),void(null!==this.currentDirection&&a&&a(this.currentDirection));this.updateAxis("x",t.point,i),this.updateAxis("y",t.point,i),this.visualElement.render(),s&&s(e,t)},onSessionEnd:(e,t)=>{this.latestPointerEvent=e,this.latestPanInfo=t,this.stop(e,t),this.latestPointerEvent=null,this.latestPanInfo=null},resumeAnimation:()=>GO(e=>{var t;return"paused"===this.getAnimationState(e)&&(null==(t=this.getAxisMotionValue(e).animation)?void 0:t.play())})},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:a,distanceThreshold:r,contextWindow:qO(this.visualElement)})}stop(e,t){const r=e||this.latestPointerEvent,n=t||this.latestPanInfo,a=this.isDragging;if(this.cancel(),!a||!n||!r)return;const{velocity:s}=n;this.startAnimation(s);const{onDragEnd:i}=this.getProps();i&&pS.postRender(()=>i(r,n))}cancel(){this.isDragging=!1;const{projection:e,animationState:t}=this.visualElement;e&&(e.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:r}=this.getProps();!r&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),t&&t.setActive("whileDrag",!1)}updateAxis(e,t,r){const{drag:n}=this.getProps();if(!r||!cI(e,n,this.currentDirection))return;const a=this.getAxisMotionValue(e);let s=this.originPoint[e]+r[e];this.constraints&&this.constraints[e]&&(s=function(e,{min:t,max:r},n){return void 0!==t&&e<t?e=n?aT(t,e,n.min):Math.max(e,t):void 0!==r&&e>r&&(e=n?aT(r,e,n.max):Math.min(e,r)),e}(s,this.constraints[e],this.elastic[e])),a.set(s)}resolveConstraints(){var e;const{dragConstraints:t,dragElastic:r}=this.getProps(),n=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):null==(e=this.visualElement.projection)?void 0:e.layout,a=this.constraints;t&&NA(t)?this.constraints||(this.constraints=this.resolveRefConstraints()):this.constraints=!(!t||!n)&&function(e,{top:t,left:r,bottom:n,right:a}){return{x:rI(e.x,r,a),y:rI(e.y,t,n)}}(n.layoutBox,t),this.elastic=function(e=aI){return!1===e?e=0:!0===e&&(e=aI),{x:sI(e,"left","right"),y:sI(e,"top","bottom")}}(r),a!==this.constraints&&n&&this.constraints&&!this.hasMutatedConstraints&&GO(e=>{!1!==this.constraints&&this.getAxisMotionValue(e)&&(this.constraints[e]=function(e,t){const r={};return void 0!==t.min&&(r.min=t.min-e.min),void 0!==t.max&&(r.max=t.max-e.min),r}(n.layoutBox[e],this.constraints[e]))})}resolveRefConstraints(){const{dragConstraints:e,onMeasureDragConstraints:t}=this.getProps();if(!e||!NA(e))return!1;const r=e.current,{projection:n}=this.visualElement;if(!n||!n.layout)return!1;const a=function(e,t,r){const n=XA(e,r),{scroll:a}=t;return a&&(GA(n.x,a.offset.x),GA(n.y,a.offset.y)),n}(r,n.root,this.visualElement.getTransformPagePoint());let s=function(e,t){return{x:nI(e.x,t.x),y:nI(e.y,t.y)}}(n.layout.layoutBox,a);if(t){const e=t(function({x:e,y:t}){return{top:t.min,right:e.max,bottom:t.max,left:e.min}}(s));this.hasMutatedConstraints=!!e,e&&(s=PA(e))}return s}startAnimation(e){const{drag:t,dragMomentum:r,dragElastic:n,dragTransition:a,dragSnapToOrigin:s,onDragTransitionEnd:i}=this.getProps(),o=this.constraints||{},l=GO(i=>{if(!cI(i,t,this.currentDirection))return;let l=o&&o[i]||{};s&&(l={min:0,max:0});const c=n?200:1e6,d=n?40:1e7,u={type:"inertia",velocity:r?e[i]:0,bounceStiffness:c,bounceDamping:d,timeConstant:750,restDelta:1,restSpeed:10,...a,...l};return this.startAxisValueAnimation(i,u)});return Promise.all(l).then(i)}startAxisValueAnimation(e,t){const r=this.getAxisMotionValue(e);return hO(this.visualElement,e),r.start(bO(e,r,0,t,this.visualElement,!1))}stopAnimation(){GO(e=>this.getAxisMotionValue(e).stop())}pauseAnimation(){GO(e=>{var t;return null==(t=this.getAxisMotionValue(e).animation)?void 0:t.pause()})}getAnimationState(e){var t;return null==(t=this.getAxisMotionValue(e).animation)?void 0:t.state}getAxisMotionValue(e){const t=`_drag${e.toUpperCase()}`,r=this.visualElement.getProps(),n=r[t];return n||this.visualElement.getValue(e,(r.initial?r.initial[e]:void 0)||0)}snapToCursor(e){GO(t=>{const{drag:r}=this.getProps();if(!cI(t,r,this.currentDirection))return;const{projection:n}=this.visualElement,a=this.getAxisMotionValue(t);if(n&&n.layout){const{min:r,max:s}=n.layout.layoutBox[t];a.set(e[t]-aT(r,s,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:e,dragConstraints:t}=this.getProps(),{projection:r}=this.visualElement;if(!NA(t)||!r||!this.constraints)return;this.stopAnimation();const n={x:0,y:0};GO(e=>{const t=this.getAxisMotionValue(e);if(t&&!1!==this.constraints){const r=t.get();n[e]=function(e,t){let r=.5;const n=BO(e),a=BO(t);return a>n?r=Hj(t.min,t.max-n,e.min):n>a&&(r=Hj(e.min,e.max-a,t.min)),Lj(0,1,r)}({min:r,max:r},this.constraints[e])}});const{transformTemplate:a}=this.visualElement.getProps();this.visualElement.current.style.transform=a?a({},""):"none",r.root&&r.root.updateScroll(),r.updateLayout(),this.resolveConstraints(),GO(t=>{if(!cI(t,e,null))return;const r=this.getAxisMotionValue(t),{min:a,max:s}=this.constraints[t];r.set(aT(a,s,n[t]))})}addListeners(){if(!this.visualElement.current)return;oI.set(this.visualElement,this);const e=UO(this.visualElement.current,"pointerdown",e=>{const{drag:t,dragListener:r=!0}=this.getProps();t&&r&&this.start(e)}),t=()=>{const{dragConstraints:e}=this.getProps();NA(e)&&e.current&&(this.constraints=this.resolveRefConstraints())},{projection:r}=this.visualElement,n=r.addEventListener("measure",t);r&&!r.layout&&(r.root&&r.root.updateScroll(),r.updateLayout()),pS.read(t);const a=MO(window,"resize",()=>this.scalePositionWithinConstraints()),s=r.addEventListener("didUpdate",({delta:e,hasLayoutChanged:t})=>{this.isDragging&&t&&(GO(t=>{const r=this.getAxisMotionValue(t);r&&(this.originPoint[t]+=e[t].translate,r.set(r.get()+e[t].translate))}),this.visualElement.render())});return()=>{a(),e(),n(),s&&s()}}getProps(){const e=this.visualElement.getProps(),{drag:t=!1,dragDirectionLock:r=!1,dragPropagation:n=!1,dragConstraints:a=!1,dragElastic:s=aI,dragMomentum:i=!0}=e;return{...e,drag:t,dragDirectionLock:r,dragPropagation:n,dragConstraints:a,dragElastic:s,dragMomentum:i}}}function cI(e,t,r){return!(!0!==t&&t!==e||null!==r&&r!==e)}const dI=e=>(t,r)=>{e&&pS.postRender(()=>e(t,r))};const uI={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function hI(e,t){return t.max===t.min?0:e/(t.max-t.min)*100}const fI={correct:(e,t)=>{if(!t.target)return e;if("string"==typeof e){if(!$S.test(e))return e;e=parseFloat(e)}return`${hI(e,t.target.x)}% ${hI(e,t.target.y)}%`}},mI={correct:(e,{treeScale:t,projectionDelta:r})=>{const n=e,a=tT.parse(e);if(a.length>5)return n;const s=tT.createTransformer(e),i="number"!=typeof a[0]?1:0,o=r.x.scale*t.x,l=r.y.scale*t.y;a[0+i]/=o,a[1+i]/=l;const c=aT(o,l,.5);return"number"==typeof a[2+i]&&(a[2+i]/=c),"number"==typeof a[3+i]&&(a[3+i]/=c),s(a)}};let pI=!1;class gI extends W.Component{componentDidMount(){const{visualElement:e,layoutGroup:t,switchLayoutGroup:r,layoutId:n}=this.props,{projection:a}=e;!function(e){for(const t in e)YC[t]=e[t],kS(t)&&(YC[t].isCSSVariable=!0)}(vI),a&&(t.group&&t.group.add(a),r&&r.register&&n&&r.register(a),pI&&a.root.didUpdate(),a.addEventListener("animationComplete",()=>{this.safeToRemove()}),a.setOptions({...a.options,onExitComplete:()=>this.safeToRemove()})),uI.hasEverUpdated=!0}getSnapshotBeforeUpdate(e){const{layoutDependency:t,visualElement:r,drag:n,isPresent:a}=this.props,{projection:s}=r;return s?(s.isPresent=a,pI=!0,n||e.layoutDependency!==t||void 0===t||e.isPresent!==a?s.willUpdate():this.safeToRemove(),e.isPresent!==a&&(a?s.promote():s.relegate()||pS.postRender(()=>{const e=s.getStack();e&&e.members.length||this.safeToRemove()})),null):null}componentDidUpdate(){const{projection:e}=this.props.visualElement;e&&(e.root.didUpdate(),cC.postRender(()=>{!e.currentAnimation&&e.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:e,layoutGroup:t,switchLayoutGroup:r}=this.props,{projection:n}=e;pI=!0,n&&(n.scheduleCheckAfterUnmount(),t&&t.group&&t.group.remove(n),r&&r.deregister&&r.deregister(n))}safeToRemove(){const{safeToRemove:e}=this.props;e&&e()}render(){return null}}function xI(e){const[t,r]=AC(),n=W.useContext(Cj);return Q.jsx(gI,{...e,layoutGroup:n,switchLayoutGroup:W.useContext(EA),isPresent:t,safeToRemove:r})}const vI={borderRadius:{...fI,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:fI,borderTopRightRadius:fI,borderBottomLeftRadius:fI,borderBottomRightRadius:fI,boxShadow:mI};const bI=(e,t)=>e.depth-t.depth;class yI{constructor(){this.children=[],this.isDirty=!1}add(e){Pj(this.children,e),this.isDirty=!0}remove(e){Dj(this.children,e),this.isDirty=!0}forEach(e){this.isDirty&&this.children.sort(bI),this.isDirty=!1,this.children.forEach(e)}}const wI=["TopLeft","TopRight","BottomLeft","BottomRight"],_I=wI.length,kI=e=>"string"==typeof e?parseFloat(e):e,NI=e=>"number"==typeof e||$S.test(e);function jI(e,t){return void 0!==e[t]?e[t]:e.borderRadius}const SI=EI(0,.5,sS),TI=EI(.5,.95,zj);function EI(e,t,r){return n=>n<e?0:n>t?1:r(Hj(e,t,n))}function CI(e,t){e.min=t.min,e.max=t.max}function AI(e,t){CI(e.x,t.x),CI(e.y,t.y)}function OI(e,t){e.translate=t.translate,e.scale=t.scale,e.originPoint=t.originPoint,e.origin=t.origin}function II(e,t,r,n,a){return e=BA(e-=t,1/r,n),void 0!==a&&(e=BA(e,1/a,n)),e}function RI(e,t,[r,n,a],s,i){!function(e,t=0,r=1,n=.5,a,s=e,i=e){BS.test(t)&&(t=parseFloat(t),t=aT(i.min,i.max,t/100)-i.min);if("number"!=typeof t)return;let o=aT(s.min,s.max,n);e===s&&(o-=t),e.min=II(e.min,t,r,o,a),e.max=II(e.max,t,r,o,a)}(e,t[r],t[n],t[a],t.scale,s,i)}const PI=["x","scaleX","originX"],DI=["y","scaleY","originY"];function LI(e,t,r,n){RI(e.x,t,PI,r?r.x:void 0,n?n.x:void 0),RI(e.y,t,DI,r?r.y:void 0,n?n.y:void 0)}function MI(e){return 0===e.translate&&1===e.scale}function FI(e){return MI(e.x)&&MI(e.y)}function UI(e,t){return e.min===t.min&&e.max===t.max}function BI(e,t){return Math.round(e.min)===Math.round(t.min)&&Math.round(e.max)===Math.round(t.max)}function $I(e,t){return BI(e.x,t.x)&&BI(e.y,t.y)}function zI(e){return BO(e.x)/BO(e.y)}function VI(e,t){return e.translate===t.translate&&e.scale===t.scale&&e.originPoint===t.originPoint}class WI{constructor(){this.members=[]}add(e){Pj(this.members,e),e.scheduleRender()}remove(e){if(Dj(this.members,e),e===this.prevLead&&(this.prevLead=void 0),e===this.lead){const e=this.members[this.members.length-1];e&&this.promote(e)}}relegate(e){const t=this.members.findIndex(t=>e===t);if(0===t)return!1;let r;for(let n=t;n>=0;n--){const e=this.members[n];if(!1!==e.isPresent){r=e;break}}return!!r&&(this.promote(r),!0)}promote(e,t){const r=this.lead;if(e!==r&&(this.prevLead=r,this.lead=e,e.show(),r)){r.instance&&r.scheduleRender(),e.scheduleRender(),e.resumeFrom=r,t&&(e.resumeFrom.preserveOpacity=!0),r.snapshot&&(e.snapshot=r.snapshot,e.snapshot.latestValues=r.animationValues||r.latestValues),e.root&&e.root.isUpdating&&(e.isLayoutDirty=!0);const{crossfade:n}=e.options;!1===n&&r.hide()}}exitAnimationComplete(){this.members.forEach(e=>{const{options:t,resumingFrom:r}=e;t.onExitComplete&&t.onExitComplete(),r&&r.options.onExitComplete&&r.options.onExitComplete()})}scheduleRender(){this.members.forEach(e=>{e.instance&&e.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}const HI=["","X","Y","Z"];let GI=0;function qI(e,t,r,n){const{latestValues:a}=t;a[e]&&(r[e]=a[e],t.setStaticValue(e,0),n&&(n[e]=0))}function KI(e){if(e.hasCheckedOptimisedAppear=!0,e.root===e)return;const{visualElement:t}=e.options;if(!t)return;const r=fO(t);if(window.MotionHasOptimisedAnimation(r,"transform")){const{layout:t,layoutId:n}=e.options;window.MotionCancelOptimisedAnimation(r,"transform",pS,!(t||n))}const{parent:n}=e;n&&!n.hasCheckedOptimisedAppear&&KI(n)}function XI({attachResizeListener:e,defaultParent:t,measureScroll:r,checkIsScrollRoot:n,resetTransform:a}){return class{constructor(e={},r=(null==t?void 0:t())){this.id=GI++,this.animationId=0,this.animationCommitId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,this.nodes.forEach(ZI),this.nodes.forEach(sR),this.nodes.forEach(iR),this.nodes.forEach(QI)},this.resolvedRelativeTargetAt=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=e,this.root=r?r.root||r:this,this.path=r?[...r.path,r]:[],this.parent=r,this.depth=r?r.depth+1:0;for(let t=0;t<this.path.length;t++)this.path[t].shouldResetTransform=!0;this.root===this&&(this.nodes=new yI)}addEventListener(e,t){return this.eventHandlers.has(e)||this.eventHandlers.set(e,new Gj),this.eventHandlers.get(e).add(t)}notifyListeners(e,...t){const r=this.eventHandlers.get(e);r&&r.notify(...t)}hasListeners(e){return this.eventHandlers.has(e)}mount(t){if(this.instance)return;var r;this.isSVG=_C(t)&&!(_C(r=t)&&"svg"===r.tagName),this.instance=t;const{layoutId:n,layout:a,visualElement:s}=this.options;if(s&&!s.current&&s.mount(t),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),this.root.hasTreeAnimated&&(a||n)&&(this.isLayoutDirty=!0),e){let r,n=0;const a=()=>this.root.updateBlockedByResize=!1;pS.read(()=>{n=window.innerWidth}),e(t,()=>{const e=window.innerWidth;e!==n&&(n=e,this.root.updateBlockedByResize=!0,r&&r(),r=function(e,t){const r=wS.now(),n=({timestamp:a})=>{const s=a-r;s>=t&&(gS(n),e(s-t))};return pS.setup(n,!0),()=>gS(n)}(a,250),uI.hasAnimatedSinceResize&&(uI.hasAnimatedSinceResize=!1,this.nodes.forEach(aR)))})}n&&this.root.registerSharedNode(n,this),!1!==this.options.animate&&s&&(n||a)&&this.addEventListener("didUpdate",({delta:e,hasLayoutChanged:t,hasRelativeLayoutChanged:r,layout:n})=>{if(this.isTreeAnimationBlocked())return this.target=void 0,void(this.relativeTarget=void 0);const a=this.options.transition||s.getDefaultTransition()||hR,{onLayoutAnimationStart:i,onLayoutAnimationComplete:o}=s.getProps(),l=!this.targetLayout||!$I(this.targetLayout,n),c=!t&&r;if(this.options.layoutRoot||this.resumeFrom||c||t&&(l||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0);const t={...zE(a,"layout"),onPlay:i,onComplete:o};(s.shouldReduceMotion||this.options.layoutRoot)&&(t.delay=0,t.type=!1),this.startAnimation(t),this.setAnimationOrigin(e,c)}else t||aR(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=n})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const e=this.getStack();e&&e.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,this.eventHandlers.clear(),gS(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(oR),this.animationId++)}getTransformTemplate(){const{visualElement:e}=this.options;return e&&e.getProps().transformTemplate}willUpdate(e=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked())return void(this.options.onExitComplete&&this.options.onExitComplete());if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&KI(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let a=0;a<this.path.length;a++){const e=this.path[a];e.shouldResetTransform=!0,e.updateScroll("snapshot"),e.options.layoutRoot&&e.willUpdate(!1)}const{layoutId:t,layout:r}=this.options;if(void 0===t&&!r)return;const n=this.getTransformTemplate();this.prevTransformTemplateValue=n?n(this.latestValues,""):void 0,this.updateSnapshot(),e&&this.notifyListeners("willUpdate")}update(){this.updateScheduled=!1;if(this.isUpdateBlocked())return this.unblockUpdate(),this.clearAllSnapshots(),void this.nodes.forEach(tR);if(this.animationId<=this.animationCommitId)return void this.nodes.forEach(rR);this.animationCommitId=this.animationId,this.isUpdating?(this.isUpdating=!1,this.nodes.forEach(nR),this.nodes.forEach(YI),this.nodes.forEach(JI)):this.nodes.forEach(rR),this.clearAllSnapshots();const e=wS.now();xS.delta=Lj(0,1e3/60,e-xS.timestamp),xS.timestamp=e,xS.isProcessing=!0,vS.update.process(xS),vS.preRender.process(xS),vS.render.process(xS),xS.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,cC.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(eR),this.sharedNodes.forEach(lR)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,pS.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){pS.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){!this.snapshot&&this.instance&&(this.snapshot=this.measure(),!this.snapshot||BO(this.snapshot.measuredBox.x)||BO(this.snapshot.measuredBox.y)||(this.snapshot=void 0))}updateLayout(){if(!this.instance)return;if(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead()||this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let r=0;r<this.path.length;r++){this.path[r].updateScroll()}const e=this.layout;this.layout=this.measure(!1),this.layoutCorrected={x:{min:0,max:0},y:{min:0,max:0}},this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:t}=this.options;t&&t.notify("LayoutMeasure",this.layout.layoutBox,e?e.layoutBox:void 0)}updateScroll(e="measure"){let t=Boolean(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===e&&(t=!1),t&&this.instance){const t=n(this.instance);this.scroll={animationId:this.root.animationId,phase:e,isRoot:t,offset:r(this.instance),wasRoot:this.scroll?this.scroll.isRoot:t}}}resetTransform(){if(!a)return;const e=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,t=this.projectionDelta&&!FI(this.projectionDelta),r=this.getTransformTemplate(),n=r?r(this.latestValues,""):void 0,s=n!==this.prevTransformTemplateValue;e&&this.instance&&(t||MA(this.latestValues)||s)&&(a(this.instance,n),this.shouldResetTransform=!1,this.scheduleRender())}measure(e=!0){const t=this.measurePageBox();let r=this.removeElementScroll(t);var n;return e&&(r=this.removeTransform(r)),pR((n=r).x),pR(n.y),{animationId:this.root.animationId,measuredBox:t,layoutBox:r,latestValues:{},source:this.id}}measurePageBox(){var e;const{visualElement:t}=this.options;if(!t)return{x:{min:0,max:0},y:{min:0,max:0}};const r=t.measureViewportBox();if(!((null==(e=this.scroll)?void 0:e.wasRoot)||this.path.some(xR))){const{scroll:e}=this.root;e&&(GA(r.x,e.offset.x),GA(r.y,e.offset.y))}return r}removeElementScroll(e){var t;const r={x:{min:0,max:0},y:{min:0,max:0}};if(AI(r,e),null==(t=this.scroll)?void 0:t.wasRoot)return r;for(let n=0;n<this.path.length;n++){const t=this.path[n],{scroll:a,options:s}=t;t!==this.root&&a&&s.layoutScroll&&(a.wasRoot&&AI(r,e),GA(r.x,a.offset.x),GA(r.y,a.offset.y))}return r}applyTransform(e,t=!1){const r={x:{min:0,max:0},y:{min:0,max:0}};AI(r,e);for(let n=0;n<this.path.length;n++){const e=this.path[n];!t&&e.options.layoutScroll&&e.scroll&&e!==e.root&&KA(r,{x:-e.scroll.offset.x,y:-e.scroll.offset.y}),MA(e.latestValues)&&KA(r,e.latestValues)}return MA(this.latestValues)&&KA(r,this.latestValues),r}removeTransform(e){const t={x:{min:0,max:0},y:{min:0,max:0}};AI(t,e);for(let r=0;r<this.path.length;r++){const e=this.path[r];if(!e.instance)continue;if(!MA(e.latestValues))continue;LA(e.latestValues)&&e.updateSnapshot();const n=YA();AI(n,e.measurePageBox()),LI(t,e.latestValues,e.snapshot?e.snapshot.layoutBox:void 0,n)}return MA(this.latestValues)&&LI(t,this.latestValues),t}setTargetDelta(e){this.targetDelta=e,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(e){this.options={...this.options,...e,crossfade:void 0===e.crossfade||e.crossfade}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==xS.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(e=!1){var t;const r=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=r.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=r.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=r.isSharedProjectionDirty);const n=Boolean(this.resumingFrom)||this!==r;if(!(e||n&&this.isSharedProjectionDirty||this.isProjectionDirty||(null==(t=this.parent)?void 0:t.isProjectionDirty)||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:a,layoutId:s}=this.options;if(this.layout&&(a||s)){if(this.resolvedRelativeTargetAt=xS.timestamp,!this.targetDelta&&!this.relativeTarget){const e=this.getClosestProjectingParent();e&&e.layout&&1!==this.animationProgress?(this.relativeParent=e,this.forceRelativeParentToResolveTarget(),this.relativeTarget={x:{min:0,max:0},y:{min:0,max:0}},this.relativeTargetOrigin={x:{min:0,max:0},y:{min:0,max:0}},HO(this.relativeTargetOrigin,this.layout.layoutBox,e.layout.layoutBox),AI(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}var i,o,l;if(this.relativeTarget||this.targetDelta)if(this.target||(this.target={x:{min:0,max:0},y:{min:0,max:0}},this.targetWithTransforms={x:{min:0,max:0},y:{min:0,max:0}}),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),i=this.target,o=this.relativeTarget,l=this.relativeParent.target,VO(i.x,o.x,l.x),VO(i.y,o.y,l.y)):this.targetDelta?(Boolean(this.resumingFrom)?this.target=this.applyTransform(this.layout.layoutBox):AI(this.target,this.layout.layoutBox),VA(this.target,this.targetDelta)):AI(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget){this.attemptToResolveRelativeTarget=!1;const e=this.getClosestProjectingParent();e&&Boolean(e.resumingFrom)===Boolean(this.resumingFrom)&&!e.options.layoutScroll&&e.target&&1!==this.animationProgress?(this.relativeParent=e,this.forceRelativeParentToResolveTarget(),this.relativeTarget={x:{min:0,max:0},y:{min:0,max:0}},this.relativeTargetOrigin={x:{min:0,max:0},y:{min:0,max:0}},HO(this.relativeTargetOrigin,this.target,e.target),AI(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}}}getClosestProjectingParent(){if(this.parent&&!LA(this.parent.latestValues)&&!FA(this.parent.latestValues))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return Boolean((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){var e;const t=this.getLead(),r=Boolean(this.resumingFrom)||this!==t;let n=!0;if((this.isProjectionDirty||(null==(e=this.parent)?void 0:e.isProjectionDirty))&&(n=!1),r&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(n=!1),this.resolvedRelativeTargetAt===xS.timestamp&&(n=!1),n)return;const{layout:a,layoutId:s}=this.options;if(this.isTreeAnimating=Boolean(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!a&&!s)return;AI(this.layoutCorrected,this.layout.layoutBox);const i=this.treeScale.x,o=this.treeScale.y;!function(e,t,r,n=!1){const a=r.length;if(!a)return;let s,i;t.x=t.y=1;for(let o=0;o<a;o++){s=r[o],i=s.projectionDelta;const{visualElement:a}=s.options;a&&a.props.style&&"contents"===a.props.style.display||(n&&s.options.layoutScroll&&s.scroll&&s!==s.root&&KA(e,{x:-s.scroll.offset.x,y:-s.scroll.offset.y}),i&&(t.x*=i.x.scale,t.y*=i.y.scale,VA(e,i)),n&&MA(s.latestValues)&&KA(e,s.latestValues))}t.x<HA&&t.x>WA&&(t.x=1),t.y<HA&&t.y>WA&&(t.y=1)}(this.layoutCorrected,this.treeScale,this.path,r),!t.layout||t.target||1===this.treeScale.x&&1===this.treeScale.y||(t.target=t.layout.layoutBox,t.targetWithTransforms={x:{min:0,max:0},y:{min:0,max:0}});const{target:l}=t;l?(this.projectionDelta&&this.prevProjectionDelta?(OI(this.prevProjectionDelta.x,this.projectionDelta.x),OI(this.prevProjectionDelta.y,this.projectionDelta.y)):this.createProjectionDeltas(),zO(this.projectionDelta,this.layoutCorrected,l,this.latestValues),this.treeScale.x===i&&this.treeScale.y===o&&VI(this.projectionDelta.x,this.prevProjectionDelta.x)&&VI(this.projectionDelta.y,this.prevProjectionDelta.y)||(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",l))):this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender())}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(e=!0){var t;if(null==(t=this.options.visualElement)||t.scheduleRender(),e){const e=this.getStack();e&&e.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta={x:{translate:0,scale:1,origin:0,originPoint:0},y:{translate:0,scale:1,origin:0,originPoint:0}},this.projectionDelta={x:{translate:0,scale:1,origin:0,originPoint:0},y:{translate:0,scale:1,origin:0,originPoint:0}},this.projectionDeltaWithTransform={x:{translate:0,scale:1,origin:0,originPoint:0},y:{translate:0,scale:1,origin:0,originPoint:0}}}setAnimationOrigin(e,t=!1){const r=this.snapshot,n=r?r.latestValues:{},a={...this.latestValues},s={x:{translate:0,scale:1,origin:0,originPoint:0},y:{translate:0,scale:1,origin:0,originPoint:0}};this.relativeParent&&this.relativeParent.options.layoutRoot||(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!t;const i={x:{min:0,max:0},y:{min:0,max:0}},o=(r?r.source:void 0)!==(this.layout?this.layout.source:void 0),l=this.getStack(),c=!l||l.members.length<=1,d=Boolean(o&&!c&&!0===this.options.crossfade&&!this.path.some(uR));let u;this.animationProgress=0,this.mixTargetDelta=t=>{const r=t/1e3;var l,h,f,m;cR(s.x,e.x,r),cR(s.y,e.y,r),this.setTargetDelta(s),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(HO(i,this.layout.layoutBox,this.relativeParent.layout.layoutBox),l=this.relativeTarget,h=this.relativeTargetOrigin,f=i,m=r,dR(l.x,h.x,f.x,m),dR(l.y,h.y,f.y,m),u&&function(e,t){return UI(e.x,t.x)&&UI(e.y,t.y)}(this.relativeTarget,u)&&(this.isProjectionDirty=!1),u||(u={x:{min:0,max:0},y:{min:0,max:0}}),AI(u,this.relativeTarget)),o&&(this.animationValues=a,function(e,t,r,n,a,s){a?(e.opacity=aT(0,r.opacity??1,SI(n)),e.opacityExit=aT(t.opacity??1,0,TI(n))):s&&(e.opacity=aT(t.opacity??1,r.opacity??1,n));for(let i=0;i<_I;i++){const a=`border${wI[i]}Radius`;let s=jI(t,a),o=jI(r,a);void 0===s&&void 0===o||(s||(s=0),o||(o=0),0===s||0===o||NI(s)===NI(o)?(e[a]=Math.max(aT(kI(s),kI(o),n),0),(BS.test(o)||BS.test(s))&&(e[a]+="%")):e[a]=o)}(t.rotate||r.rotate)&&(e.rotate=aT(t.rotate||0,r.rotate||0,n))}(a,n,this.latestValues,r,d,c)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=r},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(e){var t,r,n;this.notifyListeners("animationStart"),null==(t=this.currentAnimation)||t.stop(),null==(n=null==(r=this.resumingFrom)?void 0:r.currentAnimation)||n.stop(),this.pendingAnimation&&(gS(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=pS.update(()=>{uI.hasAnimatedSinceResize=!0,this.motionValue||(this.motionValue=lC(0)),this.currentAnimation=function(e,t,r){const n=kC(e)?e:lC(e);return n.start(bO("",n,t,r)),n.animation}(this.motionValue,[0,1e3],{...e,velocity:0,isSync:!0,onUpdate:t=>{this.mixTargetDelta(t),e.onUpdate&&e.onUpdate(t)},onStop:()=>{},onComplete:()=>{e.onComplete&&e.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const e=this.getStack();e&&e.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(1e3),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const e=this.getLead();let{targetWithTransforms:t,target:r,layout:n,latestValues:a}=e;if(t&&r&&n){if(this!==e&&this.layout&&n&&gR(this.options.animationType,this.layout.layoutBox,n.layoutBox)){r=this.target||{x:{min:0,max:0},y:{min:0,max:0}};const t=BO(this.layout.layoutBox.x);r.x.min=e.target.x.min,r.x.max=r.x.min+t;const n=BO(this.layout.layoutBox.y);r.y.min=e.target.y.min,r.y.max=r.y.min+n}AI(t,r),KA(t,a),zO(this.projectionDeltaWithTransform,this.layoutCorrected,t,a)}}registerSharedNode(e,t){this.sharedNodes.has(e)||this.sharedNodes.set(e,new WI);this.sharedNodes.get(e).add(t);const r=t.options.initialPromotionConfig;t.promote({transition:r?r.transition:void 0,preserveFollowOpacity:r&&r.shouldPreserveFollowOpacity?r.shouldPreserveFollowOpacity(t):void 0})}isLead(){const e=this.getStack();return!e||e.lead===this}getLead(){var e;const{layoutId:t}=this.options;return t&&(null==(e=this.getStack())?void 0:e.lead)||this}getPrevLead(){var e;const{layoutId:t}=this.options;return t?null==(e=this.getStack())?void 0:e.prevLead:void 0}getStack(){const{layoutId:e}=this.options;if(e)return this.root.sharedNodes.get(e)}promote({needsReset:e,transition:t,preserveFollowOpacity:r}={}){const n=this.getStack();n&&n.promote(this,r),e&&(this.projectionDelta=void 0,this.needsReset=!0),t&&this.setOptions({transition:t})}relegate(){const e=this.getStack();return!!e&&e.relegate(this)}resetSkewAndRotation(){const{visualElement:e}=this.options;if(!e)return;let t=!1;const{latestValues:r}=e;if((r.z||r.rotate||r.rotateX||r.rotateY||r.rotateZ||r.skewX||r.skewY)&&(t=!0),!t)return;const n={};r.z&&qI("z",e,n,this.animationValues);for(let a=0;a<HI.length;a++)qI(`rotate${HI[a]}`,e,n,this.animationValues),qI(`skew${HI[a]}`,e,n,this.animationValues);e.render();for(const a in n)e.setStaticValue(a,n[a]),this.animationValues&&(this.animationValues[a]=n[a]);e.scheduleRender()}applyProjectionStyles(e,t){if(!this.instance||this.isSVG)return;if(!this.isVisible)return void(e.visibility="hidden");const r=this.getTransformTemplate();if(this.needsReset)return this.needsReset=!1,e.visibility="",e.opacity="",e.pointerEvents=gA(null==t?void 0:t.pointerEvents)||"",void(e.transform=r?r(this.latestValues,""):"none");const n=this.getLead();if(!this.projectionDelta||!this.layout||!n.target)return this.options.layoutId&&(e.opacity=void 0!==this.latestValues.opacity?this.latestValues.opacity:1,e.pointerEvents=gA(null==t?void 0:t.pointerEvents)||""),void(this.hasProjected&&!MA(this.latestValues)&&(e.transform=r?r({},""):"none",this.hasProjected=!1));e.visibility="";const a=n.animationValues||n.latestValues;this.applyTransformsToTarget();let s=function(e,t,r){let n="";const a=e.x.translate/t.x,s=e.y.translate/t.y,i=(null==r?void 0:r.z)||0;if((a||s||i)&&(n=`translate3d(${a}px, ${s}px, ${i}px) `),1===t.x&&1===t.y||(n+=`scale(${1/t.x}, ${1/t.y}) `),r){const{transformPerspective:e,rotate:t,rotateX:a,rotateY:s,skewX:i,skewY:o}=r;e&&(n=`perspective(${e}px) ${n}`),t&&(n+=`rotate(${t}deg) `),a&&(n+=`rotateX(${a}deg) `),s&&(n+=`rotateY(${s}deg) `),i&&(n+=`skewX(${i}deg) `),o&&(n+=`skewY(${o}deg) `)}const o=e.x.scale*t.x,l=e.y.scale*t.y;return 1===o&&1===l||(n+=`scale(${o}, ${l})`),n||"none"}(this.projectionDeltaWithTransform,this.treeScale,a);r&&(s=r(a,s)),e.transform=s;const{x:i,y:o}=this.projectionDelta;e.transformOrigin=`${100*i.origin}% ${100*o.origin}% 0`,n.animationValues?e.opacity=n===this?a.opacity??this.latestValues.opacity??1:this.preserveOpacity?this.latestValues.opacity:a.opacityExit:e.opacity=n===this?void 0!==a.opacity?a.opacity:"":void 0!==a.opacityExit?a.opacityExit:0;for(const l in YC){if(void 0===a[l])continue;const{correct:t,applyTo:r,isCSSVariable:i}=YC[l],o="none"===s?a[l]:t(a[l],n);if(r){const t=r.length;for(let n=0;n<t;n++)e[r[n]]=o}else i?this.options.visualElement.renderState.vars[l]=o:e[l]=o}this.options.layoutId&&(e.pointerEvents=n===this?gA(null==t?void 0:t.pointerEvents)||"":"none")}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(e=>{var t;return null==(t=e.currentAnimation)?void 0:t.stop()}),this.root.nodes.forEach(tR),this.root.sharedNodes.clear()}}}function YI(e){e.updateLayout()}function JI(e){var t;const r=(null==(t=e.resumeFrom)?void 0:t.snapshot)||e.snapshot;if(e.isLead()&&e.layout&&r&&e.hasListeners("didUpdate")){const{layoutBox:t,measuredBox:n}=e.layout,{animationType:a}=e.options,s=r.source!==e.layout.source;"size"===a?GO(e=>{const n=s?r.measuredBox[e]:r.layoutBox[e],a=BO(n);n.min=t[e].min,n.max=n.min+a}):gR(a,r.layoutBox,t)&&GO(n=>{const a=s?r.measuredBox[n]:r.layoutBox[n],i=BO(t[n]);a.max=a.min+i,e.relativeTarget&&!e.currentAnimation&&(e.isProjectionDirty=!0,e.relativeTarget[n].max=e.relativeTarget[n].min+i)});const i={x:{translate:0,scale:1,origin:0,originPoint:0},y:{translate:0,scale:1,origin:0,originPoint:0}};zO(i,t,r.layoutBox);const o={x:{translate:0,scale:1,origin:0,originPoint:0},y:{translate:0,scale:1,origin:0,originPoint:0}};s?zO(o,e.applyTransform(n,!0),r.measuredBox):zO(o,t,r.layoutBox);const l=!FI(i);let c=!1;if(!e.resumeFrom){const n=e.getClosestProjectingParent();if(n&&!n.resumeFrom){const{snapshot:a,layout:s}=n;if(a&&s){const i={x:{min:0,max:0},y:{min:0,max:0}};HO(i,r.layoutBox,a.layoutBox);const o={x:{min:0,max:0},y:{min:0,max:0}};HO(o,t,s.layoutBox),$I(i,o)||(c=!0),n.options.layoutRoot&&(e.relativeTarget=o,e.relativeTargetOrigin=i,e.relativeParent=n)}}}e.notifyListeners("didUpdate",{layout:t,snapshot:r,delta:o,layoutDelta:i,hasLayoutChanged:l,hasRelativeLayoutChanged:c})}else if(e.isLead()){const{onExitComplete:t}=e.options;t&&t()}e.options.transition=void 0}function ZI(e){e.parent&&(e.isProjecting()||(e.isProjectionDirty=e.parent.isProjectionDirty),e.isSharedProjectionDirty||(e.isSharedProjectionDirty=Boolean(e.isProjectionDirty||e.parent.isProjectionDirty||e.parent.isSharedProjectionDirty)),e.isTransformDirty||(e.isTransformDirty=e.parent.isTransformDirty))}function QI(e){e.isProjectionDirty=e.isSharedProjectionDirty=e.isTransformDirty=!1}function eR(e){e.clearSnapshot()}function tR(e){e.clearMeasurements()}function rR(e){e.isLayoutDirty=!1}function nR(e){const{visualElement:t}=e.options;t&&t.getProps().onBeforeLayoutMeasure&&t.notify("BeforeLayoutMeasure"),e.resetTransform()}function aR(e){e.finishAnimation(),e.targetDelta=e.relativeTarget=e.target=void 0,e.isProjectionDirty=!0}function sR(e){e.resolveTargetDelta()}function iR(e){e.calcProjection()}function oR(e){e.resetSkewAndRotation()}function lR(e){e.removeLeadSnapshot()}function cR(e,t,r){e.translate=aT(t.translate,0,r),e.scale=aT(t.scale,1,r),e.origin=t.origin,e.originPoint=t.originPoint}function dR(e,t,r,n){e.min=aT(t.min,r.min,n),e.max=aT(t.max,r.max,n)}function uR(e){return e.animationValues&&void 0!==e.animationValues.opacityExit}const hR={duration:.45,ease:[.4,0,.1,1]},fR=e=>"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(e),mR=fR("applewebkit/")&&!fR("chrome/")?Math.round:zj;function pR(e){e.min=mR(e.min),e.max=mR(e.max)}function gR(e,t,r){return"position"===e||"preserve-aspect"===e&&(n=zI(t),a=zI(r),s=.2,!(Math.abs(n-a)<=s));var n,a,s}function xR(e){var t;return e!==e.root&&(null==(t=e.scroll)?void 0:t.wasRoot)}const vR=XI({attachResizeListener:(e,t)=>MO(e,"resize",t),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),bR={current:void 0},yR=XI({measureScroll:e=>({x:e.scrollLeft,y:e.scrollTop}),defaultParent:()=>{if(!bR.current){const e=new vR({});e.mount(window),e.setOptions({layoutScroll:!0}),bR.current=e}return bR.current},resetTransform:(e,t)=>{e.style.transform=void 0!==t?t:"none"},checkIsScrollRoot:e=>Boolean("fixed"===window.getComputedStyle(e).position)}),wR={pan:{Feature:class extends PO{constructor(){super(...arguments),this.removePointerDownListener=zj}onPointerDown(e){this.session=new XO(e,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:qO(this.node)})}createPanHandlers(){const{onPanSessionStart:e,onPanStart:t,onPan:r,onPanEnd:n}=this.node.getProps();return{onSessionStart:dI(e),onStart:dI(t),onMove:r,onEnd:(e,t)=>{delete this.session,n&&pS.postRender(()=>n(e,t))}}}mount(){this.removePointerDownListener=UO(this.node.current,"pointerdown",e=>this.onPointerDown(e))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}},drag:{Feature:class extends PO{constructor(e){super(e),this.removeGroupControls=zj,this.removeListeners=zj,this.controls=new lI(e)}mount(){const{dragControls:e}=this.node.getProps();e&&(this.removeGroupControls=e.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||zj}unmount(){this.removeGroupControls(),this.removeListeners()}},ProjectionNode:yR,MeasureLayout:xI}};function _R(e,t,r){const{props:n}=e;e.animationState&&n.whileHover&&e.animationState.setActive("whileHover","Start"===r);const a=n["onHover"+r];a&&pS.postRender(()=>a(t,FO(t)))}function kR(e,t,r){const{props:n}=e;if(e.current instanceof HTMLButtonElement&&e.current.disabled)return;e.animationState&&n.whileTap&&e.animationState.setActive("whileTap","Start"===r);const a=n["onTap"+("End"===r?"":r)];a&&pS.postRender(()=>a(t,FO(t)))}const NR=new WeakMap,jR=new WeakMap,SR=e=>{const t=NR.get(e.target);t&&t(e)},TR=e=>{e.forEach(SR)};function ER(e,t,r){const n=function({root:e,...t}){const r=e||document;jR.has(r)||jR.set(r,{});const n=jR.get(r),a=JSON.stringify(t);return n[a]||(n[a]=new IntersectionObserver(TR,{root:e,...t})),n[a]}(t);return NR.set(e,r),n.observe(e),()=>{NR.delete(e),n.unobserve(e)}}const CR={some:0,all:1};const AR=RA({...LO,...{inView:{Feature:class extends PO{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:e={}}=this.node.getProps(),{root:t,margin:r,amount:n="some",once:a}=e,s={root:t?t.current:void 0,rootMargin:r,threshold:"number"==typeof n?n:CR[n]};return ER(this.node.current,s,e=>{const{isIntersecting:t}=e;if(this.isInView===t)return;if(this.isInView=t,a&&!t&&this.hasEnteredView)return;t&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",t);const{onViewportEnter:r,onViewportLeave:n}=this.node.getProps(),s=t?r:n;s&&s(e)})}mount(){this.startObserver()}update(){if("undefined"==typeof IntersectionObserver)return;const{props:e,prevProps:t}=this.node;["amount","margin","root"].some(function({viewport:e={}},{viewport:t={}}={}){return r=>e[r]!==t[r]}(e,t))&&this.startObserver()}unmount(){}}},tap:{Feature:class extends PO{mount(){const{current:e}=this.node;e&&(this.unmount=wC(e,(e,t)=>(kR(this.node,t,"Start"),(e,{success:t})=>kR(this.node,e,t?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}},focus:{Feature:class extends PO{constructor(){super(...arguments),this.isActive=!1}onFocus(){let e=!1;try{e=this.node.current.matches(":focus-visible")}catch(t){e=!0}e&&this.node.animationState&&(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){this.isActive&&this.node.animationState&&(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=Wj(MO(this.node.current,"focus",()=>this.onFocus()),MO(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}},hover:{Feature:class extends PO{mount(){const{current:e}=this.node;e&&(this.unmount=function(e,t,r={}){const[n,a,s]=hC(e,r),i=e=>{if(!fC(e))return;const{target:r}=e,n=t(r,e);if("function"!=typeof n||!r)return;const s=e=>{fC(e)&&(n(e),r.removeEventListener("pointerleave",s))};r.addEventListener("pointerleave",s,a)};return n.forEach(e=>{e.addEventListener("pointerenter",i,a)}),s}(e,(e,t)=>(_R(this.node,t,"Start"),e=>_R(this.node,e,"End"))))}unmount(){}}}},...wR,...{layout:{ProjectionNode:yR,MeasureLayout:xI}}},oO),OR=H.forwardRef(({className:e,...t},r)=>Q.jsx("div",{ref:r,className:`rounded-lg border bg-card text-card-foreground shadow-sm ${e||""}`,...t}));OR.displayName="Card";const IR=H.forwardRef(({className:e,...t},r)=>Q.jsx("div",{ref:r,className:`flex flex-col space-y-1.5 p-6 ${e||""}`,...t}));IR.displayName="CardHeader";const RR=H.forwardRef(({className:e,...t},r)=>Q.jsx("h3",{ref:r,className:`text-2xl font-semibold leading-none tracking-tight ${e||""}`,...t}));RR.displayName="CardTitle";H.forwardRef(({className:e,...t},r)=>Q.jsx("p",{ref:r,className:`text-sm text-muted-foreground ${e||""}`,...t})).displayName="CardDescription";const PR=H.forwardRef(({className:e,...t},r)=>Q.jsx("div",{ref:r,className:`p-6 pt-0 ${e||""}`,...t}));PR.displayName="CardContent";H.forwardRef(({className:e,...t},r)=>Q.jsx("div",{ref:r,className:`flex items-center p-6 pt-0 ${e||""}`,...t})).displayName="CardFooter";const DR=new class{constructor(){this.rates={USD_MXN:20,MXN_USD:.05},this.lastUpdate=null}async getExchangeRate(e="USD",t="MXN"){try{if(this.lastUpdate&&Date.now()-this.lastUpdate<36e5)return this.rates[`${e}_${t}`]||20;const r=await fetch(`https://api.exchangerate-api.com/v4/latest/${e}`);if(r.ok){const n=await r.json();if(n.rates&&n.rates[t])return this.rates[`${e}_${t}`]=n.rates[t],this.rates[`${t}_${e}`]=1/n.rates[t],this.lastUpdate=Date.now(),console.log(`: 1 ${e} = ${n.rates[t]} ${t}`),n.rates[t]}}catch(r){console.warn(":",r)}return this.rates[`${e}_${t}`]||20}async usdToMxn(e){return e*await this.getExchangeRate("USD","MXN")}async mxnToUsd(e){return e*await this.getExchangeRate("MXN","USD")}formatMXN(e){return new Intl.NumberFormat("es-MX",{style:"currency",currency:"MXN",minimumFractionDigits:0,maximumFractionDigits:0}).format(e)}formatUSD(e){return new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0}).format(e)}},LR=()=>{const[e,t]=W.useState({todayStats:{adSpend:0,creditCardAmount:0,creditCardAmountUSD:0,paymentInfoCount:0,creditCardOrders:0,costPerPaymentInfo:0,activeStaff:0},last7DaysStats:{totalAdSpend:0,totalCreditCardAmount:0,totalCreditCardAmountUSD:0,totalPaymentInfoCount:0,totalCreditCardOrders:0,avgCostPerPaymentInfo:0},staffPerformance:[],dailyTrend:[],exchangeRate:20,pendingAccountRequests:0,pendingRequestsDetail:[],loading:!0,error:null,lastUpdate:""});W.useEffect(()=>{r();const e=setInterval(r,3e5);return()=>clearInterval(e)},[]);const r=async()=>{try{t(e=>({...e,loading:!0,error:null}));const e=await DR.getExchangeRate("USD","MXN");console.log("===  ===");const{data:r,error:n}=await sp.from("app_e87b41cfe355428b8146f8bae8184e10_account_requests").select("*");console.log(":",r),console.log(":",n),console.log(":",null==r?void 0:r.length),r&&r.length>0&&(console.log(":",r.map(e=>e.status)),console.log(":",r[0]),console.log(":",Object.keys(r[0])));const a=(null==r?void 0:r.filter(e=>["pending"].includes(e.status)))||[],s=n;s&&console.error(":",s),console.log(":",a),console.log(":",s);const i=(null==a?void 0:a.length)||0,o=a||[];console.log(":",i),console.log(":",o),o&&o.length>0&&(console.log(":",o[0]),console.log(":",Object.keys(o[0])));const{data:l,error:c}=await sp.from("app_e87b41cfe355428b8146f8bae8184e10_ad_data_entries").select("*").order("created_at",{ascending:!1});if(c)throw console.error(":",c),c;if(console.log(":",(null==l?void 0:l.length)||0,""),!l||0===l.length)return void t(t=>({...t,loading:!1,error:"",exchangeRate:e,pendingAccountRequests:i,pendingRequestsDetail:o}));const d=(new Date).toISOString().split("T")[0],u=l.filter(e=>e.date===d);console.log(":",u.length,"");let h={adSpend:0,creditCardAmount:0,creditCardAmountUSD:0,paymentInfoCount:0,creditCardOrders:0,costPerPaymentInfo:0,activeStaff:new Set(u.map(e=>e.staff)).size};u.forEach(e=>{h.adSpend+=parseFloat(e.ad_spend||0),h.creditCardAmount+=parseFloat(e.credit_card_amount||0),h.paymentInfoCount+=parseInt(e.payment_info_count||0),h.creditCardOrders+=parseInt(e.credit_card_orders||0)}),h.creditCardAmountUSD=await DR.mxnToUsd(h.creditCardAmount),h.costPerPaymentInfo=h.paymentInfoCount>0?h.adSpend/h.paymentInfoCount:0;const f=new Date;f.setDate(f.getDate()-7);const m=f.toISOString().split("T")[0],p=l.filter(e=>e.date>=m);let g={totalAdSpend:0,totalCreditCardAmount:0,totalCreditCardAmountUSD:0,totalPaymentInfoCount:0,totalCreditCardOrders:0,avgCostPerPaymentInfo:0};p.forEach(e=>{g.totalAdSpend+=parseFloat(e.ad_spend||0),g.totalCreditCardAmount+=parseFloat(e.credit_card_amount||0),g.totalPaymentInfoCount+=parseInt(e.payment_info_count||0),g.totalCreditCardOrders+=parseInt(e.credit_card_orders||0)}),g.totalCreditCardAmountUSD=await DR.mxnToUsd(g.totalCreditCardAmount),g.avgCostPerPaymentInfo=g.totalPaymentInfoCount>0?g.totalAdSpend/g.totalPaymentInfoCount:0;const x={};u.forEach(e=>{const t=e.staff;x[t]||(x[t]={name:t,adSpend:0,creditCardAmount:0,creditCardAmountUSD:0,paymentInfoCount:0,creditCardOrders:0,costPerPaymentInfo:0,entries:0});const r=x[t];r.adSpend+=parseFloat(e.ad_spend||0),r.creditCardAmount+=parseFloat(e.credit_card_amount||0),r.paymentInfoCount+=parseInt(e.payment_info_count||0),r.creditCardOrders+=parseInt(e.credit_card_orders||0),r.entries+=1});const v=[];for(const t of Object.values(x))t.creditCardAmountUSD=await DR.mxnToUsd(t.creditCardAmount),t.costPerPaymentInfo=t.paymentInfoCount>0?t.adSpend/t.paymentInfoCount:0,v.push(t);v.forEach(e=>{e.roi=e.adSpend>0?e.creditCardAmountUSD/e.adSpend:0}),v.sort((e,t)=>t.roi-e.roi);const b=[];for(let t=6;t>=0;t--){const e=new Date;e.setDate(e.getDate()-t);const r=e.toISOString().split("T")[0],n=l.filter(e=>e.date===r);let a={date:r,adSpend:0,creditCardAmount:0,creditCardAmountUSD:0,paymentInfoCount:0,creditCardOrders:0,costPerPaymentInfo:0,entries:n.length};n.forEach(e=>{a.adSpend+=parseFloat(e.ad_spend||0),a.creditCardAmount+=parseFloat(e.credit_card_amount||0),a.paymentInfoCount+=parseInt(e.payment_info_count||0),a.creditCardOrders+=parseInt(e.credit_card_orders||0)}),a.creditCardAmountUSD=await DR.mxnToUsd(a.creditCardAmount),a.costPerPaymentInfo=a.paymentInfoCount>0?a.adSpend/a.paymentInfoCount:0,a.roi=a.adSpend>0?a.creditCardAmountUSD/a.adSpend:0,b.push(a)}t({todayStats:h,last7DaysStats:g,staffPerformance:v.slice(0,5),dailyTrend:b,exchangeRate:e,pendingAccountRequests:i,pendingRequestsDetail:o,loading:!1,error:null,lastUpdate:(new Date).toLocaleTimeString("zh-CN")})}catch(e){console.error(":",e),t(t=>({...t,loading:!1,error:e.message||""}))}},n=e=>DR.formatUSD(e),a=e=>DR.formatMXN(e);if(e.loading)return Q.jsx("div",{className:"p-6",children:Q.jsx("div",{className:"flex items-center justify-center min-h-96",children:Q.jsxs("div",{className:"text-center",children:[Q.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),Q.jsx("p",{className:"text-gray-600",children:"..."})]})})});if(e.error)return Q.jsx("div",{className:"p-6",children:Q.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:Q.jsxs("div",{className:"flex",children:[Q.jsx("div",{className:"text-red-400",children:""}),Q.jsxs("div",{className:"ml-3",children:[Q.jsx("h3",{className:"text-sm font-medium text-red-800",children:""}),Q.jsx("p",{className:"mt-1 text-sm text-red-700",children:e.error}),Q.jsx("button",{onClick:r,className:"mt-2 bg-red-100 hover:bg-red-200 text-red-800 px-3 py-1 rounded text-sm",children:""})]})]})})});const{todayStats:s,last7DaysStats:i,staffPerformance:o,dailyTrend:l,exchangeRate:c,pendingAccountRequests:d,pendingRequestsDetail:u,lastUpdate:h}=e;return Q.jsxs("div",{className:"p-4 md:p-6 space-y-4 md:space-y-6",children:[Q.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3 md:p-4",children:Q.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-2",children:[Q.jsxs("div",{className:"flex items-center gap-2",children:[Q.jsx("span",{className:"text-blue-600",children:""}),Q.jsxs("span",{className:"font-medium text-blue-800 text-sm md:text-base",children:[": 1 USD = ",c.toFixed(2)," MXN"]})]}),Q.jsxs("div",{className:"text-xs md:text-sm text-blue-600",children:[": ",h]})]})}),Q.jsxs(OR,{children:[Q.jsx(IR,{children:Q.jsx(RR,{className:"flex items-center gap-2",children:" "})}),Q.jsxs(PR,{children:[Q.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-2 lg:grid-cols-4 gap-3 md:gap-6",children:[Q.jsxs("div",{className:"bg-red-50 rounded-lg p-3 md:p-4",children:[Q.jsx("div",{className:"text-xl md:text-2xl mb-1 md:mb-2",children:""}),Q.jsx("div",{className:"text-lg md:text-2xl font-bold text-red-600",children:n(s.adSpend)}),Q.jsx("div",{className:"text-xs md:text-sm text-gray-600",children:""})]}),Q.jsxs("div",{className:"bg-green-50 rounded-lg p-3 md:p-4",children:[Q.jsx("div",{className:"text-xl md:text-2xl mb-1 md:mb-2",children:""}),Q.jsx("div",{className:"text-sm md:text-lg font-bold text-green-600",children:a(s.creditCardAmount)}),Q.jsxs("div",{className:"text-xs md:text-sm text-green-500",children:[" ",n(s.creditCardAmountUSD)]}),Q.jsx("div",{className:"text-xs md:text-sm text-gray-600",children:""})]}),Q.jsxs("div",{className:"bg-blue-50 rounded-lg p-3 md:p-4",children:[Q.jsx("div",{className:"text-xl md:text-2xl mb-1 md:mb-2",children:""}),Q.jsx("div",{className:"text-lg md:text-2xl font-bold text-blue-600",children:n(s.costPerPaymentInfo)}),Q.jsx("div",{className:"text-xs md:text-sm text-gray-600",children:""})]}),Q.jsxs("div",{className:"bg-purple-50 rounded-lg p-3 md:p-4",children:[Q.jsx("div",{className:"text-xl md:text-2xl mb-1 md:mb-2",children:""}),Q.jsx("div",{className:"text-lg md:text-2xl font-bold text-purple-600",children:s.activeStaff}),Q.jsx("div",{className:"text-xs md:text-sm text-gray-600",children:""})]})]}),Q.jsxs("div",{className:"mt-3 md:mt-4 grid grid-cols-1 md:grid-cols-3 gap-3 md:gap-4",children:[Q.jsx("div",{className:"bg-orange-50 rounded-lg p-3 md:p-4",children:Q.jsxs("div",{className:"flex items-center justify-between",children:[Q.jsx("span",{className:"text-orange-600 text-sm md:text-base",children:""}),Q.jsx("span",{className:"font-bold text-orange-800 text-sm md:text-base",children:s.paymentInfoCount})]})}),Q.jsx("div",{className:"bg-teal-50 rounded-lg p-3 md:p-4",children:Q.jsxs("div",{className:"flex items-center justify-between",children:[Q.jsx("span",{className:"text-teal-600 text-sm md:text-base",children:""}),Q.jsx("span",{className:"font-bold text-teal-800 text-sm md:text-base",children:s.creditCardOrders})]})}),Q.jsxs("div",{className:"rounded-lg p-3 md:p-4 cursor-pointer hover:opacity-80 transition-opacity "+(d>0?"bg-red-50 animate-pulse":"bg-gray-50"),onClick:e=>{console.log(":",d),e.preventDefault(),window.dispatchEvent(new CustomEvent("navigateToModule",{detail:"account-requests"}))},children:[Q.jsxs("div",{className:"flex items-center justify-between",children:[Q.jsx("div",{className:"flex items-center gap-2",children:Q.jsxs("span",{className:"text-sm md:text-base "+(d>0?"text-red-600":"text-gray-600"),children:[d>0?"":""," "]})}),Q.jsx("span",{className:"font-bold text-sm md:text-base "+(d>0?"text-red-800":"text-gray-800"),children:d})]}),u.length>0&&Q.jsxs("div",{className:"mt-2 space-y-1",children:[u.slice(0,2).map((e,t)=>Q.jsxs("div",{className:"flex items-center justify-between text-xs",children:[Q.jsx("span",{className:"truncate",children:e.user_name||e.applicant_name||""}),Q.jsx("span",{className:"px-2 py-0.5 rounded-full text-xs "+("urgent"===e.urgency?"bg-red-200 text-red-800":"medium"===e.urgency?"bg-yellow-200 text-yellow-800":"bg-green-200 text-green-800"),children:"urgent"===e.urgency?"":"high"===e.urgency?"":"medium"===e.urgency?"":""})]},t)),u.length>2&&Q.jsxs("div",{className:"text-xs text-gray-500 text-center",children:["+",u.length-2," ..."]})]})]})]})]})]}),Q.jsxs(OR,{children:[Q.jsx(IR,{children:Q.jsx(RR,{className:"flex items-center gap-2",children:" 7"})}),Q.jsx(PR,{children:Q.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 md:gap-6",children:[Q.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[Q.jsx("div",{className:"text-xl mb-2",children:""}),Q.jsx("div",{className:"text-xl font-bold text-red-600",children:n(i.totalAdSpend)}),Q.jsx("div",{className:"text-sm text-gray-600",children:"7"})]}),Q.jsxs("div",{className:"bg-green-50 rounded-lg p-4",children:[Q.jsx("div",{className:"text-xl mb-2",children:""}),Q.jsx("div",{className:"text-lg font-bold text-green-600",children:a(i.totalCreditCardAmount)}),Q.jsxs("div",{className:"text-sm text-green-500",children:[" ",n(i.totalCreditCardAmountUSD)]}),Q.jsx("div",{className:"text-sm text-gray-600",children:"7"})]}),Q.jsxs("div",{className:"bg-blue-50 rounded-lg p-4",children:[Q.jsx("div",{className:"text-xl mb-2",children:""}),Q.jsx("div",{className:"text-xl font-bold text-blue-600",children:n(i.avgCostPerPaymentInfo)}),Q.jsx("div",{className:"text-sm text-gray-600",children:"7"})]}),Q.jsx("div",{className:"bg-orange-50 rounded-lg p-4",children:Q.jsxs("div",{className:"flex items-center justify-between",children:[Q.jsx("span",{className:"text-orange-600",children:"7"}),Q.jsx("span",{className:"font-bold text-orange-800",children:i.totalPaymentInfoCount})]})}),Q.jsx("div",{className:"bg-teal-50 rounded-lg p-4",children:Q.jsxs("div",{className:"flex items-center justify-between",children:[Q.jsx("span",{className:"text-teal-600",children:"7"}),Q.jsx("span",{className:"font-bold text-teal-800",children:i.totalCreditCardOrders})]})})]})})]}),Q.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4 md:gap-6",children:[Q.jsxs(OR,{children:[Q.jsx(IR,{children:Q.jsx(RR,{className:"flex items-center gap-2",children:" ROI (ROI)"})}),Q.jsxs(PR,{children:[Q.jsx("div",{className:"space-y-2 md:space-y-3",children:o.length>0?o.map((e,t)=>{const r=t===o.length-1&&o.length>1;return Q.jsxs("div",{className:"flex items-center justify-between p-2 md:p-3 rounded-lg transition-all duration-300 "+(r?"bg-gradient-to-r from-red-100 to-orange-100 border-2 border-red-300 animate-pulse":0===t?"bg-gradient-to-r from-yellow-100 to-yellow-200 border-2 border-yellow-400":"bg-gray-50"),children:[Q.jsxs("div",{className:"flex items-center gap-2 md:gap-3",children:[Q.jsx("div",{className:"w-6 h-6 md:w-8 md:h-8 rounded-full flex items-center justify-center text-white font-bold text-xs md:text-sm "+(0===t?"bg-yellow-500 animate-bounce":1===t?"bg-gray-400":2===t?"bg-orange-400":r?"bg-red-500 animate-bounce":"bg-blue-500"),children:r?"":t+1}),Q.jsxs("div",{children:[Q.jsxs("div",{className:"font-medium flex items-center gap-1 md:gap-2 text-sm md:text-base",children:[e.name,Q.jsx("span",{className:"px-1 md:px-2 py-0.5 md:py-1 text-xs rounded-full "+(r?"bg-red-200 text-red-800 animate-pulse":0===t?"bg-yellow-200 text-yellow-800":"bg-gray-200 text-gray-600"),children:0===t?" ROI":1===t?" ":2===t?" ":r?" ":`${t+1}`})]}),Q.jsxs("div",{className:"text-xs md:text-sm text-gray-500",children:[e.paymentInfoCount," "]})]})]}),Q.jsxs("div",{className:"text-right",children:[Q.jsx("div",{className:"font-bold text-sm md:text-lg "+(r?"text-red-600":0===t?"text-yellow-600":"text-blue-600"),children:e.roi.toFixed(2)}),Q.jsx("div",{className:"text-xs text-gray-500",children:"ROI"}),Q.jsx("div",{className:"text-xs md:text-sm text-gray-500",children:a(e.creditCardAmount)})]})]},e.name)}):Q.jsx("div",{className:"text-center py-8 text-gray-500",children:""})}),o.length>1&&Q.jsx("div",{className:"mt-4 p-3 bg-gradient-to-r from-red-50 to-orange-50 border border-red-200 rounded-lg",children:Q.jsxs("div",{className:"flex items-center gap-2 text-red-700",children:[Q.jsx("span",{className:"text-lg animate-bounce",children:""}),Q.jsx("span",{className:"font-medium",children:"ROI"}),Q.jsx("span",{className:"text-lg animate-spin",children:""})]})})]})]}),Q.jsxs(OR,{children:[Q.jsx(IR,{children:Q.jsx(RR,{className:"flex items-center gap-2",children:"  ()"})}),Q.jsxs(PR,{children:[Q.jsx("div",{className:"space-y-3",children:o.length>0?[...o].sort((e,t)=>t.creditCardAmountUSD-e.creditCardAmountUSD).map((e,t)=>{const r=t===o.length-1&&o.length>1;return Q.jsxs("div",{className:"flex items-center justify-between p-3 rounded-lg transition-all duration-300 "+(r?"bg-gradient-to-r from-orange-100 to-red-100 border-2 border-orange-300 animate-pulse":0===t?"bg-gradient-to-r from-yellow-100 to-yellow-200 border-2 border-yellow-400":"bg-gray-50"),children:[Q.jsxs("div",{className:"flex items-center gap-3",children:[Q.jsx("div",{className:"w-8 h-8 rounded-full flex items-center justify-center text-white font-bold "+(0===t?"bg-yellow-500 animate-bounce":1===t?"bg-gray-400":2===t?"bg-orange-400":r?"bg-orange-500 animate-pulse":"bg-blue-500"),children:r?"":t+1}),Q.jsxs("div",{children:[Q.jsxs("div",{className:"font-medium flex items-center gap-2",children:[e.name,Q.jsx("span",{className:"px-2 py-1 text-xs rounded-full "+(r?"bg-orange-200 text-orange-800 animate-bounce":0===t?"bg-yellow-200 text-yellow-800":"bg-gray-200 text-gray-600"),children:0===t?" ":1===t?" ":2===t?" ":r?" ":`${t+1}`})]}),Q.jsxs("div",{className:"text-sm text-gray-500",children:[e.paymentInfoCount," "]})]})]}),Q.jsxs("div",{className:"text-right",children:[Q.jsx("div",{className:"font-bold text-lg "+(r?"text-orange-600":0===t?"text-yellow-600":"text-green-600"),children:n(e.creditCardAmountUSD)}),Q.jsx("div",{className:"text-xs text-gray-500",children:""}),Q.jsx("div",{className:"text-sm text-gray-500",children:a(e.creditCardAmount)})]})]},e.name)}):Q.jsx("div",{className:"text-center py-8 text-gray-500",children:""})}),o.length>1&&Q.jsx("div",{className:"mt-4 p-3 bg-gradient-to-r from-orange-50 to-red-50 border border-orange-200 rounded-lg",children:Q.jsxs("div",{className:"flex items-center gap-2 text-orange-700",children:[Q.jsx("span",{className:"text-lg animate-bounce",children:""}),Q.jsx("span",{className:"font-medium",children:'""'}),Q.jsx("span",{className:"text-lg animate-spin",children:""})]})})]})]})]}),Q.jsxs(OR,{children:[Q.jsx(IR,{children:Q.jsx(RR,{className:"flex items-center gap-2",children:" 7"})}),Q.jsx(PR,{children:Q.jsx("div",{className:"overflow-x-auto",children:Q.jsxs("table",{className:"w-full text-sm",children:[Q.jsx("thead",{children:Q.jsxs("tr",{className:"border-b",children:[Q.jsx("th",{className:"text-left py-2",children:""}),Q.jsx("th",{className:"text-right py-2",children:"(USD)"}),Q.jsx("th",{className:"text-right py-2",children:"(MX$)"}),Q.jsx("th",{className:"text-right py-2",children:"(USD)"}),Q.jsx("th",{className:"text-right py-2",children:""}),Q.jsx("th",{className:"text-right py-2",children:"ROI"})]})}),Q.jsx("tbody",{children:l.map(e=>Q.jsxs("tr",{className:"border-b last:border-b-0",children:[Q.jsx("td",{className:"py-2",children:new Date(e.date).toLocaleDateString("zh-CN",{month:"short",day:"numeric"})}),Q.jsx("td",{className:"text-right py-2 text-red-600",children:n(e.adSpend)}),Q.jsx("td",{className:"text-right py-2 text-green-600",children:a(e.creditCardAmount)}),Q.jsx("td",{className:"text-right py-2 text-green-500",children:n(e.creditCardAmountUSD)}),Q.jsx("td",{className:"text-right py-2 text-blue-600",children:e.paymentInfoCount}),Q.jsx("td",{className:"text-right py-2 text-purple-600",children:e.roi.toFixed(2)})]},e.date))})]})})})]}),d>0&&Q.jsxs(OR,{children:[Q.jsx(IR,{children:Q.jsxs(RR,{className:"flex items-center gap-2",children:["  (",d,")"]})}),Q.jsxs(PR,{children:[Q.jsx("div",{className:"space-y-3",children:u.map((e,t)=>Q.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg hover:bg-gray-100 transition-colors",children:[Q.jsxs("div",{className:"flex items-center gap-3",children:[Q.jsx("div",{className:"w-3 h-3 rounded-full "+("urgent"===e.urgency?"bg-red-500 animate-pulse":"medium"===e.urgency?"bg-yellow-500":"bg-green-500")}),Q.jsxs("div",{children:[Q.jsx("div",{className:"font-medium text-sm md:text-base",children:e.user_name||""}),Q.jsxs("div",{className:"text-xs md:text-sm text-gray-500",children:["facebook"===e.request_type?"Facebook":"google"===e.request_type?"Google":"tiktok"===e.request_type?"TikTok":"","  : ",new Date(e.created_at).toLocaleDateString("zh-CN")]})]})]}),Q.jsxs("div",{className:"flex items-center gap-2",children:[Q.jsx("span",{className:"px-2 py-1 rounded-full text-xs "+("urgent"===e.urgency?"bg-red-200 text-red-800":"medium"===e.urgency?"bg-yellow-200 text-yellow-800":"bg-green-200 text-green-800"),children:"urgent"===e.urgency?"":"high"===e.urgency?"":"medium"===e.urgency?"":""}),Q.jsx("button",{onClick:()=>window.dispatchEvent(new CustomEvent("navigateToModule",{detail:"account-request"})),className:"px-3 py-1 bg-blue-500 text-white text-xs rounded hover:bg-blue-600 transition-colors",children:""})]})]},t))}),Q.jsx("div",{className:"mt-4 flex justify-center",children:Q.jsxs("button",{onClick:e=>{console.log(""),e.preventDefault(),window.dispatchEvent(new CustomEvent("navigateToModule",{detail:"account-requests"}))},className:"px-4 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600 transition-colors",children:["  (",d,")"]})})]})]}),Q.jsxs(OR,{children:[Q.jsx(IR,{children:Q.jsx(RR,{className:"flex items-center gap-2",children:" "})}),Q.jsx(PR,{children:Q.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[Q.jsxs("button",{onClick:()=>window.dispatchEvent(new CustomEvent("navigateToModule",{detail:"ad-data"})),className:"p-4 bg-blue-50 hover:bg-blue-100 rounded-lg text-center transition-colors",children:[Q.jsx("div",{className:"text-2xl mb-2",children:""}),Q.jsx("div",{className:"font-medium text-blue-800",children:""})]}),Q.jsxs("button",{onClick:()=>window.dispatchEvent(new CustomEvent("navigateToModule",{detail:"leaderboard"})),className:"p-4 bg-green-50 hover:bg-green-100 rounded-lg text-center transition-colors",children:[Q.jsx("div",{className:"text-2xl mb-2",children:""}),Q.jsx("div",{className:"font-medium text-green-800",children:""})]}),Q.jsxs("button",{onClick:()=>window.dispatchEvent(new CustomEvent("navigateToModule",{detail:"product-image"})),className:"p-4 bg-purple-50 hover:bg-purple-100 rounded-lg text-center transition-colors",children:[Q.jsx("div",{className:"text-2xl mb-2",children:""}),Q.jsx("div",{className:"font-medium text-purple-800",children:"PRO"})]}),Q.jsxs("button",{onClick:r,className:"p-4 bg-gray-50 hover:bg-gray-100 rounded-lg text-center transition-colors",children:[Q.jsx("div",{className:"text-2xl mb-2",children:""}),Q.jsx("div",{className:"font-medium text-gray-800",children:""})]})]})})]})]})},MR=()=>{const[e,t]=W.useState([]),[r,n]=W.useState(!0),[a,s]=W.useState(null);W.useEffect(()=>{i()},[]);const i=async()=>{try{console.log(" ...");const e=await fp.getAll();console.log(" :",e);const r="2025-07-19",n=e.filter(e=>e.date===r);console.log(" :",n),t(n),s(null)}catch(e){console.error(" :",e),s(e.message)}finally{n(!1)}};return r?Q.jsx("div",{className:"p-8 text-center",children:"..."}):a?Q.jsxs("div",{className:"p-8 text-center text-red-600",children:[": ",a]}):Q.jsxs("div",{className:"p-8 max-w-6xl mx-auto",children:[Q.jsx("h1",{className:"text-3xl font-bold mb-6",children:""}),Q.jsxs("div",{className:"bg-white rounded-lg shadow p-6 mb-6",children:[Q.jsxs("h2",{className:"text-xl font-semibold mb-4",children:[" (",e.length," )"]}),0===e.length?Q.jsx("p",{className:"text-gray-500",children:""}):e.map((e,t)=>Q.jsxs("div",{className:"border-b pb-4 mb-4 last:border-b-0",children:[Q.jsxs("h3",{className:"font-bold text-lg text-blue-600",children:[": ",e.staff]}),Q.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mt-2 text-sm",children:[Q.jsxs("div",{children:[Q.jsx("span",{className:"font-medium",children:":"})," ",e.date]}),Q.jsxs("div",{children:[Q.jsx("span",{className:"font-medium",children:":"})," $",e.ad_spend]}),Q.jsxs("div",{children:[Q.jsx("span",{className:"font-medium",children:":"})," MX$",e.credit_card_amount]}),Q.jsxs("div",{children:[Q.jsx("span",{className:"font-medium",children:":"})," ",e.credit_card_orders]}),Q.jsxs("div",{children:[Q.jsx("span",{className:"font-medium",children:":"})," ",e.payment_info_count]}),Q.jsxs("div",{children:[Q.jsx("span",{className:"font-medium",children:"ROI:"}),Q.jsx("span",{className:e.ad_spend>0?e.credit_card_amount>e.ad_spend?"text-green-600":"text-red-600":"text-gray-500",children:e.ad_spend>0?((e.credit_card_amount-e.ad_spend)/e.ad_spend*100).toFixed(1)+"%":"N/A"})]})]})]},e.id))]}),Q.jsx("button",{onClick:i,className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700",children:""})]})},FR=()=>{const[e,t]=W.useState([]),[r,n]=W.useState(!0);W.useEffect(()=>{a();const e=setInterval(()=>{a()},5e3);return()=>clearInterval(e)},[]);const a=()=>{try{const e=JSON.parse(localStorage.getItem("accountRequests")||"[]");t(e)}catch(e){console.error("Error loading requests:",e)}},s=e.filter(e=>"pending"===e.status),i=s.filter(e=>"high"===e.urgency),o=e.filter(e=>e.resetRequested&&"pending"===e.resetStatus);return 0===s.length&&0===o.length?null:Q.jsx(RC,{children:r&&Q.jsxs(AR.div,{initial:{y:-100,opacity:0},animate:{y:0,opacity:1},exit:{y:-100,opacity:0},transition:{duration:.5,ease:"easeOut"},className:`fixed top-0 left-0 right-0 z-[9999] ${i.length>0?"bg-gradient-to-r from-red-500 via-orange-500 to-red-500":"bg-gradient-to-r from-blue-500 via-purple-500 to-indigo-500"} text-white shadow-lg`,style:{zIndex:9999},children:[Q.jsxs("div",{className:"container mx-auto px-4 py-3",children:[Q.jsxs("div",{className:"flex items-center justify-between",children:[Q.jsxs("div",{className:"flex items-center space-x-4",children:[Q.jsx(AR.div,{animate:{rotate:i.length>0?[0,10,-10,0]:0,scale:i.length>0?[1,1.1,1]:1},transition:{repeat:i.length>0?1/0:0,duration:i.length>0?1:0},className:"text-2xl",children:i.length>0?"":""}),Q.jsxs("div",{className:"flex flex-wrap items-center space-x-6",children:[s.length>0&&Q.jsxs(AR.div,{animate:i.length>0?{opacity:[1,.7,1]}:{},transition:{repeat:i.length>0?1/0:0,duration:1.5},className:"flex items-center space-x-2",children:[Q.jsxs("span",{className:"font-semibold",children:[" : ",s.length," "]}),i.length>0&&Q.jsxs(AR.span,{animate:{scale:[1,1.2,1],color:["#ffffff","#ffff00","#ffffff"]},transition:{repeat:1/0,duration:1},className:"bg-red-600 px-2 py-1 rounded-full text-xs font-bold",children:[" : ",i.length," "]})]}),o.length>0&&Q.jsx(AR.div,{animate:{opacity:[1,.8,1]},transition:{repeat:1/0,duration:2},className:"flex items-center space-x-2",children:Q.jsxs("span",{className:"font-semibold",children:[" : ",o.length," "]})})]})]}),Q.jsx("button",{onClick:()=>n(!1),className:"text-white hover:text-gray-200 transition-colors p-1",children:Q.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:Q.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})})]}),i.length>0&&Q.jsx(AR.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},transition:{delay:.5,duration:.3},className:"mt-2 pt-2 border-t border-white/30",children:Q.jsxs("div",{className:"text-sm",children:[Q.jsx("span",{className:"font-medium",children:": "}),i.map((e,t)=>Q.jsxs(AR.span,{animate:{color:["#ffffff","#ffff00","#ffffff"]},transition:{repeat:1/0,duration:1.5,delay:.2*t},className:"mr-2 font-semibold",children:[e.requester,t<i.length-1&&", "]},e.id))]})})]}),i.length>0&&Q.jsx(AR.div,{animate:{opacity:[0,.3,0]},transition:{repeat:1/0,duration:2},className:"absolute inset-0 bg-red-400 pointer-events-none"})]})})},UR=()=>{const[e,t]=W.useState(""),[r,n]=W.useState(!1),[a,s]=W.useState(null),i=async()=>{if(e.trim()){n(!0),s(null);try{const t=e.replace(/^https?:\/\//,"").replace(/\/$/,""),r=`https://transparencyreport.google.com/safe-browsing/search?url=${encodeURIComponent(t)}&hl=zh_CN`,n=`https://dnschecker.org/country/mx/#A/${encodeURIComponent(t)}`;s({domain:t,safeBrowsingUrl:r,dnsCheckerUrl:n,timestamp:(new Date).toLocaleString("zh-CN")})}catch(t){console.error(":",t),alert("")}finally{n(!1)}}else alert("")};return Q.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-6",children:[Q.jsx("h2",{className:"text-2xl font-bold text-slate-800 mb-6 flex items-center",children:" "}),Q.jsxs("div",{className:"bg-blue-50 rounded-xl p-4 border border-blue-200 mb-6",children:[Q.jsx("h3",{className:"font-bold text-blue-800 mb-3",children:""}),Q.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[Q.jsx("input",{type:"text",value:e,onChange:e=>t(e.target.value),placeholder:"www.example.com",className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",onKeyPress:e=>"Enter"===e.key&&i()}),Q.jsxs("div",{className:"flex gap-2",children:[Q.jsx("button",{onClick:i,disabled:r,className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed whitespace-nowrap",children:r?"...":""}),Q.jsx("button",{onClick:()=>{t(""),s(null)},className:"px-4 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600",children:""})]})]})]}),Q.jsxs("div",{className:"bg-yellow-50 rounded-xl p-4 border border-yellow-200 mb-6",children:[Q.jsx("h3",{className:"font-bold text-yellow-800 mb-2",children:""}),Q.jsxs("div",{className:"text-sm text-yellow-700 space-y-1",children:[Q.jsxs("p",{children:[" ",Q.jsx("strong",{children:"Google :"})," "]}),Q.jsxs("p",{children:[" ",Q.jsx("strong",{children:"DNS :"})," DNS"]}),Q.jsx("p",{children:" "})]})]}),a&&Q.jsxs("div",{className:"space-y-4",children:[Q.jsxs("div",{className:"bg-green-50 rounded-xl p-4 border border-green-200",children:[Q.jsxs("h3",{className:"font-bold text-green-800 mb-3",children:["  - ",a.domain]}),Q.jsxs("p",{className:"text-sm text-green-600 mb-3",children:[": ",a.timestamp]})]}),Q.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[Q.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl p-4",children:[Q.jsxs("h4",{className:"font-bold text-gray-800 mb-3 flex items-center",children:[Q.jsx("span",{className:"mr-2",children:""}),"Google "]}),Q.jsx("p",{className:"text-sm text-gray-600 mb-3",children:""}),Q.jsxs("a",{href:a.safeBrowsingUrl,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center px-4 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600 transition-colors",children:[Q.jsx("span",{className:"mr-2",children:""})," Google "]})]}),Q.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl p-4",children:[Q.jsxs("h4",{className:"font-bold text-gray-800 mb-3 flex items-center",children:[Q.jsx("span",{className:"mr-2",children:""}),"DNS  ()"]}),Q.jsx("p",{className:"text-sm text-gray-600 mb-3",children:"DNS"}),Q.jsxs("a",{href:a.dnsCheckerUrl,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors",children:[Q.jsx("span",{className:"mr-2",children:""})," DNS "]})]})]}),Q.jsxs("div",{className:"bg-gray-50 rounded-xl p-4 border border-gray-200",children:[Q.jsx("h4",{className:"font-bold text-gray-800 mb-2",children:" "}),Q.jsxs("div",{className:"text-sm text-gray-600 space-y-1",children:[Q.jsx("p",{children:" "}),Q.jsx("p",{children:" Google : "}),Q.jsx("p",{children:" DNS : "}),Q.jsx("p",{children:" "})]})]})]}),Q.jsxs("div",{className:"mt-6 bg-gray-50 rounded-xl p-4 border border-gray-200",children:[Q.jsx("h3",{className:"font-bold text-gray-800 mb-3",children:""}),Q.jsx("div",{className:"flex flex-wrap gap-2",children:["www.google.com","www.facebook.com","www.mercadotodas.com"].map(e=>Q.jsx("button",{onClick:()=>t(e),className:"px-3 py-1 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 text-sm",children:e},e))})]})]})};class BR extends H.Component{constructor(e){super(e),this.state={hasError:!1,error:null,errorInfo:null}}static getDerivedStateFromError(e){return{hasError:!0}}componentDidCatch(e,t){console.error(":",e),console.error(":",t),this.setState({error:e,errorInfo:t})}render(){if(this.state.hasError){const{customFallback:e,componentName:t}=this.props;return e||Q.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center p-4",children:Q.jsx("div",{className:"max-w-md w-full bg-white rounded-lg shadow-lg p-6",children:Q.jsxs("div",{className:"text-center",children:[Q.jsx("div",{className:"text-6xl mb-4",children:""}),Q.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:""}),Q.jsxs("p",{className:"text-gray-600 mb-6",children:[t?`${t}`:"",""]}),Q.jsxs("div",{className:"space-y-3",children:[Q.jsx("button",{onClick:()=>window.location.reload(),className:"w-full bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors",children:" "}),Q.jsx("button",{onClick:()=>this.setState({hasError:!1,error:null,errorInfo:null}),className:"w-full bg-gray-600 text-white px-4 py-2 rounded-lg hover:bg-gray-700 transition-colors",children:" "})]}),!1]})})})}return this.props.children}}const $R=({size:e="default",message:t="...",className:r=""})=>Q.jsxs("div",{className:`flex flex-col items-center justify-center ${r}`,children:[Q.jsx("div",{className:`animate-spin rounded-full border-2 border-gray-300 border-t-blue-600 ${{small:"h-4 w-4",default:"h-8 w-8",large:"h-12 w-12"}[e]}`}),t&&Q.jsx("p",{className:"mt-2 text-sm text-gray-600",children:t})]}),zR=({children:e,componentName:t,fallbackMessage:r="",showLoading:n=!1,loadingMessage:a="...",className:s="",customFallback:i=null})=>{const[o,l]=W.useState(!1);if(W.useEffect(()=>{l(!0)},[]),!o&&n)return Q.jsx("div",{className:`p-6 ${s}`,children:Q.jsx($R,{message:a})});const c=i||Q.jsx("div",{className:`p-6 bg-red-50 border border-red-200 rounded-lg ${s}`,children:Q.jsxs("div",{className:"text-center",children:[Q.jsx("div",{className:"text-4xl mb-2",children:""}),Q.jsxs("h3",{className:"text-lg font-semibold text-red-800 mb-2",children:[t||"",""]}),Q.jsx("p",{className:"text-red-600 text-sm mb-4",children:r}),Q.jsx("button",{onClick:()=>window.location.reload(),className:"bg-red-600 text-white px-4 py-2 rounded hover:bg-red-700 transition-colors",children:""})]})});return Q.jsx(BR,{componentName:t,customFallback:c,children:e})},VR=()=>{const[e,t]=W.useState({loading:!0,error:null,stats:{totalUsers:0,totalRevenue:0,totalOrders:0,activeProjects:0},lastUpdate:""});W.useEffect(()=>{r()},[]);const r=async()=>{try{t(e=>({...e,loading:!0,error:null})),await new Promise(e=>setTimeout(e,1e3));t({loading:!1,error:null,stats:{totalUsers:156,totalRevenue:25680,totalOrders:342,activeProjects:8},lastUpdate:(new Date).toLocaleTimeString("zh-CN")})}catch(e){console.error(":",e),t(e=>({...e,loading:!1,error:""}))}};if(e.loading)return Q.jsx("div",{className:"p-6",children:Q.jsx("div",{className:"flex items-center justify-center min-h-96",children:Q.jsx($R,{size:"large",message:"..."})})});if(e.error)return Q.jsx("div",{className:"p-6",children:Q.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:Q.jsxs("div",{className:"flex",children:[Q.jsx("div",{className:"text-yellow-400",children:""}),Q.jsxs("div",{className:"ml-3",children:[Q.jsx("h3",{className:"text-sm font-medium text-yellow-800",children:""}),Q.jsx("p",{className:"mt-1 text-sm text-yellow-700",children:e.error}),Q.jsx("button",{onClick:r,className:"mt-2 bg-yellow-100 hover:bg-yellow-200 text-yellow-800 px-3 py-1 rounded text-sm",children:""})]})]})})});const{stats:n,lastUpdate:a}=e;return Q.jsxs("div",{className:"p-6 space-y-6",children:[Q.jsx("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 border border-blue-200 rounded-lg p-4",children:Q.jsxs("div",{className:"flex items-center justify-between",children:[Q.jsxs("div",{children:[Q.jsx("h1",{className:"text-2xl font-bold text-blue-900",children:""}),Q.jsx("p",{className:"text-blue-700 text-sm",children:""})]}),Q.jsxs("div",{className:"text-blue-600 text-sm",children:[": ",a]})]})}),Q.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[Q.jsxs(OR,{className:"hover:shadow-lg transition-shadow duration-200",children:[Q.jsx(IR,{className:"pb-2",children:Q.jsx(RR,{className:"text-sm font-medium text-gray-600",children:""})}),Q.jsx(PR,{children:Q.jsxs("div",{className:"flex items-center",children:[Q.jsx("div",{className:"text-2xl mr-2",children:""}),Q.jsxs("div",{children:[Q.jsx("div",{className:"text-2xl font-bold text-blue-600",children:n.totalUsers}),Q.jsx("div",{className:"text-xs text-green-600",children:" +12.5%"})]})]})})]}),Q.jsxs(OR,{className:"hover:shadow-lg transition-shadow duration-200",children:[Q.jsx(IR,{className:"pb-2",children:Q.jsx(RR,{className:"text-sm font-medium text-gray-600",children:""})}),Q.jsx(PR,{children:Q.jsxs("div",{className:"flex items-center",children:[Q.jsx("div",{className:"text-2xl mr-2",children:""}),Q.jsxs("div",{children:[Q.jsxs("div",{className:"text-2xl font-bold text-green-600",children:["$",n.totalRevenue.toLocaleString()]}),Q.jsx("div",{className:"text-xs text-green-600",children:" +8.3%"})]})]})})]}),Q.jsxs(OR,{className:"hover:shadow-lg transition-shadow duration-200",children:[Q.jsx(IR,{className:"pb-2",children:Q.jsx(RR,{className:"text-sm font-medium text-gray-600",children:""})}),Q.jsx(PR,{children:Q.jsxs("div",{className:"flex items-center",children:[Q.jsx("div",{className:"text-2xl mr-2",children:""}),Q.jsxs("div",{children:[Q.jsx("div",{className:"text-2xl font-bold text-purple-600",children:n.totalOrders}),Q.jsx("div",{className:"text-xs text-green-600",children:" +15.2%"})]})]})})]}),Q.jsxs(OR,{className:"hover:shadow-lg transition-shadow duration-200",children:[Q.jsx(IR,{className:"pb-2",children:Q.jsx(RR,{className:"text-sm font-medium text-gray-600",children:""})}),Q.jsx(PR,{children:Q.jsxs("div",{className:"flex items-center",children:[Q.jsx("div",{className:"text-2xl mr-2",children:""}),Q.jsxs("div",{children:[Q.jsx("div",{className:"text-2xl font-bold text-orange-600",children:n.activeProjects}),Q.jsx("div",{className:"text-xs text-green-600",children:" +9.1%"})]})]})})]})]}),Q.jsxs(OR,{children:[Q.jsx(IR,{children:Q.jsx(RR,{className:"flex items-center gap-2",children:" "})}),Q.jsx(PR,{children:Q.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[Q.jsxs("button",{onClick:()=>window.dispatchEvent(new CustomEvent("navigateToModule",{detail:"input"})),className:"p-4 bg-blue-50 hover:bg-blue-100 rounded-lg text-center transition-colors duration-200",children:[Q.jsx("div",{className:"text-2xl mb-2",children:""}),Q.jsx("div",{className:"text-sm font-medium text-blue-700",children:""})]}),Q.jsxs("button",{onClick:()=>window.dispatchEvent(new CustomEvent("navigateToModule",{detail:"daily"})),className:"p-4 bg-green-50 hover:bg-green-100 rounded-lg text-center transition-colors duration-200",children:[Q.jsx("div",{className:"text-2xl mb-2",children:""}),Q.jsx("div",{className:"text-sm font-medium text-green-700",children:""})]}),Q.jsxs("button",{onClick:()=>window.dispatchEvent(new CustomEvent("navigateToModule",{detail:"roi-ranking"})),className:"p-4 bg-purple-50 hover:bg-purple-100 rounded-lg text-center transition-colors duration-200",children:[Q.jsx("div",{className:"text-2xl mb-2",children:""}),Q.jsx("div",{className:"text-sm font-medium text-purple-700",children:"ROI"})]}),Q.jsxs("button",{onClick:()=>window.dispatchEvent(new CustomEvent("navigateToModule",{detail:"export"})),className:"p-4 bg-orange-50 hover:bg-orange-100 rounded-lg text-center transition-colors duration-200",children:[Q.jsx("div",{className:"text-2xl mb-2",children:""}),Q.jsx("div",{className:"text-sm font-medium text-orange-700",children:""})]})]})})]}),Q.jsxs(OR,{children:[Q.jsx(IR,{children:Q.jsx(RR,{className:"flex items-center gap-2",children:" "})}),Q.jsx(PR,{children:Q.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[Q.jsxs("div",{className:"flex items-center justify-between p-3 bg-green-50 rounded-lg",children:[Q.jsx("span",{className:"text-sm text-green-700",children:""}),Q.jsxs("span",{className:"flex items-center text-green-600",children:[Q.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full mr-2"}),""]})]}),Q.jsxs("div",{className:"flex items-center justify-between p-3 bg-green-50 rounded-lg",children:[Q.jsx("span",{className:"text-sm text-green-700",children:""}),Q.jsxs("span",{className:"flex items-center text-green-600",children:[Q.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full mr-2"}),""]})]}),Q.jsxs("div",{className:"flex items-center justify-between p-3 bg-green-50 rounded-lg",children:[Q.jsx("span",{className:"text-sm text-green-700",children:""}),Q.jsx("span",{className:"text-green-600 text-sm",children:"2"})]})]})})]})]})},WR=()=>Q.jsxs("div",{className:"p-6 space-y-6",children:[Q.jsx("div",{className:"bg-yellow-50 border-l-4 border-yellow-400 p-4",children:Q.jsxs("div",{className:"flex",children:[Q.jsx("div",{className:"text-yellow-400 mr-3",children:Q.jsx("svg",{className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:Q.jsx("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})})}),Q.jsxs("div",{children:[Q.jsx("h3",{className:"text-sm font-medium text-yellow-800",children:""}),Q.jsx("div",{className:"mt-2 text-sm text-yellow-700",children:Q.jsx("p",{children:"..."})})]})]})}),Q.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[Q.jsx("div",{className:"bg-white overflow-hidden shadow rounded-lg",children:Q.jsx("div",{className:"p-5",children:Q.jsxs("div",{className:"flex items-center",children:[Q.jsx("div",{className:"flex-shrink-0",children:Q.jsx("div",{className:"text-3xl",children:""})}),Q.jsx("div",{className:"ml-5 w-0 flex-1",children:Q.jsxs("dl",{children:[Q.jsx("dt",{className:"text-sm font-medium text-gray-500 truncate",children:""}),Q.jsx("dd",{className:"text-lg font-medium text-gray-900",children:""})]})})]})})}),Q.jsx("div",{className:"bg-white overflow-hidden shadow rounded-lg",children:Q.jsx("div",{className:"p-5",children:Q.jsxs("div",{className:"flex items-center",children:[Q.jsx("div",{className:"flex-shrink-0",children:Q.jsx("div",{className:"text-3xl",children:""})}),Q.jsx("div",{className:"ml-5 w-0 flex-1",children:Q.jsxs("dl",{children:[Q.jsx("dt",{className:"text-sm font-medium text-gray-500 truncate",children:""}),Q.jsx("dd",{className:"text-lg font-medium text-gray-900",children:""})]})})]})})}),Q.jsx("div",{className:"bg-white overflow-hidden shadow rounded-lg",children:Q.jsx("div",{className:"p-5",children:Q.jsxs("div",{className:"flex items-center",children:[Q.jsx("div",{className:"flex-shrink-0",children:Q.jsx("div",{className:"text-3xl",children:""})}),Q.jsx("div",{className:"ml-5 w-0 flex-1",children:Q.jsxs("dl",{children:[Q.jsx("dt",{className:"text-sm font-medium text-gray-500 truncate",children:""}),Q.jsx("dd",{className:"text-lg font-medium text-gray-900",children:""})]})})]})})}),Q.jsx("div",{className:"bg-white overflow-hidden shadow rounded-lg",children:Q.jsx("div",{className:"p-5",children:Q.jsxs("div",{className:"flex items-center",children:[Q.jsx("div",{className:"flex-shrink-0",children:Q.jsx("div",{className:"text-3xl",children:""})}),Q.jsx("div",{className:"ml-5 w-0 flex-1",children:Q.jsxs("dl",{children:[Q.jsx("dt",{className:"text-sm font-medium text-gray-500 truncate",children:""}),Q.jsx("dd",{className:"text-lg font-medium text-gray-900",children:""})]})})]})})})]}),Q.jsx("div",{className:"bg-white shadow rounded-lg",children:Q.jsxs("div",{className:"px-4 py-5 sm:p-6",children:[Q.jsx("h3",{className:"text-lg leading-6 font-medium text-gray-900",children:""}),Q.jsx("div",{className:"mt-5",children:Q.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[Q.jsx("button",{onClick:()=>window.location.reload(),className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:" "}),Q.jsx("button",{onClick:()=>window.dispatchEvent(new CustomEvent("navigateToModule",{detail:"input"})),className:"inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:" "}),Q.jsx("button",{onClick:()=>window.dispatchEvent(new CustomEvent("navigateToModule",{detail:"daily"})),className:"inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:" "}),Q.jsx("button",{onClick:()=>window.dispatchEvent(new CustomEvent("navigateToModule",{detail:"export"})),className:"inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:" "})]})})]})}),Q.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:Q.jsxs("div",{className:"flex",children:[Q.jsx("div",{className:"text-blue-400 mr-3",children:Q.jsx("svg",{className:"h-5 w-5",fill:"currentColor",viewBox:"0 0 20 20",children:Q.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z",clipRule:"evenodd"})})}),Q.jsxs("div",{children:[Q.jsx("h3",{className:"text-sm font-medium text-blue-800",children:""}),Q.jsx("div",{className:"mt-2 text-sm text-blue-700",children:Q.jsx("p",{children:""})})]})]})})]});class HR extends H.Component{constructor(e){super(e),t(this,"handleReload",()=>{window.location.reload()}),t(this,"handleReset",()=>{this.setState({hasError:!1,error:null,errorInfo:null,errorId:null})}),this.state={hasError:!1,error:null,errorInfo:null,errorId:null}}static getDerivedStateFromError(e){return{hasError:!0,error:e,errorId:Date.now()}}componentDidCatch(e,t){console.error(":",e),console.error(":",t),this.setState({error:e,errorInfo:t,errorId:Date.now()})}render(){return this.state.hasError?Q.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center p-6",children:Q.jsx("div",{className:"max-w-lg w-full",children:Q.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-8 text-center",children:[Q.jsx(tj,{className:"mx-auto mb-6 text-red-500",size:64}),Q.jsx("h1",{className:"text-2xl font-bold text-gray-800 mb-4",children:""}),Q.jsx("p",{className:"text-gray-600 mb-6",children:""}),Q.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 mb-6 text-left",children:[Q.jsx("h3",{className:"font-semibold mb-3 text-gray-800",children:""}),Q.jsxs("ul",{className:"space-y-2 text-sm text-gray-700",children:[Q.jsxs("li",{className:"flex items-start",children:[Q.jsx("span",{className:"font-medium mr-2",children:"1."}),Q.jsx("span",{children:'""'})]}),Q.jsxs("li",{className:"flex items-start",children:[Q.jsx("span",{className:"font-medium mr-2",children:"2."}),Q.jsx("span",{children:""})]}),Q.jsxs("li",{className:"flex items-start",children:[Q.jsx("span",{className:"font-medium mr-2",children:"3."}),Q.jsx("span",{children:""})]})]})]}),Q.jsxs("div",{className:"flex gap-3 mb-6",children:[Q.jsx("button",{onClick:this.handleReload,className:"flex-1 bg-blue-600 hover:bg-blue-700 text-white font-medium px-6 py-3 rounded-lg transition-colors",children:""}),Q.jsx("button",{onClick:this.handleReset,className:"flex-1 bg-gray-500 hover:bg-gray-600 text-white font-medium px-6 py-3 rounded-lg transition-colors",children:""})]}),!1,Q.jsxs("div",{className:"mt-6 pt-4 border-t border-gray-200",children:[Q.jsxs("p",{className:"text-xs text-gray-500",children:["ID: ",this.state.errorId]}),Q.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"ID"})]})]})})}):this.props.children}}function GR(){const[e,t]=W.useState("overview"),[r,n]=W.useState(!1),[a,s]=W.useState(!1);W.useEffect(()=>{window.addEventListener("unhandledrejection",e=>{console.error("Promise:",e.reason),e.preventDefault()}),window.addEventListener("error",e=>{console.error("JavaScript:",e.error)})},[]),W.useEffect(()=>{const e=e=>{t("account-requests")},r=e=>{const r=e.detail;r&&t(r)};return window.addEventListener("navigateToAccountRequests",e),window.addEventListener("navigateToModule",r),()=>{window.removeEventListener("navigateToAccountRequests",e),window.removeEventListener("navigateToModule",r)}},[]),W.useEffect(()=>{"authenticated"===localStorage.getItem("websiteAuth")&&s(!0)},[]);const i=e=>{s(e)};return a?Q.jsx(BR,{componentName:"",children:Q.jsx(uu,{children:Q.jsxs("div",{className:"min-h-screen bg-gray-50 transition-colors duration-200",children:[Q.jsx(zR,{componentName:"",fallbackMessage:"",children:Q.jsx(FR,{})}),Q.jsx(zR,{componentName:"",fallbackMessage:"",children:Q.jsx(hu,{onMenuToggle:()=>n(!r),onLogout:()=>{localStorage.removeItem("websiteAuth"),s(!1),t("overview")},isAuthenticated:a})}),Q.jsxs("div",{className:"flex",children:[Q.jsx(zR,{componentName:"",fallbackMessage:"",children:Q.jsx(fu,{activeTab:e,setActiveTab:t,isOpen:r,onClose:()=>n(!1)})}),Q.jsx("main",{className:"flex-1 lg:ml-64 min-h-screen transition-all duration-200 ease-in-out",children:Q.jsx("div",{className:"p-6",children:Q.jsx("div",{className:"max-w-7xl mx-auto",children:Q.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden",children:Q.jsx(BR,{componentName:"",children:(()=>{try{switch(e){case"overview":default:return Q.jsx(zR,{componentName:"",fallbackMessage:"",customFallback:Q.jsx(zR,{componentName:"",fallbackMessage:"",customFallback:Q.jsx(WR,{}),children:Q.jsx(VR,{})}),children:Q.jsx(LR,{})});case"input":return Q.jsx(zR,{componentName:"",fallbackMessage:"",children:Q.jsx(Tj,{})});case"recharge-input":return Q.jsx(zR,{componentName:"",fallbackMessage:"",children:Q.jsx(wp,{})});case"daily":return Q.jsx(zR,{componentName:"",fallbackMessage:"",children:Q.jsx(pp,{})});case"roi-ranking":return Q.jsx(HR,{componentName:"ROI",errorMessage:"ROI",children:Q.jsx(vp,{})});case"leaderboard":return Q.jsx(zR,{componentName:"",fallbackMessage:"",children:Q.jsx(bp,{})});case"export":return Q.jsx(zR,{componentName:"",fallbackMessage:"",children:Q.jsx(yp,{})});case"account-management-3d":return Q.jsx(HR,{componentName:"",errorMessage:"",showReload:!0,children:Q.jsx(bj,{})});case"daily-orders":return Q.jsx(zR,{componentName:"",fallbackMessage:"",children:Q.jsx(kp,{})});case"product-downloader":return Q.jsx(zR,{componentName:"",fallbackMessage:"",children:Q.jsx(WN,{})});case"product-image":return Q.jsx(zR,{componentName:"",fallbackMessage:"",children:Q.jsx(WN,{})});case"account-reset":return Q.jsx(zR,{componentName:"",fallbackMessage:"",children:Q.jsx(GN,{})});case"recharge":return Q.jsx(zR,{componentName:"",fallbackMessage:"",children:Q.jsx(_p,{})});case"ad-data":return Q.jsx(zR,{componentName:"",fallbackMessage:"",children:Q.jsx(Ej,{})});case"test-data":return Q.jsx(zR,{componentName:"",fallbackMessage:"",children:Q.jsx(MR,{})});case"commission-system":return Q.jsx(zR,{componentName:"",fallbackMessage:"",children:Q.jsx(Nj,{})});case"three-column-commission":return Q.jsx(zR,{componentName:"",fallbackMessage:"",children:Q.jsx(jj,{})});case"commission-leaderboard":return Q.jsx(zR,{componentName:"",fallbackMessage:"",children:Q.jsx(Sj,{})});case"website-checker":return Q.jsx(zR,{componentName:"",fallbackMessage:"",children:Q.jsx(UR,{})})}}catch(t){return console.error(":",t),Q.jsx("div",{className:"p-6 bg-red-50 border border-red-200 rounded-lg",children:Q.jsxs("div",{className:"text-center",children:[Q.jsx("div",{className:"text-4xl mb-2",children:""}),Q.jsx("h3",{className:"text-lg font-semibold text-red-800 mb-2",children:""}),Q.jsx("p",{className:"text-red-600 text-sm mb-4",children:""}),Q.jsx("button",{onClick:()=>window.location.reload(),className:"bg-red-600 text-white px-4 py-2 rounded hover:bg-red-700 transition-colors",children:""})]})})}})()})})})})})]}),Q.jsx("style",{jsx:!0,global:!0,children:"\n          * {\n            scrollbar-width: thin;\n            scrollbar-color: #e5e7eb #f9fafb;\n          }\n          \n          *::-webkit-scrollbar {\n            width: 6px;\n          }\n          \n          *::-webkit-scrollbar-track {\n            background: #f9fafb;\n          }\n          \n          *::-webkit-scrollbar-thumb {\n            background-color: #e5e7eb;\n            border-radius: 3px;\n          }\n          \n          *::-webkit-scrollbar-thumb:hover {\n            background-color: #d1d5db;\n          }\n          \n          .material-shadow {\n            box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1), 0 1px 2px 0 rgba(0, 0, 0, 0.06);\n          }\n          \n          .material-shadow-md {\n            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);\n          }\n          \n          .material-shadow-lg {\n            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);\n          }\n          \n          .hover-lift {\n            transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);\n          }\n          \n          .hover-lift:hover {\n            transform: translateY(-1px);\n            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);\n          }\n          \n          .material-ripple {\n            position: relative;\n            overflow: hidden;\n          }\n          \n          .material-ripple:before {\n            content: '';\n            position: absolute;\n            top: 50%;\n            left: 50%;\n            width: 0;\n            height: 0;\n            border-radius: 50%;\n            background: rgba(255, 255, 255, 0.3);\n            transform: translate(-50%, -50%);\n            transition: width 0.3s, height 0.3s;\n          }\n          \n          .material-ripple:active:before {\n            width: 300px;\n            height: 300px;\n          }\n          \n          /*  */\n          .leaderboard-entrance {\n            animation: slideInFromBottom 0.8s cubic-bezier(0.25, 0.46, 0.45, 0.94);\n          }\n          \n          .leaderboard-glow {\n            animation: gentleGlow 3s ease-in-out infinite alternate;\n          }\n          \n          .medal-bounce {\n            animation: medalBounce 2s ease-in-out infinite;\n          }\n          \n          .rank-pulse {\n            animation: rankPulse 2s ease-in-out infinite;\n          }\n          \n          .fade-in-up {\n            animation: fadeInUp 0.6s ease-out;\n          }\n          \n          @keyframes slideInFromBottom {\n            from {\n              transform: translateY(100px);\n              opacity: 0;\n            }\n            to {\n              transform: translateY(0);\n              opacity: 1;\n            }\n          }\n          \n          @keyframes gentleGlow {\n            from {\n              box-shadow: 0 0 20px rgba(168, 85, 247, 0.3);\n            }\n            to {\n              box-shadow: 0 0 40px rgba(168, 85, 247, 0.6);\n            }\n          }\n          \n          @keyframes medalBounce {\n            0%, 100% {\n              transform: translateY(0) scale(1);\n            }\n            50% {\n              transform: translateY(-10px) scale(1.1);\n            }\n          }\n          \n          @keyframes rankPulse {\n            0%, 100% {\n              transform: scale(1);\n            }\n            50% {\n              transform: scale(1.05);\n            }\n          }\n          \n          @keyframes fadeInUp {\n            from {\n              transform: translateY(30px);\n              opacity: 0;\n            }\n            to {\n              transform: translateY(0);\n              opacity: 1;\n            }\n          }\n          \n          /*  */\n          @media (max-width: 768px) {\n            .leaderboard-grid {\n              grid-template-columns: 1fr;\n            }\n          }\n          \n          @media (min-width: 769px) and (max-width: 1024px) {\n            .leaderboard-grid {\n              grid-template-columns: repeat(2, 1fr);\n            }\n          }\n          \n          @media (min-width: 1025px) {\n            .leaderboard-grid {\n              grid-template-columns: repeat(3, 1fr);\n            }\n          }\n        "})]})})}):Q.jsx(lu,{onLogin:i})}iu(document.getElementById("root")).render(Q.jsx(W.StrictMode,{children:Q.jsx(GR,{})}));
